html

<body class="db air__layout--appMaxWidth air__menu--white air__layout--cardsShadow" style="overflow: inherit;">
  <div class="db air__layout">
    <div class="db air__layout__header">
      <div class="db air__utils__header">
        <div class="db air__topbar" style="padding: 0rem 0.33rem;">
          <div class="db air__topbar__searchDropdown dropdown mr-md-4 mr-auto">
            <div class="db air__subbar" style="border-bottom: 0px solid #e4e9f0 !important;">
              <ul class="db air__subbar__breadcrumbs mr-4" style="align-items: center;">

                <li class="db air__subbar__breadcrumb">
                  <a routerLink="/client/clientdashboard/clientdashboardview" href="javascript:void(0)" class="db air__subbar__breadcrumbLink">
                    <div class="db air__auth__logo__name" style="margin-left: 0rem;">
                      <span class="db font-size-32" style="color: #6EACAF !important;">D</span><span
                        class="db text-secondary font-size-32">C</span>
                    </div>
                  </a>
                </li>

                <li class="db air__subbar__breadcrumb dashboardicon">
                  <div class="db launcher">
                    <div class="db button"><img alt="" src="./assets/svg/icon--apps.svg" (click)="showdashboardmenu()" /></div>
                    <div class="db app-launcher" *ngIf="dashboardmenu">
                      <div class="db apps" style="    left: -22px;">
                        <ul class="db first-set">
                          <li class="db mb-1"><a routerLink="/client/clientdashboard/clientdashboardview" (click)="gallery()"><img alt="" src="./assets/svg/dash.svg" style="max-height: 50px;" /><span class="db pt-1">Dashboard</span></a></li>
                          <li class="db mb-1" *ngIf="sessionrole!='Reviewer'"><a routerLink="/client/masterlibrary" (click)="library()"><img alt="" src="./assets/svg/lib_1.svg" style="max-height: 50px;"/><span class="db pt-1">Library</span></a></li>
                          <li class="db mb-1" *ngIf="sessionrole!='Reviewer'"><a routerLink="/client/managedocument" (click)="Mydocument()"><img alt="" src="./assets/svg/doc.svg" style="max-height: 50px;"/><span class="db pt-1">Document</span></a></li>
                          <li class="db mt-2" *ngIf="sessionrole!='Reviewer'"><a routerLink="/client/datadictionary" (click)="datadictionary()"><img alt="" src="./assets/svg/dic.svg" style="max-height: 50px;"/><span class="db pt-1">Dictionary</span></a></li>
                          <li [ngClass]="sessionrole!='Reviewer'?'mt-2':'mt-0'"><a routerLink="/client/imagegallery" (click)="ImageGallery()"><img alt="" src="./assets/svg/gallery.svg" style="max-height: 50px;"/><span class="db pt-1">Gallery</span></a></li>
                          <li class="db mt-2" *ngIf="sessionrole!='Reviewer'"><a  routerLink="/client/clientdashboard/overalldocumentstatus" (click)="report()"><img src="./assets/svg/rep.svg" alt="" style="max-height: 50px;"/><span class="db pt-1">Report</span></a></li>
                         <li [ngClass]="sessionrole!='Reviewer'?'mt-2':'mt-0'"><a routerLink="/client/inbox" (click)="inbox()"><img alt="" src="./assets/svg/inbox_menu.svg" style="max-height: 50px;"/><span class="db pt-1">Inbox <span class="db badge badge-dark" *ngIf="operationMessage!=0" [minFontSize]='7' fittext style="position: absolute;top: 0rem;left: 3.3rem;height: 24px;width: 24px;color: #fff;border-radius: 50%;">{{operationMessage}}</span></span></a></li>
                          <li class="db mt-2" *ngIf="sessionrole!='Reviewer'"><a routerLink="/client/adminct/manageuser"(click)="admin()"><img alt="" src="./assets/svg/admin.svg" style="max-height: 50px;"/><span class="db pt-1">Admin</span></a></li>
                         <li class="db mb-1"><a routerLink="/profile" (click)="myprof()"><img alt=""src="./assets/svg/profile.svg" style="max-height: 50px;    margin-top: 10px;"/><span class="db pt-1">My Profile</span></a></li>                  
                  </ul><a class="db more mt-2" (click)="logout()">Log Out</a> 

                      </div>
                    </div>
                    <style type="text/css">
.editorautosave{display:block!important}.launcher{position:relative;text-align:center;color:#272727;z-index:999!important}.app-launcher{position:absolute;top:45px;-webkit-animation:menu 200ms;animation:menu 200ms;z-index:-1;-webkit-transition:all 200ms ease-in-out 0s,visibility 0 linear 200ms;transition:all 200ms ease-in-out 0s,visibility 0 linear 200ms;display:block;border-radius:2px}.app-launcher:before{content:'';border-left:10px solid transparent;border-right:10px solid transparent;border-bottom:10px solid #ccc;border-bottom-color:#ccc;position:absolute;top:-9px;left:16px;-webkit-transform:translate(-50%);transform:translate(-50%);z-index:1}.app-launcher:after{position:absolute;top:-8px;left:16px;-webkit-transform:translate(-50%);transform:translate(-50%);display:inline-block;border-right:9px solid transparent;border-bottom:9px solid #fff;border-left:9px solid transparent;content:"";z-index:9999}.apps{position:relative;border:1px solid #ccc;border-color:rgba(0,0,0,0.2);box-shadow:0 2px 10px rgba(0,0,0,0.2);-webkit-transition:height 200ms ease-in-out;transition:height 200ms ease-in-out;min-height:210px;overflow-y:auto;overflow-x:hidden;width:320px;height:375px;display:block;white-space:normal;text-align:left;margin:0;padding:0;right:101px}.dashboardicon .apps ul{min-height:373px}.apps ul{background:#fff;margin:0;padding:24px;text-align:left;width:320px;overflow:hidden;list-style:none;position:relative;display:block;white-space:normal}.apps ul li{height:98px;width:86px;color:#000;margin:0;padding:1px;text-align:center;display:inline-block;vertical-align:top}.apps ul li a{text-decoration:none;display:block;margin:8px 2px;text-align:center;border:1px solid transparent;-webkit-transform:translate(0px,0px);transform:translate(0px,0px);-webkit-transition:-webkit-transform .2s cubic-bezier(0.333,0,0,1);transition:-webkit-transform .2s cubic-bezier(0.333,0,0,1);transition:transform .2s cubic-bezier(0.333,0,0,1);transition:transform .2s cubic-bezier(0.333,0,0,1),-webkit-transform .2s cubic-bezier(0.333,0,0,1)}.apps ul li a:hover{border-color:#e5e5e5}.apps ul li a span{font-size:13px;line-height:20px;display:block;color:#272727}.apps ul li a img{width:64px;height:64px;display:block;margin:0 auto}.apps .more{line-height:40px;text-align:center;display:block;width:322px;background:#f5f5f5;cursor:pointer;height:40px;overflow:hidden;position:absolute;text-decoration:none;color:#282828;bottom:0}.apps .more .apps{height:500px!important}.apps .overflow .more{border-bottom:1px solid #ebebeb;left:28px;width:270px;height:0;cursor:default;outline:none}.launcher .button{cursor:pointer;margin:0 auto}.hide{display:none}::-webkit-scrollbar-thumb{background-clip:padding-box;background-color:rgba(0,0,0,0.3);border:5px solid transparent;border-radius:10px;min-height:20px;min-width:20px;height:5px;width:5px}::-webkit-scrollbar{height:15px;width:15px;background:#fff}::-webkit-scrollbar-button{height:0;width:0}@-webkit-keyframes menu{0%{opacity:0;-webkit-transform:translateY(-2rem);transform:translateY(-2rem)}100%{oapcity:1;-webkit-transform:translateY(0);transform:translateY(0)}}@keyframes menu{0%{opacity:0;-webkit-transform:translateY(-2rem);transform:translateY(-2rem)}100%{oapcity:1;-webkit-transform:translateY(0);transform:translateY(0)}}.kit__utils__heading:after,.air__utils__heading:after{position:absolute;display:block;content:'';left:0;bottom:-3px;height:4px;width:35px;border-radius:7px;background:#6EACAF} </style>
                  </div>
                </li>

                <li class="db air__subbar__breadcrumb fstdropdownmenu" style="position: relative;">
                  <a>
                    <em class="db fe fe-chevron-right"></em></a>
                </li>
                <li class="db air__subbar__breadcrumb">
                  <a class="db air__subbar__breadcrumbLink ">Documents </a>
                </li>

              </ul>
              <ng-template #newpage>
                <div class="db container addpagesec" style="padding: 20px;">
                  <div class="db popup">
                    <h6 class="db heading-3"
                      style="font-family: arial;color:black;border-bottom: 1px solid #d4cfcf;margin-bottom: 13px;padding-bottom: 9px;">
                      Create New Page</h6>
                    <div class="db newpagecreatepopup">
                      <div class="db form-group">
                        <input type="radio" value="blank_page" checked> Blank Page
                      </div>
                      <div class="db form-group">
                        <label class="db form-label fixedwidth">Select Chapter</label>
                        <select class="db chapters" disabled>
                          <option value="{{docname}}" selected>{{docname}}</option>
                        </select>
                      </div>
                      <div class="db form-group">
                        <label class="db form-label fixedwidth">Template</label>
                        <select class="db template" disabled>
                          <option value="{{docname}}" selected>{{docname}}</option>
                        </select>
                      </div>
                      <div class="db form-group">
                        <label class="db form-label fixedwidth">Page Title</label>
                        <input type="text" class="db form-control form-input" [(ngModel)]="createpgname">
                      </div>
                      <hr>
                      <h6>Page Size</h6>
                      <div class="db form-group">
                        <label class="db form-label fixedwidth">
                          <input type="radio" value="preset" checked class="db pagesizetype" name="pagesizetype"
                            (change)="pagesizetype($event)"> Preset</label>
                        <select class="db pagesize" aria-readonly="true" (change)="pagetype($event)">
                          <option value="US Letter">US Letter</option>
                          <option value="US Legal">US Legal</option>
                          <option value="US Executive">US Executive</option>
                          <option value="A3">A3</option>
                          <option value="A4">A4</option>
                          <option value="A5">A5</option>
                        </select>
                      </div>
                      <div class="db form-group">
                        <label class="db form-label">
                          <input type="radio" value="custom" class="db pagesizetype" (change)="pagesizetype($event)"
                            name="pagesizetype"> Custom</label>
                        <div class="db row">
                          <div class="db col-md-3">
                            Width <input type="number" class="db inputwidth" [(ngModel)]="createpgwidth" value="816"
                              [disabled]='pgsizetype'>
                          </div>
                          <div class="db col-md-3">
                            Height <input type="number" class="db inputwidth" [(ngModel)]="createpgheight" value="1056"
                              [disabled]='pgsizetype'>
                          </div>
                        </div>
                      </div>
                      <hr>
                      <h6>Page Sequence</h6>
                      <div class="db form-group">
                        <label class="db form-label fixedwidth">Select Chapter</label>
                        <select class="db chapters">
                          <option value="{{docname}}" selected>{{docname}}</option>
                        </select>
                      </div>
                      <div class="db form-group">
                        <label class="db form-label mr"><input type="radio" name="pageorder" value="before"> Before</label>
                        <label class="db form-label mr"><input type="radio" name="pageorder" value="after" checked>
                          After</label>
                        <select class="db pagesname">
                          <option value="{{data.sequenceno}}" *ngFor="let data of arrTemplateList">page
                            {{data.sequenceno}}</option>
                        </select>
                      </div>
                      <div class="db form-group" class="db mt-20">
                        <button type="button" class="db btn" style="margin-right: 10px;"
                          (click)="createpage()">Create</button>
                        <button type="button" class="db btn" (click)="closexml()">Cancel</button>
                      </div>
                    </div>
                  </div>

                </div>
              </ng-template>


              <div class="db dropdown searchheader mr-auto d-none d-md-block ml-3" >
                <a href="#" class="db dropdown-toggle text-nowrap" data-toggle="dropdown" aria-expanded="false"
                  data-offset="0,15">
                  <span class="db dropdown-toggle-text text-bold" style="    text-transform: uppercase;
  font-size: 15px !important;
  font-family: 'Poppins-Regular', sans-serif;
  color: #333333;">{{docnamenew}} <em _ngcontent-grp-c1="" class="db btn-addon-icon fe fe-chevron-down ml-1"></em></span>                </a>
                <div class="db dropdown-menu" role="menu">

                  <div class="db air__topbar__searchContainer mb-4" >
                    <em class="db air__topbar__searchIcon fe fe-search"></em>
                    <input class="db air__topbar__searchInput" style="color: #786fa4 !important;" type="text" [(ngModel)]="searchText" placeholder="Start typing to search..." />
                  </div>
                  <div class="db dropdown-divider"></div>
                  <div class="db kit__l1">
                    <div class="db text-uppercase font-size-12 mb-2 text-gray-6">Recent Files</div>
                    <ul class="db list-unstyled" style="height: 200px;overflow-y: scroll;">
                      <li class="db kit__l1__item" *ngFor="let data of searchlistdata | filter:searchText">
                        <a class="db kit__l1__itemLink">
                          <div class="db kit__l1__itemPic mr-3">
                            <em class="db kit__l1__itemIcon fe fe-file"></em>
                          </div>
                          <div (click)="btnEditClick(data)">
                            <div class="db text-blue" >{{data.name}}</div>
                            <div class="db text-muted">{{data.formType}}</div>
                          </div>
                        </a>
                      </li>
                    </ul>

                  </div>
                </div>
              </div>


            </div>
          </div>
          <div class="db air__subbar__breadcrumb pdficon dropdown" [style.right]="!editable ? '17rem' : '18rem'">
            <label class="db switch" *ngIf="reply_flag && overallcomments.length>0">
              <input type="checkbox" [checked]="commentdisplaystatus?'checked':''" (click)="updatecommentstatus()">
              <span class="db slider round"></span>
            </label>
              <div *ngIf="editable" class="db launcher mr-4" dropdown #dropdown="bs-dropdown" [isDisabled]="false" container="body" style="top: 1px;">
                <button class="db button" dropdownToggle type="button"
                  aria-controls="dropdown-animated dropdown-disabled-menu" style="    display: flex;
      align-items: center; background: transparent;border: none;" >{{tmpselect}} <em
                    class="db fe fe-chevron-down ml-1 text-gray" style=" position: relative;"></em>
                </button>
                <div class="db app-launcher dropdown-menu dropdownmenu1 pdfm" *dropdownMenu role="menu"
                  aria-labelledby="button-disabled-menu" style="top: 18px !important;padding:0px !important;">
                  <div class="db apps"  style="    right: 0px;  ">
                    <ul class="db first-set" style="padding:0px;">
                      <li class="db mb-1" ><a (click)="Templateactions('Show All')">Show All</a></li>
                      <li class="db mb-1" ><a (click)="Templateactions('Show Template')">Show Template</a></li>
                      <li class="db mb-1" ><a (click)="Templateactions('Sample Data')">Sample Data</a></li>
                    </ul>
                  </div>
                </div>
              </div>
            <div class="db launcher mr-4" dropdown #dropdown="bs-dropdown" [isDisabled]="false" container="body" style="top: 3px;">
              <button class="db button pdfview" dropdownToggle type="button"
                aria-controls="dropdown-animated dropdown-disabled-menu" style="    display: flex;
    align-items: center; background: transparent;border: none;" ><em
                  class="db fa fa-file-pdf-o ml-1 text-gray" style="position: relative;font-size: 22px !important;"></em> <em
                  class="db fe fe-chevron-down ml-1 text-gray" style=" position: relative;"></em>
              </button>
              <div class="db app-launcher dropdown-menu dropdownmenu1 pdfm" *dropdownMenu role="menu"
                aria-labelledby="button-disabled-menu" style="top: 18px !important;padding:0px !important;">
                <div class="db apps"  style="    right: 0px;  ">
                  <ul class="db first-set" style="padding:0px;">
                    <li class="db mb-1" ><a (click)="pdfactions('templatewithvariable')">PDF Template</a></li>
                    <li class="db mb-1" ><a (click)="pdfactions('templatewithoutvariable')">PDF Template (No variable)</a></li>
                    <li class="db mb-1" ><a (click)="pdfactions('templatewithsampledata')">PDF Template (Sample Data)</a></li>
                    <li class="db mb-1" ><a (click)="pdfactions('templatewithdata')">PDF Template (Data)</a></li>
                  </ul>
                </div>
              </div>
            </div>
            <a *ngIf="!editable && sessionrole!='Reviewer'" class="db ml-3 mr-4" (click)="gotoeditablepage()" style="cursor:pointer;color: #6EACAF !important;"><em class="db fe fe-edit-3 mr-2 font-size-24" style="color: #6EACAF !important;    font-size: 13px !important;"></em> Edit Form</a>
            <div class="db launcher mr-4" dropdown #dropdown="bs-dropdown" [isDisabled]="false" container="body" style="top: 4px;">
              <button class="db button" dropdownToggle type="button"
                aria-controls="dropdown-animated dropdown-disabled-menu" tooltip="Download" style="    display: flex;
    align-items: center; background: transparent;border: none;" (mouseover)="imagechangeover('preview')"
                (mouseout)="imagechangeoverout('preview')" (click)="showrightsidepanel0=false;"><img class="db imgicons" alt=""  [src]="previewicon" /> <em
                  class="db fe fe-chevron-down ml-1 text-gray" style=" position: relative;"></em>
              </button>
              <div class="db app-launcher dropdown-menu dropdownmenu1 pdfm" *dropdownMenu role="menu"
                aria-labelledby="button-disabled-menu" style="top: 18px !important;padding:0px !important;">
                <div class="db apps" (mouseover)="imagechangeover('preview')" style="    right: 0px;  ">
                  <ul class="db first-set" style="padding:0px;">
                    <li class="db mb-1" *ngIf="editable"><a (click)="btnPreviewClick();pdfmenus=false;">Preview</a></li>
                    <li class="db mb-1"><a (click)="presentSlideshow();pdfmenus=false;">Present</a></li>
                    <li class="db mb-1"><a (click)="btnDownLoadPDFFile();pdfmenus=false;">PDF download</a></li>
                    <li class="db mb-1"><a (click)="btnsuperimposedownload();pdfmenus=false;">Impose PDF Download</a></li>
                  </ul>
                </div>
              </div>
            </div>
            
            <div class="db dropdown icon-sec">
              <span *ngIf="editable && naviDate.routerpage!='Approved'" class="db mr-2 mt-1 ml-2" >
                <img class="db imgicons" (click)="gotosharepage()" tooltip="Share" [src]="shareicon" alt="" (mouseover)="imagechangeover('share')"
                  (mouseout)="imagechangeoverout('share')" style="width: 1.3rem;" />  </span>
              <span *ngIf="!editable && naviDate.routerpage!='Approved'" class="db mr-2 ml-2" style=" top: -5px !important;">
                <img class="db imgicons" (click)="gotosharepage()" tooltip="Share" [src]="shareicon" alt="" (mouseover)="imagechangeover('share')"
                  (mouseout)="imagechangeoverout('share')" style="width: 1.3rem;" />  </span>                 
         
  
            </div>
          </div>

          <div class="db previewicons" *ngIf="!editable">
            <i class="db fa fa-mobile" aria-hidden="true" (click)="changedevice('mobile')"></i>
            <i class="db fa fa-tablet" aria-hidden="true" (click)="changedevice('tablet')"></i>
            <i class="db fa fa-desktop active" aria-hidden="true" style="font-size:27px !important;" (click)="changedevice('desktop')"></i>
          </div>  
          <div class="db previewicons" *ngIf="editable">
          <span *ngIf="editable" class="db mr-2 ml-2" style=" position: relative; right: 20px;">
        <button type="button" (click)="btnSaveJsonClick()" class="db save_btn btn btn-rounded btn-primary mr-2"
          style="background-color: #6EACAF !important; border-color: #6EACAF;">Save</button>
      </span>
      <span *ngIf="editable" class="db mr-2 ml-2" style=" position: relative; right: 20px;">
        <button type="button" (click)="btncancelClick(cancel);"
          class="db cancel_btn btn btn-rounded btn-primary mr-2">Cancel</button> </span>
        </div>       
        </div>
        <div
          [ngClass]="[showrightsidepanel0==true && (selectedItem=='text' || selectedItem=='shape' || selectedItem=='image' || selectedItem=='table') ? 'air__sidebar kit__customScroll rightsidepanelcontents rightsidepanelcontentsactive' : 'hidediv']">
          <div [ngClass]="[selectedItem == 'text' ? 'overall-sec' : 'hidediv']"
            style="overflow-y: scroll;height: 95vh;overflow-x: hidden;">
            <h2 class="db property">Text Properties</h2>
            <div class="db air__sidebar__inner" style="padding-top: 0px;">
              <a href="javascript: void(0);" (click)="rightsidepanel0()"
                class="db air__sidebar__close rightsideclose air__sidebar__actionToggle">
                <img class="db imgicons" alt="" src="./assets/svg/close-icon.svg" style="width: 12px;" />
              </a>
              <div class="db group-sec pt-2">
                <h3 class="db text-secondary">Font & Alignment</h3>
                <div class="db row">
                  <div class="db col-sm-3">
                    <mat-button-toggle [disabled]="(selectedItem != 'text' && selectedItem != 'i-text') || !editable"
                      value="true" tooltip="Align Left" placement="bottom"
                      [ngClass]="[selectedItem == 'text' && selectedProperty.textAlign === 'left' ? 'mat-button-toggle-checked' : '']"
                      (click)="setSelItemTxtAlign('left')">
                      <svg height="16" width="16" style="width:16px;height:16px;" xmlns="http://www.w3.org/2000/svg"
                        viewBox="0 0 23.81 23.69">
                        <defs>
                          <style>
                            .cls-1 {
                              fill: #d4d2de;
                            }
                          </style>
                        </defs>
                        <title>L-align</title>
                        <g id="Layer_2" data-name="Layer 2">
                          <g id="Layer_1-2" data-name="Layer 1">
                            <path id="path-1" class="db cls-1" d="M.06,7H16.67v3.39H.06Z" />
                            <path id="path-1-2" data-name="path-1" class="db cls-1" d="M.06,14H23.81v3.39H.06Z" />
                            <path class="db cls-1" d="M0,20.3H17v3.39H0Z" />
                            <path id="path-1-3" data-name="path-1" class="db cls-1" d="M.06,0H23.81V3.39H.06Z" />
                          </g>
                        </g>
                      </svg>
                    </mat-button-toggle>
                  </div>
                  <div class="db col-sm-3">
                    <mat-button-toggle [disabled]="(selectedItem != 'text' && selectedItem != 'i-text') || !editable"
                      value="true" tooltip="Align Center" placement="bottom"
                      [ngClass]="[selectedItem == 'text' && selectedProperty.textAlign === 'center' ? 'mat-button-toggle-checked' : '']"
                      value="true" (click)="setSelItemTxtAlign('center')">
                      <svg height="16" width="16" style="width:16px;height:16px;" xmlns="http://www.w3.org/2000/svg"
                        viewBox="0 0 23.75 23.69">
                        <defs>
                          <style>
                            .cls-1 {
                              fill: #d4d2de;
                            }
                          </style>
                        </defs>
                        <title>C-align</title>
                        <g id="Layer_2" data-name="Layer 2">
                          <g id="Layer_1-2" data-name="Layer 1">
                            <path id="path-1" class="db cls-1" d="M20.18,10.41H3.57V7H20.18Z" />
                            <path id="path-1-2" data-name="path-1" class="db cls-1" d="M23.75,17.43H0V14H23.75Z" />
                            <path class="db cls-1" d="M20.36,23.69h-17V20.3h17Z" />
                            <path id="path-1-3" data-name="path-1" class="db cls-1" d="M23.75,3.39H0V0H23.75Z" />
                          </g>
                        </g>
                      </svg>
                    </mat-button-toggle>
                  </div>
                  <div class="db col-sm-3">
                    <mat-button-toggle [disabled]="(selectedItem != 'text' && selectedItem != 'i-text') || !editable"
                      value="true" tooltip="Align Right" placement="bottom"
                      [ngClass]="[selectedItem == 'text' && selectedProperty.textAlign === 'right' ? 'mat-button-toggle-checked' : '']"
                      value="false" (click)="setSelItemTxtAlign('right')">
                      <svg height="16" width="16" style="width:16px;height:16px;" xmlns="http://www.w3.org/2000/svg"
                        viewBox="0 0 23.81 23.69">
                        <defs>
                          <style>
                            .cls-1 {
                              fill: #d4d2de;
                            }
                          </style>
                        </defs>
                        <title>R-align</title>
                        <g id="Layer_2" data-name="Layer 2">
                          <g id="Layer_1-2" data-name="Layer 1">
                            <path id="path-1" class="db cls-1" d="M23.75,10.41H7.14V7H23.75Z" />
                            <path id="path-1-2" data-name="path-1" class="db cls-1" d="M23.75,17.43H0V14H23.75Z" />
                            <path class="db cls-1" d="M23.81,23.69h-17V20.3h17Z" />
                            <path id="path-1-3" data-name="path-1" class="db cls-1" d="M23.75,3.39H0V0H23.75Z" />
                          </g>
                        </g>
                      </svg>
                    </mat-button-toggle>
                  </div>
                  <div class="db col-sm-3">
                    <mat-button-toggle [disabled]="(selectedItem != 'text' && selectedItem != 'i-text') || !editable"
                      value="true" tooltip="Align Justify" placement="bottom"
                      [ngClass]="[selectedItem == 'text' && selectedProperty.textAlign === 'Left justify' ? 'mat-button-toggle-checked' : '']"
                     (click)="setSelItemTxtAlign('Left justify')">
                      <svg height="16" width="16" style="width:16px;height:16px;" xmlns="http://www.w3.org/2000/svg"
                        viewBox="0 0 23.75 23.69">
                        <defs>
                          <style>
                            .cls-1 {
                              fill: #d4d2de;
                            }
                          </style>
                        </defs>
                        <title>Justify</title>
                        <g id="Layer_2" data-name="Layer 2">
                          <g id="Layer_1-2" data-name="Layer 1">
                            <path id="path-1" class="db cls-1" d="M23.75,23.69H0V20.3H23.75Z" />
                            <path id="path-1-2" data-name="path-1" class="db cls-1" d="M23.75,10.41H0V7H23.75Z" />
                            <path id="path-1-3" data-name="path-1" class="db cls-1" d="M23.75,17.43H0V14H23.75Z" />
                            <path id="path-1-4" data-name="path-1" class="db cls-1" d="M23.75,3.39H0V0H23.75Z" />
                          </g>
                        </g>
                      </svg>
                    </mat-button-toggle>
                  </div>
                </div>
                <div class="db row paddingstyle">
                  <div class="db col-sm-8">
                    <div class="db select-box">
                      <div class="db options-container fontfamilydiv">
                        <div class="db option">
                          <input type="radio" class="db radio" name="objfontfamily" value="Arial"
                            (change)="setSelItemFontFamily('Arial')" />
                          <label style="font-family:Arial">Arial</label>
                        </div>
                        <div class="db option">
                          <input type="radio" class="db radio" name="objfontfamily" value="Bookman Old Style"
                            (change)="setSelItemFontFamily('Bookman Old Style')" />
                          <label style="font-family:Bookman Old Style">Bookman Old Style</label>
                        </div>
                        <div class="db option">
                          <input type="radio" class="db radio" name="objfontfamily" value="Times New Roman"
                            (change)="setSelItemFontFamily('Times New Roman')" />
                          <label style="font-family:Times New Roman">Times New Roman</label>
                        </div>
                        <div class="db option">
                          <input type="radio" class="db radio" name="objfontfamily" value="Verdana"
                            (change)="setSelItemFontFamily('Verdana')" />
                          <label style="font-family:Verdana">Verdana</label>
                        </div>
                        <div class="db option">
                          <input type="radio" class="db radio" name="objfontfamily" value="courier"
                            (change)="setSelItemFontFamily('courier')" />
                          <label style="font-family:courier">courier</label>
                        </div>
                        <div class="db option">
                          <input type="radio" class="db radio" name="objfontfamily" value="Calibri"
                            (change)="setSelItemFontFamily('Calibri')" />
                          <label style="font-family:Calibri">Calibri</label>
                        </div>
                        <div class="db option">
                          <input type="radio" class="db radio" name="objfontfamily" value="Constantia"
                            (change)="setSelItemFontFamily('Constantia')" />
                          <label style="font-family:Constantia">Constantia</label>
                        </div>
                        <div class="db option">
                          <input type="radio" class="db radio" name="objfontfamily" value="Georgia"
                            (change)="setSelItemFontFamily('Georgia')" />
                          <label style="font-family:Georgia">Georgia</label>
                        </div>
                        <div class="db option">
                          <input type="radio" class="db radio" name="objfontfamily" value="Helvetica"
                            (change)="setSelItemFontFamily('Helvetica')" />
                          <label style="font-family:Helvetica">Helvetica</label>
                        </div>
                        <div class="db option">
                          <input type="radio" class="db radio" name="objfontfamily" value="Minion"
                            (change)="setSelItemFontFamily('Minion')" />
                          <label style="font-family:Minion">Minion</label>
                        </div>
                        <div class="db option">
                          <input type="radio" class="db radio" name="objfontfamily" value="Minion Pro"
                            (change)="setSelItemFontFamily('Minion Pro')" />
                          <label style="font-family:Minion Pro">Minion Pro</label>
                        </div>
                        <div class="db option">
                          <input type="radio" class="db radio" name="objfontfamily" value="Myriad Pro"
                            (change)="setSelItemFontFamily('Myriad Pro')" />
                          <label style="font-family:Myriad Pro">Myriad Pro</label>
                        </div>
                        <div class="db option">
                          <input type="radio" class="db radio" name="objfontfamily" value="Proxima Nova"
                            (change)="setSelItemFontFamily('Proxima Nova')" />
                          <label style="font-family:Proxima Nova">Proxima Nova</label>
                        </div>
                        <div class="db option">
                          <input type="radio" class="db radio" name="objfontfamily" value="Source Sans Pro"
                            (change)="setSelItemFontFamily('Source Sans Pro')" />
                          <label style="font-family:Source Sans Pro">Source Sans Pro</label>
                        </div>
                        <div class="db option">
                          <input type="radio" class="db radio" name="objfontfamily" value="Trebuchet MS"
                            (change)="setSelItemFontFamily('Trebuchet MS')" />
                          <label style="font-family:Trebuchet MS">Trebuchet MS</label>
                        </div>
                        <div class="db option">
                          <input type="radio" class="db radio" name="objfontfamily" value="Webdings"
                            (change)="setSelItemFontFamily('Webdings')" />
                          <label style="font-family:Webdings">Webdings</label>
                        </div>
                        <div class="db option">
                          <input type="radio" class="db radio" name="objfontfamily" value="Wingding"
                            (change)="setSelItemFontFamily('Wingding')" />
                          <label style="font-family:Wingding">Wingding</label>
                        </div>
                        <div class="db option">
                          <input type="radio" class="db radio" name="objfontfamily" value="ZapfDingbats"
                            (change)="setSelItemFontFamily('ZapfDingbats')" />
                          <label style="font-family:ZapfDingbats">ZapfDingbats</label>
                        </div>
                        <div class="db option">
                          <input type="radio" class="db radio" name="objfontfamily" value="Gotham Bold"
                            (change)="setSelItemFontFamily('Gotham Bold')" />
                          <label style="font-family:Gotham Bold">Gotham Bold</label>
                        </div>
                        <div class="db option">
                          <input type="radio" class="db radio" name="objfontfamily" value="Gotham Black"
                            (change)="setSelItemFontFamily('Gotham Black')" />
                          <label style="font-family:Gotham Black">Gotham Black</label>
                        </div>
                        <div class="db option">
                          <input type="radio" class="db radio" name="objfontfamily" value="Gotham Black"
                            (change)="setSelItemFontFamily('Gotham Black')" />
                          <label style="font-family:Gotham Black">Gotham Black</label>
                        </div>
                        <div class="db option">
                          <input type="radio" class="db radio" name="objfontfamily" value="Gotham Book"
                            (change)="setSelItemFontFamily('Gotham Book')" />
                          <label style="font-family:Gotham Book">Gotham Book</label>
                        </div>
                        <div class="db option">
                          <input type="radio" class="db radio" name="objfontfamily" value="HelveticaNeueLT Std Cn"
                            (change)="setSelItemFontFamily('HelveticaNeueLT Std Cn')" />
                          <label style="font-family:HelveticaNeueLT Std Cn">HelveticaNeueLT Std Cn</label>
                        </div>
                        <div class="db option">
                          <input type="radio" class="db radio" name="objfontfamily" value="HelveticaNeueLT Std Med"
                            (change)="setSelItemFontFamily('HelveticaNeueLT Std Med')" />
                          <label style="font-family:HelveticaNeueLT Std Med">HelveticaNeueLT Std Med</label>
                        </div>
                        <div class="db option">
                          <input type="radio" class="db radio" name="objfontfamily" value="HelveticaNeueLT Std Med Cn"
                            (change)="setSelItemFontFamily('HelveticaNeueLT Std Med Cn')" />
                          <label style="font-family:HelveticaNeueLT Std Med Cn">HelveticaNeueLT Std Med Cn</label>
                        </div>
                        <div class="db option">
                          <input type="radio" class="db radio" name="objfontfamily" value="HelveticaNeueLT Std Lt"
                            (change)="setSelItemFontFamily('HelveticaNeueLT Std Lt')" />
                          <label style="font-family:HelveticaNeueLT Std Lt">HelveticaNeueLT Std Lt</label>
                        </div>
                        <div class="db option">
                          <input type="radio" class="db radio" name="objfontfamily" value="HelveticaNeueLT Std Lt Cn"
                            (change)="setSelItemFontFamily('HelveticaNeueLT Std Lt Cn')" />
                          <label style="font-family:HelveticaNeueLT Std Lt Cn">HelveticaNeueLT Std Lt Cn</label>
                        </div>
                        <div class="db option">
                          <input type="radio" class="db radio" name="objfontfamily" value="ProximaNovaLight"
                            (change)="setSelItemFontFamily('ProximaNovaLight')" />
                          <label style="font-family:ProximaNovaLight">ProximaNovaLight</label>
                        </div>
                        <div class="db option">
                          <input type="radio" class="db radio" name="objfontfamily" value="Boudler"
                            (change)="setSelItemFontFamily('Boudler')" />
                          <label style="font-family:Boudler">Boudler</label>
                        </div>
                        <div class="db option">
                          <input type="radio" class="db radio" name="objfontfamily" value="Cambria"
                            (change)="setSelItemFontFamily('Cambria')" />
                          <label style="font-family:Cambria">Cambria</label>
                        </div>
                        <div class="db option">
                          <input type="radio" class="db radio" name="objfontfamily" value="Centaur MT Std"
                            (change)="setSelItemFontFamily('Centaur MT Std')" />
                          <label style="font-family:Centaur MT Std">Centaur MT Std</label>
                        </div>
                        <div class="db option">
                          <input type="radio" class="db radio" name="objfontfamily" value="Frutiger45-Light"
                            (change)="setSelItemFontFamily('Frutiger45-Light')" />
                          <label style="font-family:Frutiger45-Light">Frutiger45-Light</label>
                        </div>
                        <div class="db option">
                          <input type="radio" class="db radio" name="objfontfamily" value="Futura Light BT"
                            (change)="setSelItemFontFamily('Futura Light BT')" />
                          <label style="font-family:Futura Light BT">Futura Light BT</label>
                        </div>
                        <div class="db option">
                          <input type="radio" class="db radio" name="objfontfamily" value="Gotham Light"
                            (change)="setSelItemFontFamily('Gotham Light')" />
                          <label style="font-family:Gotham Light">Gotham Light</label>
                        </div>
                        <div class="db option">
                          <input type="radio" class="db radio" name="objfontfamily" value="Garamond"
                            (change)="setSelItemFontFamily('Garamond')" />
                          <label style="font-family:Garamond">Garamond</label>
                        </div>
                        <div class="db option">
                          <input type="radio" class="db radio" name="objfontfamily" value="IDAutomationMICR"
                            (change)="setSelItemFontFamily('IDAutomationMICR')" />
                          <label style="font-family:IDAutomationMICR">IDAutomationMICR</label>
                        </div>
                        <div class="db option">
                          <input type="radio" class="db radio" name="objfontfamily" value="Impact"
                            (change)="setSelItemFontFamily('Impact')" />
                          <label style="font-family:Impact">Impact</label>
                        </div>
                        <div class="db option">
                          <input type="radio" class="db radio" name="objfontfamily" value="ocra"
                            (change)="setSelItemFontFamily('ocra')" />
                          <label style="font-family:ocra">ocra</label>
                        </div>
                        <div class="db option">
                          <input type="radio" class="db radio" name="objfontfamily" value="OCRAAlternate"
                            (change)="setSelItemFontFamily('OCRAAlternate')" />
                          <label style="font-family:OCRAAlternate">OCRAAlternate</label>
                        </div>
                        <div class="db option">
                          <input type="radio" class="db radio" name="objfontfamily" value="TimesNRCondensedBold"
                            (change)="setSelItemFontFamily('TimesNRCondensedBold')" />
                          <label style="font-family:TimesNRCondensedBold">TimesNRCondensedBold</label>
                        </div>
                        <div class="db option">
                          <input type="radio" class="db radio" name="objfontfamily" value="usb"
                            (change)="setSelItemFontFamily('usb')" />
                          <label style="font-family:usb">usb</label>
                        </div>
                        <div class="db option">
                          <input type="radio" class="db radio" name="objfontfamily" value="Franklin Gothic"
                            (change)="setSelItemFontFamily('Franklin Gothic')" />
                          <label style="font-family:Franklin Gothic">Franklin Gothic</label>
                        </div>
                      </div>
                      <div class="db selected fontfamilyselected"
                        (click)="opendropdown('fontfamilydiv','fontfamilyselected');removedropdown('fontsizediv','fontsizeselected');removedropdown('template','templateselected');removedropdown('whchangediv','whchangeselected');removedropdown('xychangediv','xychangeselected');removedropdown('angledivs','angleselecteds');removedropdown('objpositiondivs','objpositionselecteds');removedropdown('whchangedivs','whchangeselecteds');removedropdown('xychangedivs','xychangeselecteds');removedropdown('anglediv','angleselected');removedropdown('objpositiondiv','objpositionselected')">
                        {{selectedProperty.fontFamily}}</div>
                    </div>
                  </div>
                  <div class="db col-sm-4">
                    <div class="db select-box">
                      <div class="db options-container fontsizediv">
                        <div class="db option" *ngFor="let i of fontsizearray">
                          <input type="radio" class="db radio" name="objfontsize" [value]="i"
                            (change)="setSelItemFontSize(i)" />
                          <label>{{i}}</label>
                        </div>
                      </div>
                      <div class="db selected fontsizeselected"
                        (click)="opendropdown('fontsizediv','fontsizeselected');removedropdown('fontfamilydiv','fontfamilyselected');removedropdown('template','templateselected');removedropdown('whchangediv','whchangeselected');removedropdown('xychangediv','xychangeselected');removedropdown('angledivs','angleselecteds');removedropdown('objpositiondivs','objpositionselecteds');removedropdown('whchangedivs','whchangeselecteds');removedropdown('xychangedivs','xychangeselecteds');removedropdown('anglediv','angleselected');removedropdown('objpositiondiv','objpositionselected')">
                        {{selectedProperty.fontSize}}</div>
                    </div>
                
                  </div>
                  <span class="db notes">Change font and alignment</span>
                </div>
                <h3 class="db text-secondary" style="    margin: 10px 0px 5px 0px;">Font Property</h3>
                <div class="db row">
                  <div class="db col-sm-3">
                    <mat-button-toggle [disabled]="(selectedItem != 'text' && selectedItem != 'i-text') || !editable"
                      tooltip="Bold" placement="bottom"
                      [ngClass]="[selectedItem == 'text' && selectedProperty.fontWeight=='bold' ? 'mat-button-toggle-checked' : 'a']"
                      (click)="setSelItemBold()">
                      <svg height="15" width="15" style="width:15px;height:15px;" xmlns="http://www.w3.org/2000/svg"
                        viewBox="0 0 18.84 23.66">
                        <defs>
                          <style>
                            .cls-1 {
                              fill: #d4d2de;
                            }
                          </style>
                        </defs>
                        <title>bold</title>
                        <g id="Layer_2" data-name="Layer 2">
                          <g id="Layer_1-2" data-name="Layer 1">
                            <path class="db cls-1"
                              d="M17.59,13.55a5.68,5.68,0,0,1,1.25,3.65,5.88,5.88,0,0,1-2,4.75A8.77,8.77,0,0,1,11,23.66H0V0H10.74a8.77,8.77,0,0,1,5.59,1.57,5.4,5.4,0,0,1,2,4.48,5.52,5.52,0,0,1-1.14,3.56,5.24,5.24,0,0,1-3,1.86A5.93,5.93,0,0,1,17.59,13.55ZM5.72,9.67H9.47q3,0,3-2.54t-3-2.54H5.72ZM13,16.4a2.49,2.49,0,0,0-.84-2,3.54,3.54,0,0,0-2.38-.72h-4V19H9.81Q13,19,13,16.4Z" />
                          </g>
                        </g>
                      </svg>
                    </mat-button-toggle>
                  </div>
                 <div class="db col-sm-3">
                    <mat-button-toggle [disabled]="(selectedItem != 'text' && selectedItem != 'i-text') || !editable"
                      tooltip="Italic" placement="bottom"
                      [ngClass]="[selectedItem == 'text' && selectedProperty.fontStyle=='italic' ? 'mat-button-toggle-checked' : 'a']"
                      (click)="setSelItemFontStyle()">
                      <svg height="20" width="20" style="width:20px;height:18px;" xmlns="http://www.w3.org/2000/svg"
                        viewBox="0 0 8.09 23.66">
                        <defs>
                          <style>
                            .cls-1 {
                              fill: #d4d2de;
                            }
                          </style>
                        </defs>
                        <title>italic</title>
                        <g id="Layer_2" data-name="Layer 2">
                          <g id="Layer_1-2" data-name="Layer 1">
                            <path class="db cls-1" d="M8.09,0,2.35,23.66H0L5.75,0Z" />
                          </g>
                        </g>
                      </svg>
                    </mat-button-toggle>
                  </div>
                  <div class="db col-sm-3">
                    <mat-button-toggle [disabled]="(selectedItem != 'text' && selectedItem != 'i-text') || !editable"
                      tooltip="Underline" placement="bottom"
                      [ngClass]="[selectedItem == 'text' && selectedProperty.underline === 'underline' ? 'mat-button-toggle-checked' : '']"
                      (click)="setSelItemUnderline()">
                      <svg height="16" width="16" style="width:16px;height:16px;" xmlns="http://www.w3.org/2000/svg"
                        viewBox="0 0 19.7 23.66">
                        <defs>
                          <style>
                            .cls-1 {
                              fill: #d4d2de;
                            }
                          </style>
                        </defs>
                        <title>underline</title>
                        <g id="Layer_2" data-name="Layer 2">
                          <g id="Layer_1-2" data-name="Layer 1">
                            <path class="db cls-1"
                              d="M5.23,0V12.3a6,6,0,0,0,1.22,4.11,4.37,4.37,0,0,0,3.42,1.35,4.33,4.33,0,0,0,3.39-1.35,6,6,0,0,0,1.22-4.11V0h3.35V12.3q0,4.26-2.2,6.44a7.89,7.89,0,0,1-5.81,2.19,7.75,7.75,0,0,1-5.75-2.19Q1.88,16.56,1.88,12.3V0Z" />
                            <path class="db cls-1" d="M0,23.66V22.2H19.7v1.47Z" />
                          </g>
                        </g>
                      </svg>
                    </mat-button-toggle>
                  </div>
                  <div class="db col-sm-3">
                    <mat-button-toggle [disabled]="(selectedItem != 'text' && selectedItem != 'i-text') || !editable"
                      tooltip="Strikethrough" placement="bottom"
                      [ngClass]="[selectedItem == 'text' && selectedProperty.textDecoration === 'linethrough' ? 'mat-button-toggle-checked' : '']"
                      (click)="setSelItemOverline()">
                      <svg height="16" width="16" style="width:16px;height:16px;" xmlns="http://www.w3.org/2000/svg"
                        viewBox="0 0 18.86 22.91">
                        <defs>
                          <style>
                            .cls-1 {
                              fill: #d4d2de;
                            }
                          </style>
                        </defs>
                        <title>strike</title>
                        <g id="Layer_2" data-name="Layer 2">
                          <g id="Layer_1-2" data-name="Layer 1">
                            <path class="db cls-1"
                              d="M9.58,22.91c-4.5,0-7.68-2.51-7.74-6.2H4.95c.19,1.86,1.51,3.73,4.63,3.73,2.83,0,4.5-1.61,4.5-3.73C14.07,10.67,2,14.52,2,6.2,2,2.51,4.95,0,9.38,0c4.27,0,7.07,2.35,7.42,5.75H13.59C13.4,4.24,12,2.54,9.25,2.51,6.84,2.44,4.95,3.7,4.95,6.11,4.95,11.89,17,8.29,17,16.58,17,19.76,14.43,22.91,9.58,22.91Z" />
                            <path class="db cls-1" d="M0,14.68V13.08H18.86v1.61Z" />
                          </g>
                        </g>
                      </svg>
                    </mat-button-toggle>
                  </div>
                  <div class="db col-sm-3">
                    <mat-button-toggle [disabled]="(selectedItem != 'text' && selectedItem != 'i-text') || !editable"
                      tooltip="Hyperlink" placement="bottom"
                      [ngClass]="[selectedItem == 'text' && selectedProperty.linkURL!='' ? 'mat-button-toggle-checked' : '']"
                      (click)="openhyperlinkpopup(hyperlink)">
                      <i class="fa fa-link" aria-hidden="true"></i>
                    </mat-button-toggle>
                  </div>
                  <div class="db col-sm-3">
                    <mat-button-toggle [disabled]="(selectedItem != 'text' && selectedItem != 'i-text') || !editable"
                      tooltip="Unlink" placement="bottom" (click)="unlink()">
                      <i class="fa fa-chain-broken" aria-hidden="true"></i>
                    </mat-button-toggle>
                  </div>
                  <span class="db notes">Change font styles</span>
                </div>
                <div class="db row">
                  <div class="db col-sm-12 dropdown-toggle colordiv" style="    display: flex;align-items: center;">
                    <h3 class="db text-secondary" style="margin:0px;font-weight: bold;color: #fff;">Text Color</h3>
                    <input type="text"
                      style="width: 20px; height: 20px; font-size: 12px; margin-left: 105px;border:none !important;cursor:pointer;border-radius:100px;background: rgb(255, 255, 255); color: transparent;"
                      [cpPosition]="'bottom'" [(colorPicker)]="selectedProperty.fill"
                      [style.background]="selectedProperty.fill" [value]="selectedProperty.fill"
                      (colorPickerChange)="setSelItemFill()"
                      [disabled]="(selectedItem != 'text' && selectedItem != 'i-text') || !editable">
                  </div>
                  <span class="db notes">Change font color</span>
                </div>
                <h3 class="db text-secondary" style="    margin: 10px 0px 5px 0px;">Location Property</h3>
                <div class="db row paddingstyle">
                  <div class="db col-sm-5">
                    <span style="font-size:14px;color: white;">W:</span>
                    <input type="number" id="w" [(ngModel)]="selectedProperty.width"
                      style="font-size:13px;width: 65px;height: 25px;margin-left: 4px;" (change)="setSelWidth()"
                      [disabled]="selectedProperty.objtype=='table' || selectedItem == 'empty' || !editable || selectedProperty.lockMovementX==true">
                  </div>
                  <div class="db col-sm-4" style="padding:0px;">
                    <span style="font-size:14px;color: white;">H:</span>
                    <input type="number" id="h" [(ngModel)]="selectedProperty.height"
                      style="margin-left: 4px;font-size:13px;width: 60px;height: 25px;" (change)="setSelHeight()"
                      [disabled]="selectedProperty.objtype=='table' || selectedProperty.lockMovementX==true || selectedItem == 'empty' || !editable">
                  </div>
                  <div class="db col-sm-3" style="padding: 0px 1px 0px 0px;">
                    <div class="db select-box">
                      <div class="db options-container whchangediv">
                        <div class="db option">
                          <input type="radio" class="db radio" name="objectwhsize" value="in"
                            (change)="changeobjectwh('in')" />
                          <label>in</label>
                        </div>
                        <div class="db option">
                          <input type="radio" class="db radio" name="objectwhsize" value="pt"
                            (change)="changeobjectwh('pt')" />
                          <label>pt</label>
                        </div>
                        <div class="db option">
                          <input type="radio" class="db radio" name="objectwhsize" value="px"
                            (change)="changeobjectwh('px')" />
                          <label>px</label>
                        </div>
                        <div class="db option">
                          <input type="radio" class="db radio" name="objectwhsize" value="cm"
                            (change)="changeobjectwh('cm')" />
                          <label>cm</label>
                        </div>
                      </div>
                      <div class="db selected whchangeselected"
                        (click)="opendropdown('whchangediv','whchangeselected');removedropdown('fontfamilydiv','fontfamilyselected');removedropdown('fontsizediv','fontsizeselected');removedropdown('template','templateselected');removedropdown('xychangediv','xychangeselected');removedropdown('angledivs','angleselecteds');removedropdown('objpositiondivs','objpositionselecteds');removedropdown('whchangedivs','whchangeselecteds');removedropdown('xychangedivs','xychangeselecteds');removedropdown('anglediv','angleselected');removedropdown('objpositiondiv','objpositionselected')">{{sizewhtype}}</div>
                    </div>
                  </div>
                </div>
                <div class="db row paddingstyle">
                  <div class="db col-sm-5">
                    <span style="font-size:14px;color: white;">X:</span>
                    <input type="number" id="x" [(ngModel)]="selectedProperty.left"
                      style="margin-left:4px;font-size:13px;width: 65px;height: 25px;" (change)="setSelMoveX()"
                      [disabled]="!selectedItem || selectedItem == 'empty' || !editable">
                  </div>
                  <div class="db col-sm-4" style="padding:0px;">
                    <span style="font-size:14px;color: white;">Y:</span>
                    <input type="number" id="y" [(ngModel)]="selectedProperty.top"
                      style="font-size:13px;width: 60px;height: 25px;margin-left: 4px ;" (change)="setSelMoveY()"
                      [disabled]="!selectedItem || selectedItem == 'empty' || !editable">
                  </div>
                  <div class="db col-sm-3" style="padding: 0px 1px 0px 0px;">
                    <div class="db select-box">
                      <div class="db options-container xychangediv">
                        <div class="db option">
                          <input type="radio" class="db radio" name="objectxysize" value="in"
                            (change)="changeobjectxy('in')" />
                          <label>in</label>
                        </div>
                        <div class="db option">
                          <input type="radio" class="db radio" name="objectxysize" value="pt"
                            (change)="changeobjectxy('pt')" />
                          <label>pt</label>
                        </div>
                        <div class="db option">
                          <input type="radio" class="db radio" name="objectxysize" value="px"
                            (change)="changeobjectxy('px')" />
                          <label>px</label>
                        </div>
                        <div class="db option">
                          <input type="radio" class="db radio" name="objectxysize" value="cm"
                            (change)="changeobjectxy('cm')" />
                          <label>cm</label>
                        </div>
                      </div>
                      <div class="db selected xychangeselected"
                        (click)="opendropdown('xychangediv','xychangeselected');removedropdown('fontfamilydiv','fontfamilyselected');removedropdown('fontsizediv','fontsizeselected');removedropdown('template','templateselected');removedropdown('whchangediv','whchangeselected');removedropdown('angledivs','angleselecteds');removedropdown('objpositiondivs','objpositionselecteds');removedropdown('whchangedivs','whchangeselecteds');removedropdown('xychangedivs','xychangeselecteds');removedropdown('anglediv','angleselected');removedropdown('objpositiondiv','objpositionselected')">{{sizexytype}}</div>
                    </div>
                  </div>
                  <span class="db notes">Change font size & position</span>
                </div>
                <h3 class="db text-secondary" style=" margin: 10px 0px 5px 0px;">General Property</h3>
                <div class="db row">
                  <div class="db col-sm-2">
                    <mat-button-toggle tooltip="Ruler" placement="bottom" (click)="btnToggleRuler()">
                      <mat-icon>straighten</mat-icon>
                    </mat-button-toggle>
                  </div>
                  <div class="db col-sm-2">
                    <mat-button-toggle tooltip="Paste" placement="bottom" (click)="btnCloneClick()">
                      <i class="db fa fa-clipboard" aria-hidden="true"></i>
                    </mat-button-toggle>
                  </div>
                  <div class="db col-sm-2">
                    <mat-button-toggle tooltip="Delete Item" placement="bottom" (click)="btnSelObjDel()">
                      <mat-icon>delete_sweep</mat-icon>
                    </mat-button-toggle>
                  </div>
                  <div class="db col-sm-2">
                    <mat-button-toggle tooltip="Delete Page" placement="bottom" (click)=" btnConfirmPageDel()">
                      <mat-icon>delete_forever</mat-icon>
                    </mat-button-toggle>
                  </div>
                  <div class="db col-sm-2">
                    <mat-button-toggle tooltip="Undo" placement="bottom" (click)="btnUndoClick()">
                      <i class="db fa fa-undo" aria-hidden="true"></i>
                    </mat-button-toggle>
                  </div>
                  <div class="db col-sm-2">
                    <mat-button-toggle tooltip="Redo" placement="bottom" (click)="btnRedoClick()">
                      <i class="db fa fa-repeat" aria-hidden="true"></i>
                    </mat-button-toggle>
                  </div>
                  <div class="db col-sm-6" style="margin-top: 5px;display: flex;align-items: center;">
                    <span style="font-size: 11px; color:white ;" >Water mark </span>&nbsp;
                    <input type="checkbox" [(ngModel)]="watermarktest" (change)="checkValue(watermarktest ? 'on':'off')" />
                    </div>
                    <div class="db col-sm-6" style="margin-top: 5px;">
                      <div class="db btn-group" dropdown>
                        <button id="button-basic" [disabled]="!editable" dropdownToggle type="button"
                          class="db btn btn-basic btn-sm dropdown-toggle" aria-controls="dropdown-basic" style="background-color: transparent;border: none;color: white;">
                          Symbol <span class="db fa fa-angle-down"></span>
                        </button>
                        <ul id="dropdown-basic" *dropdownMenu class="db dropdown-menu symbols" role="menu" aria-labelledby="button-basic"
                          style="min-width: 6rem; overflow: auto; max-height: 114px;padding: 5px; z-index: 10000;">
                          <li role="menuitem" (click)="addsymbol('&#0161;')">&#0161;</li>
                          <li role="menuitem" (click)="addsymbol('&#0170;')">&#0170;</li>
                          <li role="menuitem" (click)="addsymbol('&#0171;')">&#0171;</li>
                          <li role="menuitem" (click)="addsymbol('&#0174;')">&#0174;</li>
                          <br>
                          <li role="menuitem" (click)="addsymbol('&#0186;')">&#0186;</li>
                          <li role="menuitem" (click)="addsymbol('&#0187;')">&#0187;</li>
                          <li role="menuitem" (click)="addsymbol('&#0191;')">&#0191;</li>
                          <li role="menuitem" (click)="addsymbol('&#0193;')">&#0193;</li>
                          <br>
                          <li role="menuitem" (click)="addsymbol('&#0201;')">&#0201;</li>
                          <li role="menuitem" (click)="addsymbol('&#0205;')">&#0205;</li>
                          <li role="menuitem" (click)="addsymbol('&#0209;')">&#0209;</li>
                          <li role="menuitem" (click)="addsymbol('&#0211;')">&#0211;</li>
                          <br>
                          <li role="menuitem" (click)="addsymbol('&#0218;')">&#0218;</li>
                          <li role="menuitem" (click)="addsymbol('&#0220;')">&#0220;</li>
                          <li role="menuitem" (click)="addsymbol('&#0225;')">&#0225;</li>
                          <li role="menuitem" (click)="addsymbol('&#0233;')">&#0233;</li>
                          <br>
                          <li role="menuitem" (click)="addsymbol('&#0237;')">&#0237;</li>
                          <li role="menuitem" (click)="addsymbol('&#0241;')">&#0241;</li>
                          <li role="menuitem" (click)="addsymbol('&#0243;')">&#0243;</li>
                          <li role="menuitem" (click)="addsymbol('&#0250;')">&#0250;</li>
                          <br>
                          <li role="menuitem" (click)="addsymbol('&#0252;')">&#0252;</li>
                          <li role="menuitem" (click)="addsymbol('&#0169;')">&#0169;</li>
                          <li role="menuitem" (click)="addsymbol('&#0225;')">&#0225;</li>
                          <li role="menuitem" (click)="addsymbol('&#0167;')">&#0167;</li>
                          <br>
                          <li role="menuitem" (click)="addsymbol('&#8226;')">&#8226;</li>
                          <li role="menuitem" (click)="addsymbol('&#8212;')">&#8212;</li>
                          <li role="menuitem" (click)="addsymbol('&#8211;')">&#8211;</li>
      
                        </ul>
                      </div>       
                    </div>
                  <div class="db col-sm-6">
                    <label>Rotate</label>
                    <div class="db select-box">
                      <div class="db options-container angledivs">
                        <div class="db option">
                          <input type="radio" class="db radio" name="angle" value="0" (change)="rotateobj($event)" />
                          <label>rotate</label>
                        </div>
                        <div class="db option">
                          <input type="radio" class="db radio" name="angle" value="90" (change)="rotateobj($event)" />
                          <label>90</label>
                        </div>
                        <div class="db option">
                          <input type="radio" class="db radio" name="angle" value="-90" (change)="rotateobj($event)" />
                          <label>-90</label>
                        </div>
                        <div class="db option">
                          <input type="radio" class="db radio" name="angle" value="180" (change)="rotateobj($event)" />
                          <label>180</label>
                        </div>
                        <div class="db option">
                          <input type="radio" class="db radio" name="angle" value="0" (change)="rotateobj($event)" />
                          <label>Undo rotate</label>
                        </div>
                      </div>
                      <div class="db selected angleselecteds"
                        (click)="opendropdown('angledivs','angleselecteds');removedropdown('fontfamilydiv','fontfamilyselected');removedropdown('fontsizediv','fontsizeselected');removedropdown('template','templateselected');removedropdown('whchangediv','whchangeselected');removedropdown('xychangediv','xychangeselected');removedropdown('objpositiondivs','objpositionselecteds');removedropdown('whchangedivs','whchangeselecteds');removedropdown('xychangedivs','xychangeselecteds');removedropdown('anglediv','angleselected');removedropdown('objpositiondiv','objpositionselected')"
                        *ngIf="selectedProperty.angle!='' && selectedProperty.angle!=0 && selectedProperty.angle!=undefined">{{selectedProperty.angle}}</div>
                      <div class="db selected angleselecteds"
                        (click)="opendropdown('angledivs','angleselecteds');removedropdown('fontfamilydiv','fontfamilyselected');removedropdown('fontsizediv','fontsizeselected');removedropdown('template','templateselected');removedropdown('whchangediv','whchangeselected');removedropdown('xychangediv','xychangeselected');removedropdown('objpositiondivs','objpositionselecteds');removedropdown('whchangedivs','whchangeselecteds');removedropdown('xychangedivs','xychangeselecteds');removedropdown('anglediv','angleselected');removedropdown('objpositiondiv','objpositionselected')"
                        *ngIf="selectedProperty.angle=='' || selectedProperty.angle==0 || selectedProperty.angle==undefined">rotate</div>
                    </div>
                  </div>
                  <div class="db col-sm-6">
                    <label>Order</label>
                    <div class="db select-box">
                      <div class="db options-container objpositiondivs">
                        <div class="db option">
                          <input type="radio" class="db radio" name="objposition" value="sendtobottom"
                            (change)="changeobjposition($event)" />
                          <label>Send to Bottom</label>
                        </div>
                        <div class="db option">
                          <input type="radio" class="db radio" name="objposition" value="sendtoback"
                            (change)="changeobjposition($event)" />
                          <label>Send to Back</label>
                        </div>
                        <div class="db option">
                          <input type="radio" class="db radio" name="objposition" value="bringtofront"
                            (change)="changeobjposition($event)" />
                          <label>Bring to Front</label>
                        </div>
                        <div class="db option">
                          <input type="radio" class="db radio" name="objposition" value="bringtotop"
                            (change)="changeobjposition($event)" />
                          <label>Bring to Top</label>
                        </div>
                      </div>
                      <div class="db selected objpositionselecteds"
                        (click)="opendropdown('objpositiondivs','objpositionselecteds');removedropdown('fontfamilydiv','fontfamilyselected');removedropdown('fontsizediv','fontsizeselected');removedropdown('template','templateselected');removedropdown('whchangediv','whchangeselected');removedropdown('xychangediv','xychangeselected');removedropdown('angledivs','angleselecteds');removedropdown('whchangedivs','whchangeselecteds');removedropdown('xychangedivs','xychangeselecteds');removedropdown('anglediv','angleselected');removedropdown('objpositiondiv','objpositionselected')">
                        {{objposition}}</div>
                    </div>
                  </div>
                  <div class="db col-sm-6" style="margin-top: 5px;">
                    <div class="db btn-group" dropdown>
                      <button dropdownToggle (click)="setupmargin()" type="button"
                        class="db btn btn-basic btn-sm dropdown-toggle" aria-controls="dropdown-basic" style="background-color: #4c4b4b;border: none;color: white;">
                        Margin 
                      </button>
</div></div>
                </div>
              </div>
            </div>
          </div>
          <div class="db overall-sec"
            [ngClass]="[selectedItem=='shape' || selectedItem=='image' || selectedItem=='table' ? 'overall-sec' : 'hidediv']">
            <h2 class="db property">Properties</h2>
            <div class="db air__sidebar__inner" style="padding-top: 0px;">
              <a href="javascript: void(0);" (click)="rightsidepanel0()"
                class="db air__sidebar__close rightsideclose air__sidebar__actionToggle">
                <img class="db imgicons" alt="" src="./assets/svg/close-icon.svg" style="width: 12px;" />
              </a>
              <div class="db group-sec pt-2">
                <h3 class="db text-secondary" style="    margin: 10px 0px 5px 0px;">Border Settings</h3>
                <div class="db row">
                  <div class="db col-sm-12" style="    display: flex;align-items: center;">
                    <input type="text"
                      style="width: 20px; height: 20px; font-size: 12px;    border-radius: 100px;margin: 0px 15px 0px 0px;cursor:pointer;background: rgb(255, 255, 255); color: transparent;"
                      [cpPosition]="'bottom'" [(colorPicker)]="selectedProperty.stroke"
                      [style.background]="selectedProperty.stroke" [value]="selectedProperty.stroke"
                      (colorPickerChange)="setSelItemStrokecolor()"
                      [disabled]="(selectedItem == 'empty' || selectedProperty.objtype != 'rect' || selectedProperty.objtype != 'vline' || selectedProperty.objtype != 'hline' || selectedProperty.objtype != 'ellipse' || selectedProperty.objtype != 'circle') && !editable">
                    <mat-icon style="margin-top:0px;">border_outer</mat-icon> <input type="number"
                      style="font-size:12px;width: 40px;height: 25px;margin: 0px 0px 0px 5px;"
                      [(ngModel)]="selectedProperty.strokeWidth" max="5" min="0" (change)="changestrokesize()"
                      [disabled]="selectedItem == 'empty' && !editable">
                    <span style="font-size:12px;color: #68707b;">Corner:</span> <input type="number"
                      style="font-size:12px;width: 40px;height: 25px;margin: 5px ;" (change)="changestrokeradius()"
                      min="0" [(ngModel)]="selectedProperty.rx" [disabled]="selectedItem == 'empty' && !editable">
                  </div>
                </div>
                <h3 class="db text-secondary" style="    margin: 10px 0px 5px 0px;">Background Settings</h3>
                <div class="db row">
                  <div class="db col-sm-12" style="display: flex;align-items: center;">
                    <input type="text"
                      style="width: 20px; height: 20px; font-size: 12px;    border-radius: 100px;margin: 0px 15px 0px 0px;cursor:pointer;background: rgb(255, 255, 255); color: transparent;"
                      [cpPosition]="'bottom'" [(colorPicker)]="selectedProperty.fill"
                      [style.background]="selectedProperty.fill" [value]="selectedProperty.fill"
                      (colorPickerChange)="setSelItemFillcolor()"
                      [disabled]="(selectedItem == 'empty' || selectedProperty.objtype != 'rect' || selectedProperty.objtype != 'vline' || selectedProperty.objtype != 'hline' || selectedProperty.objtype != 'ellipse' || selectedProperty.objtype != 'circle') && !editable">
                  </div>
                  <span class="db notes">Change fill color</span>
                </div>
                <h3 class="db text-secondary" style="    margin: 10px 0px 5px 0px;">Location Property</h3>
                <div class="db row paddingstyle">
                  <div class="db col-sm-5">
                    <span style="font-size:14px;color: white;">W:</span>
                    <input type="number" id="w" *ngIf="selectedItem!='shape' && selectedItem!='table'"
                      [(ngModel)]="selectedProperty.tmp_width"
                      style="font-size:13px;width: 65px;height: 25px;margin-left: 4px;" (change)="setSelWidth0()"
                      [disabled]="selectedProperty.objtype=='table' || selectedProperty.lockMovementX==true || selectedItem == 'empty' || !editable">
                    <input type="number" id="w" *ngIf="selectedItem=='shape' || selectedItem=='table'"
                      [(ngModel)]="selectedProperty.width"
                      style="font-size:13px;width: 65px;height: 25px;margin-left: 4px;" (change)="setSelWidth()"
                      [disabled]="selectedProperty.objtype=='table' || selectedProperty.lockMovementX==true || selectedItem == 'empty' || !editable">
                  </div>
                  <div class="db col-sm-4" style="padding:0px">
                    <span style="font-size:14px;color: white;">H:</span>
                    <input type="number" id="h" [(ngModel)]="selectedProperty.tmp_height"
                      *ngIf="selectedItem!='shape' && selectedItem!='table'"
                      style="font-size:13px;width: 60px;height: 25px;margin-left:4px;" (change)="setSelHeight0()"
                      [disabled]="selectedProperty.objtype=='table' || selectedItem == 'empty' || !editable">
                    <input type="number" id="h" [(ngModel)]="selectedProperty.height"
                      *ngIf="selectedItem=='shape' || selectedItem=='table'"
                      style="font-size:13px;width: 60px;height: 25px;margin-left:4px;" (change)="setSelHeight()"
                      [disabled]="selectedProperty.objtype=='table' || selectedItem == 'empty' || !editable">
                  </div>
                  <div class="db col-sm-3" style="padding: 0px 1px 0px 0px;">
                    <div class="db select-box">
                      <div class="db options-container whchangedivs">
                        <div class="db option">
                          <input type="radio" class="db radio" name="objectwhsize" value="in"
                            (change)="changeobjectwh('in')" />
                          <label>in</label>
                        </div>
                        <div class="db option">
                          <input type="radio" class="db radio" name="objectwhsize" value="pt"
                            (change)="changeobjectwh('pt')" />
                          <label>pt</label>
                        </div>
                        <div class="db option">
                          <input type="radio" class="db radio" name="objectwhsize" value="px"
                            (change)="changeobjectwh('px')" />
                          <label>px</label>
                        </div>
                        <div class="db option">
                          <input type="radio" class="db radio" name="objectwhsize" value="cm"
                            (change)="changeobjectwh('cm')" />
                          <label>cm</label>
                        </div>
                      </div>
                      <div class="db selected whchangeselecteds"
                        (click)="opendropdown('whchangedivs','whchangeselecteds');removedropdown('fontfamilydiv','fontfamilyselected');removedropdown('fontsizediv','fontsizeselected');removedropdown('template','templateselected');removedropdown('whchangediv','whchangeselected');removedropdown('xychangediv','xychangeselected');removedropdown('angledivs','angleselecteds');removedropdown('objpositiondivs','objpositionselecteds');removedropdown('xychangedivs','xychangeselecteds');removedropdown('anglediv','angleselected');removedropdown('objpositiondiv','objpositionselected')">{{sizewhtype}}</div>
                    </div>
                  </div>
                </div>
                <div class="db row paddingstyle">
                  <div class="db col-sm-5">
                    <span style="font-size:14px;color: white;">X:</span>
                    <input type="number" id="x" [(ngModel)]="selectedProperty.left"
                      style="font-size:13px;width: 65px;margin-left:4px;height: 25px;" (change)="setSelMoveX()"
                      [disabled]="!selectedItem || selectedItem == 'empty' || !editable">
                  </div>
                  <div class="db col-sm-4" style="padding:0px">
                    <span style="font-size:14px;color: white;">Y:</span>
                    <input type="number" id="y" [(ngModel)]="selectedProperty.top"
                      style="font-size:13px;width: 60px;height: 25px;margin-left: 4px ;" (change)="setSelMoveY()"
                      [disabled]="!selectedItem || selectedItem == 'empty' || !editable">
                  </div>
                  <div class="db col-sm-3" style="padding: 0px 1px 0px 0px;">
                    <div class="db select-box">
                      <div class="db options-container xychangedivs">
                        <div class="db option">
                          <input type="radio" class="db radio" name="objectxysize" value="in"
                            (change)="changeobjectxy('in')" />
                          <label>in</label>
                        </div>
                        <div class="db option">
                          <input type="radio" class="db radio" name="objectxysize" value="pt"
                            (change)="changeobjectxy('pt')" />
                          <label>pt</label>
                        </div>
                        <div class="db option">
                          <input type="radio" class="db radio" name="objectxysize" value="px"
                            (change)="changeobjectxy('px')" />
                          <label>px</label>
                        </div>
                        <div class="db option">
                          <input type="radio" class="db radio" name="objectxysize" value="cm"
                            (change)="changeobjectxy('cm')" />
                          <label>cm</label>
                        </div>
                      </div>
                      <div class="db selected xychangeselecteds"
                        (click)="opendropdown('xychangedivs','xychangeselecteds');removedropdown('fontfamilydiv','fontfamilyselected');removedropdown('fontsizediv','fontsizeselected');removedropdown('template','templateselected');removedropdown('whchangediv','whchangeselected');removedropdown('xychangediv','xychangeselected');removedropdown('angledivs','angleselecteds');removedropdown('objpositiondivs','objpositionselecteds');removedropdown('whchangedivs','whchangeselecteds');removedropdown('anglediv','angleselected');removedropdown('objpositiondiv','objpositionselected')">{{sizexytype}}</div>
                    </div>
                  </div>
                  <span class="db notes">Change font size & position</span>
                </div>
                <h3 class="db text-secondary" style=" margin: 10px 0px 5px 0px;">General Property</h3>
                <div class="db row">
                  <div class="db col-sm-2">
                    <mat-button-toggle tooltip="Ruler" placement="bottom" (click)="btnToggleRuler()">
                      <mat-icon>straighten</mat-icon>
                    </mat-button-toggle>
                  </div>
                  <div class="db col-sm-2">
                    <mat-button-toggle tooltip="Paste" placement="bottom" (click)="btnCloneClick()">
                      <i class="db fa fa-clipboard" aria-hidden="true"></i>
                    </mat-button-toggle>
                  </div>
                  <div class="db col-sm-2">
                    <mat-button-toggle tooltip="Delete Item" placement="bottom" (click)="btnSelObjDel()">
                      <mat-icon>delete_sweep</mat-icon>
                    </mat-button-toggle>
                  </div>
                  <div class="db col-sm-2">
                    <mat-button-toggle tooltip="Delete Page" placement="bottom" (click)=" btnConfirmPageDel()">
                      <mat-icon>delete_forever</mat-icon>
                    </mat-button-toggle>
                  </div>
                  <div class="db col-sm-2">
                    <mat-button-toggle tooltip="Undo" placement="bottom" (click)="btnUndoClick()">
                      <i class="db fa fa-undo" aria-hidden="true"></i>
                    </mat-button-toggle>
                  </div>
                  <div class="db col-sm-2">
                    <mat-button-toggle tooltip="Redo" placement="bottom" (click)="btnRedoClick()">
                      <i class="db fa fa-repeat" aria-hidden="true"></i>
                    </mat-button-toggle>
                  </div>
                  <div class="db col-sm-8" style="margin-top: 5px;">
                    <span style="font-size: 12px; color:white ;" >Water mark</span>&nbsp;&nbsp;
                    <input type="checkbox" [(ngModel)]="watermarktest" (change)="checkValue(watermarktest ? 'on':'off')" />
                    </div>
                  <div class="db col-sm-6">
                    <label>Rotate</label>
                    <div class="db select-box">
                      <div class="db options-container anglediv">
                        <div class="db option">
                          <input type="radio" class="db radio" name="angle" value="0" (change)="rotateobj($event)" />
                          <label>rotate</label>
                        </div>
                        <div class="db option">
                          <input type="radio" class="db radio" name="angle" value="90" (change)="rotateobj($event)" />
                          <label>90</label>
                        </div>
                        <div class="db option">
                          <input type="radio" class="db radio" name="angle" value="-90" (change)="rotateobj($event)" />
                          <label>-90</label>
                        </div>
                        <div class="db option">
                          <input type="radio" class="db radio" name="angle" value="180" (change)="rotateobj($event)" />
                          <label>180</label>
                        </div>
                        <div class="db option">
                          <input type="radio" class="db radio" name="angle" value="0" (change)="rotateobj($event)" />
                          <label>Undo rotate</label>
                        </div>
                      </div>
                      <div class="db selected angleselected"
                        (click)="opendropdown('anglediv','angleselected');removedropdown('fontfamilydiv','fontfamilyselected');removedropdown('fontsizediv','fontsizeselected');removedropdown('template','templateselected');removedropdown('whchangediv','whchangeselected');removedropdown('xychangediv','xychangeselected');removedropdown('angledivs','angleselecteds');removedropdown('objpositiondivs','objpositionselecteds');removedropdown('whchangedivs','whchangeselecteds');removedropdown('xychangedivs','xychangeselecteds');removedropdown('objpositiondiv','objpositionselected')"
                        *ngIf="selectedProperty.angle!=''">{{selectedProperty.angle}}</div>
                      <div class="db selected angleselected"
                        (click)="opendropdown('anglediv','angleselected');removedropdown('fontfamilydiv','fontfamilyselected');removedropdown('fontsizediv','fontsizeselected');removedropdown('template','templateselected');removedropdown('whchangediv','whchangeselected');removedropdown('xychangediv','xychangeselected');removedropdown('angledivs','angleselecteds');removedropdown('objpositiondivs','objpositionselecteds');removedropdown('whchangedivs','whchangeselecteds');removedropdown('xychangedivs','xychangeselecteds');removedropdown('objpositiondiv','objpositionselected')"
                        *ngIf="selectedProperty.angle==''">rotate</div>
                    </div>
                  </div>
                  <div class="db col-sm-6">
                    <label>Order</label>
                    <div class="db select-box">
                      <div class="db options-container objpositiondiv">
                        <div class="db option">
                          <input type="radio" class="db radio" name="objposition" value="sendtobottom"
                            (change)="changeobjposition($event)" />
                          <label>Send to Bottom</label>
                        </div>
                        <div class="db option">
                          <input type="radio" class="db radio" name="objposition" value="sendtoback"
                            (change)="changeobjposition($event)" />
                          <label>Send to Back</label>
                        </div>
                        <div class="db option">
                          <input type="radio" class="db radio" name="objposition" value="bringtofront"
                            (change)="changeobjposition($event)" />
                          <label>Bring to Front</label>
                        </div>
                        <div class="db option">
                          <input type="radio" class="db radio" name="objposition" value="bringtotop"
                            (change)="changeobjposition($event)" />
                          <label>Bring to Top</label>
                        </div>
                      </div>
                      <div class="db selected objpositionselected"
                        (click)="opendropdown('objpositiondiv','objpositionselected');removedropdown('fontfamilydiv','fontfamilyselected');removedropdown('fontsizediv','fontsizeselected');removedropdown('template','templateselected');removedropdown('whchangediv','whchangeselected');removedropdown('xychangediv','xychangeselected');removedropdown('angledivs','angleselecteds');removedropdown('objpositiondivs','objpositionselecteds');removedropdown('whchangedivs','whchangeselecteds');removedropdown('xychangedivs','xychangeselecteds');removedropdown('anglediv','angleselected')">
                        {{objposition}}</div>
                    </div>
                  </div>

                  
                </div>
              </div>
            </div>
          </div>
        </div>
        <div class="db air__sidebarR air__sidebar kit__customScroll rightsidepanelcontents sidebarcontents" *ngIf="showrightsidepanel">
          <div class="db air__sidebar__inner" style="padding-top: 0px;">
            <a href="javascript: void(0);" (click)="rightsidepanel0();showrightsidepanel=false"
              class="db air__sidebar__close rightsideclose air__sidebar__actionToggle">
              <img class="db imgicons" alt="" src="./assets/svg/close-icon.svg" style="width: 12px;" />
            </a>
            <div class="db air__sidebar__type" style="margin-top: 4rem;" dropdown [insideClick]="true">
              <a href="javascript:void(0);" (click)="btnmenuclickshow('page')" (mouseover)="imagechangeover('page')"
                (mouseout)="imagechangeoverout('page')" tooltip="Page Setting" placement="right" id="button-basic10"
                dropdownToggle type="button" aria-controls="dropdown-basic10"
                class="db list-group-item  text-center btn btn-primary dropdown-toggle">
                <img [src]="pagesrc" alt="" width="18" />
                <span class="db notes notes1">Page</span>
              </a>
              <div class="db bhoechie-tab-content dropdown-menu" id="dropdown-basic10" *dropdownMenu role="menu"
                aria-labelledby="button-basic10">
                <h2 class="db property">Page Setting</h2>
                <div style=" padding-top: 8px;">
                  <div class="db horizontal">
                    <mat-tab-group>
                      <mat-tab>
                        <ng-template mat-tab-label>
                          <div class="db btn btn-default tab-view" [ngClass]="{'bg':!editable}"> Pages</div>
                        </ng-template>
                      <div class="db csPagesThumb" style="width: 100%;height: auto;">
                          <div class="db PageThumb">
                            <div #activeList="cdkDropList" class="db box-list" cdkDropList cdkDropListOrientation="vertical"
                              [cdkDropListData]="arrTemplateList" [cdkDropListConnectedTo]="[inactiveList]"
                              (cdkDropListDropped)="drop($event)">
                              <div class="db drag-box" cdkDrag *ngFor="let data of arrTemplateList"
                                id="thumpage{{data.sequenceno}}">
                                <img id="imagepage{{data.sequenceno}}" alt=""
                                  src="data:image/jpeg;base64,/9j/4AAQSkZJRgABAQAAAQABAAD/2wBDAAYEBQYFBAYGBQYHBwYIChAKCgkJChQODwwQFxQYGBcUFhYaHSUfGhsjHBYWICwgIyYnKSopGR8tMC0oMCUoKSj/2wBDAQcHBwoIChMKChMoGhYaKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCj/wAARCAQgAzADASIAAhEBAxEB/8QAFQABAQAAAAAAAAAAAAAAAAAAAAj/xAAUEAEAAAAAAAAAAAAAAAAAAAAA/8QAFAEBAAAAAAAAAAAAAAAAAAAAAP/EABQRAQAAAAAAAAAAAAAAAAAAAAD/2gAMAwEAAhEDEQA/AKpAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB//9k="
                                  (contextmenu)="pageonrightclick($event)" (click)="btnThumbImgClick($event)"
                                  style="width: 90px;height: 100px;box-shadow: rgba(0, 0, 0, 0.1) 0px 1px 1px 0px, rgba(0, 0, 0, 0.1) 0px 3px 8px 0px;">
                                <p style="color: #eae5e5;">{{data.name}}</p>
                              </div>
                            </div>
                            <ul *ngIf="showpagecontextmenu" class="db contextmenu pagecontextmenu" [ngStyle]="myStyles">
                              <a href="javascript:void(0);"
                                (click)="renamepagepopup(renamepage);showpagecontextmenu=false;">
                                Rename
                              </a>
                              <a href="javascript:void(0);" (click)="newpagepopup(newpage);showpagecontextmenu=false;">
                                New Page
                              </a>
                              <a href="javascript:void(0);" (click)="btnSaveJsonClick();showpagecontextmenu=false;">
                                Save Page
                              </a>
                              <a href="javascript:void(0);" (click)="btnConfirmPageDel();showpagecontextmenu=false;">
                                Delete Page
                              </a>
                            </ul>
                          </div>
                          <div *ngIf="tempobj">
                            <h2 class="db property" style="text-align: center">ReSizing Form</h2>
                            <div class="db form-group col-md-12">
                              <div class="db input-group">
                                <div class="db input-group-append">
                                  <span class="db input-group-text">
                                    Width
                                  </span>
                                </div>
                                <input type="number" id="txtWidth" (change)="updatecanvaswidth($event)" style="width:50%;"
                                  class="db form-control" [(ngModel)]="currenttmpwidth">
                                <div class="db input-group-append">
                                  <span class="db input-group-text">
                                    px
                                  </span>
                                </div>
                              </div>
                            </div>
                            <div class="db form-group col-md-12">
                              <div class="db input-group mb-3">
                                <div class="db input-group-append">
                                  <span class="db input-group-text">
                                    Height
                                  </span>
                                </div>
                                <input type="number" id="txtHeight" (change)="updatecanvasheight($event)" style="width:50%;"
                                  class="db form-control" [(ngModel)]="currenttmpheight">
                                <div class="db input-group-append">
                                  <span class="db input-group-text">
                                    px
                                  </span>
                                </div>
                              </div>
                            </div>
                            <div id="dvAddNewPage" style="text-align: center;">
                              <button class="db save_btn btn btn-rounded btn-primary mr-2"  (click)="newpagepopup(newpage)" id="btnAddPage" style="width: 80px;">Add</button>
                            </div>
                          </div>
                        </div>
                      </mat-tab>
    
                      <mat-tab>
                        <ng-template mat-tab-label>
                          <div class="db btn btn-default tab-view" [ngClass]="{'bg':!editable}"> Layers</div>
                        </ng-template>
                        <div class="db layers kit__customScroll col-md-12">
                          <ul class="db list-group layerslists">
                            <p class="db pageele" style="color: #eae5e5;">Page Elements
                              <a href="javascript:void(0);" class="db pull-right" (click)="renderLayers()">
                                <i class="db fa fa-refresh" aria-hidden="true"  style="color: #6eacaf;"></i>
                              </a>
                              <a href="javascript:void(0);" style="margin-right: 10px;" class="db pull-right alllock"
                                (click)="lockunlockalllayer1()">
                                <i class="db fa fa-unlock" aria-hidden="true"  style="color: #03868d;"></i>
                              </a>
                            </p>
                            <li class="db paglist-group-iteme1" *ngFor="let data of layers;index as i" id="{{i}}">
                              <a class="db btn btn-sm btn-danger eye_{{i}}" (click)="hideshowlayer(i)">
                                <i [ngClass]="data.visible?'fa fa-eye':'fa fa-eye-slash'" aria-hidden="true"  style="color: #6eacaf;"></i>
                             </a>
                              <a class="db btn btn-sm btn-danger lock_{{i}}" (click)="lockunlocklayer(i)">
                                <i [ngClass]="data.lockMovementX ?'fa fa-lock':'fa fa-unlock'" aria-hidden="true"  style="color: #3e5569;"></i>
                              </a>
                              <span style="font-size: 10px;" class="db llabel">{{data.objtype}}</span>
                              <span class="db ltxt">{{data.text}}{{data.cacheKey}}</span>
                              <a class="db btn btn-sm btn-warning pull-right deletel2" (click)="activeLayers(i)">
                                <i class="db fa fa-arrows" aria-hidden="true"  style="color: #3e5569;"></i>
                              </a>
                              <a class="db btn btn-sm btn-danger pull-right deletel" (click)="removelayers(i)">
                                x
                              </a>
                            </li>
                          </ul>
                        </div>
                      </mat-tab>
                      <mat-tab>
                        <ng-template mat-tab-label>
                          <div class="db btn btn-default tab-view" [ngClass]="{'bg':!editable}"> Signature
                          </div>
                        </ng-template>
                        <div class="db layers">
                          <ul class="db list-group layerslists">
                            <p class="db pageele" style="color: #eae5e5;">Signatures
                            </p>
                            <div *ngFor="let data of layers;index as i">
                              <li class="db paglist-group-iteme1"
                                *ngIf="data.signature_name!='' && data.signature_name!=undefined" id="{{i}}"
                                (contextmenu)="signaturerightclick(i,$event)">
                                <a class="db btn btn-sm btn-warning" (click)="activeLayers(i);showsignaturecontextmenu=false;">
                                  <i class="db fa fa-arrows" aria-hidden="true"></i>
                                </a>
                                <span class="db ltxt">{{data.signature_name}}</span>
                                <a class="db btn btn-sm btn-warning pull-right deletel2"
                                  (click)="editsignature(i, edisignaturepopuptwo);showsignaturecontextmenu=false;">
                                  <i class="db fa fa-pencil-square-o" aria-hidden="true"></i>
                                </a>
                                <a class="db btn btn-sm btn-danger pull-right deletel"
                                  (click)="removelayers(i);showsignaturecontextmenu=false;">
                                  x
                                </a>
                              </li>
                            </div>
                            <ul *ngIf="showsignaturecontextmenu" class="db contextmenu pagecontextmenu signaturecmenu"
                              [ngStyle]="myStyles">
                              <a href="javascript:void(0);"
                                (click)="signaturerightedit(selectedsignature);showsignaturecontextmenu=false;">
                                Edit Signature
                              </a>
                            </ul>
                          </ul>
                        </div>
                      </mat-tab>
                    </mat-tab-group>
                  </div>    
                </div>
              </div>
            </div>
            <div class="db air__sidebar__type" dropdown [insideClick]="true">
              <a href="javascript:void(0);" (click)="btnmenuclickshow('toolkit')" (mouseover)="imagechangeover('toolkit')"
                (mouseout)="imagechangeoverout('toolkit')" tooltip="Tool Kit" placement="right" id="button-basic2"
                dropdownToggle type="button" aria-controls="dropdown-basic2"
                class="db list-group-item  text-center btn btn-primary dropdown-toggle">
                <img [src]="toolkitsrc" alt="" width="18" />
                <span class="db notes notes1">Tool Kit</span>
              </a>
              <div class="db bhoechie-tab-content dropdown-menu" id="dropdown-basic2" *dropdownMenu role="menu"
                aria-labelledby="button-basic2">
                <h2 class="db property">Tool Kit</h2>
                <div style=" padding-top: 8px;">
                  <ng-container>
                    <mat-accordion>
                      <mat-expansion-panel [expanded]="true">
                        <mat-expansion-panel-header [collapsedHeight]="customCollapsedHeight"
                          [expandedHeight]="customExpandedHeight">
                          <mat-panel-title>
                            General Tools
                          </mat-panel-title>
    
                        </mat-expansion-panel-header>
                        <div class="db nicescroll">
                          <div class="db col-md-12 toolkitsec" style="height: 300px;">
                            <div class="db overflow" *ngFor="let data of generaldata" draggable="true"
                              (dragstart)="toolkitdrag(data.contentjson)">
                              <i class="db fa fa-book" style="margin-right: 6px;" aria-hidden="true"></i>
                              {{data.name}}</div>
                            <br>
                          </div>
                        </div>
                      </mat-expansion-panel>
                      <mat-expansion-panel>
                        <mat-expansion-panel-header [collapsedHeight]="customCollapsedHeight"
                          [expandedHeight]="customExpandedHeight">
                          <mat-panel-title>
                            Personal Tools
                          </mat-panel-title>
    
                        </mat-expansion-panel-header>
                        <div class="db nicescroll">
                          <div class="db col-md-12 toolkitsec">
                            <div class="db overflow" *ngFor="let data of personaldata" draggable="true"
                              (dragstart)="toolkitdrag(data.contentjson)">
                              <i class="db fa fa-book" style="margin-right: 6px;" aria-hidden="true"></i>{{data.name}}
                            </div>
                          </div>
                        </div>
                      </mat-expansion-panel>
                      <mat-expansion-panel>
                        <mat-expansion-panel-header [collapsedHeight]="customCollapsedHeight"
                          [expandedHeight]="customExpandedHeight">
                          <mat-panel-title>
                            Barcode
                          </mat-panel-title>
    
                        </mat-expansion-panel-header>
                        <div class="db nicescroll">
                          <a href="javascript:void(0);" draggable="true" (dragend)="onDragEnd($event)"
                            (dragstart)="barcode('assets/images/designtool/sign/posnetzip.jpg',barcodes,'Barcode Postnet_Zip','PostnetZip')"
                            placement="right" class="db list-group-item barcode-img text-left" style="text-align: left!important;">
                            <img class="db images-item" alt="" src="assets/images/designtool/sign/posnetzip.jpg"> Barcode
                            Postnet_Zip
                          </a>
                          <a href="javascript:void(0);" draggable="true" (dragend)="onDragEnd($event)"
                            (dragstart)="barcode('assets/images/designtool/sign/barcode_128.jpg',barcodes,'Barcode 128','Barcode_128')"
                            placement="right" class="db list-group-item barcode-img text-left" style="text-align: left!important;">
                            <img class="db images-item" alt="" src="assets/images/designtool/sign/barcode_128.jpg"> Barcode 128
                          </a>
                          <a href="javascript:void(0);" draggable="true" (dragend)="onDragEnd($event)"
                            (dragstart)="barcode('assets/images/designtool/sign/barcode39.jpg',barcodes,'Barcode 3 of 9','Barcode39')"
                            placement="right" class="db list-group-item barcode-img text-left" style="text-align: left!important;">
                            <img class="db images-item" alt="" src="assets/images/designtool/sign/barcode39.jpg"> Barcode 3 of 9
                          </a>
                          <a href="javascript:void(0);" draggable="true" (dragend)="onDragEnd($event)"
                            (dragstart)="barcode('assets/images/designtool/sign/qrbarcode.jpg',barcodes,'QR Barcode','QR')"
                            placement="right" class="db list-group-item barcode-img text-left" style="text-align: left!important;">
                            <img class="db images-item" alt="" style="margin-right: 2.4rem !important;" src="assets/images/designtool/sign/qrbarcode.jpg"> QR Barcode
                          </a>
                          <a href="javascript:void(0);" draggable="true" (dragend)="onDragEnd($event)"
                            (dragstart)="barcode('assets/images/designtool/sign/ean8.jpg',barcodes,'Barcode EAN.UCC-8','EAN8')"
                            placement="right" class="db list-group-item barcode-img text-left" style="text-align: left!important;">
                            <img class="db images-item" alt="" src="assets/images/designtool/sign/ean8.jpg"> Barcode EAN.UCC-8
                          </a>
                          <a href="javascript:void(0);" draggable="true" (dragend)="onDragEnd($event)"
                            (dragstart)="barcode('assets/images/designtool/sign/planet.jpg',barcodes,'Barcode Planet','PLANET')"
                            placement="right" class="db list-group-item barcode-img text-left" style="text-align: left!important;">
                            <img class="db images-item" alt="" src="assets/images/designtool/sign/planet.jpg"> Barcode Planet
                          </a>
                          <a href="javascript:void(0);" draggable="true" (dragend)="onDragEnd($event)"
                            (dragstart)="barcode('assets/images/designtool/sign/2dbarcode.jpg',barcodes,'2D Barcode','2D_Barcode')"
                            placement="right" class="db list-group-item barcode-img text-left" style="text-align: left!important;">
                            <img class="db images-item" alt="" style="margin-right: 2.4rem !important;" src="assets/images/designtool/sign/2dbarcode.jpg"> 2D Barcode
                          </a>
                        </div>
                        <ng-template #barcodes>
                          <div class="db container popupbg" style="padding: 20px;">
                            <div class="db popup barcode-editor">
                              <h5 class="db heading-3">Barcode Editor</h5>
                              <div class="db content">
                                <div class="db form-wrapper">
                                  <div class="db form-group1">
                                    <label class="db form-label">Name</label> {{ln}}<br>
                                    <label class="db form-label">Type</label> {{lt}}
                                  </div>
                                  <div class="db row">
                                    <div class="db form-group col-md-6" *ngFor="let data of barcodetypes">
                                      <input type="radio" class="db form-control" name="barcodetype" value="data"
                                        (click)="model.option = data" [checked]="data === model.option">
                                      <label class="db form-label">{{data}}</label>
                                    </div>
                                  </div>
                                  <div class="db form-group">
                                    <label class="db form-label">Value</label>
                                    <input type="text" class="db form-control" id="inp_barcodevalue"
                                      (keypress)="keyPress($event)" [(ngModel)]="selectedProperty.barcode_val">
                                  </div>
                                  <span class="db msg">{{barcodemsg}}</span>
                                  <span class="db msg">{{barcodemsg1}}</span>
                                  <div class="db form-group" class="db mt-20">
                                    <button type="button" class="db btn" style="margin-right: 10px;"
                                      (click)="storebarcode()">Done</button>
                                    <button type="button" class="db btn" (click)="closebarcodepopup()">Cancel</button>
                                  </div>
                                </div>
                              </div>
                            </div>
    
                          </div>
                        </ng-template>
                      </mat-expansion-panel>
    
                    </mat-accordion>
                  </ng-container> 
                </div>
              </div>
            </div>
            <div class="db air__sidebar__type" dropdown [insideClick]="true">
              <a href="javascript:void(0);" (click)="btnmenuclickshow('image')" (mouseover)="imagechangeover('image')"
                (mouseout)="imagechangeoverout('image')" tooltip="Image" placement="right" id="button-basic3"
                dropdownToggle type="button" aria-controls="dropdown-basic3"
                class="db list-group-item  text-center btn btn-primary dropdown-toggle">
                <img [src]="imagesrc" alt="" width="18" />
                <span class="db notes notes1">Image</span>
              </a>
              <div class="db bhoechie-tab-content dropdown-menu" id="dropdown-basic3" *dropdownMenu role="menu"
                aria-labelledby="button-basic3">
                  <h2 class="db property">Image</h2>
                  <em class="db fe fe-search" style="cursor:pointer;position:fixed;right:30px;top:20px;font-size:15px;"(click)="getSearchBoxValue(searchValue)"></em>
                  <input class="db form-control" style="width: 50% !important; position:fixed;
                  left: 140px; top: 10px;height: 5%;background: none;color: #fff;" type="text" placeholder="Search...." aria-label="Search"
                  [(ngModel)]="searchValue" name="searchValue" autocomplete="off" (keyup)="getSearchBoxValue(searchValue)">
                <div style=" padding-top: 8px;">
                  <ng-container >
                    <mat-accordion>
                      <mat-expansion-panel>
                        <mat-expansion-panel-header [collapsedHeight]="customCollapsedHeight"
                          [expandedHeight]="customExpandedHeight">
                          <mat-panel-title>
                            Logo Images
                          </mat-panel-title>
    
                        </mat-expansion-panel-header>
                        <div class="db nicescroll">
                          <div class="db align-content-center logo-sec" style="text-align: center;">
                            <div class="db gallery" *ngFor="let item of logoList">
                              <div>
                                <a href="javascript:void(0);" (click)="datesigndragenable('logodrag');setactivelogo($event)" placement="bottom">
                                  <h3>
                                    <img class="db images-item" alt="" [src]="api_url +item.file" />
                                  </h3>
                                </a>
                                <img [src]="api_url +item.file" alt="" class="db tooltip-logo-image">
                              </div>
                            </div>
                          </div>
                        </div>
                      </mat-expansion-panel>
                      <mat-expansion-panel>
                        <mat-expansion-panel-header [collapsedHeight]="customCollapsedHeight"
                          [expandedHeight]="customExpandedHeight">
                          <mat-panel-title>
                            Signature
                          </mat-panel-title>
    
                        </mat-expansion-panel-header>
                        <div class="db nicescroll">
                          <div class="db align-content-center logo-sec" style="text-align: center;">
                            <div class="db gallery" *ngFor="let item of signatureimageList">
                              <div>
                                <a href="javascript:void(0);" (click)="datesigndragenable('logodrag');setactivelogo($event)" placement="bottom">
                                  <h3>
                                    <img class="db images-item" alt="" [src]="api_url +item.file" />
                                  </h3>
                                </a>
                                <img class="db tooltip-logo-image" alt="" [src]="api_url +item.file">
                              </div>
                            </div>
                          </div>
                        </div>
                      </mat-expansion-panel>
                      <mat-expansion-panel>
                        <mat-expansion-panel-header [collapsedHeight]="customCollapsedHeight"
                          [expandedHeight]="customExpandedHeight">
                          <mat-panel-title>
                            Other Images
                          </mat-panel-title>
    
                        </mat-expansion-panel-header>
                        <div class="db nicescroll">
                          <div class="db align-content-center logo-sec" style="text-align: center;">
                            <div class="db gallery" *ngFor="let item of otherimageList">
                              <div>
                                <a href="javascript:void(0);" (click)="datesigndragenable('logodrag');setactivelogo($event)" placement="bottom">
                                  <h3>
                                    <img class="db images-item" alt="" [src]="api_url +item.file" />
                                  </h3>
                                </a>
                                <img class="db tooltip-logo-image" alt="" [src]="api_url +item.file">
                              </div>
                            </div>
                          </div>
                        </div>
                      </mat-expansion-panel>
                      <div class="db nicescroll">
                        <div class="db align-content-center logo-sec" style="text-align: center;">
                          <div class="db gallery" *ngFor="let item of serachImage">
                            <div>
                              <a href="javascript:void(0);" (click)="datesigndragenable('logodrag');setactivelogo($event)" placement="bottom">
                                <h3>
                                  <img class="db images-item" alt="" [src]="api_url +item.file" />
                                </h3>
                              </a>
                              <img [src]="api_url +item.file" alt="" class="db tooltip-logo-image">
                            </div>
                          </div>
                        </div>
                      </div>
    
                    </mat-accordion>
                  </ng-container>
                </div>
              </div>
            </div>
            <div class="db air__sidebar__type" dropdown [insideClick]="true">
              <a href="javascript:void(0);" (click)="btnmenuclickshow('datadictionary')" (mouseover)="imagechangeover('datadictionary')"
                (mouseout)="imagechangeoverout('datadictionary')" tooltip="Data Dictionary" placement="right" id="button-basic4"
                dropdownToggle type="button" aria-controls="dropdown-basic4"
                class="db list-group-item  text-center btn btn-primary dropdown-toggle">
                <img [src]="datadictionarysrc" alt="" width="18" />
                <span class="db notes notes1">Dictionary</span>
              </a>
              <div class="db bhoechie-tab-content dropdown-menu" id="dropdown-basic4" *dropdownMenu role="menu"
                aria-labelledby="button-basic4">
                <h2 class="db property">Data Dictionary</h2>
                <div style=" padding-top: 8px;">
                  <ng-container>
                    <mat-accordion>
                      <mat-expansion-panel *ngFor="let currentData of dictcategory;first as isFirst" [expanded]="isFirst"
                        (opened)="dataChanged(currentData.categoryid)">
                        <mat-expansion-panel-header [collapsedHeight]="customaccordianCollapsedHeight"
                          [expandedHeight]="customaccordianCollapsedHeight">
                          <mat-panel-title>
                            {{currentData.categotyname}}
                          </mat-panel-title>
    
                        </mat-expansion-panel-header>
                        <div class="db nicescroll">
                          <accordion>
                            <accordion-group (isOpenChange)="log($event,i)" [isOpen]="false"
                              *ngFor="let dataItem of itemnames; let i = index">
                              <button class="db btn btn-link bb" style="width: 100%;" accordion-heading type="button"
                                (click)="open(dataItem)" (dragend)="onDragEnd($event)"
                                (dragstart)="onDragStartmulti($event,dataItem, 'multidrag', dataItem.itemname)"
                                draggable="true">
                                <span [ngClass]="{'mdi-folder-multiple': !dataItem.open,'mdi-folder-open': dataItem.open}"
                                  class="db mdi float-left pull-left folderspace" [attr.id]="'fold' + dataItem.itemid"></span>
                                <div class="db pull-left float-left appl">
                                  {{dataItem.itemname}}</div>
                              </button>
                              <div *ngIf="dataItem.subitemname.length">
                                <ng-template ngFor let-inchildItem [ngForOf]="dataItem.subitemname" let-j="index">
                                  <ng-template
                                    *ngTemplateOutlet="nodeTemplateRef; context: { $implicit: inchildItem ,j: j}">
                                  </ng-template>
                                </ng-template>
                                <ng-template #nodeTemplateRef let-indataItem let-j="j" let-k="k">
                                  <accordion>
                                    <accordion-group style="margin-top: 5px;border-left: 0.5px dashed #4882ca38;"
                                      [isOpen]="false" (isOpenChange)="log1($event,i,j,k)">
                                      <button class="db btn btn-link"  draggable="true" style="width: 100%;" accordion-heading type="button"
                                        (click)="open(indataItem)" 
                                        (dragstart)="onDragStartmulti($event,indataItem, 'multidrag', indataItem.itemname)"
                                        (dragend)="onDragEnd($event)" draggable="true">
                                        <span
                                          [ngClass]="{'mdi-folder-multiple': !indataItem.open,'mdi-folder-open': indataItem.open}"
                                          class="db mdi float-left pull-left folderspace "
                                          [attr.id]="'fold' + indataItem.itemid"></span>
                                        <span class="db pull-left float-left appl"> {{indataItem.itemname}}</span>
                                      </button>
                                      <div *ngIf="indataItem.subitemname.length">
                                        <ng-template ngFor let-inchildItem [ngForOf]="indataItem.subitemname" let-k="index">
                                          <ng-template
                                            *ngTemplateOutlet="nodeTemplateRef; context: { $implicit: inchildItem ,j: j,k:k}">
                                          </ng-template>
                                        </ng-template>
                                      </div>
                                      <div *ngFor="let incurrentData of indataItem.property; index as i">
                                        <div style="width: 100%;padding:2px 0 2px 0;cursor: default;" draggable="true"
                                          class="db pull-left float-left appl ee"
                                          id="datadictionary_{{incurrentData.propertyid}}"
                                          (dragend)="onDragEnd0($event,'datadictionary',incurrentData.propertyid)"
                                          (dragstart)="onDragStart0($event,'datadictionary',incurrentData.propertyid)">
                                          <span class="db mdi mdi-file-outline acc_divide" style="font-size: 18px;"></span>
                                          <span class="db acc_divide ddval"> {{incurrentData.name}} </span>
                                          <span class="db acc_divide objsampledata"
                                            style="display: none;">{{incurrentData.sampledata}}</span>
                                        </div>
                                      </div>
                                    </accordion-group>
                                  </accordion>
                                </ng-template>
                              </div>
                              <div *ngFor="let currentData of dataItem.property; index as i">
                                <div style="width: 100%;padding:2px 0 2px 0;cursor: default;" draggable="true"
                                  class="db pull-left float-left appl aa" id="datadictionary_{{currentData.propertyid}}"
                                  (dragend)="onDragEnd0($event,'datadictionary',currentData.propertyid)"
                                  (dragstart)="onDragStart0($event,'datadictionary',currentData.propertyid)">
                                  <span class="db mdi mdi-file-outline acc_divide" style="font-size: 18px;"></span>
                                  <span class="db acc_divide ddval">{{currentData.name}}</span>
                                  <span class="db acc_divide objsampledata"
                                    style="display: none;">{{currentData.sampledata}}</span>
    
                                </div>
                              </div>
                            </accordion-group>
                          </accordion>
                        </div>
                      </mat-expansion-panel>
    
    
    
    
                    </mat-accordion>
                  </ng-container>
                </div>
              </div>
            </div>
            <div class="db air__sidebar__type" dropdown [insideClick]="true">
              <a href="javascript:void(0);" (click)="btnmenuclickshow('datavariable')" (mouseover)="imagechangeover('datavariable')"
                (mouseout)="imagechangeoverout('datavariable')" tooltip="Data Variables" placement="right" id="button-basic5"
                dropdownToggle type="button" aria-controls="dropdown-basic5"
                class="db list-group-item  text-center btn btn-primary dropdown-toggle">
                <img [src]="varsrc" alt="" width="18" />
                <span class="db notes notes1">Variables</span>
              </a>
              <div class="db bhoechie-tab-content dropdown-menu" id="dropdown-basic5" *dropdownMenu role="menu"
                aria-labelledby="button-basic5">
                <h2 class="db property">Data Variables</h2>
                <div style=" padding-top: 8px;">
                  <ng-container>
                    <div class="db horizontal">
                      <mat-tab-group>
                        <mat-tab>
                          <ng-template mat-tab-label>
                            <div class="db btn btn-default tab-view" [ngClass]="{'bg':!editable}"> Data Variables
                            </div>
    
                          </ng-template>
                          <div class="db col-md-12" style="margin-top:10px;max-height:calc(100vh - 239px);    padding-right: 0px;
            ">
                            <div>
                              <div class="db pull-left">
                                <mat-button-toggle-group class="db one">
                                  <mat-button-toggle tooltip="Reload Variables" placement="bottom"
                                    (click)="checkvariable()">
                                    <i class="db fa fa-refresh" aria-hidden="true"></i>
                                  </mat-button-toggle>
                                  <mat-button-toggle tooltip="Download Variables" placement="bottom">
                                    <i class="db fa fa-download" aria-hidden="true"></i>
                                  </mat-button-toggle>
                                  <mat-button-toggle tooltip="Download Sample Data" placement="bottom">
                                    <i class="db fa fa-file-excel-o" aria-hidden="true"></i>
                                  </mat-button-toggle>
                                  <mat-button-toggle tooltip="Remove Variable" placement="bottom"
                                    (click)="removevariable()">
                                    <mat-icon>delete_forever</mat-icon>
                                  </mat-button-toggle>
                                </mat-button-toggle-group>
                              </div>
                              <div class="db pull-right">
                                <mat-button-toggle-group name="fontStyle" aria-label="Font Style">
                                  <mat-button-toggle value="Grid" (click)="tableView = 'Grid'">Grid
                                  </mat-button-toggle>
                                  <mat-button-toggle value="Single" (click)="tableView = 'Single';objsingleproperty()">
                                    Single
                                  </mat-button-toggle>
                                </mat-button-toggle-group>
                              </div>
                            </div>
                            <br>
                            <div class="db col-md-12 variabletable" style="margin-top:20px;clear: both;padding: 0px;"
                              *ngIf="tableView == 'Grid'">
                              <table>
                                <tr>
                                  <th style="width: 35px;">Id</th>
                                  <th>Variable Name</th>
                                  <th>Category</th>
                                  <th>Max.Char</th>
                                  <th>Overflow</th>
                                </tr>
                                <ng-container *ngFor="let data of layers1;index as i">
                                  <ng-container
                                    *ngIf="data.text && data.text.indexOf('&lt;&lt;')==0 && data.text.indexOf('&gt;&gt;') > 0">
                                    <tr *ngFor="let data1 of data.variable" (click)="setClickedRow(i)"
                                      [class.active]="i == selectedRow">
                                      <td style="width: 35px;">{{i}}</td>
                                      <td>&lt;&lt;{{data1}}&gt;&gt;</td>
                                      <td>{{data.objcategory}}</td>
                                      <td>99</td>
                                      <td></td>
                                    </tr>
                                  </ng-container>
                                </ng-container>
                              </table>
                       
                            </div>
                            <div class="db col-md-12" style="margin-top:20px;clear: both;padding: 0px;"
                              *ngIf="tableView == 'Single'">
                              <div class="db singleobject" *ngFor="let obj of layer3">
                                <h4 class="db heading property">Properties</h4>
                                <div class="db text-left">
                                  <p style="color: #eae5e5;">
                                    <strong>Variable Name: </strong>
                                    <span *ngFor="let data1 of obj.variable">
                                      {{data1}}
                                    </span> <br>
                                    <strong>Category: </strong> {{obj.objcategory}}<br>
                                    <strong>Sample Data: </strong> {{obj.objsampledata}}
                                  </p>
                                </div>
                                <hr>
                                <h4 class="db heading property">Properties</h4>
    
                                <div class="db text-left">
                                  <p style="color: #eae5e5;">
                                    <strong>Font Family: </strong>
                                    {{obj.fontFamily}}
                                    <br>
                                    <strong>Font Size: </strong> {{obj.fontSize}}
                                    <br>
                                    <strong>Font Color: </strong> {{obj.fill}}
                                    <br>
                                    <strong>Font Weigth: </strong>{{obj.fontWeight}}
                                  </p>
                                </div>
                              </div>
                              <hr>
                            </div>
                          </div>
                        </mat-tab>
                        <mat-tab>
                          <ng-template mat-tab-label>
                            <div class="db btn btn-default tab-view" [ngClass]="{'bg':!editable}">Data XML</div>
    
                          </ng-template>
                          <div class="db xmlsec">
                            <label>Select file to upload</label>
                            <mat-form-field floatPlaceholder="never">
                              <input id="fileSelect" [hidden]="true" (change)="onChange($event.target.files)" type="file"
                                accept=".xml" #fileSelect>
                              <input readonly matInput [(ngModel)]="filename" />
                              <button *ngIf="base64File" (click)="base64File = null; filename = null;" matSuffix
                                type="button" color="warn" mat-icon-button>
                                <mat-icon>close</mat-icon>
                              </button>
                              <button matSuffix mat-icon-button [disabled]="!editable" (click)="fileSelect.click();"
                                id="bbtn">
                                Browse </button>
                            </mat-form-field>
                            <button matSuffix mat-icon-button [disabled]="!editable" (click)="uploadfile()" id="bbtn1"
                              style="margin-top: 10px;">
                              upload </button>
                            <span class="db or">or</span>
                            <label>Enter Sample Data for all variables</label>
                            <mat-form-field floatPlaceholder="never">
                              <input [hidden]="true" (change)="onFileSelect1($event)" type="file" accept=".xml"
                                #fileSelect1>
                              <input matInput [(ngModel)]="filename1" />
                            <button matSuffix mat-icon-button id="bbtn2" (click)="downloadpdfwithdata()" [disabled]="filename1=='' && !editable">
                                Download PDF</button>
                            </mat-form-field>
                            <div class="db flexrow">
                              <button (click)="viewdataxml(dataxml)">View Data</button>
                              <button (click)="viewsignaturexml(signaturexml)">View Signature</button>
                              <button (click)="viewrulexml(rulexml)">View Rule</button>
                            </div>
                            <textarea class="db xmldatadiv" disabled>
                  {{fileContent}}
                </textarea>
                          </div>
                          <ng-template #dataxml>
                            <div class="db container popupbg" style="padding: 20px;position: relative;">
                              <a (click)="closexml()" class="db signaturexml" href="javascript:void(0);">
                                <i class="db fa fa-times" aria-hidden="true"></i>
                              </a>
                              <h4>Data XML</h4>
                              <pre class="db popup" style="width: 100%;height: 250px;border: 1px solid gray;
    padding: 10px;    overflow-y: scroll;
    font-family: monospace;    font-size: 14px;
    color: black;" *ngIf="fileContent">{{fileContent | xml}}
              </pre>
                            </div>
                          </ng-template>
                          <ng-template #rulexml>
                            <div class="db container popupbg" style="padding: 20px;position: relative;">
                              <a (click)="closexml()" class="db signaturexml" href="javascript:void(0);">
                                <i class="db fa fa-times" aria-hidden="true"></i>
                              </a>
                              <h4>Rule JSON</h4>
                              <pre class="db popup" style="width: 100%;height: 250px;border: 1px solid gray;
    padding: 10px;    overflow-y: scroll;
    font-family: monospace;    font-size: 14px;
    color: black;" [innerHTML]="viewjson | json">
              </pre>
                            </div>
                          </ng-template>
                          <ng-template #signaturexml>
                            <div class="db container popupbg" style="padding: 20px;position: relative;">
                              <a (click)="closexml()" class="db signaturexml" href="javascript:void(0);">
                                <i class="db fa fa-times" aria-hidden="true"></i>
                              </a>
                              <h4>Signature JSON</h4>
                              <pre class="db popup" style="width: 100%;height: 200px;border: 1px solid gray;
    padding: 10px;font-size: 14px;
    font-family: monospace;
    color: black;" [innerHTML]="viewsignaturejson | json">
              </pre>
                            </div>
                          </ng-template>
                        </mat-tab>
                      </mat-tab-group>
                    </div>
                  </ng-container>
                </div>
              </div>
            </div>
            
          </div>
        </div>

        <a href="javascript: void(0);" (click)="rightsidepanel()" *ngIf="editable" style="bottom: calc(50% + 120px)"
          class="db air__sidebar__toggleButton air__sidebar__actionToggle" data-toggle="tooltip" data-placement="left"
          tooltip="Settings" placement="right" container="body">
          <svg _ngcontent-ayq-c6="" style="width: 30px;height:30px; margin: 7px 0px 0px -3px;" viewBox="0 0 36.61 30.66"
            xmlns="http://www.w3.org/2000/svg">
            <defs _ngcontent-ayq-c6="">
              <style _ngcontent-ayq-c6="">
                .cls-1 {
                  fill: #606060;
                }
              </style>
            </defs>
            <title _ngcontent-ayq-c6="">setting-icon-roght-panel</title>
            <g _ngcontent-ayq-c6="" data-name="Layer 2" id="Layer_2">
              <g _ngcontent-ayq-c6="" data-name="Layer 1" id="Layer_1-2">
                <g _ngcontent-ayq-c6="" data-name="<Group>" id="_Group_">
                  <path _ngcontent-ayq-c6="" class="db cls-1"
                    d="M35,23.82a.78.78,0,0,0,.91-.62l.66-3.45a.78.78,0,0,0-.62-.91l-1.33-.25a9.23,9.23,0,0,0-.45-2.14l1.12-.76a.78.78,0,0,0,.21-1.08l-2-2.9a.78.78,0,0,0-1.08-.21l-1.12.76a9.26,9.26,0,0,0-1.83-1.2l.25-1.33a.78.78,0,0,0-.62-.91l-3.45-.66a.78.78,0,0,0-.91.62l-.25,1.33a9.25,9.25,0,0,0-2.14.45l-.76-1.12a.78.78,0,0,0-1.08-.21l-2.9,2a.78.78,0,0,0-.21,1.08l.76,1.12A9.25,9.25,0,0,0,17,15.22L15.67,15a.78.78,0,0,0-.91.62L14.1,19a.78.78,0,0,0,.62.91l1.33.25a9.2,9.2,0,0,0,.44,2.14l-1.12.76a.78.78,0,0,0-.21,1.08l2,2.9a.78.78,0,0,0,1.08.21l1.12-.76a9.23,9.23,0,0,0,1.83,1.2l-.25,1.33a.78.78,0,0,0,.62.91l3.45.66h.15A.78.78,0,0,0,25.9,30l.25-1.33a9.25,9.25,0,0,0,2.14-.45l.76,1.12a.78.78,0,0,0,1.08.21l2.9-2a.78.78,0,0,0,.21-1.08l-.76-1.12a9.23,9.23,0,0,0,1.2-1.83Zm-2.51-1.43a7.7,7.7,0,0,1-1.58,2.4.78.78,0,0,0-.08,1l.67,1-1.61,1.1-.67-1a.78.78,0,0,0-.94-.28,7.67,7.67,0,0,1-2.81.58.78.78,0,0,0-.75.63L24.51,29,22.6,28.6l.22-1.17a.78.78,0,0,0-.47-.87A7.69,7.69,0,0,1,20,25a.78.78,0,0,0-1-.09l-1,.67L16.9,24l1-.67a.78.78,0,0,0,.28-.94,7.69,7.69,0,0,1-.58-2.81.78.78,0,0,0-.63-.75l-1.17-.22.37-1.91,1.17.22a.78.78,0,0,0,.87-.47A7.7,7.7,0,0,1,19.76,14a.78.78,0,0,0,.08-1l-.67-1,1.61-1.09.67,1a.78.78,0,0,0,.94.28,7.69,7.69,0,0,1,2.81-.58A.78.78,0,0,0,26,11l.22-1.17,1.91.37-.22,1.17a.78.78,0,0,0,.47.87,7.68,7.68,0,0,1,2.4,1.58.78.78,0,0,0,1,.08l1-.67,1.1,1.61-1,.67a.78.78,0,0,0-.28.94,7.69,7.69,0,0,1,.58,2.81.78.78,0,0,0,.63.75l1.17.22-.37,1.91-1.17-.22A.78.78,0,0,0,32.52,22.39Z"
                    data-name="<Compound Path>" id="_Compound_Path_"></path>
                  <path _ngcontent-ayq-c6="" class="db cls-1"
                    d="M26.4,13.89a5.61,5.61,0,1,0-2.1,11h0a5.55,5.55,0,0,0,1.05.1,5.61,5.61,0,0,0,1-11.12Zm2.93,6.27a4,4,0,0,1-4.73,3.22h0a4,4,0,0,1,.75-8,4.1,4.1,0,0,1,.77.07A4.05,4.05,0,0,1,29.32,20.16Z"
                    data-name="<Compound Path>" id="_Compound_Path_2"></path>
                  <path _ngcontent-ayq-c6="" class="db cls-1"
                    d="M.38,11a.59.59,0,0,0,.66.5l1-.14a6.94,6.94,0,0,0,.84,1.41l-.61.82a.59.59,0,0,0,.12.82l2.11,1.58a.59.59,0,0,0,.82-.12L5.94,15a6.93,6.93,0,0,0,1.59.41l.14,1a.59.59,0,0,0,.58.5h.08L11,16.54a.59.59,0,0,0,.5-.66l-.14-1A6.92,6.92,0,0,0,12.72,14l.82.61a.59.59,0,0,0,.82-.12l1.58-2.11a.59.59,0,0,0-.12-.82L15,11a6.93,6.93,0,0,0,.41-1.59l1-.14a.59.59,0,0,0,.5-.66L16.54,6a.59.59,0,0,0-.66-.5l-1,.14A6.89,6.89,0,0,0,14,4.2l.61-.82a.59.59,0,0,0-.12-.82L12.41,1a.59.59,0,0,0-.82.12L11,1.92a7,7,0,0,0-1.59-.41L9.25.5A.59.59,0,0,0,8.58,0L6,.38a.59.59,0,0,0-.5.66l.14,1a6.94,6.94,0,0,0-1.41.84l-.82-.61a.59.59,0,0,0-.82.12L1,4.51a.59.59,0,0,0,.12.82l.82.61a6.94,6.94,0,0,0-.41,1.59l-1,.14a.59.59,0,0,0-.5.66ZM2.13,8.63a.59.59,0,0,0,.5-.54A5.78,5.78,0,0,1,3.17,6,.59.59,0,0,0,3,5.28l-.72-.54.88-1.17.71.54a.59.59,0,0,0,.74,0A5.77,5.77,0,0,1,6.46,3a.59.59,0,0,0,.38-.63l-.13-.88,1.45-.21.13.88a.59.59,0,0,0,.54.5,5.78,5.78,0,0,1,2.09.54A.59.59,0,0,0,11.64,3l.54-.72,1.17.88-.54.71a.59.59,0,0,0,0,.74,5.79,5.79,0,0,1,1.1,1.85.59.59,0,0,0,.63.38l.88-.13.21,1.45-.88.13a.59.59,0,0,0-.5.54,5.79,5.79,0,0,1-.54,2.09.59.59,0,0,0,.18.72l.71.53-.88,1.17-.72-.54a.59.59,0,0,0-.74,0,5.77,5.77,0,0,1-1.85,1.1.59.59,0,0,0-.38.63l.13.88-1.45.21-.13-.88a.59.59,0,0,0-.54-.5A5.78,5.78,0,0,1,6,13.75a.59.59,0,0,0-.72.18l-.54.72-1.17-.88.54-.71a.59.59,0,0,0,0-.74A5.77,5.77,0,0,1,3,10.46a.59.59,0,0,0-.63-.38l-.88.13L1.25,8.76Z"
                    data-name="<Compound Path>" id="_Compound_Path_3"></path>
                  <path _ngcontent-ayq-c6="" class="db cls-1"
                    d="M8.46,12.68a4.34,4.34,0,0,0,.6,0,4.21,4.21,0,1,0-.6,0ZM8,5.45a3.12,3.12,0,0,1,.43,0,3,3,0,1,1-.43,0Z"
                    data-name="<Compound Path>" id="_Compound_Path_4"></path>
                </g>
              </g>
            </g>
          </svg>
        </a>
        <a href="javascript: void(0);" (click)="rightsidecomments0()" *ngIf="reply_flag==true && overallcomments.length>0" style="bottom: calc(40% + 120px);color: #606060 !important;font-size: 20px;"
        class="db air__sidebar__toggleButton comments air__sidebar__actionToggle" tooltip="Comments" placement="right" container="body">
        {{overallcomments.length}} 
        <em class="db fe fe-message-circle text-gray" style="font-size:20px; margin: 7px 0px 0px -3px;color: #606060 !important;"></em>
        </a>
        <div class="db air__sidebarR air__sidebar kit__customScroll sidebarcontents" style="right: 0px;
left: inherit;width: 17rem !important;" *ngIf="showrightsidecomments0">
<div class="db air__sidebar__inner">
<a href="javascript: void(0);" (click)="rightsidecomments0()" class="db air__sidebar__close air__sidebar__actionToggle" style="padding-top: 10px;background-color: transparent !important;">
  <img class ="imgicons" src="./assets/svg/close-icon.svg" alt="" style="width: 12px;" />
</a>
<h5 class="db air__sidebar__type pl-2 text-white">
  <strong>Comments</strong>
</h5>
<div  style="margin-top: 15px; margin-bottom: 10px"></div>
<div class="commentslistgroup">
<div class="db commentslist" *ngFor="let data of overallcomments; let i=index">
<span class="db numbers" style="position: relative;background-color: #d4cfcf;margin:0px 10px 0px 0px;">{{i+1}}</span>   
<div class="db userdetail">
  <p style="margin: 0px;" style="color: white;margin: 0px !important;font-size: 15px;">{{data.comments}}</p>
  <h3 style="color: white;font-size: 12px;font-weight: 100;">{{data.username}} {{data.createdate | date:'short'}}</h3>
  <a style="font-weight: 100;
  text-decoration: underline !important;
  color: gray !important;
  font-size: 13px;" (click)="replydetail(data.commentid)">{{data.replymessage.length}} replies</a>
 <hr>
 <div *ngIf="data.commentid==activerplycommentid && showreplydetaildiv">
 <div class="db replycommentsdiv" *ngFor="let data0 of data.replymessage">
  <p style="margin: 0px;" style="color: white;margin: 0px;">{{data0.commentmessage}}</p>
  <h3 style="color: white;font-size: 12px;font-weight: 100;margin-bottom: 10px;">{{data0.username}} {{data0.create_date | date:'short'}}</h3>
 </div>
</div>
<input type="text" #replystxt [ngClass]="showreplytxt && activepin==data.pinid ?'form-control showdiv':'hidediv'" placeholder="Type reply here..." style="background: transparent;
border: none;padding: 0px;border-bottom: 1px solid #565555;width: 100%;color:white;
margin-bottom: 10px;">
<a class="db btn btn-primary rplybtn" (click)="replybtn(replystxt.value,data.pinid,data.commentid)">Reply</a>
</div>
</div>
</div>
</div>
</div>
        <!--<div class="db air__sidebarl air__sidebar kit__customScroll sidebarcontents" *ngIf="showleftsidepanel">
          <div class="db air__sidebar__inner">
            <a href="javascript: void(0);" (click)="leftsidepanel()"
              class="db air__sidebar__close air__sidebar__actionToggle">
              <img class="db imgicons" src="./assets/svg/close-icon.svg" alt="" style="width: 12px;" />
            </a>
            <div class="db air__sidebar__type" style="    margin-top: 0rem;">
              <a href="javascript:void(0);" (click)="newpagepopup(newpage)" class="db list-group-item  text-center">
                <em class="db fe fe-plus font-size-20" style="font-weight: bold;"></em>
              </a>
            </div>
            <div class="db air__sidebar__type" dropdown>
              <a href="javascript:void(0);" (click)="btnmenuclickshow('textdiv')" (mouseover)="imagechangeover('text')"
                (mouseout)="imagechangeoverout('text')" tooltip="Text" placement="right" id="button-basic1"
                dropdownToggle type="button" aria-controls="dropdown-basic1"
                class="db list-group-item  text-center btn btn-primary dropdown-toggle">
                <img [src]="textsrc" alt="" width="18" />
                <span class="db notes notes1">Text</span>
              </a>
              <div class="db bhoechie-tab-content dropdown-menu" id="dropdown-basic1" *dropdownMenu role="menu"
                aria-labelledby="button-basic1">
                <div style=" padding-top: 8px;">
                  <h5 draggable="true" id="addtext04" (mouseover)="imagechangeover('stext')"
                    (mouseout)="imagechangeoverout('stext')" (dragend)="onDragEnd($event)"
                    (dragstart)="onDragStart($event)" class="db bn btn-primry addtextaclass">
                    <span tooltip="Drag to Draw Text Variable" placement="right">
                      <img [src]="shorttextsrc" alt="" class="db imageicon">Classic Text</span>
                  </h5>
                  <hr>
                  <h5 draggable="true" id="addtext05" (mouseover)="imagechangeover('label')"
                    (mouseout)="imagechangeoverout('label')" (dragend)="onDragEnd($event)"
                    (dragstart)="onDragStart($event)" class="db bn btn-primry addtextaclass">
                    <span tooltip="Drag to Draw Text Label" placement="right"> <img [src]="labelsrc" alt="" class="db imageicon">
                      Short Text</span>
                  </h5>
                  <hr>
                  <h5 draggable="true" id="addtext06" (mouseover)="imagechangeover('ltext')"
                    (mouseout)="imagechangeoverout('ltext')" (dragend)="onDragEnd($event)"
                    (dragstart)="onDragStart($event)" class="db bn btn-primry addtextaclass">
                    <span tooltip="Drag to Draw Text Para" placement="right"><img [src]="longtextsrc" alt="" class="db imageicon">
                      Long Text</span>
                  </h5>
                </div>
              </div>
            </div>
            <div class="db air__sidebar__type" dropdown>
              <a href="javascript:void(0);" (click)="btnmenuclickshow('shapesdiv')"
                (mouseover)="imagechangeover('shapes')" (mouseout)="imagechangeoverout('shapes')" tooltip="Shapes"
                placement="right" id="button-basic" dropdownToggle type="button"
                class="db btn btn-primary dropdown-toggle list-group-item  text-center" aria-controls="dropdown-basic">
                <img [src]="shapessrc" alt="" width="18" />
                <span class="db notes notes1">Shapes</span>
              </a>

              <div class="db bhoechie-tab-content dropdown-menu shape" id="dropdown-basic" *dropdownMenu>
                <div style=" padding-top: 8px;">
                  <h5 draggable="true" id="rectangle" (mouseover)="imagechangeover('rectangle')"
                    (mouseout)="imagechangeoverout('rectangle')" (dragstart)="btnAddShapes('rect','')"
                    class="db bn btn-primry addtextaclass">
                    <span placement="right">
                      <img [src]="rectsrc"  alt="" class="db imageicon">Rectangle</span>
                  </h5>
                  <hr>
                  <h5 draggable="true" id="circle" (mouseover)="imagechangeover('circle')"
                    (mouseout)="imagechangeoverout('circle')" (dragstart)="btnAddShapes('circle','')"
                    class="db bn btn-primry addtextaclass">
                    <span placement="right"> <img [src]="circlesrc"  alt="" class="db imageicon"> Circle</span>
                  </h5>
                  <hr>
                  <h5 draggable="true" id="ellipse" (mouseover)="imagechangeover('ellipse')"
                    (mouseout)="imagechangeoverout('ellipse')" (dragstart)="btnAddShapes('ellipse','')"
                    class="db bn btn-primry addtextaclass">
                    <span placement="right"> <img [src]="ellipsesrc"  alt="" class="db imageicon"> Ellipse</span>
                  </h5>
                  <hr>
                  <h5 draggable="true" id="horzline" (mouseover)="imagechangeover('hline')"
                    (mouseout)="imagechangeoverout('hline')" (dragstart)="btnAddShapes('hline','')"
                    class="db bn btn-primry addtextaclass">
                    <span placement="right"> <img [src]="hlinesrc"  alt="" class="db imageicon"> Horizontal Line</span>
                  </h5>
                  <hr>
                  <h5 draggable="true" id="vertline" (mouseover)="imagechangeover('vline')"
                    (mouseout)="imagechangeoverout('vline')" (dragstart)="btnAddShapes('vline','')"
                    class="db bn btn-primry addtextaclass">
                    <span placement="right"> <img [src]="vlinesrc"  alt="" class="db imageicon"> Vertical Line</span>
                  </h5>
                  <hr>


                </div>
              </div>
            </div>
            <div class="db air__sidebar__type">
              <a href="javascript:void(0);" (click)="btnToggleGrid();btnMenuClose($event)" tooltip="Show/Hide Grid"
                placement="right" class="db list-group-item  text-center">
                <img  alt=""
                  src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGQAAABkCAIAAAD/gAIDAAAABmJLR0QA/wD/AP+gvaeTAAACfUlEQVR4nO3cMW6CUBzH8UK6YTiFMTLozOAZDA4MSDyAcXP1Dk4mXkCNiYt4BRnYMWj0EhLj/Lp1UNr+f7RaJL/P2L5HHt/0EfoGNKXUG8no/72AV8JYAMYCMBaAsQCMBWAsAGMBGAvAWADGAjAW4D3HnCRJgiA4Ho/X6/XmV7ZtD4fDmx+Ox+Moin687HPmGoZRq9Ucx7Es68fL3lKI8/nseZ6maV9dzXXd+1mu60pW8sy5mqZ1u900TaHbB/6y0jRttVq73U4+pbCUUovFIo7jMAxN0xTOAp5Z/X6/HKU+xXE8GAzk46WxkiRZLpe5llRo8/l8v98LB0tjrddrVcYzVaVUEATCwdJYp9Mp73qKTn5r0lj3bwmlcblchCP5UgpgLABjARgLwFgA6b87tm3nHvaKczNppXzVfBBuQwBjARgLwFgAxgJIXx0KdY7+hLmZpLGiKFqtVsLBJZibidsQwFgAxgIwFoCxAIwFYCwAYwEYC8BYAMYC8AyeZ/CPwW0IYCwAYwEYC8BYAJ7B8wz+13MzcRsCGAvAWADGAjAWgLEAjAVgLABjARgLwFgAnsHzDP4xuA0BjAVgLABjARgLwDN4nsH/em4mbkMAYwEYC8BYAMYCSGNVKpWHruMf/f3HxqrVat7FFJ381qSxOp3ON5/6e126rjuOIx0sHGdZlud5eZdUXL7v1+t14WDgAT+dThuNRq4lFVSz2ZxMJvLxQCzTNMMw9H2/BPtR1/Ver7fdbuVP9zf0o66mac5ms9FotNlsDodD5kdd72cV6gzeMAzLstrttnz3feIZPIAvpQDGAjAWgLEAjAVgLABjARgLwFgAxgIwFoCxAB9nYq7o7VHRcgAAAABJRU5ErkJggg==">
                <span class="db notes notes1">Grid</span>
              </a>
            </div>
            <div class="db air__sidebar__type">
              <a href="javascript:void(0);" (click)="btnCreateTable();btnMenuClose($event)"
                (mouseover)="imagechangeover('table')" (mouseout)="imagechangeoverout('table')" tooltip="Table"
                placement="right" class="db list-group-item  text-center">
                <img [src]="tablesrc"  alt="" width="18" />
                <span class="db notes notes1">Table</span>
              </a>
            </div>
            <div class="db air__sidebar__type">
              <a href="javascript:void(0);" (click)="btnAddImgVarClick(imgvar);" (mouseover)="imagechangeover('image')"
                (mouseout)="imagechangeoverout('image')" tooltip="Image Variable" placement="right"
                class="db list-group-item  text-center">
                <img [src]="imagesrc"  alt="" width="20" />
                <span class="db notes notes1">Image</span>
              </a>
            </div>
            <div class="db air__sidebar__type">
              <a href="javascript:void(0);" (click)="electronictools();" tooltip="Electronic Tools" placement="right"
                class="db list-group-item  text-center">
                                <img  alt="" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGQAAABkCAIAAAD/gAIDAAAABmJLR0QA/wD/AP+gvaeTAAACfUlEQVR4nO3cMW6CUBzH8UK6YTiFMTLozOAZDA4MSDyAcXP1Dk4mXkCNiYt4BRnYMWj0EhLj/Lp1UNr+f7RaJL/P2L5HHt/0EfoGNKXUG8no/72AV8JYAMYCMBaAsQCMBWAsAGMBGAvAWADGAjAW4D3HnCRJgiA4Ho/X6/XmV7ZtD4fDmx+Ox+Moin687HPmGoZRq9Ucx7Es68fL3lKI8/nseZ6maV9dzXXd+1mu60pW8sy5mqZ1u900TaHbB/6y0jRttVq73U4+pbCUUovFIo7jMAxN0xTOAp5Z/X6/HKU+xXE8GAzk46WxkiRZLpe5llRo8/l8v98LB0tjrddrVcYzVaVUEATCwdJYp9Mp73qKTn5r0lj3bwmlcblchCP5UgpgLABjARgLwFgA6b87tm3nHvaKczNppXzVfBBuQwBjARgLwFgAxgJIXx0KdY7+hLmZpLGiKFqtVsLBJZibidsQwFgAxgIwFoCxAIwFYCwAYwEYC8BYAMYC8AyeZ/CPwW0IYCwAYwEYC8BYAJ7B8wz+13MzcRsCGAvAWADGAjAWgLEAjAVgLABjARgLwFgAnsHzDP4xuA0BjAVgLABjARgLwDN4nsH/em4mbkMAYwEYC8BYAMYCSGNVKpWHruMf/f3HxqrVat7FFJ381qSxOp3ON5/6e126rjuOIx0sHGdZlud5eZdUXL7v1+t14WDgAT+dThuNRq4lFVSz2ZxMJvLxQCzTNMMw9H2/BPtR1/Ver7fdbuVP9zf0o66mac5ms9FotNlsDodD5kdd72cV6gzeMAzLstrttnz3feIZPIAvpQDGAjAWgLEAjAVgLABjARgLwFgAxgIwFoCxAB9nYq7o7VHRcgAAAABJRU5ErkJggg==" width="20" />
              </a>
            </div>
            <div class="db air__sidebar__type">
              <a href="javascript:void(0);" (click)="showheaderfooter();" tooltip="Header and Footer" placement="right"
                class="db list-group-item  text-center">
                                <img   alt="" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGQAAABkCAIAAAD/gAIDAAAABmJLR0QA/wD/AP+gvaeTAAACfUlEQVR4nO3cMW6CUBzH8UK6YTiFMTLozOAZDA4MSDyAcXP1Dk4mXkCNiYt4BRnYMWj0EhLj/Lp1UNr+f7RaJL/P2L5HHt/0EfoGNKXUG8no/72AV8JYAMYCMBaAsQCMBWAsAGMBGAvAWADGAjAW4D3HnCRJgiA4Ho/X6/XmV7ZtD4fDmx+Ox+Moin687HPmGoZRq9Ucx7Es68fL3lKI8/nseZ6maV9dzXXd+1mu60pW8sy5mqZ1u900TaHbB/6y0jRttVq73U4+pbCUUovFIo7jMAxN0xTOAp5Z/X6/HKU+xXE8GAzk46WxkiRZLpe5llRo8/l8v98LB0tjrddrVcYzVaVUEATCwdJYp9Mp73qKTn5r0lj3bwmlcblchCP5UgpgLABjARgLwFgA6b87tm3nHvaKczNppXzVfBBuQwBjARgLwFgAxgJIXx0KdY7+hLmZpLGiKFqtVsLBJZibidsQwFgAxgIwFoCxAIwFYCwAYwEYC8BYAMYC8AyeZ/CPwW0IYCwAYwEYC8BYAJ7B8wz+13MzcRsCGAvAWADGAjAWgLEAjAVgLABjARgLwFgAnsHzDP4xuA0BjAVgLABjARgLwDN4nsH/em4mbkMAYwEYC8BYAMYCSGNVKpWHruMf/f3HxqrVat7FFJ381qSxOp3ON5/6e126rjuOIx0sHGdZlud5eZdUXL7v1+t14WDgAT+dThuNRq4lFVSz2ZxMJvLxQCzTNMMw9H2/BPtR1/Ver7fdbuVP9zf0o66mac5ms9FotNlsDodD5kdd72cV6gzeMAzLstrttnz3feIZPIAvpQDGAjAWgLEAjAVgLABjARgLwFgAxgIwFoCxAB9nYq7o7VHRcgAAAABJRU5ErkJggg==" width="20" />
              </a>
            </div>

            <div class="db air__sidebar__type" dropdown>
              <a href="javascript:void(0);" id="button-basic0" dropdownToggle type="button"
                aria-controls="dropdown-basic0" (click)="btnmenuclickshow('signaturediv')"
                (mouseover)="imagechangeover('signature')" (mouseout)="imagechangeoverout('signature')"
                tooltip="Signature" placement="right"
                class="db list-group-item  text-center btn btn-primary dropdown-toggle">
                <img [src]="signaturesrc"  alt="" width="18" />
                <span class="db notes notes1">Signature</span>
              </a>

              <div class="db bhoechie-tab-content dropdown-menu sign" id="dropdown-basic0" *dropdownMenu role="menu"
                aria-labelledby="button-basic0">
                <div style=" padding-top: 8px;">
                  <h5 style="cursor: pointer;" (click)="btnAddfreeflowSignClick(signaturepopups)"
                    class="db bn btn-primry addtextaclass">
                    <span tooltip="Free Flow" placement="right">
                      <img  alt=""
                        src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAABmJLR0QA/wD/AP+gvaeTAAABfElEQVRIidXUvy6kURgG8B+rWH8aotuNQqHYCJUQUcluS9BIZBKVcAFEJIgolHS2obC3sN02LkAjohBCsbMuQEIQjOJ8E8eYjxlGYp/kJF/Oe87znO95//BB0YDu9xTYxB2+VJq4HqMJ8TSqKy3wEzmcor3S5O24SQRyGCjlUlUZAquoxaGQ4FEhD68WaMV39OESE1HsN3awgqsyHomQyF0PVtyiM4oPRLE99JYrMB0R5LARxT5hvyB+hy00lUL+WaiQ/OUTj2t9yuM/i4X+YeQlgcnk8CUynuZoDX8xJ+QkV2TtC/kZKiSvwXFyaAmN+IMzbCekXUJzteAgRSC/JhQgEwU7sJBy8aKIPakCNQl5NWYjsWvp5Vebsl8U+VnyA9+i/WGsC9a8CXmB22jvBjNoQ79gXfatQjCOZRx58HosidVhEede9j41yQSr0joYvuKX0FwlCRTO8/roe1MYGTGygmU9QglfFHvlcxgUKmhe6OqKowrN70H8/+IeV9SGZBJftmYAAAAASUVORK5CYII=" />Free
                      Flow</span>
                  </h5>
                  <hr>
                  <h5 style="cursor: pointer;" (click)="btnAddacccSignClick(signaturepopups)"
                    class="db bn btn-primry addtextaclass">
                    <span tooltip="ACCC Signature" placement="right">
                      <img src="https://img.icons8.com/ios-filled/24/000000/autograph.png"  alt="" />ACCC Signature</span>
                  </h5>
                  <hr>
                  <h5 style="cursor: pointer;" (click)="btnAddaccinitSignClick(signaturepopups)"
                    class="db bn btn-primry addtextaclass">
                    <span tooltip="ACCC Initial" placement="right">
                      <img src="https://img.icons8.com/carbon-copy/100/000000/hand-with-pen.png"  alt="" />ACCC Initial</span>
                  </h5>
                </div>

              </div>
            </div>
          </div>
        </div>-->
        
        <div class="sidebar" *ngIf="showleftsidepanel" style="width: 80px;">
          <div class="sidebarTabs" style="background-color: #272c33">
            <div class="nav flex-column nav-pills" id="v-pills-tab" role="tablist" aria-orientation="vertical" style="position: relative;">
              <a href="javascript: void(0);" *ngIf="mstatus0=='none'" (click)="leftsidepanel()"
              class="air__sidebar__close rightsideclose air__sidebar__actionToggle" style="right: -40px;left: inherit;">
              <img class="imgicons" alt="" src="./assets/svg/close-icon.svg" style="width: 12px;" />
           </a>            
              <a class="nav-link leftsidea" (click)="Templates();" id="templates-tab" data-toggle="pill" href="#templates" role="tab" aria-controls="templates" aria-selected="false"><svg aria-hidden="true" focusable="false" data-prefix="far" data-icon="star" class="svg-inline--fa fa-star fa-w-18" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><path fill="currentColor" d="M528.1 171.5L382 150.2 316.7 17.8c-11.7-23.6-45.6-23.9-57.4 0L194 150.2 47.9 171.5c-26.2 3.8-36.7 36.1-17.7 54.6l105.7 103-25 145.5c-4.5 26.3 23.2 46 46.4 33.7L288 439.6l130.7 68.7c23.2 12.2 50.9-7.4 46.4-33.7l-25-145.5 105.7-103c19-18.5 8.5-50.8-17.7-54.6zM388.6 312.3l23.7 138.4L288 385.4l-124.3 65.3 23.7-138.4-100.6-98 139-20.2 62.2-126 62.2 126 139 20.2-100.6 98z"></path></svg> <span>Templates</span></a>
    
               <a class="nav-link leftsidea" (click)="Text();" id="text-tab" data-toggle="pill" href="#text" role="tab" aria-controls="text" aria-selected="true"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="text-height" class="svg-inline--fa fa-text-height fa-w-18" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><path fill="currentColor" d="M304 32H16A16 16 0 0 0 0 48v96a16 16 0 0 0 16 16h32a16 16 0 0 0 16-16v-32h56v304H80a16 16 0 0 0-16 16v32a16 16 0 0 0 16 16h160a16 16 0 0 0 16-16v-32a16 16 0 0 0-16-16h-40V112h56v32a16 16 0 0 0 16 16h32a16 16 0 0 0 16-16V48a16 16 0 0 0-16-16zm256 336h-48V144h48c14.31 0 21.33-17.31 11.31-27.31l-80-80a16 16 0 0 0-22.62 0l-80 80C379.36 126 384.36 144 400 144h48v224h-48c-14.31 0-21.32 17.31-11.31 27.31l80 80a16 16 0 0 0 22.62 0l80-80C580.64 386 575.64 368 560 368z"></path></svg> <span>Text</span></a>
              
              <a class="nav-link leftsidea" (click)="Image();" id="images-tab" data-toggle="pill" href="#images" role="tab" aria-controls="images" aria-selected="false"><svg aria-hidden="true" focusable="false" data-prefix="far" data-icon="image" class="svg-inline--fa fa-image fa-w-16" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M464 64H48C21.49 64 0 85.49 0 112v288c0 26.51 21.49 48 48 48h416c26.51 0 48-21.49 48-48V112c0-26.51-21.49-48-48-48zm-6 336H54a6 6 0 0 1-6-6V118a6 6 0 0 1 6-6h404a6 6 0 0 1 6 6v276a6 6 0 0 1-6 6zM128 152c-22.091 0-40 17.909-40 40s17.909 40 40 40 40-17.909 40-40-17.909-40-40-40zM96 352h320v-80l-87.515-87.515c-4.686-4.686-12.284-4.686-16.971 0L192 304l-39.515-39.515c-4.686-4.686-12.284-4.686-16.971 0L96 304v48z"></path></svg> <span>Images</span></a>
  
              <a class="nav-link leftsidea" (click)="Videos();" id="videos-tab" data-toggle="pill" href="#videos" role="tab" aria-controls="images" aria-selected="false"><svg aria-hidden="true" focusable="false" data-prefix="far" data-icon="image" class="svg-inline--fa fa-image fa-w-16" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M464 64H48C21.49 64 0 85.49 0 112v288c0 26.51 21.49 48 48 48h416c26.51 0 48-21.49 48-48V112c0-26.51-21.49-48-48-48zm-6 336H54a6 6 0 0 1-6-6V118a6 6 0 0 1 6-6h404a6 6 0 0 1 6 6v276a6 6 0 0 1-6 6zM128 152c-22.091 0-40 17.909-40 40s17.909 40 40 40 40-17.909 40-40-17.909-40-40-40zM96 352h320v-80l-87.515-87.515c-4.686-4.686-12.284-4.686-16.971 0L192 304l-39.515-39.515c-4.686-4.686-12.284-4.686-16.971 0L96 304v48z"></path></svg> <span>Videos</span></a>
            
              <a class="nav-link leftsidea" (click)="Shapes();" id="shapes-tab" data-toggle="pill" href="#shapes" role="tab" aria-controls="shapes" aria-selected="false"><svg aria-hidden="true" focusable="false" data-prefix="far" data-icon="gem" class="svg-inline--fa fa-gem fa-w-18" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><path fill="currentColor" d="M464 0H112c-4 0-7.8 2-10 5.4L2 152.6c-2.9 4.4-2.6 10.2.7 14.2l276 340.8c4.8 5.9 13.8 5.9 18.6 0l276-340.8c3.3-4.1 3.6-9.8.7-14.2L474.1 5.4C471.8 2 468.1 0 464 0zm-19.3 48l63.3 96h-68.4l-51.7-96h56.8zm-202.1 0h90.7l51.7 96H191l51.6-96zm-111.3 0h56.8l-51.7 96H68l63.3-96zm-43 144h51.4L208 352 88.3 192zm102.9 0h193.6L288 435.3 191.2 192zM368 352l68.2-160h51.4L368 352z"></path></svg> <span>Shapes</span></a>
            
              <a class="nav-link leftsidea" (click)="Background();" id="bgimages-tab" data-toggle="pill" href="#bgimages" role="tab" aria-controls="images" aria-selected="false"><svg aria-hidden="true" focusable="false" data-prefix="far" data-icon="image" class="svg-inline--fa fa-image fa-w-16" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M464 64H48C21.49 64 0 85.49 0 112v288c0 26.51 21.49 48 48 48h416c26.51 0 48-21.49 48-48V112c0-26.51-21.49-48-48-48zm-6 336H54a6 6 0 0 1-6-6V118a6 6 0 0 1 6-6h404a6 6 0 0 1 6 6v276a6 6 0 0 1-6 6zM128 152c-22.091 0-40 17.909-40 40s17.909 40 40 40 40-17.909 40-40-17.909-40-40-40zM96 352h320v-80l-87.515-87.515c-4.686-4.686-12.284-4.686-16.971 0L192 304l-39.515-39.515c-4.686-4.686-12.284-4.686-16.971 0L96 304v48z"></path></svg> <span>Background</span></a>
              <a href="javascript:void(0);" (click)="btnToggleGrid();btnMenuClose($event)" tooltip="Show/Hide Grid"
              placement="right" class="nav-link leftsidea">
              <img style="width: 20px;" alt=""
                src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGQAAABkCAIAAAD/gAIDAAAABmJLR0QA/wD/AP+gvaeTAAACfUlEQVR4nO3cMW6CUBzH8UK6YTiFMTLozOAZDA4MSDyAcXP1Dk4mXkCNiYt4BRnYMWj0EhLj/Lp1UNr+f7RaJL/P2L5HHt/0EfoGNKXUG8no/72AV8JYAMYCMBaAsQCMBWAsAGMBGAvAWADGAjAW4D3HnCRJgiA4Ho/X6/XmV7ZtD4fDmx+Ox+Moin687HPmGoZRq9Ucx7Es68fL3lKI8/nseZ6maV9dzXXd+1mu60pW8sy5mqZ1u900TaHbB/6y0jRttVq73U4+pbCUUovFIo7jMAxN0xTOAp5Z/X6/HKU+xXE8GAzk46WxkiRZLpe5llRo8/l8v98LB0tjrddrVcYzVaVUEATCwdJYp9Mp73qKTn5r0lj3bwmlcblchCP5UgpgLABjARgLwFgA6b87tm3nHvaKczNppXzVfBBuQwBjARgLwFgAxgJIXx0KdY7+hLmZpLGiKFqtVsLBJZibidsQwFgAxgIwFoCxAIwFYCwAYwEYC8BYAMYC8AyeZ/CPwW0IYCwAYwEYC8BYAJ7B8wz+13MzcRsCGAvAWADGAjAWgLEAjAVgLABjARgLwFgAnsHzDP4xuA0BjAVgLABjARgLwDN4nsH/em4mbkMAYwEYC8BYAMYCSGNVKpWHruMf/f3HxqrVat7FFJ381qSxOp3ON5/6e126rjuOIx0sHGdZlud5eZdUXL7v1+t14WDgAT+dThuNRq4lFVSz2ZxMJvLxQCzTNMMw9H2/BPtR1/Ver7fdbuVP9zf0o66mac5ms9FotNlsDodD5kdd72cV6gzeMAzLstrttnz3feIZPIAvpQDGAjAWgLEAjAVgLABjARgLwFgAxgIwFoCxAB9nYq7o7VHRcgAAAABJRU5ErkJggg==">
              <span class="notes notes1">Grid</span>
            </a>
            <a href="javascript:void(0);" (click)="datesigndragenable('tabledrag');btnMenuClose($event)"
            (mouseover)="imagechangeover('table')" (mouseout)="imagechangeoverout('table')" tooltip="Table"
            placement="right" class="nav-link leftsidea">
            <img [src]="tablesrc"  alt="" width="18" />
            <span class="notes notes1">Table</span>
          </a>
        <a href="javascript:void(0);" (click)="showheaderfooter();" 
         tooltip="Header and Footer" placement="right"
        class="nav-link leftsidea">
                        <img   alt="" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGQAAABkCAIAAAD/gAIDAAAABmJLR0QA/wD/AP+gvaeTAAACfUlEQVR4nO3cMW6CUBzH8UK6YTiFMTLozOAZDA4MSDyAcXP1Dk4mXkCNiYt4BRnYMWj0EhLj/Lp1UNr+f7RaJL/P2L5HHt/0EfoGNKXUG8no/72AV8JYAMYCMBaAsQCMBWAsAGMBGAvAWADGAjAW4D3HnCRJgiA4Ho/X6/XmV7ZtD4fDmx+Ox+Moin687HPmGoZRq9Ucx7Es68fL3lKI8/nseZ6maV9dzXXd+1mu60pW8sy5mqZ1u900TaHbB/6y0jRttVq73U4+pbCUUovFIo7jMAxN0xTOAp5Z/X6/HKU+xXE8GAzk46WxkiRZLpe5llRo8/l8v98LB0tjrddrVcYzVaVUEATCwdJYp9Mp73qKTn5r0lj3bwmlcblchCP5UgpgLABjARgLwFgA6b87tm3nHvaKczNppXzVfBBuQwBjARgLwFgAxgJIXx0KdY7+hLmZpLGiKFqtVsLBJZibidsQwFgAxgIwFoCxAIwFYCwAYwEYC8BYAMYC8AyeZ/CPwW0IYCwAYwEYC8BYAJ7B8wz+13MzcRsCGAvAWADGAjAWgLEAjAVgLABjARgLwFgAnsHzDP4xuA0BjAVgLABjARgLwDN4nsH/em4mbkMAYwEYC8BYAMYCSGNVKpWHruMf/f3HxqrVat7FFJ381qSxOp3ON5/6e126rjuOIx0sHGdZlud5eZdUXL7v1+t14WDgAT+dThuNRq4lFVSz2ZxMJvLxQCzTNMMw9H2/BPtR1/Ver7fdbuVP9zf0o66mac5ms9FotNlsDodD5kdd72cV6gzeMAzLstrttnz3feIZPIAvpQDGAjAWgLEAjAVgLABjARgLwFgAxgIwFoCxAB9nYq7o7VHRcgAAAABJRU5ErkJggg==" width="20" />
                        <span class="notes notes2">Header and Footer</span>
      </a>
      <a class="nav-link leftsidea" (click)="signatures();" id="signature-tab" data-toggle="pill" href="#signature" role="tab" aria-controls="signature" aria-selected="false"><img [src]="signaturesrc"  alt="" width="18" /> <span>Signature</span></a>
           
  <!--  <a  class="nav-link" target="_blank" href="#" style="position: fixed;text-align: center;padding-left: 20px;bottom: 10px;margin-bottom: 15px;"><img src="/assets/studioassets/images/help.png" width="40" height="40" style="margin-bottom: 5px;"/><br>Help<br>v1.0.0</a>-->
    
            </div>
        </div>
        </div>
        <div class="side-menu">
          <div id="side-menu_inner">
              <ul class="menu">
                  <li class="">
                      <div class="menu-box templates-area">
                          <div class="menu-items">
                            <div class="button-style clearfix detail-btn mt-5">
                              <li class="nav-item px-1">
                                <a class="nav-link" href="javascript:void(0)" style="color: white !important;line-height: 22px;" (click)="triggerpsdupload();">            
                                <i class="fa fa-upload" title="Upload PSD"></i> Import PSD
                                </a>
                                <div class="hiddenfile">
                                    <input type="file" name="folderpathpsd" id="folderpathpsd" (change)="onPSDFileChanged($event);" #fileInput accept=".psd">
                                </div>
                              </li>
                              <li class="nav-item px-1">
                                <a class="nav-link" href="javascript:void(0)" style="color: white !important;line-height: 22px;" (click)="triggerpdfupload();">            
                                <i class="fa fa-upload" title="Import PDF"></i> Import PDF
                                </a>
                                <div class="hiddenfile">
                                    <input type="file" name="folderpathpdf" [(ngModel)]="folderpathpdf" id="folderpathpdf" (change)="onPDFFileChanged($event);" #fileInput accept=".pdf">
                                </div>
                              </li>
                              <!--<li class="nav-item px-1">
                                <a class="nav-link" href="javascript:void(0)" style="color: white;line-height: 22px;" (click)="triggerpdfupload1();">            
                                <i class="fa fa-upload" title="Upload PDF"></i> Upload PDF
                                </a>
                                <div class="hiddenfile">
                                    <input type="file" name="folderpathpdf1" [(ngModel)]="folderpathpdf1" id="folderpathpdf1" (change)="onPDFFileChanged1($event);" #fileInput1 accept=".pdf">
                                </div>
                              </li>-->
                            </div>
                              <div class="button-style clearfix detail-btn mt-1">
                                  <div class="input-box mt-1 dateinput">
                                      <label style="color:white;">Category :</label>
                                      <select [(ngModel)]="props.catg" id="tempcatg" name="tempcatg" (change)="gettempcatg()"></select>
                                  </div>
                              </div>
                              <h2>Templates</h2>
                              <div class="tab-content pl30 pr30 m15 backgroundgrad">
                                  <div class="border-box row mt20" id="templatelist" style="margin-bottom: 100px;">
                                  </div>
                              </div>
                          </div>
                          <span class="menutoggle"></span>
                      </div>
                  </li>
                  <li class="">
                    <div class="menu-box bg-area">
                        <div class="menu-items">
                            <h2>Background Images</h2>
                            <div class="button-style clearfix detail-btn mt-1">
                                <div class="input-box mt-1 dateinput">
                                    <label style="color:white;">Category :</label>
                                    <select [(ngModel)]="props.catg" id="bgimgcatg" name="bgimgcatg" (change)="getbgimgcatg()"></select>
                                </div>
                            </div>
                            <div class="tab-content pl30 pr30 m15" style="max-height: 200px; overflow-y:scroll;">
                                <div class="border-box row mt20" id="bgimglist"></div>
                            </div>
                            <div class="button-style clearfix detail-btn mt-3" style="color: white;">
                                <div class="button-radius" *ngIf="userName !== 'guest'">
                                    <a href="javascript:void(0)" style="color: white;width:100%;" (click)="triggerfilebgimg();">Upload New Background Image</a>
                                    <div class="hiddenfile">
                                        <input type="file" class="form-control-file" id="folderpathbgimg" name="folderpathbgimg" (change)="onBackgroundFileChanged($event)" >
                                    </div>
                                    <a href="javascript:void(0)" class=""  style="color: white;width:100%;" (click)="displaybgimagepopup();">My Background Image </a>
                                </div>
                                <div class="button-radius">
                                    <a href="javascript:void(0)" (click)="pixabayimg('bgimg');" style="color: white;width:100%;">Select Stock Background Image</a>
  <!--                                  <a href="javascript:void(0)"><i class="fa fa-crop" title="Crop Image" style="padding: 10px;"></i>Crop Image</a>
                                    <a href="javascript:void(0)" ><i class="fa fa-crop" title="Crop Image" style="padding: 10px;"></i>Reset Crop</a>-->
                                </div>
                            </div>
                            <div class="tab-content pl30 pr30 m15 backgroundgrad" style="margin-bottom: 200px !important;">
                                <div class="wrapper center-block">
                                    <div class="panel-group" id="accordion" role="tablist" aria-multiselectable="true" style="border: 1px solid transparent;">
                                        <div class="panel panel-default" style="border-radius: 4px;border: 1px solid transparent; background-color: #f5f5f5;">
                                            <div class="panel-heading" role="tab" id="headingFour">
                                                <label class="panel-title" style="color: #333;background-color: #f5f5f5;border-color: #ddd;width: -webkit-fill-available; margin-left:10px;margin-top: 5px;" data-toggle="collapse" data-parent="#accordion" href="#collapsEleven" aria-expanded="true" aria-controls="collapsEleven">
                                                <a role="button" data-toggle="collapse" data-parent="#accordion" href="#collapsEleven" aria-expanded="true" aria-controls="collapsEleven">
                                                Change BG to Solid Color
                                                </a>
                                                </label>
                                            </div>
                                            <div id="collapsEleven" class="panel-collapse collapse in" role="tabpanel" aria-labelledby="headingFour">
                                                <div class="panel-body">
                                                    <div class="button-radius">
                                                        <div align="center">
                                                            <a href="javascript:void(0);" id="colorbgSelector" title="Color Picker" class="tools-top btn btn-default color-pic" style="width: 190px;" ></a>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div style="display: none !important;" class="tab-content pl30 pr30 m15 backgroundgrad">
                                <div class="wrapper center-block">
                                    <div class="panel-group" id="accordion" role="tablist" aria-multiselectable="true" style="border: 1px solid transparent;">
                                        <div class="panel panel-default" style="border-radius: 4px;border: 1px solid transparent; background-color: #f5f5f5;">
                                            <div class="panel-heading" role="tab" id="headingOne" >
                                                <label class="panel-title" style="color: #333;background-color: #f5f5f5;border-color: #ddd;width: -webkit-fill-available; margin-left:10px;margin-top: 5px;" data-toggle="collapse" data-parent="#accordion" href="#collapseTen" aria-expanded="true" aria-controls="collapseTen">
                                                <a role="button" data-toggle="collapse" data-parent="#accordion" href="#collapseTen" aria-expanded="true" aria-controls="collapseTen">
                                                Background Image Filters
                                                </a>
                                                </label>
                                            </div>
                                            <div id="collapseTen" class="panel-collapse collapse in" role="tabpanel" aria-labelledby="headingOne" style="position: relative;">
                                                <div class="panel-body">
                                                    <div class="button-radius">
                                                        <label for="">Rotate:</label>&nbsp;&nbsp;
                                                        <span class="size charSpac">{{props.setrotate}}</span>
                                                    </div>
                                                    <div class="fonts-slider">
                                                        <input type="range" style="width: 260px;" class="slider" max="360" min="0" step="10" [(ngModel)]="props.setrotate" (change)="setrotate()">
                                                    </div>
                                                    <div class="button-radius">
                                                        <label for="">Opacity:</label>&nbsp;&nbsp;
                                                        <span class="size">{{selectedProperty.opacity*100}}%</span>
                                                    </div>
                                                    <div class="fonts-slider">
                                                        <input class="slider" style="width: 260px;" type="range" max="1" min="0" step="0.1" (change)="setOpacity()">
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="menu-items" style="height: auto !important;display: none !important;">
                                <h2>Background Gradients</h2>
                                <div class="tab-content pl30 pr30 m15 backgroundgrad" *ngIf="isAdmin">
                                    <div class="wrapper center-block">
                                        <div class="panel-group" id="accordion" role="tablist" aria-multiselectable="true" style="border: 1px solid transparent;">
                                            <div class="panel panel-default" style="border-radius: 4px;border: 1px solid transparent; background-color: #f5f5f5;">
                                                <div class="panel-heading" role="tab" id="headingFour">
                                                    <label class="panel-title" style="color: #333;background-color: #f5f5f5;border-color: #ddd;width: -webkit-fill-available; margin-left:10px;margin-top: 5px;" data-toggle="collapse" data-parent="#accordion" href="#collapsEight" aria-expanded="true" aria-controls="collapsEight">
                                                    <a role="button" data-toggle="collapse" data-parent="#accordion" href="#collapsEight" aria-expanded="true" aria-controls="collapsEight">
                                                    Color1
                                                    </a>
                                                    </label>
                                                </div>
                                                <div id="collapsEight" class="panel-collapse collapse in" role="tabpanel" aria-labelledby="headingFour">
                                                    <div class="panel-body">
                                                        <div class="button-radius">
                                                            <div align="center">
                                                                <a href="javascript:void(0);" id="coloroneSelector" title="Color Picker" class="tools-top btn btn-default color-pic" style="width: 190px;" ></a>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="tab-content pl30 pr30 m15 backgroundgrad" *ngIf="isAdmin">
                                    <div class="wrapper center-block">
                                        <div class="panel-group" id="accordion" role="tablist" aria-multiselectable="true" style="border: 1px solid transparent;">
                                            <div class="panel panel-default" style="border-radius: 4px;border: 1px solid transparent; background-color: #f5f5f5;">
                                                <div class="panel-heading" role="tab" id="headingFour">
                                                    <label class="panel-title" style="color: #333;background-color: #f5f5f5;border-color: #ddd;width: -webkit-fill-available; margin-left:10px;margin-top: 5px;" data-toggle="collapse" data-parent="#accordion" href="#collapseNine" aria-expanded="true" aria-controls="collapseNine">
                                                    <a role="button" data-toggle="collapse" data-parent="#accordion" href="#collapseNine" aria-expanded="true" aria-controls="collapseNine">
                                                    Color2
                                                    </a>
                                                    </label>
                                                </div>
                                                <div id="collapseNine" class="panel-collapse collapse in" role="tabpanel" aria-labelledby="headingFour">
                                                    <div class="panel-body">
                                                        <div class="button-radius">
                                                            <div align="center">
                                                                <a href="javascript:void(0);" id="colortwoSelector" title="Color Picker" class="tools-top btn btn-default color-pic" style="width: 190px;" ></a>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="button-style clearfix detail-btn mt-1" *ngIf="isAdmin">
                                    <div class="input-box mt-1 dateinput" style="color: white;">
                                        <div class="selected-color">
                                            <!-- <i class="fas fa-save" title="Save" (click)="saveBGGradient()" id="saveBGGradient" style="font-size: 20px;" *ngIf="isAdmin"></i> -->
                                            <i class="fas fa-save" title="Save" (click)="saveBGGradient()" id="saveBGGradient" style="font-size: 20px;"></i>
                                        </div>
                                    </div>
                                </div>
                                <div class="gradient-colors-list bggradientsec" style="margin-bottom: 75px !important;"></div>
                            </div>
                        </div>
                        <span class="menutoggle"></span>
                    </div>
                </li>
                <li class="">
                  <div class="menu-box text-area">
                      <div class="menu-items">
                          <h2>Text &nbsp;&nbsp;&nbsp;&nbsp;</h2>
                         <div class="button-style clearfix detail-btn detailbtn1 mt-1" style="display: block;">
                           <h5 id="addtext04" (mouseover)="imagechangeover('stext')"
                            (mouseout)="imagechangeoverout('stext')" (click)="datesigndragenable('textvariabledrag')" class="ecstructure bn btn-primry addtextaclass">
                            <span tooltip="Drag to Draw Text Variable" placement="right">
                              <img [src]="shorttextsrc" alt="" class="imageicon">Classic Text</span>
                          </h5>
                          <h5 id="addtext05" (mouseover)="imagechangeover('label')"
                            (mouseout)="imagechangeoverout('label')" (click)="datesigndragenable('slabeldrag')" class="bn btn-primry addtextaclass">
                            <span tooltip="Drag to Draw Text Label" placement="right"> <img [src]="labelsrc" alt="" class="imageicon">
                              Short Text</span>
                          </h5>
                          <h5 id="addtext06" (mouseover)="imagechangeover('ltext')"
                            (mouseout)="imagechangeoverout('ltext')" (click)="datesigndragenable('longtextdrag')" class="bn btn-primry addtextaclass">
                            <span tooltip="Drag to Draw Text Para" placement="right"><img [src]="longtextsrc" alt="" class="imageicon">
                              Long Text</span>
                          </h5>
                          </div>
                          <div class="button-style clearfix detail-btn mt-1">
                            <div class="input-box mt-1 dateinput">
                                <label style="color:white;">Font Family</label>
                                <select [ngModel]="objProps.get('fontFamily')" (ngModelChange)="objProps.set('fontFamily', $event)" id="fontselect" name="fontselect" (change)="setFontFamily()"></select>
                            </div>
                        </div>
                          <div class="tab-content pl30 pr30 m15 backgroundgrad">
                              <div class="wrapper center-block">
                                  <div class="panel-group" id="accordion" role="tablist" aria-multiselectable="true" style="border: 1px solid transparent;">
                                      <div class="panel panel-default" style="border-radius: 4px;border: 1px solid transparent; background-color: #f5f5f5;">
                                          <div class="panel-heading" role="tab" id="headingFour">
                                              <label class="panel-title" style="color: #333;background-color: #f5f5f5;border-color: #ddd;width: -webkit-fill-available; margin-left:10px;margin-top: 5px;" data-toggle="collapse" data-parent="#accordion" href="#collapseFive" aria-expanded="true" aria-controls="collapseFive">
                                              <a role="button" data-toggle="collapse" data-parent="#accordion" href="#collapseFive" aria-expanded="true" aria-controls="collapseFive">
                                              Stroke Color
                                              </a>
                                              </label>
                                          </div>
                                          <div id="collapseFive" class="panel-collapse collapse in" role="tabpanel" aria-labelledby="headingFour">
                                              <div class="panel-body">
                                                  <div class="button-radius">
                                                      <label for="">Stroke Width:</label>&nbsp;&nbsp;
                                                      <span class="opacity-counter">{{objProps.get('strokeWidth')}}</span>
                                                  </div>
                                                  <div class="fonts-slider">
                                                      <input class="slider" style="width: 260px;" type="range" max="10" min="0" step="1" [ngModel]="objProps.get('strokeWidth')" (ngModelChange)="objProps.set('strokeWidth', $event)" (change)="setStorkeWidth()">
                                                  </div>
                                                  <div class="button-radius">
                                                      <label for="">Stroke Color:</label>&nbsp;&nbsp;
                                                      <div align="center">
                                                          <a href="javascript:void(0);" id="strolkecolorSelector" title="Color Picker" class="tools-top btn btn-default color-pic" style="width: 190px;" ></a>
                                                      </div>
                                                  </div>
                                                  <div class="button-radius">
                                                      <label for="">No Stroke:</label> &nbsp;&nbsp; 
                                                      <input type="checkbox" id="textnostroke" class="nostroke" (change)="nostroke($event)">
                                                  </div>
                                              </div>
                                          </div>
                                      </div>
                                  </div>
                              </div>
                          </div>
                          <div class="tab-content pl30 pr30 m15 backgroundgrad">
                              <div class="wrapper center-block">
                                  <div class="panel-group" id="accordion" role="tablist" aria-multiselectable="true" style="border: 1px solid transparent;">
                                      <div class="panel panel-default" style="border-radius: 4px;border: 1px solid transparent; background-color: #f5f5f5;">
                                          <div class="panel-heading" role="tab" id="headingOne">
                                              <label class="panel-title" style="color: #333;background-color: #f5f5f5;border-color: #ddd;width: -webkit-fill-available; margin-left:10px;margin-top: 5px;"  data-toggle="collapse" data-parent="#accordion" href="#collapsecurved" aria-expanded="true" aria-controls="collapsecurved">
                                              <a role="button" data-toggle="collapse" data-parent="#accordion" href="#collapsecurved" aria-expanded="true" aria-controls="collapsecurved">
                                               Curved Text
                                              </a>
                                              </label>
                                          </div>
                                          <div id="collapsecurved" class="panel-collapse collapse in" role="tabpanel" aria-labelledby="headingOne">
                                              <div class="panel-body">
                                                 <div class="button-radius">
                                                      <label for="">Text:</label>&nbsp;&nbsp;
                                                  </div>
                                                  <div class="fonts-slider">
                                                      <input type="text" name="ctext" id="ctext" class="form-control" (input)="curvedText($event.target.value)" style="width: 260px;" sytle="-webkit-appearance: none;background: black;">
                                                  </div>
                                                 <div class="button-radius">
                                                      <label for="">Diameter:</label>&nbsp;&nbsp;
                                                      <span class="size charSpac">{{objProps.get('diameter')}}</span>
                                                  </div>
                                                  <div class="fonts-slider">
                                                      <input type="range" style="width: 260px;" class="slider" max="2500" min="100" step="1" [ngModel]="objProps.get('diameter')" (ngModelChange)="objProps.set('diameter', $event)" (change)="setDiameter()" sytle="-webkit-appearance: none;background: black;">
                                                  </div>
                                                 <div class="button-radius">
                                                      <label for="">Curve Font size:</label>&nbsp;&nbsp;
                                                      <span class="size charSpac">{{objProps.get('ctxtsize')}}</span>
                                                  </div>
                                                  <div class="fonts-slider">
                                                      <input type="range" style="width: 260px;" class="slider" max="100" min="8" step="1" [ngModel]="objProps.get('ctxtsize')" (ngModelChange)="objProps.set('ctxtsize', $event)" (change)="setCtxtsize()" sytle="-webkit-appearance: none;background: black;">
                                                  </div>
                                                 <div class="button-radius">
                                                      <label for="">Kerning:</label>&nbsp;&nbsp;
                                                      <span class="size charSpac">{{objProps.get('kerning')}}</span>
                                                  </div>
                                                  <div class="fonts-slider">
                                                      <input type="range" style="width: 260px;" class="slider" max="10" min="-10" step="0" [ngModel]="objProps.get('kerning')" (ngModelChange)="objProps.set('kerning', $event)" (change)="setKerning()" sytle="-webkit-appearance: none;background: black;">
                                                  </div>
                                                 <div class="button-radius">
                                                      <label for="">Flip:</label>&nbsp;&nbsp;
                                                      <input type="checkbox" id="flip" [(ngModel)]="props.flip" (change)="flip()">
                                                  </div>
                                              </div>
                                          </div>
                                      </div>
                                  </div>
                              </div>
                          </div>                        
                          <div class="tab-content pl30 pr30 m15 backgroundgrad" style="margin-bottom: 200px !important;">
                              <div class="wrapper center-block">
                                  <div class="panel-group" id="accordion" role="tablist" aria-multiselectable="true" style="border: 1px solid transparent;">
                                      <div class="panel panel-default" style="border-radius: 4px;border: 1px solid transparent; background-color: #f5f5f5;">
                                          <div class="panel-heading" role="tab" id="headingOne">
                                              <label class="panel-title" style="color: #333;background-color: #f5f5f5;border-color: #ddd;width: -webkit-fill-available; margin-left:10px;margin-top: 5px;"  data-toggle="collapse" data-parent="#accordion" href="#collapseOne" aria-expanded="true" aria-controls="collapseOne">
                                              <a role="button" data-toggle="collapse" data-parent="#accordion" href="#collapseOne" aria-expanded="true" aria-controls="collapseOne">
                                              Text Adjust
                                              </a>
                                              </label>
                                          </div>
                                          <div id="collapseOne" class="panel-collapse collapse in" role="tabpanel" aria-labelledby="headingOne">
                                              <div class="panel-body">
                                                 <div class="button-radius">
                                                      <label for="">Letter Spacing:</label>&nbsp;&nbsp;
                                                      <span class="size charSpac">{{objProps.get('charSpacing')}}</span>
                                                  </div>
                                                  <div class="fonts-slider">
                                                      <input type="range" style="width: 260px;" class="slider" max="400" min="50" step="25" [ngModel]="objProps.get('charSpacing')" (ngModelChange)="objProps.set('charSpacing', $event)" (change)="setCharSpacing()" sytle="-webkit-appearance: none;background: black;">
                                                  </div>
                                                  <div class="button-radius">
                                                      <label for="">Rotate:</label>&nbsp;&nbsp;
                                                      <span class="size charSpac">{{props.setrotate}}</span>
                                                  </div>
                                                  <div class="fonts-slider">
                                                      <input type="range" style="width: 260px;" class="slider" max="360" min="0" step="10" [(ngModel)]="props.setrotate" (change)="setrotate()">
                                                  </div>
                                                  <div class="button-radius">
                                                      <label for="">Line Spacing:</label>&nbsp;&nbsp;
                                                      <span class="size">{{objProps.get('lineHeight')}}</span>
                                                  </div>
                                                  <div class="fonts-slider">
                                                      <input type="range" style="width: 260px;" class="slider" max="4" min="1" step="0.2" [ngModel]="objProps.get('lineHeight')" (ngModelChange)="objProps.set('lineHeight', $event)" (change)="setLineHeight()">
                                                  </div>
                                                  <div class="button-radius">
                                                      <label for="">Blur:</label>&nbsp;&nbsp;
                                                      <span class="size lineHei" *ngIf="objProps.get('opacity')=='NaN'">{{1*100}}%</span>
                                                      <span class="size lineHei" *ngIf="objProps.get('opacity')!='NaN'">{{objProps.get('opacity')*100}}%</span>
                                                  </div>
                                                  <div class="fonts-slider">
                                                      <input class="slider" style="width: 260px;" type="range" max="1" min="0" step="0.1" [ngModel]="objProps.get('opacity')" (ngModelChange)="objProps.set('opacity', $event)" (change)="setOpacity()">
                                                  </div>
                                              </div>
                                          </div>
                                      </div>
                                  </div>
                              </div>
                          </div>
                          <div class="tab-content pl30 pr30 m15 backgroundgrad" style="display:none;margin-bottom: 100px !important;">
                              <div class="wrapper center-block">
                                  <div class="panel-group" id="accordion" role="tablist" aria-multiselectable="true" style="border: 1px solid transparent;">
                                      <div class="panel panel-default" style="border-radius: 4px;border: 1px solid transparent; background-color: #f5f5f5;">
                                          <div class="panel-heading" role="tab" id="headingOne">
                                              <label class="panel-title" style="color: #333;background-color: #f5f5f5;border-color: #ddd;width: -webkit-fill-available; margin-left:10px;margin-top: 5px;"  data-toggle="collapse" data-parent="#accordion" href="#collapseZero" aria-expanded="true" aria-controls="collapseZero">
                                              <a role="button" data-toggle="collapse" data-parent="#accordion" href="#collapseZero" aria-expanded="true" aria-controls="collapseZero">
                                              Text Shadow
                                              </a>
                                              </label>
                                          </div>
                                          <div id="collapseZero" class="panel-collapse collapse in" role="tabpanel" aria-labelledby="headingOne">
                                              <div class="panel-body">
                                                  <div class="button-radius">
                                                      <label for="">Shadow Color:</label>&nbsp;&nbsp;
                                                      <div align="center">
                                                          <a href="javascript:void(0);" id="shadowcolorSelector" title="Color Picker" class="tools-top btn btn-default color-pic" style="width: 190px;" ></a>
                                                      </div>
                                                  </div>
                                                  <div class="button-radius">
                                                      <label for="">OffsetX :</label>&nbsp;&nbsp;
                                                      <span class="size">{{props.offsetX}}</span>
                                                  </div>
                                                  <div class="fonts-slider">
                                                      <input class="slider" type="range" max="10" min="1" step="1" [(ngModel)]="props.offsetX" (change)="setglowoffsetX()">
                                                  </div>
                                                  <div class="button-radius">
                                                      <label for="">OffsetY :</label>&nbsp;&nbsp;
                                                      <span class="size">{{props.offsetY}}</span>
                                                  </div>
                                                  <div class="fonts-slider">
                                                      <input class="slider" type="range" max="10" min="1" step="1" [(ngModel)]="props.offsetY" (change)="setglowoffsetY()">
                                                  </div>
                                                  <div class="button-radius">
                                                      <label for="">Transparency:</label>&nbsp;&nbsp;
                                                      <span class="size">{{props.blur}}%</span>
                                                  </div>
                                                  <div class="fonts-slider">
                                                      <input class="slider" style="width: 260px;" type="range" max="10" min="1" step="1" [(ngModel)]="props.blur" (change)="setglowblur()">
                                                  </div>
                                              </div>
                                          </div>
                                      </div>
                                  </div>
                              </div>
                          </div>
                      </div>
                      <span class="menutoggle"></span>
                  </div>
              </li>
              <li class="">
                <div class="menu-box signature-area">
                    <div class="menu-items">
                        <h2>Signature</h2>
                        
                        <div class="detail-btn detailbtn1" style=" padding-top: 8px;">
                          <h5 style="cursor: pointer;" (click)="datesigndragenable('freeflowdrag')" class="bn btn-primry addtextaclass">
                          <span tooltip="Free Flow" placement="right">
                            <img  alt=""
                              src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAABmJLR0QA/wD/AP+gvaeTAAABfElEQVRIidXUvy6kURgG8B+rWH8aotuNQqHYCJUQUcluS9BIZBKVcAFEJIgolHS2obC3sN02LkAjohBCsbMuQEIQjOJ8E8eYjxlGYp/kJF/Oe87znO95//BB0YDu9xTYxB2+VJq4HqMJ8TSqKy3wEzmcor3S5O24SQRyGCjlUlUZAquoxaGQ4FEhD68WaMV39OESE1HsN3awgqsyHomQyF0PVtyiM4oPRLE99JYrMB0R5LARxT5hvyB+hy00lUL+WaiQ/OUTj2t9yuM/i4X+YeQlgcnk8CUynuZoDX8xJ+QkV2TtC/kZKiSvwXFyaAmN+IMzbCekXUJzteAgRSC/JhQgEwU7sJBy8aKIPakCNQl5NWYjsWvp5Vebsl8U+VnyA9+i/WGsC9a8CXmB22jvBjNoQ79gXfatQjCOZRx58HosidVhEede9j41yQSr0joYvuKX0FwlCRTO8/roe1MYGTGygmU9QglfFHvlcxgUKmhe6OqKowrN70H8/+IeV9SGZBJftmYAAAAASUVORK5CYII=" />Free
                            Flow</span>
                        </h5>
                        <h5 style="cursor: pointer;" (click)="datesigndragenable('acccsigndrag')"
                          class="bn btn-primry addtextaclass">
                          <span tooltip="ACCC Signature" placement="right">
                            <img src="https://img.icons8.com/ios-filled/24/000000/autograph.png"  alt="" />ACCC Signature</span>
                        </h5>
                        <h5 style="cursor: pointer;" (click)="datesigndragenable('acccinitdrag')"
                          class="bn btn-primry addtextaclass">
                          <span tooltip="ACCC Initial" placement="right">
                            <img src="https://img.icons8.com/carbon-copy/100/000000/hand-with-pen.png"  alt="" />ACCC Initial</span>
                        </h5>
                          </div>
                          <h2 class="ecstructure" (click)="datesigndragenable('esignaturedrag')"><img src="./assets/images/designtool/sign/esignaturei.png" /> e Signature</h2>  
                          <h2 class="ecstructure" style="padding: 5px 30px 11px;" (click)="datesigndragenable('einitialdrag')"><img src="./assets/images/designtool/sign/investment.png" /> Initial</h2>  
                          <h2 class="ecstructure" style="padding: 5px 30px 11px;" (click)="datesigndragenable('estampdrag')"><img src="./assets/images/designtool/sign/stamp.png" /> Stamp</h2>  
                         <h2 class="ecstructure" style="padding: 5px 30px 11px;" (click)="datesigndragenable('datesigneddrag')"><img src="./assets/images/designtool/sign/calendar.png" /> Date Signed</h2>                
                          <h2 class="ecstructure" style="padding: 5px 30px 11px;"(click)="datesigndragenable('echeckbox')"><img style=" width: 24px;"  src="./assets/images/designtool/sign/checkbox.png" /> Check box</h2>  
                          <h2 class="ecstructure" style="padding: 5px 30px 11px;" (click)="datesigndragenable('everified')"><img style=" width: 24px;"  src="./assets/images/designtool/sign/verified.png" /> Radio check</h2>  
  
                        
                         
                        </div>
                        
                        <span class="menutoggle"></span>
                        </div>
              </li>
              <li class="">
                <div class="menu-box shape-area">
                    <div class="menu-items">
                        <h2>Shapes</h2>
                        <div class="detail-btn detailbtn1" style=" padding-top: 8px;">
                          <h5 id="rectangle" (mouseover)="imagechangeover('rectangle')"
                            (mouseout)="imagechangeoverout('rectangle')" (click)="datesigndragenable('rectangledrag')"
                            class="bn btn-primry addtextaclass">
                            <span placement="right">
                              <img [src]="rectsrc"  alt="" class="imageicon">Rectangle</span>
                          </h5>
                          <h5 id="circle" (mouseover)="imagechangeover('circle')"
                            (mouseout)="imagechangeoverout('circle')" (click)="datesigndragenable('circledrag')"
                            class="bn btn-primry addtextaclass">
                            <span placement="right"> <img [src]="circlesrc"  alt="" class="imageicon"> Circle</span>
                          </h5>
                          <h5 id="ellipse" (mouseover)="imagechangeover('ellipse')"
                            (mouseout)="imagechangeoverout('ellipse')" (click)="datesigndragenable('ellipsedrag')"
                            class="bn btn-primry addtextaclass">
                            <span placement="right"> <img [src]="ellipsesrc"  alt="" class="imageicon"> Ellipse</span>
                          </h5>
                          <h5 id="horzline" (mouseover)="imagechangeover('hline')"
                            (mouseout)="imagechangeoverout('hline')" (click)="datesigndragenable('hlinedrag')"
                            class="bn btn-primry addtextaclass">
                            <span placement="right"> <img [src]="hlinesrc"  alt="" class="imageicon"> Horizontal Line</span>
                          </h5>
                          <h5 id="vertline" (mouseover)="imagechangeover('vline')"
                            (mouseout)="imagechangeoverout('vline')" (click)="datesigndragenable('vlinedrag')"
                            class="bn btn-primry addtextaclass">
                            <span placement="right"> <img [src]="vlinesrc"  alt="" class="imageicon"> Vertical Line</span>
                          </h5>
                        </div>
                        <div class="tab-content pl30 pr30 m15 backgroundgrad">
                            <div class="wrapper center-block">
                                <div class="panel-group" id="accordion" role="tablist" aria-multiselectable="true" style="border: 1px solid transparent;">
                                    <div class="panel panel-default" style="border-radius: 4px;border: 1px solid transparent; background-color: #f5f5f5;">
                                        <div class="panel-heading" role="tab" id="headingOne">
                                            <label class="panel-title" style="color: #333;background-color: #f5f5f5;border-color: #ddd;width: -webkit-fill-available; margin-left:10px;margin-top: 5px;" data-toggle="collapse" data-parent="#accordion" href="#collapseThree" aria-expanded="true" aria-controls="collapseThree">
                                            <a role="button" data-toggle="collapse" data-parent="#accordion" href="#collapseThree" aria-expanded="true" aria-controls="collapseThree">
                                            Shapes Filters
                                            </a>
                                            </label>
                                        </div>
                                        <div id="collapseThree" class="panel-collapse collapse in" role="tabpanel" aria-labelledby="headingOne">
                                           <div class="panel-body">
                                                <div class="button-radius">
                                                    <label for="">Rotate:</label>&nbsp;&nbsp;
                                                    <span class="size charSpac">{{props.setrotate}}</span>
                                                </div>
                                                <div class="fonts-slider">
                                                    <input type="range" style="width: 260px;" class="slider" max="360" min="0" step="10" [(ngModel)]="props.setrotate" (change)="setrotate()">
                                                </div>
                                                <div class="button-radius">
                                                    <label for="">Transparency:</label>&nbsp;&nbsp;
                                                    <span class="size" *ngIf="objProps.get('opacity')=='NaN'">{{1*100}}%</span>
                                                     <span class="size" *ngIf="objProps.get('opacity')!='NaN'">{{objProps.get('opacity')*100}}%</span>
                                                </div>
                                                <div class="fonts-slider">
                                                    <input class="slider" style="width: 260px;" type="range" max="1" min="0" step="0.1" [ngModel]="objProps.get('opacity')" (ngModelChange)="objProps.set('opacity', $event)" (change)="setOpacity()">
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <span class="menutoggle"></span>
                </div>
            </li>
            <li class="">
                <div class="menu-box videos-area">
                    <div class="menu-items">
                        <div>
                          <h2>Video Stocks</h2>
                          <!-- <div class="menu-items" id="gfimage" style="max-height: 300px;margin-top: 10px;">
                            <ul class="template-list-items" id="videoslist" style="margin-bottom: 100px;"></ul>
                          </div> -->
                          <div class="tab-content pl30 pr30 m15" style="max-height: 300px; overflow-y:scroll;">
                              <div class="border-box row mt20" id="videoslist"></div>
                          </div>
                        </div>
                    </div>
                    <span class="menutoggle"></span>
                </div>
            </li>
                <li class="">
                  <div class="menu-box image-area">
                      <div class="menu-items">
                          <h2>Images</h2>
                          <div class="detail-btn detailbtn1" style=" padding-top: 8px;">
                            <a href="javascript:void(0);" (click)="datesigndragenable('imagevariabledrag')" (mouseover)="imagechangeover('image')"
                            (mouseout)="imagechangeoverout('image')" tooltip="Image Variable" placement="right"
                            class="list-group-item  text-center" style="border: none !important; width: 100%;
                            display: flex;">
                            <img [src]="imagesrc"  alt="" width="20" />
                            <span class="notes notes1" style="color:white !important;margin:13px 0px 0px 0px;">Add Image Variable</span>
                          </a>
                          </div>
                          <div class="button-style clearfix detail-btn mt-3" style="color: white;">
                             <div class="button-radius">
                                  <a href="javascript:void(0)" style="color: white;" (click)="triggerfileimage();">Upload New Image</a>
                                  <div class="hiddenfile">
                                      <input type="file" name="folderpathimg" id="folderpathimg" (change)="onImageFileChanged($event);" #fileInput multiple="multiple" >
                                  </div>
                              </div>
                          </div>
                          <div>
                            <h2>GF Library Stock Images</h2>
                              <!--<form class="form-inline searchForm">
                                  <input class="form-control mr-sm-2" type="search"  style="margin-left:20px;width:80%;" placeholder="Search" aria-label="Search" name="" id="gfquery" name="gfquery">
                                  <button class="btnSearch" type="submit" (click)="searchGFImg()"><i class="fa fa-search"></i></button>
                              </form>-->
                            <div class="menu-items" id="gfimage" style="max-height: 300px;margin-top: 10px;padding: 0px 20px;">
                              <ul class="template-list-items" id="gflibsection" ></ul>
                            </div>
                          </div>
                         <!--<div *ngIf="userName == 'guest'" align="center">
                          <a class="nav-link" style="color: white;">Login to remove watermarks</a>
                          </div>-->
                          <div class="button-style clearfix detail-btn mt-3" style="color: white;">
                              <div class="button-radius">
                                  <a href="javascript:void(0)" style="color: white;width:100%;text-align: left;" (click)="pixabayimg('photo');">Stock Photo Library</a>
                              </div>
                          </div>
                          <div class="button-style images_sec_zero clearfix detail-btn mt-3">
                            <h2 class="property" style="background: transparent;border: none !important; padding: 0px;">Image</h2>
                            <input class="form-control" style="border: none; width: 56% !important; position: relative;
                            left: 110px; bottom: 25px;" type="text" placeholder="Search...." aria-label="Search"
                            [(ngModel)]="searchValue" name="searchValue" autocomplete="off" (keyup)="getSearchBoxValue(searchValue)">
                          <div style=" padding-top: 8px;">
                            <ng-container >
                              <mat-accordion>
                                <mat-expansion-panel>
                                  <mat-expansion-panel-header [collapsedHeight]="customCollapsedHeight"
                                    [expandedHeight]="customExpandedHeight">
                                    <mat-panel-title>
                                      Logo Images
                                    </mat-panel-title>
              
                                  </mat-expansion-panel-header>
                                  <div class="nicescroll" >
                                    <div class="align-content-center logo-sec" style="text-align: center;">
                                      <div class="gallery" *ngFor="let item of logoList">
                                        <div>
                                          <a href="javascript:void(0);" (click)="datesigndragenable('logodrag');setactivelogo($event)" placement="bottom">
                                            <h3>
                                              <img class="images-item" alt="" [src]="api_url +item.file" />
                                            </h3>
                                          </a>
                                          <img [src]="api_url +item.file" alt="" class="tooltip-logo-image">
                                        </div>
                                      </div>
                                    </div>
                                  </div>
                                </mat-expansion-panel>
                                <mat-expansion-panel>
                                  <mat-expansion-panel-header [collapsedHeight]="customCollapsedHeight"
                                    [expandedHeight]="customExpandedHeight">
                                    <mat-panel-title>
                                      Signature
                                    </mat-panel-title>
              
                                  </mat-expansion-panel-header>
                                  <div class="nicescroll">
                                    <div class="align-content-center logo-sec" style="text-align: center;">
                                      <div class="gallery" *ngFor="let item of signatureimageList">
                                        <div>
                                          <a href="javascript:void(0);" (click)="datesigndragenable('logodrag');setactivelogo($event)" placement="bottom">
                                            <h3>
                                              <img class="images-item" alt="" [src]="api_url +item.file" />
                                            </h3>
                                          </a>
                                          <img class="tooltip-logo-image" alt="" [src]="api_url +item.file">
                                        </div>
                                      </div>
                                    </div>
                                  </div>
                                </mat-expansion-panel>
                                <mat-expansion-panel>
                                  <mat-expansion-panel-header [collapsedHeight]="customCollapsedHeight"
                                    [expandedHeight]="customExpandedHeight">
                                    <mat-panel-title>
                                      Other Images
                                    </mat-panel-title>
              
                                  </mat-expansion-panel-header>
                                  <div class="nicescroll">
                                    <div class="align-content-center logo-sec" style="text-align: center;">
                                      <div class="gallery" *ngFor="let item of otherimageList">
                                        <div>
                                          <a href="javascript:void(0);" (click)="datesigndragenable('logodrag');setactivelogo($event)" placement="bottom">
                                            <h3>
                                              <img class="images-item" alt="" [src]="api_url +item.file" />
                                            </h3>
                                          </a>
                                          <img class="tooltip-logo-image" alt="" [src]="api_url +item.file">
                                        </div>
                                      </div>
                                    </div>
                                  </div>
                                </mat-expansion-panel>
                                <div class="nicescroll" style="margin-top: 10px;">
                                  <div class="align-content-center logo-sec" style="text-align: center;">
                                    <div class="gallery" *ngFor="let item of serachImage">
                                      <div>
                                        <a href="javascript:void(0);" (click)="datesigndragenable('logodrag');setactivelogo($event)" placement="bottom">
                                          <h3>
                                            <img class="images-item" alt="" [src]="api_url +item.file" />
                                          </h3>
                                        </a>
                                        <img [src]="api_url +item.file" alt="" class="tooltip-logo-image">
                                      </div>
                                    </div>
                                  </div>
                                </div>
              
                              </mat-accordion>
                            </ng-container>
                          </div>
                          </div>
                          <div class="tab-content pl30 pr30 m15 backgroundgrad">
                              <div class="wrapper center-block">
                                  <div class="panel-group" id="accordion" role="tablist" aria-multiselectable="true" style="border: 1px solid transparent;">
                                      <div class="panel panel-default" style="border-radius: 4px;border: 1px solid transparent; background-color: #f5f5f5;">
                                          <div class="panel-heading" role="tab" id="headingOne">
                                              <label class="panel-title" style="color: #333;background-color: #f5f5f5;border-color: #ddd;width: -webkit-fill-available; margin-left:10px;margin-top: 5px;" data-toggle="collapse" data-parent="#accordion" href="#collapseTwo" aria-expanded="true" aria-controls="collapseTwo">
                                              <a role="button" data-toggle="collapse" data-parent="#accordion" href="#collapseTwo" aria-expanded="true" aria-controls="collapseTwo">
                                              Image Filters
                                              </a>
                                              </label>
                                          </div>
                                          <div id="collapseTwo" class="panel-collapse collapse in" role="tabpanel" aria-labelledby="headingOne">
                                              <div class="panel-body">
                                                  <div class="button-radius">
                                                      <label for="">Rotate:</label>&nbsp;&nbsp;
                                                      <span class="size charSpac">{{props.setrotate}}</span>
                                                  </div>
                                                  <div class="fonts-slider">
                                                      <input type="range" style="width: 260px;" class="slider" max="360" min="0" step="10" [(ngModel)]="props.setrotate" (change)="setrotate()">
                                                  </div>
                                                  <div class="button-radius">
                                                      <label for="">Hue:</label>&nbsp;&nbsp;
                                                      <span class="size lineHei">{{props.hue}}%</span>
                                                  </div>
                                                  <div class="fonts-slider">
                                                      <input class="slider" style="width: 260px;" type="range" max="100" min="0" step="5" [(ngModel)]="props.hue" (change)="setHue()">
                                                  </div>
                                                  <div class="button-radius">
                                                      <label for="">Saturation:</label>&nbsp;&nbsp;
                                                      <span class="size lineHei">{{props.saturation}}%</span>
                                                  </div>
                                                  <div class="fonts-slider">
                                                      <input class="slider" style="width: 260px;" type="range" max="100" min="0" step="5" [(ngModel)]="props.saturation" (change)="setSaturation()">
                                                  </div>
                                                  <div class="button-radius">
                                                      <label for="">Contrast:</label>&nbsp;&nbsp;
                                                      <span class="size lineHei">{{props.contrast}}%</span>
                                                  </div>
                                                  <div class="fonts-slider">
                                                      <input class="slider" style="width: 260px;" type="range" max="200" min="0" step="10" [(ngModel)]="props.contrast" (change)="setContrast()">
                                                  </div>
                                                  <div class="button-radius">
                                                      <label for="">Brightness:</label>&nbsp;&nbsp;
                                                      <span class="size lineHei">{{props.brightness}}%</span>
                                                  </div>
                                                  <div class="fonts-slider">
                                                      <input class="slider" style="width: 260px;" type="range" max="1" min="-1" step="0.003921" [(ngModel)]="props.brightness" (change)="setBrightness()">
                                                  </div>
                                                  <div class="button-radius">
                                                      <label for="">Opacity:</label>&nbsp;&nbsp;
                                                      <span class="size lineHei" *ngIf="objProps.get('opacity')=='NaN'">{{1*100}}%</span>
                                                     <span class="size lineHei" *ngIf="objProps.get('opacity')!='NaN'">{{objProps.get('opacity')*100}}%</span>
                                                </div>
                                                  <div class="fonts-slider">
                                                      <input class="slider" style="width: 260px;" type="range" max="1" min="0" step="0.1" [ngModel]="objProps.get('opacity')" (ngModelChange)="objProps.set('opacity', $event)" (change)="setOpacity()">
                                                  </div>
                                                  <div class="button-radius">
                                                      <label for="">Blur:</label>&nbsp;&nbsp;
                                                      <span class="size lineHei">{{props.blurimg}}%</span>
                                                  </div>
                                                  <div class="fonts-slider">
                                                      <input class="slider" style="width: 260px;" type="range"  value="0.1" min="0" max="1" step="0.01" [(ngModel)]="props.blurimg" (change)="setblurimg()">
                                                  </div>
                                                  <div class="button-radius">
                                                      <label for="">Sharpen:</label> &nbsp;&nbsp; 
                                                      <input type="checkbox" id="sharpen" (change)="sharpen()" [(ngModel)]="props.sharpen">
                                                  </div>
                                                  <div class="button-radius" style="overflow: auto;">
                                                      <ul class="filters">
                                                          <li><span style="background:none;"><img src="./assets/studioassets/images/property1.jpg" id="sepia" width="60" height="60" (click)="sepia();" /></span>Sepia
                                                          </li>
                                                          <li><span style="background:none;"><img src="./assets/studioassets/images/property2.jpg" id="blackwhite" width="60" height="60" (click)="blackwhite();" /></span>B/W
                                                          </li>
                                                          <li><span style="background:none;"><img src="./assets/studioassets/images/property3.jpg" id="polaroid" width="60" height="60" (click)="polaroid();" /></span>Polaroid
                                                          </li>
                                                          <li><span style="background:none;"><img src="./assets/studioassets/images/property1.jpg" id="vintage" width="60" height="60" (click)="vintage();" /></span>Vintage
                                                         </li>
                                                          <li><span style="background:none;"><img src="./assets/studioassets/images/property4.jpg" id="kodachrome" width="60" height="60" (click)="kodachrome();" /></span>Kodachrome</li>
                                                          <li><span style="background:none;"><img src="./assets/studioassets/images/property2.jpg" id="technicolor" width="60" height="60" (click)="technicolor();" /></span>Technicolor</li>
                                                      </ul>
                                                  </div>
                                                  <div class="button-radius" style="margin-left: 20px;">
                                                      <button type="button" class="btn btn-secondary" >Reset Image</button>
                                                  </div>
                                              </div>
                                          </div>
                                      </div>
                                  </div>
                              </div>
                          </div>
                          <!--
                          <div class="button-style clearfix detail-btn mt-1">
                              <div class="input-box mt-1 dateinput">
                                  <label style="color:white;">Select Images By Category :</label>
                                  <select [(ngModel)]="props.catg" id="imgcatg" name="imgcatg" (change)="getimgcatg()"></select>
                              </div>
                          </div>
                          <div class="tab-content pl30 pr30 m15">
                              <div class="border-box row mt20" id="imagelist">
                              </div>
                          </div>
                          <div class="tab-content pl30 pr30 m15">
                              <div class="border-box row mt20" id="imagesection">
                              </div>
                          </div>
                          -->
                      </div>
                      <span class="menutoggle"></span>
                  </div>
              </li>
              </ul>
          </div>
      </div>    
        
        <a href="javascript: void(0);" (click)="rightsidecomments()" *ngIf="!editable" style="bottom: calc(50% + 120px)"
class="db air__sidebar__toggleButton comments air__sidebar__actionToggle" tooltip="Comments" placement="right" container="body">
 <em class="db fe fe-message-circle text-gray" style="font-size:30px; margin: 7px 0px 0px -3px;"></em>
</a>
        <div class="db air__sidebarR air__sidebar kit__customScroll sidebarcontents" *ngIf="showrightsidecomments">
          <div class="db air__sidebar__inner">
            <a href="javascript: void(0);" (click)="rightsidecomments();showrightsidepanel=false"
                      class="db air__sidebar__close rightsideclose_comment air__sidebar__actionToggle">
                      <img class="db imgicons"  alt="" src="./assets/svg/close-icon.svg" style="width: 12px;" />
                    </a>
          <div class="db cui__utils__line" style="margin-top: 25px; margin-bottom: 30px"></div>
          <div class="db air__sidebar__type" style="border-top: 1px solid #4b525c;">
            <a href="javascript:void(0);" tooltip="Square" placement="right"
              class="db list-group-item  text-center" (mouseover)="imagechangeover('rectangle')"
              (mouseout)="imagechangeoverout('rectangle')">
            <img
            [src]="rectsrc"  alt="" width="25" /></a>
        </div>
        <div class="db air__sidebar__type">
          <a href="javascript:void(0);" tooltip="Ellipse" placement="right"
            class="db list-group-item  text-center" (mouseover)="imagechangeover('ellipse')"
            (mouseout)="imagechangeoverout('ellipse')">
          <img
          [src]="ellipsesrc"  alt="" width="25" /></a>
        </div>
        <div class="db air__sidebar__type">
          <a href="javascript:void(0);" tooltip="Circle" placement="right"
            class="db list-group-item  text-center" (mouseover)="imagechangeover('circle')"
            (mouseout)="imagechangeoverout('circle')">
          <img
          [src]="circlesrc"  alt="" width="25" /></a>
        </div>
        <div class="db air__sidebar__type">
          <a href="javascript:void(0);" tooltip="Horizontal" placement="right"
            class="db list-group-item  text-center disabled" (mouseover)="imagechangeover('hline')"
            (mouseout)="imagechangeoverout('hline')">
          <img
          [src]="hlinesrc"  alt="" width="25" /></a>
        </div>
        <div class="db air__sidebar__type">
          <a href="javascript:void(0);" tooltip="Vertical" placement="right"
            class="db list-group-item  text-center disabled" (mouseover)="imagechangeover('vline')"
            (mouseout)="imagechangeoverout('vline')">
          <img
          [src]="vlinesrc"  alt="" width="25" /></a> </div>  </div> </div> <style type="text/css">.air__sidebar__toggleButtonl{position:fixed;left:0!important;text-align:center;width:4.06rem;padding-right:1.33rem}.air__footer__inner{padding:.21rem 0}.air__sidebarl{width:4.5rem;position:fixed;height:100%;z-index:998!important;top:65px;left:0;bottom:0;background:#333;transform:translateX(0px);transition:all .2s ease-in-out} </style>
        <a *ngIf="editable" href="javascript: void(0);" style="bottom: calc(50% + 120px);z-index: 9;"
          class="db air__sidebar__toggleButton air__sidebar__actionToggle air__sidebar__toggleButtonl"
          (click)="leftsidepanel()" data-toggle="tooltip" data-placement="left" title="Builder Settings">
          <em class="db fe fe-droplet" style="font-size: 21px;color: #6eacaf;"></em>
        </a>
        <ul *ngIf="showcontextmenugp && editable" class="db contextmenu" [ngStyle]="myStyles">
          <a href="javascript:void(0);" (click)="opentoolkitpopup(toolkitcreate);showcontextmenugp=false;">Sava as
            toolkit</a>
        </ul>
        <ul *ngIf="showcontextmenu" class="db contextmenu" [ngStyle]="myStyles">
          <a href="javascript:void(0);" *ngIf="selectedProperty.objtype=='imgvar'"
            (click)="showeditcontextmenu(imgvar);showcontextmenu=false;">
            Edit value
          </a>
          <a href="javascript:void(0);" *ngIf="selectedProperty.objtype=='barcode'"
            (click)="showeditbarcodemenu(barcodes);showcontextmenu=false;">
            Edit value
          </a>
          <a href="javascript:void(0);" (click)="btnCloneClick();showcontextmenu=false;">
            Paste
          </a>
          <a href="javascript:void(0);" (click)="btnSelObjDel();showcontextmenu=false;">
            Delete
          </a>
        </ul>
      <pdf-viewer [src]="pdfurls" id="pdfview" style="position: absolute;visibility: hidden;height: 0px;" 
        [original-size]="false" [zoom]="zoomsize" [show-all]="true"
     ></pdf-viewer>
        <div style="position: absolute;width: 500px !important;height: 500px !important;opacity: 0;"> 
        <canvas id="charts" width="500" height="500" style="position: absolute;width: 500px !important;height: 500px !important;"></canvas>
        </div>
        <div [ngStyle]="bgstyle" class="db air__layout__content">

          <div class="db air__utils__content structuredocsec" style="padding:10px 0px;">
            <div class="db container">
              <div class="db row" style="justify-content: center;">
                <div class="db " style="margin: 0px auto;">
                  <div class="db csPagesThumb1" [ngClass]="!editable ? 'showdiv' : 'hidediv'">
                    <div fxLayout="column" id="dvIndThumb">
                    </div>
                    </div>
                  <div [ngClass]="editable ? 'showdiv' : 'hidediv'" class="db card-body indPage" fxLayout="column" id="dvIndPage" (drop)="onDrop($event)">
                    <span class="activehover tooltip">{{hoveredtext}}</span>
                    <span class="db topline showlines"></span>
                    <span class="db rightline showlines"></span>
                    <span class="db botline showlines"></span>
                    <span class="db leftline showlines"></span>
                    <div *ngIf="showcontentupdatepopup && selectedObj" class="container popupbg commentpopup" [style.top.px]="selectedObj.top" [style.left.px]="selectedObj.left+selectedObj.width">
                      <div class="modal-header mheader">
                <span class="col-sm-9 text-left" style="color: white !important;">{{selectedObj.objtype}}_{{selectedObj.id}}</span>
                      </div>
                      <div class="popup" style="padding: 10px; background: #ffffff;    border: 1px solid #e5e2e2;
                      border-top: 0px;">
                        <div class="content" style="width: 100%;">
                          <div class="form-wrapper">
                            <div class="form-group">
                              <input type="text" class="form-control" #commentstxt [value]="selectedObj.text" placeholder="Type comments here..." style="width: 100%;">
                         </div>
                            <div class="form-group" class="mt-20">
                              <button type="button" [disabled]="commentstxt.value==''" (click)="saveval(commentstxt.value)" class="save_btn btn btn-rounded btn-primary mr-2" style="background-color: #6EACAF !important; border-color: #6EACAF; margin-right: 10px;padding: 7px 26px;"
                                >Update</button>
                              <button type="button" class="cancel_btn btn btn-rounded btn-secondary mr-2" style="background-color: transparent !important; border-color:transparent !important;color:black !important" (click)="showcontentupdatepopup=false">Cancel</button>
                            </div>
                          </div>
                        </div>
                      </div>
                  
                    </div>
                    <button *ngIf="headertrue==true" class="db btn happlybtn" (click)="hideheader()" [style.top.px]="activehfheight">Apply</button>
                    <button *ngIf="footertrue==true" class="db btn happlybtn" (click)="hidefooter()" style="bottom: 20px;">Apply</button>
                    <div *ngFor="let ldata of layers;let i=index">
                      <video *ngIf="ldata.video_src!='' && ldata.video_src!=undefined" controls="true" class="strvideo" [style.top.px]="ldata.top+12" [style.left.px]="ldata.left+12" [style.width.px]="ldata.width-10" [style.height.px]="ldata.height-10" id="{{ldata.id}}" >
                        <source src='{{ldata.video_src}}' type="video/mp4"></video>                     </div>
                    <div *ngFor="let data of comments;let i=index">
                     <span class="db numbers" *ngIf="commentdisplaystatus" [style.top.px]="data.top" [style.left.px]="data.left" [style.background]="data.usercolor">{{i+1}}</span>
                    </div>
                  </div>
                  
                </div>

              </div>
            </div>

          </div>
        </div>



        <div class="db air__layout__footer">
          <div class="db air__footer">
            <div class="db air__footer__inner">
              <div class="db row">
                <div class="db col-md-12">

                  <p>
                   
                     <span id="year">{{getFullYear()}}</span> SolvEdge Inc. | All Rights Reserved
                  </p>
                </div>

              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
  <button type="button" style="display: none;" id="openepopup" class="btn btn-info btn-lg" data-toggle="modal" data-target="#myModal">Open Modal</button>
 <button type="button" style="display: none;" id="openstamppopup" class="btn btn-info btn-lg" data-toggle="modal" data-target="#myModal1">Open Modal</button>
 <div class="modal fade" id="myModal1" role="dialog">
  <div class="modal-dialog">
    <div class="modal-content">
  <div class="container popupbg">
    <div class="modal-header">
      <h5 class="heading-3">Stamp</h5>
    </div>
    <div class="popup" style="padding: 20px;">
      <div class="content" style="display: block;width: 100%;">
        <div class="tab">
          <button class="tablinks1 active" (click)="openCity1($event, 'choosestamp')">Choose</button>
         <button class="tablinks1" (click)="openCity1($event, 'uploadstamp')">Upload</button>
        <button class="tablinks1" (click)="openCity1($event, 'createstamp')">Create</button>
        </div>
       <div id="choosestamp" class="tabcontent1" style="display: block;">
        <h3 style="font-size: 12px;">Select stamp format</h3>
        <div class="form-group">
          <div class="row">
            <div class="col-md-6"><input type="radio" required style="margin-right: 10px;" [(ngModel)]="stampdformat" name="stampformat"
                value="Name"><label class="form-label">Name</label></div>
            <div class="col-md-6"><input type="radio" required style="margin-right: 10px;" [(ngModel)]="stampdformat" name="stampformat"
                value="Name + Date" ><label class="form-label">Name + Date</label></div>
          </div>
        </div>
        <h3 style="font-size: 12px;">Enter your name (maximum 25 characters)</h3>
        <div class="form-group">
          <div class="row">
            <div class="col-md-12"><input type="text" maxlength="25" class="form-control" required style="width:100%;" [(ngModel)]="stampdefname" 
              ></div>
          </div>
          </div>
          <div *ngIf="stampdefname!=''" #output>
            <svg width="132" height="132">
              <circle cx="66" cy="66" r="65" fill="none" stroke="#001A62" stroke-width="2" />
              <circle cx="66" cy="66" r="65" fill="none" stroke="rgb(0,26,98,0.4)" stroke-width="2" />
              <circle cx="66" cy="66" r="48" fill="none" stroke="#001A62" stroke-width="1" />
              <circle cx="66" cy="66" r="46" fill="none" stroke="#001A62" stroke-width="1" />
              <defs>
                <path id="text-path" d="M66 126A60 60 0 1 0 66 6a60 60 0 0 0 0 120" fill="none"/>
              </defs>
              <text dominant-baseline="middle" text-anchor="middle" x="50%" y="51%" font-family="Manrope3-ExtraBold, Manrope3" font-size="75" font-weight="600" fill="none" stroke="#001A62" stroke-width="2" ></text>
              <text>
                <textPath xlink:href="#text-path" font-family="Manrope3-ExtraBold, Manrope3" font-size="20" font-weight="600" fill="#001A62" letter-spacing="7">{{stampdefname}}</textPath>
            </text>
            </svg></div>
         <div class="form-group" class="mt-20">
        <button type="button" class="btn save_btn" type="submit"
            style="margin-right: 10px;" [disabled]="stampdefname=='' && stampdformat==''" (click)="adddefaultstampimg()">Add</button>
         <button type="button" class="btn cancel_btn" style="margin-right: 10px;"(click)="stampdefname='';stampdformat=''" data-dismiss="modal">Cancel</button>
        </div>
        </div>
        <div id="uploadstamp" class="tabcontent1" >
          <h3 style="font-size: 12px;">Upload image</h3>
          <input type="file" accept="image/*" [(ngModel)]="stampimg" (change)="uploadtsamp($event)" style="color: black;width: 100%;overflow: hidden;">
       <span class="mb-3" style="    display: block;
       font-size: 10px;
       color: #c9656a;
       margin-top: 5px;">Accept format png,jpg,jpeg</span>
          <h3 style="font-size: 12px;">Preview</h3>
          <div class="spreviewdiv">
<img src="{{stampimgpreview}}" *ngIf="stampimgpreview!=''" style="height: 98px;">
          </div>
          <div class="form-group" class="mt-20">
            <button type="button" class="btn save_btn" type="submit"
            style="margin-right: 10px;" [disabled]="stampimgpreview==''" (click)="updatestampimg()">Add</button>
          <button type="button" class="btn cancel_btn" id="closestamppopup" style="margin-right: 10px;"(click)="stampimgpreview=''" data-dismiss="modal">Cancel</button>
        </div>
        </div>
        <div id="createstamp" class="tabcontent1" >
          <h3 style="font-size: 12px;">Text direction</h3>
          <div class="form-group">
            <div class="row">
              <div class="col-md-6"><input type="radio" required style="margin-right: 10px;" [(ngModel)]="textdirection" name="textdirection"
                  value="Vertical"><label class="form-label">Vertical</label></div>
              <div class="col-md-6"><input type="radio" required style="margin-right: 10px;" [(ngModel)]="textdirection" name="textdirection"
                  value="Horizontal" ><label class="form-label">Horizontal</label></div>
            </div>
          </div>
          <h3 style="font-size: 12px;">Name (64 + 20 characters max)</h3>
          <div class="form-group">
            <div class="row">
              <div class="col-md-8"><input type="text" maxlength="64" class="form-control" required style="width:100%;" [(ngModel)]="sfname" name="sfname"
                ></div>
              <div class="col-md-4"><input type="text" maxlength="20" class="form-control" required style="width:100%;" [(ngModel)]="sfinitial" name="sfinitial"
                  ></div>
            </div>
          <div class="stampcpreview" *ngIf="sfname!=''" >
           <span #stamplogo1 class="isonee" (click)="getactivestamp('stamplogo1','isonee')"> 
             <svg [ngStyle]="{'writing-mode': textdirection=='Vertical' ? 'tb-rl' : 'horizontal-tb' }" width="132" height="132">
              <circle cx="66" cy="66" r="65" fill="none" stroke="#001A62" stroke-width="2" />
              <circle cx="66" cy="66" r="65" fill="none" stroke="rgb(0,26,98,0.4)" stroke-width="2" />
              <circle cx="66" cy="66" r="48" fill="none" stroke="#001A62" stroke-width="1" />
              <circle cx="66" cy="66" r="46" fill="none" stroke="#001A62" stroke-width="1" />
              <defs>
                <path id="text-path" d="M66 126A60 60 0 1 0 66 6a60 60 0 0 0 0 120" fill="none"/>
              </defs>
              <text dominant-baseline="middle" text-anchor="middle" x="50%" y="51%" font-family="Manrope3-ExtraBold, Manrope3" font-size="75" font-weight="600" fill="none" stroke="#001A62" stroke-width="2" >{{sfinitial}}</text>
              <text>
                <textPath xlink:href="#text-path" font-family="Manrope3-ExtraBold, Manrope3" font-size="20" font-weight="600" fill="#001A62" letter-spacing="7">{{sfname}}</textPath>
            </text>
            </svg>
          </span>
         <!--<svg width="400" height="200" viewBox="0 0 400 200">
              <defs>
                
                <symbol id="stamp2">
                  <rect x="10" y="10" width="370" height="80" fill="none" stroke="black" stroke-width="10" />
                  <text x="30" y="70" font-family="Impact" font-size="3em" font-weight="bold">
                    {{sfname}} {{sfinitial}}
                  </text>
                </symbol>
                
                <pattern id="a" width="31" height="41" patternTransform="rotate(20)" patternUnits="userSpaceOnUse" >
                  <ellipse cx="11" cy="7" rx="1" ry="9" />
                  <ellipse cx="23" cy="27" rx="3" ry="5" />
                  <ellipse cx="1" cy="6" rx="2" ry="8" />
                  <path d="m2 3 l 3 5 17 19 23 1 49 9  M1 31l -20 -30 M 10 10 l -5 9 30 -24 " fill="none" stroke="black" />
                  
                </pattern>
                
                <pattern id="b" width="43" height="53"  patternTransform="rotate(-17)" patternUnits="userSpaceOnUse" >
                  <rect x="11" y="7" width="25" height="39" fill="white" />
                  <ellipse cx="13" cy="37" rx="2" ry="7" />
                  <ellipse cx="22" cy="43" rx="4" ry="1" />
                </pattern>
                
                <pattern id="c" width="29" height="29" patternTransform="rotate(61)" patternUnits="userSpaceOnUse" >
                  <path d="m2 3 l 3 5 17 19 23 1 49 9  M1 31l -20 -30 M 10 10 l -5 9 30 -24 " fill="none" stroke="white" stroke-width="3" />
                  <rect x="0" y="0" width="1" height="2" />
                  <ellipse cx="15" cy="19" rx="2" ry="1" />
                  <ellipse cx="7" cy="13" rx="2" ry="1" />
                  <ellipse cx="22" cy="6" rx="1" ry="3" />
                </pattern>
               
                <symbol id="example">
                  <rect width="100" height="100" fill="url(#a)" />
                  <rect x="100" width="100" height="100" fill="url(#b)" />
                  <rect x="200" width="100" height="100" fill="url(#c)" />
                  <rect x="300" width="100" height="100" fill="url(#d)" />
                </symbol>
                
                <symbol id="maskimage">
                  <rect width="400" height="100" fill="white" />
                  <rect width="400" height="100" fill="url(#a)" />
                  <rect width="400" height="100" fill="url(#b)" />
                  <rect width="400" height="100" fill="url(#c)" />
                  <rect width="400" height="100" fill="url(#d)" />
                </symbol>
                
                <mask id="maskmask">
                  <use width="400" height="100" xlink:href="#maskimage" />
                </mask>
              </defs>
              
              <use xlink:href="#stamp2"/>
              <use y="100" xlink:href="#stamp2" mask="url(#maskmask)" />
            </svg>-->
            <span #stamplogo2 (click)="getactivestamp('stamplogo2','isone')" [ngClass]="textdirection=='Vertical'?'valigndiv stamp isone':'stamp isone'" >{{sfname}} {{sfinitial}}</span>
              <span #stamplogo3 [ngClass]="textdirection=='Vertical'?'valigndiv stamp is_nope':'stamp is_nope'" (click)="getactivestamp('stamplogo3','is_nope')">{{sfname}} {{sfinitial}}</span>
              <span #stamplogo4 [ngClass]="textdirection=='Vertical'?'valigndiv stamp is_approved':'stamp is_approved'" (click)="getactivestamp('stamplogo4','is_approved')">{{sfname}} {{sfinitial}}</span>
           <span #stamplogo5 [ngClass]="textdirection=='Vertical'?'valigndiv stamp is_draft':'stamp is_draft'" (click)="getactivestamp('stamplogo5','is_draft')">{{sfname}} {{sfinitial}}</span>
            </div>
            <div class="form-group" class="mt-2">
              <button type="button" class="btn save_btn" type="submit"
              style="margin-right: 10px;" [disabled]="sfname=='' && activecstamp==''" (click)="createstamp()">Add</button>
            <button type="button" class="btn cancel_btn" style="margin-right: 10px;"(click)="sfname='';sfinitial=''" data-dismiss="modal">Cancel</button>
          </div>
          </div>
          </div>

        </div>
        </div>
    </div>
    </div>
  </div>
</div>
  <div class="modal fade" id="myModal" role="dialog">
    <div class="modal-dialog">
    
      <!-- Modal content-->
      <div class="modal-content">
    <div class="container popupbg">
      <div class="modal-header">
        <h5 class="heading-3">e Signature</h5>
      </div>
      <div class="popup" style="padding: 20px;">
        <div class="content" style="display: block;width: 100%;">
          <div class="tab">
            <button class="tablinks active" (click)="openCity($event, 'drawsign1')">Draw</button>
           <button class="tablinks" (click)="openCity($event, 'uploadsign')">Upload</button>
           <button class="tablinks" (click)="openCity($event, 'selectstyle')">Select Style</button>
          </div>
          
          <div id="drawsign1" class="tabcontent" style="display: block;">
            <h3 style="font-size: 12px;">Draw your signature</h3>
            <signature-pad [options]="signaturePadOptions" (onBeginEvent)="drawStart()" (onEndEvent)="drawComplete()"></signature-pad>
            <div class="form-group" class="mt-20">
              <button type="button" class="btn save_btn" type="submit"
                style="margin-right: 10px;" (click)="updatedrawesign()">Create</button>
              <button type="button" class="btn cancel_btn" id="closeep" style="margin-right: 10px;" data-dismiss="modal">Cancel</button>
              <button type="button" class="btn cancel_btn" (click)="signaturePad.clear();">Clear</button>
           </div>
          </div>
          
          <div id="uploadsign" class="tabcontent">
            <h3 style="font-size: 12px;">Upload your signature</h3>
            <input type="file" accept="image/*" [(ngModel)]="esignupimg" (change)="uploadesignature($event)" style="color: black;width: 100%;overflow: hidden;">
         <span class="mb-3" style="    display: block;
         font-size: 10px;
         color: #c9656a;
         margin-top: 5px;">Accept format png,jpg,jpeg</span>
            <h3 style="font-size: 12px;">Preview</h3>
            <div class="spreviewdiv">
<img src="{{epreviewsign}}" *ngIf="epreviewsign!=''" style="height: 98px;">
            </div>
            <div class="form-group" class="mt-20">
              <button type="button" class="btn save_btn" type="submit"
              style="margin-right: 10px;" [disabled]="epreviewsign==''" (click)="updateesignimg()">Add</button>
            <button type="button" class="btn cancel_btn" style="margin-right: 10px;"(click)="epreviewsign=''" data-dismiss="modal">Cancel</button>
          </div>
        </div>
        <div id="selectstyle" class="tabcontent">
          <h3 style="font-size: 12px;">Confirm your name, initials and signature</h3>
         <div class="row">
<div class="col-md-8">
  <div class="form-group">
    <label class="form-label">First Name</label>
    <input type="text" name="fname" style="width: 100%;" class="form-control" #fname [(ngModel)]="fname.value">
  </div>
</div>
<div class="col-md-4">
  <div class="form-group">
    <label class="form-label">Initials</label>
    <input type="text" name="initials" style="width: 100%;" class="form-control" #initials [(ngModel)]="initials.value">
  </div>
</div>
         </div>
         <h3 style="font-size: 12px;">Preview</h3>
         <a style="    color: blue;
         font-size: 12px;
         position: absolute;
         right: 32px;
         margin-top: -23px;" (click)="esignfontlist(fname.value,initials.value)">Change</a>
       <div class="spreviewdiv" style=" display: flex;align-items: center;">
           <p style="font-family: 'Mr Bedfort', cursive;
           font-size: 50px;
           margin: 0px 20px;
           color: black;">{{fname.value}}  </p>
                <p style="font-family: 'Mr Bedfort', cursive;
                font-size: 50px;
                margin: 0px 20px;
                color: black;">{{initials.value}}</p>
         </div>
         <div class="spreviewdiv1" style="display:none;">
    <div class="row" (click)="selectesignstyle('Mr Bedfort')">
      <p style="font-family: 'Mr Bedfort', cursive;font-size: 20px;color: black;">{{fname.value}}</p>
     <p style="font-family: 'Mr Bedfort', cursive;font-size: 20px;color: black;">{{initials.value}}</p>
    </div>
    <div class="row" (click)="selectesignstyle('Vibur')">
      <p style="font-family: 'Vibur', cursive;font-size: 20px;color: black;">{{fname.value}}</p>
     <p style="font-family: 'Vibur', cursive;font-size: 20px;color: black;">{{initials.value}}</p>
    </div>
    <div class="row" (click)="selectesignstyle('Stalemate')">
      <p style="font-family: 'Stalemate', cursive;font-size: 20px; color: black;">{{fname.value}}</p>
     <p style="font-family: 'Stalemate', cursive;font-size: 20px;color: black;">{{initials.value}}</p>
    </div>
    <div class="row" (click)="selectesignstyle('Dr Sugiyama')">
      <p style="font-family: 'Dr Sugiyama', cursive;font-size: 20px; color: black;">{{fname.value}}</p>
     <p style="font-family: 'Dr Sugiyama', cursive;font-size: 20px;color: black;">{{initials.value}}</p>
    </div>
    <div class="row" (click)="selectesignstyle('Homemade Apple')">
      <p style="font-family: 'Homemade Apple', cursive;font-size: 20px; color: black;">{{fname.value}}</p>
     <p style="font-family: 'Homemade Apple', cursive;font-size: 20px;color: black;">{{initials.value}}</p>
    </div>
    <div class="row" (click)="selectesignstyle('Mr Dafoe')">
      <p style="font-family: 'Mr Dafoe', cursive;font-size: 20px;color: black;">{{fname.value}}</p>
     <p style="font-family: 'Mr Dafoe', cursive;font-size: 20px;color: black;">{{initials.value}}</p>
    </div>
    <div class="row" (click)="selectesignstyle('Just Another Hand')">
      <p style="font-family: 'Just Another Hand', cursive;font-size: 20px;color: black;">{{fname.value}}</p>
     <p style="font-family: 'Just Another Hand', cursive;font-size: 20px;color: black;">{{initials.value}}</p>
    </div>
    <div class="row" (click)="selectesignstyle('Just Another Hand')">
      <p style="font-family: 'Just Another Hand', cursive;font-size: 20px;color: black;">{{fname.value}}</p>
     <p style="font-family: 'Just Another Hand', cursive;font-size: 20px;color: black;">{{initials.value}}</p>
    </div>
    <div class="row" (click)="selectesignstyle('Gochi Hand')">
      <p style="font-family: 'Gochi Hand', cursive;font-size: 20px;color: black;">{{fname.value}}</p>
     <p style="font-family: 'Gochi Hand', cursive;font-size: 20px;color: black;">{{initials.value}}</p>
    </div>
        </div>
         <div class="form-group" class="mt-20">
          <button type="button" class="btn save_btn" type="submit"
          style="margin-right: 10px;" (click)="addesignstyle()" [disabled]="initials.value=='' && fname.value==''" >Add</button>
        <button type="button" class="btn cancel_btn" style="margin-right: 10px;" data-dismiss="modal">Cancel</button>
      </div>
      </div>
          </div>
          </div>
          </div>
        </div>
        </div>
      </div>
  <ng-template #esignconfig>
    <div class="container popupbg">
      <div class="modal-header">
        <h5 class="heading-3">e Signature</h5>
      </div>
      <div class="popup" style="padding: 20px;">
        <div class="content">
          <form #esigninfo="ngForm" (ngSubmit)="createesigninfo00(esigninfo.value,esigninfo)"
            style="width: 100%;">
            <div class="form-wrapper toolkitsec" style="width: 100%;">
              <div class="form-group">
                <div class="row">
                  <div class="col-md-6"><input type="radio" required name="signertype" [(ngModel)]="signertype"
                      value="I am only the Signer" (click)="firstname='';lastname='';email=''"><label class="form-label">I am only the Signer</label></div>
                  <div class="col-md-6"><input type="radio" required name="signertype" [(ngModel)]="signertype"
                      value="Add Signers" ><label class="form-label">Add Signers</label></div>
                </div>
              </div>
              <div [style.display]="signertype=='Add Signers'?'block':'none'">
              <div class="form-group">
                <label class="form-label">First Name</label>
                <input type="text" name="firstname" class="form-control" [(ngModel)]="firstname">
              </div>
              <div class="form-group">
                <label class="form-label">Last Name</label>
                <input type="text" name="lastname" class="form-control" [(ngModel)]="lastname">
              </div>
              <div class="form-group">
                <label class="form-label">Email</label>
                <input type="text" name="email" class="form-control" [(ngModel)]="email">
              </div>
            </div>
              <div class="form-group" class="mt-20">
                <button type="button" class="btn save_btn" [disabled]="esigninfo.invalid" type="submit"
                  style="margin-right: 10px;" >Add</button>
                <button type="button" class="btn cancel_btn" (click)="closeepopup();firstname='';lastname='';email='';signertype=''">Cancel</button>
             </div>
            </div>
          </form>
        </div>
      </div>

    </div>
  </ng-template>
  <ng-template #toolkitcreate>
    <div class="db container popupbg">
      <div class="db modal-header">
        <h5 class="db heading-3">Toolkit</h5>
      </div>
      <div class="db popup" style="padding: 20px;">
        <div class="db content">
          <form #createtoolkit="ngForm" (ngSubmit)="createtoolkits(createtoolkit.value,createtoolkit)"
            style="width: 100%;">
            <div class="db form-wrapper toolkitsec" style="width: 100%;">
              <div class="db form-group">
                <div class="db row">
                  <div class="db col-md-6"><input type="radio" required name="toolkittype" [(ngModel)]="toolkittype"
                      value="1"><label class="db form-label">General</label></div>
                  <div class="db col-md-6"><input type="radio" required name="toolkittype" [(ngModel)]="toolkittype"
                      value="2"><label class="db form-label">Personal</label></div>
                </div>
              </div>
              <div class="db form-group">
                <label class="db form-label">Toolkit Name</label>
                <input type="text" name="toolkitname" required class="db form-control" [(ngModel)]="toolkitname">
              </div>
              <div class="db form-group">
                <label class="db form-label">Description</label>
                <textarea name="toolkitdescription" required class="db form-control"
                  [(ngModel)]="toolkitdescription"></textarea>
              </div>
              <div class="db form-group" class="db mt-20">
                <button type="button" class="db btn save_btn" [disabled]="createtoolkit.invalid" type="submit"
                  style="margin-right: 10px;">Done</button>
                <button type="button" class="db btn cancel_btn" (click)="closexml()">Cancel</button>
             </div>
            </div>
          </form>
        </div>
      </div>

    </div>
  </ng-template>
  <div *ngIf="showhfsection" class="db container popupbg" style="position: absolute;
  width: 400px;top: 100px;right: 100px;z-index: 9999;">
      <div class="db modal-header">
        <h5 class="db heading-3">Page Overflow Properties</h5>
      </div>
      <div class="db popup" style="padding: 20px;box-shadow: 0px 0px 2px #bdbcbc;">
        <div class="db content">
          <div class="db form-wrapper" style="width: 100%;">
            <div class="db form-group" style="display: flex;
            width: 100%;
            align-items: center;">
              <input type="checkbox" #headerval value="1" [disabled]="!headertrue" class="db form-control">
              <label class="db form-label" style="margin: 0px;">Show header in all pages</label>
             <button class="db hfediticon" (click)="addheader('header')"><i class="db fa fa-pencil" aria-hidden="true"></i></button>
            </div>
            <div class="db form-group" style="display: flex;
            width: 100%;
            align-items: center;">
              <input type="checkbox" #footerval value="1" [disabled]="!footertrue" class="db form-control">
              <label class="db form-label" style="margin: 0px;">Show footer in all pages</label>
              <button class="db hfediticon" (click)="addheader('footer')"><i class="db fa fa-pencil" aria-hidden="true"></i></button>
            </div>
            <div class="db form-group" class="db mt-20">
              <button type="button" class="db btn save_btn" (click)="saveheaderconfig(headerval.checked,footerval.checked)"
                style="margin-right: 10px;">Done</button>
              <button type="button" class="db btn cancel_btn" (click)="closehfpopup()">Cancel</button>
            </div>
          </div>
        </div>
      </div>

    </div>
    <div [style.display]="showmarginoption?'block':'none'" class="db container popupbg" style="position: fixed;width: 300px;top:100px;right: 100px;z-index: 9999;">
    <div class="db modal-header">
          <h5 class="db heading-3">Page Margin setup</h5>
        </div>
        <div class="db popup" style="padding: 20px;box-shadow: 0px 0px 2px #bdbcbc;">
          <div class="db content" style="width: 100%;">
            <div class="db form-wrapper marginoptions" style="width: 100%;display: flex;flex-wrap: wrap;">
              <div class="db form-group" style="display: flex; width: 50%;align-items: center;">
                <label class="db form-label" style="margin: 0px;">Left</label>
                <input type="number" #marginleft value="0" [(ngModel)]="mcleft" class="db form-control">
              </div>
              <div class="db form-group" style="display: flex; width: 50%;align-items: center;">
                <label class="db form-label" style="margin: 0px;">Right</label>
                <input type="number" #marginright value="0" [(ngModel)]="mcright" class="db form-control">
              </div>
              <div class="db form-group" style="display: flex; width: 50%;align-items: center;">
                <label class="db form-label" style="margin: 0px;">Top</label>
                <input type="number" #margintop value="0" [(ngModel)]="mctop" class="db form-control">
              </div>
              <div class="db form-group" style="display: flex; width: 50%;align-items: center;">
                <label class="db form-label" style="margin: 0px;">Bottom</label>
                <input type="number" #marginbottom value="0" [(ngModel)]="mcbottom" class="db form-control">
              </div>
              <div class="db form-group" style="display: flex; width: 100%;align-items: center;">
                <input type="checkbox" #marginconfig [(ngModel)]="mcsetting" class="db form-control" style="width: auto;margin-right: 5px;">
              <label class="db form-label" style="margin: 0px;width: auto;">Show/Hide Margin</label>
              </div>
              <div class="db form-group" class="db mt-20" style="width: 100%;">
                <button type="button" class="db btn save_btn" (click)="savemarginconfig(marginleft.value,marginright.value,margintop.value,marginbottom.value,marginconfig.checked)"
                  style="margin-right: 10px;">Done</button>
                <button type="button" class="db btn cancel_btn" (click)="resetmargin()">Reset</button>
              </div>
            </div>
          </div>
        </div>
  
      </div>
  <ng-template #imgvar>
    <div class="db container popupbg">
      <div class="db modal-header">
        <h5 class="db heading-3">Image Variable</h5>
      </div>
      <div class="db popup" style="padding: 20px;">
        <div class="db content">
          <div class="db form-wrapper">
            <div class="db form-group">
              <label class="db form-label">Id</label> {{selectedProperty.cacheKey}}_{{selectedProperty.id}}
            </div>
            <div class="db form-group">
              <label for="imgvarval" class="db form-label">Value</label>
              <input type="text" id="imgvarval" [(ngModel)]="selectedProperty.imgvarvalue" class="db form-control">
              <span style="color: red;display: block;" *ngIf="showerror">* Field is mandatory!</span>
            </div>
            <div class="db form-group" class="db mt-20">
              <button type="button" class="db btn save_btn" (click)="saveimagevar_value()"
                style="margin-right: 10px;">Done</button>
              <button type="button" class="db btn cancel_btn" (click)="closepopup()">Cancel</button>
            </div>
          </div>
        </div>
      </div>

    </div>
  </ng-template>
  <ng-template #edisignaturepopuptwo>
    <div class="db openModal popupbg" role="document">
      <div class="db modal-header">
        <h5 class="db heading-3">Edit Signature</h5>
      </div>
      <div class="db modal-content">
        <div class="db signature_form">
          <div class="db form-group">
            <label>Signature Name <span class="db required">*</span></label>
            <input value="" class="db form-control" id="signature_name1" [(ngModel)]="selectedProperty.signature_name">
          </div>
          <div class="db form-group">
            <label>Id <span class="db required">*</span></label>
            <input value="" class="db form-control" id="signature_id1" [(ngModel)]="selectedProperty.signature_id">
          </div>
          <table>
            <tr>
              <th>S.No</th>
              <th>Type</th>
              <th>Source</th>
            </tr>
            <ng-container *ngFor="let data of currelatedobj;index as i">
              <ng-container *ngIf="data.type=='textbox'">
                <tr>
                  <td>{{i+1}}</td>
                  <td>{{data.objtype}}</td>
                  <td>&lt;stext name="Text variable" text="{{data.text}}" id="{{data.objtype}}_{{data.id}}" maxchar="99"
                    value="{{data.text}}" isConstant="false" isvariable="true" lx="{{data.left}}" ly="{{data.top}}"
                    ux="" uy="" hasFilter="false"
                    style="font-family:{{data.fontFamily}};fill:{{data.fill}};font-size:{{data.fontSize}};font-style:{{data.fontStyle}};font-weight:{{data.fontWeight}};text-anchor:start;text-decoration:{{data.underline}};"
                    overflow="0" validate="none" format="" deviceid="{{data.objtype}}" isLocked="{{data.lockMovementX}}"
                    rotation="{{data.angle}}" rx="" ry="" /&gt;</td>
                </tr>
              </ng-container>
            </ng-container>
          </table>
          <div class="db form-group" style=" margin-top: 10px;">
            <button type="button" class="db btn save_btn" (click)="savesignaturelistedit()"
              style="margin-right: 10px;">Done</button>
            <button type="button" class="db btn cancel_btn" (click)="closesignaturepopup()">Cancel</button>
          </div>
        </div>
      </div>
    </div>
  </ng-template>
  <ng-template #cancel>
    <div class="db container popupbg">
      <div class="db modal-header"> </div>
      <div class="db popup" style="padding: 20px;">
        <div class="db content">
          <div class="db form-wrapper">
            <div class="db form-group">
              <label class="db form-label">Do you want to save the page </label>
            </div>
            <div class="db form-group" class="db mt-20">
              <button type="button" class="db btn save_btn" (click)="btnsaveyes()" style="margin-right: 10px;">Yes</button>
              <button type="button" class="db btn cancel_btn" (click)="btncancelno()">No</button>
            </div>
          </div>
        </div>
      </div>

    </div>
  </ng-template>
  <ng-template #pdfdownload>
    <div class="db container popupbg">
      <div class="db modal-header">
        <h5 class="db heading-3">Water Mark</h5>  
      </div>
      <div class="db popup" style="padding: 20px;">
        <div class="db content">
          <div class="db form-wrapper">
            
          <div class="db form-group" *ngIf="watermarktest" style="width: 100%;display: flex;align-items: center;">
            <label for="imgvarval" class="db form-label" style="margin: 0px 10px 0px 0px;">Text</label>
            <input type="text" required placeholder="watermark text" [(ngModel)]="watermarktext"
              class="db form-control" style="width: 300px;">
            <span style="color: red;display: block;" *ngIf="showerror">* Field is mandatory!</span>
          </div>
            <div class="db form-group" class="db mt-20">
              <button type="button" class="db btn save_btn" (click)="save()" style="margin-right: 10px; text-align: right; ">Save</button>
              <button type="button" class="db btn cancel_btn"  (click)="close()" style="margin-right: 10px; text-align: right; ">Close</button>
            </div>
          </div>
        </div>
      </div>

    </div>
  </ng-template>
  <ng-template #barcodes>
    <div class="db container popupbg">
      <div class="db modal-header">
        <h5 class="db heading-3">Barcode Editor</h5>
      </div>
      <div class="db popup barcode-editor" style="padding: 0px;">
        <div class="db content">
          <div class="db form-wrapper">
            <div class="db form-group1">
              <label class="db form-label">Name</label> {{ln}}<br>
              <label class="db form-label">Type</label> {{lt}}
            </div>
            <div class="db row">
              <div class="db form-group col-md-6" *ngFor="let data of barcodetypes">
                <input type="radio" class="db form-control" name="barcodetype" value="data" (click)="model.option = data"
                  [checked]="data === model.option">
                <label class="db form-label">{{data}}</label>
              </div>
            </div>
            <div class="db form-group">
              <label class="db form-label">Value</label>
              <input type="text" class="db form-control" id="inp_barcodevalue" (keypress)="keyPress($event)"
                [(ngModel)]="selectedProperty.barcode_val">
            </div>
            <span class="db msg">{{barcodemsg}}</span>
            <span class="db msg">{{barcodemsg1}}</span>
            <div class="db form-group" class="db mt-20">
              <button type="button" class="db btn save_btn" style="margin-right: 10px;"
                (click)="storebarcode()">Done</button>
              <button type="button" class="db btn cancel_btn" (click)="closebarcodepopup()">Cancel</button>
            </div>
          </div>
        </div>
      </div>

    </div>
  </ng-template>
  <ng-template #signaturepopups>
    <div class="db openModal popupbg" role="document">
      <div class="db modal-header">
        <h5 class="db heading-3">Edit Signature</h5>
      </div>
      <div class="db modal-content">
        <div class="db signature_form" *ngIf="signaturepopuptwo">
          <div class="db form-group" style="margin-top: 28px;">
            <label>Signature Name <span class="db required">*</span></label>
            <input value="" class="db form-control" id="signature_names" [(ngModel)]="selectedProperty.signature_name">
          </div>
          <div class="db form-group">
            <label>Id <span class="db required">*</span></label>
            <input value="" class="db form-control" id="signature_ids" [(ngModel)]="selectedProperty.signature_id">
          </div>
          <div class="db row signature_variables">
            <div class="db col-sm-6">
              <span>select dependant variable for the signature</span>
              <div class="db secvariable">
                <ng-container *ngFor="let data of layer4;index as i">
                  <ng-container
                    *ngIf="data.text && data.text.indexOf('&lt;&lt;')==0 && data.text.indexOf('&gt;&gt;') > 0">
                    <div class="db form-group" *ngFor="let data1 of data.variable">
                      <input type="radio" name="dependant_variable" (change)="getdependantvar($event.target.value)"
                        value="{{data1}}">&lt;&lt;{{data1}}&gt;&gt;
                    </div>
                  </ng-container>
                </ng-container>
              </div>
            </div>
            <div class="db col-sm-6">
              <span>select date & time variable for the signature</span>
              <div class="db secvariable">
                <ng-container *ngFor="let data of layer4;index as i">
                  <ng-container
                    *ngIf="data.text && data.text.indexOf('&lt;&lt;')==0 && data.text.indexOf('&gt;&gt;') > 0">
                    <div class="db form-group" *ngFor="let data1 of data.variable">
                      <input type="checkbox" name="datetime_variable" value="{{data1}}">&lt;&lt;{{data1}}&gt;&gt;
                    </div>
                  </ng-container>
                </ng-container>
              </div>
            </div>
          </div>
          <div class="db form-group" class="db mt-2">
            <button type="button" class="db btn save_btn" style="margin-right: 10px;"
              (click)="saveeditsignature()">Done</button>
            <button type="button" class="db btn cancel_btn" (click)="closesignaturepopuptwo()">Cancel</button>
          </div>
        </div>
      </div>
    </div>
  </ng-template>
  <ng-template #templateAddrow>
    <div class="db popupbg">
    <div class="db modal-header ">
      <h4 class="db modal-title pull-left">Data Table  Editor</h4>
      <span aria-hidden="true" class="db pull-right" (click)="modalRef.hide()"
          style="color: white !important;">&times;</span>
    </div>
    <div class="db modal-body" style="height: 18rem;overflow-y: auto;">
    <dx-data-grid id="gridContainer" [dataSource]="clientList" [columns] = "clcolumns" [showBorders]="true">
      <dxo-sorting mode="none"></dxo-sorting>
      <dxo-editing    
      [allowDeleting]="true"
      [allowUpdating]="true"
      [useIcons]="true"
      mode="cell"> 
      <dxo-texts confirmDeleteMessage=""></dxo-texts>  
      </dxo-editing>    
     </dx-data-grid>
  
    </div>
      <div class="db modal-footer ">
        <div style="text-align: center;">
          <button class="db btn save_btn" style="position: relative;right:7%" (click)="addRowTbl()">AddRow</button>
          <button class="db btn save_btn" style="position: relative;right:10px" (click)="updateTblData()">update</button>
          <button class="db btn cancel_btn" style="position: relative;right:3px" (click)="modalRef.hide()">cancel</button>
        </div>
        
      </div>
  </div>
  
  </ng-template>
  
  <ng-template #templateTableProperties>
    <div class="db popupbg">
      <div class="db modal-header ">
        <h5 class="db modal-title pull-left">Table Properties</h5>
        <span aria-hidden="true" class="db pull-right" (click)="modalRef.hide()"
          style="color: white !important;">&times;</span>
      </div>
      <div class="db modal-body">
        <form #TableProperty="ngForm" id="frmTableProperty" autocomplete="off"
          (ngSubmit)="btnTableProperty(TableProperty.value,TableProperty)">

          <div class="db form-group row">

            <div class="db col-lg-6">
              <div class="db form-check">
                <input class="db form-check-input" type="checkbox" value="" name="showVborder"
                  [(ngModel)]="tblObjJson.columns.showVerticalDivider" id="chbShowVborder">
                <label class="db form-check-label" for="chbShowVborder" style="font-size: 11px;">Show Vertical
                  Divider</label>
              </div>
              <div class="db form-check">
                <input class="db form-check-input" type="checkbox" value="" name="showBorder"
                  [(ngModel)]="tblObjJson.borderstatus" id="chbShowBorder">
                <label class="db form-check-label" for="chbShowBorder" style="font-size: 11px;">Show Border</label>
              </div>

              <div class="db form-check">
                <input class="db form-check-input" type="checkbox" value="" name="driverTable"
                  [(ngModel)]="tblObjJson.isDriverTable" id="chdriverTable">
                <label class="db form-check-label" for="chdriverTable" style="font-size: 11px;">Driver Table</label>
              </div>

              <div class="db form-check">
                <input class="db form-check-input" type="checkbox" value="" name="rowHeaderBg"
                  [(ngModel)]="tblObjJson.rowHeaderBg" id="cbHeaderBg">
                <label class="db form-check-label" for="cbHeaderBg" style="font-size: 11px;">Row Header Fill</label>
                <input type="text" [disabled]="!tblObjJson.rowHeaderBg"
                  style="width: 25px; height: 25px; font-size: 12px; margin-left: 6px; cursor:pointer;background: rgb(255, 255, 255); color: transparent;"
                  [cpPosition]="'right'" [(colorPicker)]="tblObjJson.rowHeaderFill"
                  [style.background]="tblObjJson.rowHeaderFill" [value]="tblObjJson.rowHeaderFill">
              </div>
              <div class="db form-check">
                <input class="db form-check-input" type="checkbox" value="" name="titleBg"
                  [(ngModel)]="tblObjJson.titleBg" id="cbtitleBg">
                <label class="db form-check-label" for="cbHeaderBg" style="font-size: 11px;">Title Fill</label>
                <input type="text" [disabled]="!tblObjJson.titleFill"
                  style="width: 25px; height: 25px; font-size: 12px; margin-left: 6px; cursor:pointer;background: rgb(255, 255, 255); color: transparent;"
                  [cpPosition]="'right'" [(colorPicker)]="tblObjJson.titleFill"
                  [style.background]="tblObjJson.titleFill" [value]="tblObjJson.titleFill">
              </div>

              <div class="db form-check">
                <input class="db form-check-input" type="checkbox" value="" name="showTitle"
                  [(ngModel)]="tblObjJson.hasTitle" id="defaultCheck1">
                <label class="db form-check-label" for="defaultCheck1" style="font-size: 11px;">Show Title</label>
              </div>

            </div>

            <div class="db col-lg-6">

              <div class="db form-check">
                <input class="db form-check-input" type="checkbox" value="" name="showHborder"
                  [(ngModel)]="tblObjJson.columns.showHorizontalDivider" id="chbShowHborder">
                <label class="db form-check-label" for="chbShowHborder" style="font-size: 11px;">Show Horizontal
                  Divider</label>
              </div>
              <div class="db form-check">
                <input class="db form-check-input" type="checkbox" value="" name="groupRows"
                  [(ngModel)]="tblObjJson.groupRows" id="chbGroupRows">
                <label class="db form-check-label" for="chbGroupRows" style="font-size: 11px;">Group Rows</label>
              </div>
              <div class="db form-check">
                <input class="db form-check-input" type="checkbox" value="" name="dynamicData"
                  [(ngModel)]="tblObjJson.dynamicData" id="chbDynamicDt">
                <label class="db form-check-label" for="chbDynamicDt" style="font-size: 11px;">Dynamic Data</label>
              </div>
              <div class="db form-check">
                <input class="db form-check-input" type="checkbox" value="" name="rowTitleBg"
                  [(ngModel)]="tblObjJson.rowTitleBg" id="cbTitleBg">
                <label class="db form-check-label" for="cbTitleBg" style="font-size: 11px;">Row Title Fill</label>
                <input type="text" [disabled]="!tblObjJson.rowTitleBg"
                  style="width: 25px; height: 25px; font-size: 12px;margin-left: 6px; cursor:pointer;background: rgb(255, 255, 255); color: transparent;"
                  [cpPosition]="'right'" [(colorPicker)]="tblObjJson.rowTitleFill"
                  [style.background]="tblObjJson.rowTitleFill" [value]="tblObjJson.rowTitleFill">
              </div>
              <div class="db form-check">
                <input class="db form-check-input" type="checkbox" value="" name="showRowTitle"
                  [(ngModel)]="tblObjJson.hasRowTitle" id="chRowTitle">
                <label class="db form-check-label" for="chRowTitle" style="font-size: 11px;">Show Row Title</label>
              </div>
              <div>
                <label class="db form-check-label" style="font-size: 11px;">Row title width</label>
                <input class="db form-control" [disabled]="!tblObjJson.hasRowTitle" placeholder="" type="text"
                  name="rowTitleWidth" [required]="tblObjJson.hasRowTitle" [(ngModel)]="tblObjJson.rowTitleWidth"
                  style="font-size: 11px;width: 100%;" OnlyNumber="true">
              </div>
            </div>
          </div>


          <div class="db form-group row">
            <div class="db col-lg-3">
              <input class="db form-control" [disabled]="!tblObjJson.hasTitle" placeholder="" type="text" name="titleText"
                [(ngModel)]="tblObjJson.title" style="font-size: 11px;width: 110%;">
            </div>

            <div class="db col-lg-2">
              <select style="font-size:11px;width:60px;margin-left: 2px;height: 30px;"
                [(ngModel)]="tblObjJson.titleStyle.fontFamily" name="titleFontFamily" [disabled]="!tblObjJson.hasTitle">
                <option value="Arial" style="font-family:Arial">Arial</option>
                <option style="font-family:Helvetica" value="Helvetica" selected>Helvetica</option>
                <option style="font-family:Verdana" value="Verdana">Verdana</option>
                <option style="font-family:'Courier New', Courier, monospace" value="courier">Courier</option>
                <option style="font-family:'Roboto', sans-serif" value="Roboto">Roboto</option>
                <option style="font-family:'Open Sans', sans-serif;" value="Open Sans">Open Sans
                </option>
                <option style="font-family:'Bellefair', serif;" value="Bellefair">Bellefair</option>
                <option style="font-family:'Fresca', sans-serif;" value="Fresca">Fresca</option>
                <option style="font-family:'Open Sans Condensed', sans-serif;" value="Open Sans Condensed">Open
                  Sans
                  Condensed
                </option>
                <option style="font-family:'Indie Flower', cursive;" value="Indie Flower">Indie Flower
                </option>
                <option style="font-family:'Josefin Sans', sans-serif;" value="Josefin Sans">Josefin Sans
                </option>
                <option style="font-family:'Inconsolata', monospace;" value="Inconsolata">Inconsolata</option>
                <option style="font-family:'Pacifico', cursive;" value="Pacifico">Pacifico</option>
                <option style="font-family:'Cinzel', serif;" value="Cinzel">Cinzel</option>
                <option style="font-family:'Schoolbell', cursive;" value="Schoolbell">Schoolbell</option>
                <option style="font-family:'Tangerine', cursive;" value="Tangerine">Tangerine</option>
                <option style="font-family:'ZCOOL XiaoWei', serif;" value="ZCOOL XiaoWei">ZCOOL XiaoWei
                </option>
                <option style="font-family:'ZCOOL QingKe HuangYou', cursive" value="ZCOOL QingKe HuangYou">ZCOOL
                  QingKe
                  HuangYou</option>
                <option style="font-family:'Gloria Hallelujah', cursive;" value="Gloria Hallelujah">Gloria
                  Hallelujah
                </option>
              </select>

            </div>

            <div class="db col-lg-1">
              <div style="margin-top: 0px;position:relative;right:10px">
                <input type="text" [disabled]="!tblObjJson.hasTitle"
                  style="width: 30px; height: 30px; font-size: 12px;  cursor:pointer;background: rgb(255, 255, 255); color: transparent;"
                  [cpPosition]="'right'" [(colorPicker)]="tblObjJson.titleStyle.fill"
                  [style.background]="tblObjJson.titleStyle.fill" [value]="tblObjJson.titleStyle.fill">
              </div>
            </div>

            <div class="db col-lg-3">
              <div>
                <input class="db form-control" [disabled]="!tblObjJson.hasRowTitle" placeholder="" type="text"
                  name="rowtitleText" [required]="tblObjJson.hasRowTitle" [(ngModel)]="tblObjJson.rowTitle"
                  style="font-size: 11px;width: 110%;">
              </div>
            </div>
            <div class="db col-lg-2">
              <select style="font-size:11px;width:60px;height: 30px;" [(ngModel)]="tblObjJson.rowTitleStyle.fontFamily"
                name="rowtitleFontFamily" [disabled]="!tblObjJson.hasRowTitle">
                <option value="Arial" style="font-family:Arial">Arial</option>
                <option style="font-family:Helvetica" value="Helvetica" selected>Helvetica</option>
                <option style="font-family:Verdana" value="Verdana">Verdana</option>
                <option style="font-family:'Courier New', Courier, monospace" value="courier">Courier</option>
                <option style="font-family:'Roboto', sans-serif" value="Roboto">Roboto</option>
                <option style="font-family:'Open Sans', sans-serif;" value="Open Sans">Open Sans
                </option>
                <option style="font-family:'Bellefair', serif;" value="Bellefair">Bellefair</option>
                <option style="font-family:'Fresca', sans-serif;" value="Fresca">Fresca</option>
                <option style="font-family:'Open Sans Condensed', sans-serif;" value="Open Sans Condensed">Open
                  Sans
                  Condensed
                </option>
                <option style="font-family:'Indie Flower', cursive;" value="Indie Flower">Indie Flower
                </option>
                <option style="font-family:'Josefin Sans', sans-serif;" value="Josefin Sans">Josefin Sans
                </option>
                <option style="font-family:'Inconsolata', monospace;" value="Inconsolata">Inconsolata</option>
                <option style="font-family:'Pacifico', cursive;" value="Pacifico">Pacifico</option>
                <option style="font-family:'Cinzel', serif;" value="Cinzel">Cinzel</option>
                <option style="font-family:'Schoolbell', cursive;" value="Schoolbell">Schoolbell</option>
                <option style="font-family:'Tangerine', cursive;" value="Tangerine">Tangerine</option>
                <option style="font-family:'ZCOOL XiaoWei', serif;" value="ZCOOL XiaoWei">ZCOOL XiaoWei
                </option>
                <option style="font-family:'ZCOOL QingKe HuangYou', cursive" value="ZCOOL QingKe HuangYou">ZCOOL
                  QingKe
                  HuangYou</option>
                <option style="font-family:'Gloria Hallelujah', cursive;" value="Gloria Hallelujah">Gloria
                  Hallelujah
                </option>
              </select>

            </div>
            <div class="db col-lg-1">
              <div style="margin-top: 0px;position: relative;right:90%">
                <input type="text" [disabled]="!tblObjJson.hasRowTitle"
                  style="width: 30px; height: 30px; font-size: 12px; margin-left: 6px; cursor:pointer;background: rgb(255, 255, 255); color: transparent;"
                  [cpPosition]="'left'" [(colorPicker)]="tblObjJson.rowTitleStyle.fill"
                  [style.background]="tblObjJson.rowTitleStyle.fill" [value]="tblObjJson.rowTitleStyle.fill">
              </div>
            </div>

          </div>
          <div class="db form-group row">

            <div class="db col-lg-4">
              <select style="font-size:11px;width:37px;margin-right: 3px;height: 29px;position: relative;bottom: 2%;"
                [(ngModel)]="tblObjJson.titleStyle.fontSize" name="titleFontSize" [disabled]="!tblObjJson.hasTitle"
                step="1" min="1" max="120">
                <option value="12">12</option>
                <option value="15">15</option>
                <option value="16">16</option>
                <option value="18">18</option>
                <option value="22">22</option>
                <option value="24">24</option>
                <option value="26">26</option>
                <option value="28">28</option>
                <option value="24">24</option>
                <option value="30">30</option>
                <option value="32">32</option>
                <option value="35">35</option>
                <option value="36">36</option>
                <option value="40">40</option>
                <option value="48">48</option>
                <option value="50">50</option>
                <option value="54">54</option>
                <option value="60">60</option>
                <option value="66">66</option>
                <option value="72">72</option>
                <option value="80">80</option>
                <option value="88">88</option>
                <option value="96">96</option>
                <option value="100">100</option>
              </select>

              <mat-button-toggle tooltip="Bold" placement="bottom" [disabled]="!tblObjJson.hasTitle"
                [checked]="tblObjJson.titleStyle.fontweight"
                (click)="settblTitleBold(tblObjJson.titleStyle,tblObjJson.hasTitle)" [value]="true">
                <i class="db fa fa-bold" aria-hidden="true"></i>
              </mat-button-toggle>
              <mat-button-toggle tooltip="Italic" placement="bottom" [disabled]="!tblObjJson.hasTitle"
                [checked]="tblObjJson.titleStyle.fontStyle"
                (click)="settblTitleItalic(tblObjJson.titleStyle,tblObjJson.hasTitle)" [value]="true">
                <i class="db fa fa-italic" aria-hidden="true"></i>
              </mat-button-toggle>
              <mat-button-toggle tooltip="Underline" placement="bottom" [disabled]="!tblObjJson.hasTitle"
                [checked]="tblObjJson.titleStyle.underline"
                (click)="settblTitleUnderline(tblObjJson.titleStyle,tblObjJson.hasTitle)" [value]="true">
                <i class="db fa fa-underline" aria-hidden="true"></i>
              </mat-button-toggle>




            </div>
            <div class="db col-lg-2">
              <mat-button-toggle-group name="titleFontAlign" [disabled]="!tblObjJson.hasTitle"
                [(ngModel)]="tblObjJson.titleStyle.textalign" style="width: 100px;position: relative;right:49%">
                <mat-button-toggle value="left" tooltip="Align Left" placement="bottom">
                  <i class="db fa fa-align-left" aria-hidden="true"></i>
                </mat-button-toggle>

                <mat-button-toggle value="center" tooltip="Align Center" placement="bottom">
                  <i class="db fa fa-align-center" aria-hidden="true"></i>
                </mat-button-toggle>
                <mat-button-toggle value="right" tooltip="Align Right" placement="bottom">
                  <i class="db fa fa-align-right" aria-hidden="true"></i>
                </mat-button-toggle>
                <mat-button-toggle value="justify" tooltip="Align Justify" placement="bottom">
                  <i class="db fa fa-align-justify" aria-hidden="true"></i>
                </mat-button-toggle>
              </mat-button-toggle-group>



            </div>

            <div class="db col-lg-4">
              <select style="font-size:11px;width:37px;height: 29px;position: relative;bottom: 2%;"
                [(ngModel)]="tblObjJson.rowTitleStyle.fontSize" name="rowtitleFontSize"
                [disabled]="!tblObjJson.hasRowTitle" step="1" min="1" max="120">
                <option value="12">12</option>
                <option value="15">15</option>
                <option value="16">16</option>
                <option value="18">18</option>
                <option value="22">22</option>
                <option value="24">24</option>
                <option value="26">26</option>
                <option value="28">28</option>
                <option value="24">24</option>
                <option value="30">30</option>
                <option value="32">32</option>
                <option value="35">35</option>
                <option value="36">36</option>
                <option value="40">40</option>
                <option value="48">48</option>
                <option value="50">50</option>
                <option value="54">54</option>
                <option value="60">60</option>
                <option value="66">66</option>
                <option value="72">72</option>
                <option value="80">80</option>
                <option value="88">88</option>
                <option value="96">96</option>
                <option value="100">100</option>
              </select>

              <mat-button-toggle style="position: relative;left:2%;" tooltip="Bold" placement="bottom"
                [disabled]="!tblObjJson.hasRowTitle" [checked]="tblObjJson.rowTitleStyle.fontweight"
                (click)="settblTitleBold(tblObjJson.rowTitleStyle,tblObjJson.hasRowTitle)" [value]="true">
                <i class="db fa fa-bold" aria-hidden="true"></i>
              </mat-button-toggle>
              <mat-button-toggle tooltip="Italic" placement="bottom" [disabled]="!tblObjJson.hasRowTitle"
                [checked]="tblObjJson.rowTitleStyle.fontStyle"
                (click)="settblTitleItalic(tblObjJson.rowTitleStyle,tblObjJson.hasRowTitle)" [value]="true">
                <i class="db fa fa-italic" aria-hidden="true"></i>
              </mat-button-toggle>
              <mat-button-toggle tooltip="Underline" placement="bottom" [disabled]="!tblObjJson.hasRowTitle"
                [checked]="tblObjJson.rowTitleStyle.underline"
                (click)="settblTitleUnderline(tblObjJson.rowTitleStyle,tblObjJson.hasRowTitle)" [value]="true">
                <i class="db fa fa-underline" aria-hidden="true"></i>
              </mat-button-toggle>


            </div>

            <div class="db col-lg-2" style="margin-left: -8px;">
              <mat-button-toggle-group name="rowtitleFontAlign" [disabled]="!tblObjJson.hasRowTitle"
                [(ngModel)]="tblObjJson.rowTitleStyle.textalign" style="width: 100px;position: relative;right:49%">
                <mat-button-toggle value="left" tooltip="Align Left" placement="bottom">
                  <i class="db fa fa-align-left" aria-hidden="true"></i>
                </mat-button-toggle>

                <mat-button-toggle value="center" tooltip="Align Center" placement="bottom">
                  <i class="db fa fa-align-center" aria-hidden="true"></i>
                </mat-button-toggle>
                <mat-button-toggle value="right" tooltip="Align Right" placement="bottom">
                  <i class="db fa fa-align-right" aria-hidden="true"></i>
                </mat-button-toggle>
                <mat-button-toggle value="justify" tooltip="Align Justify" placement="bottom">
                  <i class="db fa fa-align-justify" aria-hidden="true"></i>
                </mat-button-toggle>
              </mat-button-toggle-group>


            </div>

          </div>

          <div class="db form-group row">
            <div class="db col-lg-6">
              <div class="db form-check">
                <input class="db form-check-input" type="checkbox" [disabled]="!tblObjJson.dynamicData" value=""
                  name="dynamicFontSize" [(ngModel)]="tblObjJson.dynamicFontSize" id="chbDynamicFontSize">
                <label class="db form-check-label" for="chbShowVborder" style="font-size: 11px;">Dynamic Font Size</label>
              </div>
            </div>

            <div class="db col-lg-6">
              <div class="db form-check">
                <input class="db form-check-input" type="checkbox"
                  [disabled]="!tblObjJson.dynamicFontSize || !tblObjJson.dynamicData" value="" name="moveText"
                  [(ngModel)]="tblObjJson.moveText" id="chbMoveTextPosition">
                <label class="db form-check-label" for="chbShowVborder" style="font-size: 11px;">Move Text Position</label>
              </div>
            </div>

          </div>
          <div class="db form-group row">
            <div class="db col-lg-5">
              <div class="db form-group row">
                <div class="db col-lg-9 col-xs-7">
                  <input class="db form-control" [required]="tblObjJson.dynamicFontSize"
                    [disabled]="!tblObjJson.dynamicFontSize || !tblObjJson.dynamicData" placeholder="Select component"
                    type="text" name="Selectcomponent" [(ngModel)]="tblObjJson.dependantId"
                    style="font-size: 11px;width: 110%;">
                </div>
                <div class="db col-lg-3 col-xs-3">
                  <button style="border: none;background: none;cursor: pointer;"
                    [disabled]="!tblObjJson.dynamicFontSize || !tblObjJson.dynamicData" (click)="btnDynCompSel()"><span
                      class="db  mdi  mdi-pencil-box-outline" style="font-size: 22px;"></span></button>
                </div>
              </div>
            </div>
            <div class="db col-lg-7">
              <div class="db form-group row">
                <label class="db col-lg-3 text-right control-label col-form-label" style="font-size: 10px;">Min Row Size
                  <span [ngStyle]="{'color': tblObjJson.dynamicFontSize ? 'red' : ''}">*</span></label>
                <div class="db col-lg-3 col-xs-4">
                  <input type="number" style="width: 130%;height: 70%;border: 1px solid #ced4da; color:black !important" [required]="tblObjJson.dynamicFontSize"
                    [disabled]="!tblObjJson.dynamicFontSize || !tblObjJson.dynamicData" [(ngModel)]="tblObjJson.fitRows"
                    id="rowSize" name="rowSize" min="1" max="30">
                </div>
                <label class="db col-lg-3 text-right control-label col-form-label" style="font-size: 10px;">Min Font Size
                  <span [ngStyle]="{'color': tblObjJson.dynamicFontSize ? 'red' : ''}">*</span></label>
                <div class="db col-lg-3 col-xs-4">
                  <input type="number" style="width: 130%;height: 70%;border: 1px solid #ced4da;color:black !important" [required]="tblObjJson.dynamicFontSize"
                    [disabled]="!tblObjJson.dynamicFontSize || !tblObjJson.dynamicData"
                    [(ngModel)]="tblObjJson.minFontSize" id="fontSize" name="fontSize" min="1" max="30">
                </div>
              </div>
            </div>
          </div>

          <div style="text-align: center;">
            <button class="db btn cancel_btn" type="button" style="position: relative;right:30px" (click)="modalRef.hide()">Back</button>
            <button class="db btn save_btn" type="submit" [disabled]="TableProperty.invalid">Done</button>

          </div>


        </form>










      
      </div>
    </div>
  </ng-template>
  <div class="db openModal popupbg dynamicFontSize_fst_popup" *ngIf="isDynCompSel" style="    box-shadow: 0px 1px 5px #cecece;
  ">
    <div class="db dynamicFontSize_form" style="padding: 0px;">
      <div class="db form-group modal-header">
        <label class="db col-lg-12" style="font-size: 12px;color: white !important;">Select A Text Component To Apply Dynamic Font Size</label>
      </div>
      <div class="db form-group">
        <input type="text" style="width:100% ;padding:10%;border: 1px solid #ced4da;color:black !important" [(ngModel)]="dynamicFontSizeText" id="fontSizeText"
          name="dynamicFontSizeText">
      </div>


      <div class="db form-group" class="db mt-20">
        <label style="color: red;font-size: 12px;" *ngIf="selection">Please Select The Text Component*</label>
        <button type="button" class="db btn-primary save_btn mb-2" (click)="btnGetDynamicId()"
          style="margin-right: 10px;position: relative;left: 60%;padding: 5px 10px;">Done</button>
        <button type="button" class="db btn-danger cancel_btn mb-2" style="padding: 5px 10px;position: relative;left: 60%;"
          (click)="btnCloseDynamicId()">Cancel</button>
      </div>
    </div>
  </div>

  <ng-template #templateAddcolum>
    <div class="db popupbg">
      <div class="db modal-header ">
        <h5 class="db modal-title pull-left">Manage column</h5>
        <span aria-hidden="true" class="db pull-right" (click)="modalRef.hide()">&times;</span>
      </div>
      <div class="db modal-body">
    <form #addColumn="ngForm" id="frmaddColumn" autocomplete="off"
          (ngSubmit)="btnaddColumn(addColumn.value,addColumn)">


          <div class="db row">
            <div class="db col-lg-6">
              <div class="db form-group row">
                <label class="db col-lg-6" style="font-size:11px;">Column Selection</label>
                <div class="db col-lg-6 col-xs-7">
                  <select required class="db form-control" name="columnName" (change)="colNameChange($event)"
                    [(ngModel)]="columnName" style="height:100%;width:100%;font-size:11px;">
                    <option [value]="0" tooltip="New column" selected>AddNew</option>
                    <option *ngFor="let item of columnList; let i = index" [value]="i+1">
                      {{item}}</option>
                  </select>
                </div>
              </div>
              <div class="db form-group row">
                <label class="db col-lg-6" style="font-size:11px;">Column Name <span style="color: red;">*</span></label>
                <div class="db col-lg-6 col-xs-7">
                  <input class="db form-control" type="text" name="addColumnname"
                    style="height:100%;width:100%;font-size:12px;" [(ngModel)]="addColumnname" required="true">
                </div>
              </div>
              <div class="db form-group row" *ngIf="!isDriverTable">
                <label class="db col-lg-6" style="font-size:11px;">Data Field <span style="color: red;">*</span></label>
                <div class="db col-lg-6 col-xs-7">
                  <input class="db form-control" type="text" name="addDataField"
                    style="height:100%;width:100%;font-size:12px;" [(ngModel)]="addDataField" required="true">
                </div>
              </div>
              <div class="db form-group row">
                <label class="db col-lg-6" style="font-size:11px;">Column width <span style="color: red;">*</span></label>
                <div class="db col-lg-6 col-xs-7">
                    <input class="db form-control" type="text" name="columnwidth"
                    style="height:100%;width:100%;font-size:12px;" [(ngModel)]="columnwidth"
                     required="true" OnlyNumber="true">
                </div>
              </div>
              <div class="db form-group row" *ngIf="isDriverTable">
                <label class="db col-lg-6" style="font-size:11px;">Included Data Field <span
                    style="color: red;">*</span></label>
                <div class="db col-lg-6 col-xs-7">
                  <input class="db form-control" type="text" name="addDataField"
                    style="height:100%;width:100%;font-size:12px;" [(ngModel)]="addDataField" required="true">
                </div>
              </div>

            </div>
            <div class="db col-lg-6" style="border-left:1px solid #ccc ;">
              <div class="db form-group row" *ngIf="isDriverTable">
                <label class="db col-lg-6" style="font-size:11px;">Excluded Data Field <span
                    style="color: red;">*</span></label>
                <div class="db col-lg-6 col-xs-7">
                  <input class="db form-control" type="text" name="addexcludedDataField" style="width:100%;font-size:12px;"
                    [(ngModel)]="addexcludedDataField">
                </div>
              </div>


              <div class="db form-group row">
                <label class="db col-lg-6" style="font-size:11px;">Data Prefix</label>
                <div class="db col-lg-6">
                  <input class="db form-control" style="height:100%;width:100%;font-size:12px;" type="text"
                    name="addDataprefix" [(ngModel)]="addDataprefix">
                </div>
              </div>
              <div class="db form-group row">
                <label class="db col-lg-6" style="font-size:11px;">Data Suffix</label>
                <div class="db col-lg-6">
                  <input class="db form-control" style="height:100%;width:100%;font-size:12px;" type="text"
                    name="addDataSuffix" [(ngModel)]="addDataSuffix">
                </div>
              </div>
            </div>
          </div>

          <label class="db col-lg-2" style="font-weight:bold;position: relative;right: 2%;font-size: 15px;">Styles</label>

          <div class="db row">
            <div class="db col-lg-6">
              <div class="db form-group row" style="margin-bottom:0px;">
                <label class="db col-lg-12">Column Styles </label>
              </div>
              <div class="db form-group row" style="margin-bottom:0px;">
                <div>
                  <section class="db pull-left">
                    <select style="font-size:12px;width:110px;margin-left: 5px;height: 27px;"
                      [(ngModel)]="colStylePro.fontFamily" name="colFontFamily">
                      <option value="Arial" style="font-family:Arial" selected>Arial</option>
                      <option style="font-family:Helvetica" value="Helvetica">Helvetica</option>
                      <option style="font-family:Verdana" value="Verdana">Verdana</option>
                      <option style="font-family:'Courier New', Courier, monospace" value="courier">Courier</option>
                      <option style="font-family:'Roboto', sans-serif" value="Roboto">Roboto</option>
                      <option style="font-family:'Open Sans', sans-serif;" value="Open Sans">Open Sans
                      </option>
                      <option style="font-family:'Bellefair', serif;" value="Bellefair">Bellefair</option>
                      <option style="font-family:'Fresca', sans-serif;" value="Fresca">Fresca</option>
                      <option style="font-family:'Open Sans Condensed', sans-serif;" value="Open Sans Condensed">Open
                        Sans
                        Condensed
                      </option>
                      <option style="font-family:'Indie Flower', cursive;" value="Indie Flower">Indie Flower
                      </option>
                      <option style="font-family:'Josefin Sans', sans-serif;" value="Josefin Sans">Josefin Sans
                      </option>
                      <option style="font-family:'Inconsolata', monospace;" value="Inconsolata">Inconsolata</option>
                      <option style="font-family:'Pacifico', cursive;" value="Pacifico">Pacifico</option>
                      <option style="font-family:'Cinzel', serif;" value="Cinzel">Cinzel</option>
                      <option style="font-family:'Schoolbell', cursive;" value="Schoolbell">Schoolbell</option>
                      <option style="font-family:'Tangerine', cursive;" value="Tangerine">Tangerine</option>
                      <option style="font-family:'ZCOOL XiaoWei', serif;" value="ZCOOL XiaoWei">ZCOOL XiaoWei
                      </option>
                      <option style="font-family:'ZCOOL QingKe HuangYou', cursive" value="ZCOOL QingKe HuangYou">ZCOOL
                        QingKe
                        HuangYou</option>
                      <option style="font-family:'Gloria Hallelujah', cursive;" value="Gloria Hallelujah">Gloria
                        Hallelujah
                      </option>
                    </select>

                    <select style="font-size:12px;width:60px;margin-left: 5px;height: 27px;"
                      [(ngModel)]="colStylePro.fontSize" name="colFontSize" step="1" min="1" max="120">
                      <option value="12">12</option>
                      <option value="15">15</option>
                      <option value="16">16</option>
                      <option value="18">18</option>
                      <option value="22">22</option>
                      <option value="24">24</option>
                      <option value="26">26</option>
                      <option value="28">28</option>
                      <option value="24">24</option>
                      <option value="30">30</option>
                      <option value="32">32</option>
                      <option value="35">35</option>
                      <option value="36">36</option>
                      <option value="40">40</option>
                      <option value="48">48</option>
                      <option value="50">50</option>
                      <option value="54">54</option>
                      <option value="60">60</option>
                      <option value="66">66</option>
                      <option value="72">72</option>
                      <option value="80">80</option>
                      <option value="88">88</option>
                      <option value="96">96</option>
                      <option value="100">100</option>
                    </select>
                  </section>
                </div>
                <div class="db col-lg-2">
                  <div style="margin-top: 0px;position:relative;right:7px;">
                    <input type="text"
                      style="width: 25px; height: 25px; font-size: 12px; margin-left: 6px; cursor:pointer;background: rgb(255, 255, 255); color: transparent;"
                      [cpPosition]="'top'" [(colorPicker)]="colStylePro.fill" [style.background]="colStylePro.fill"
                      [value]="colStylePro.fill" (colorPickerChange)="setColumnFill()">
                  </div>
                </div>
              </div>
              <div class="db form-group row" style="margin-bottom:0px;position: relative;left: 2%;">
                <div class="db col-lg-3.5">
                  <mat-button-toggle tooltip="Bold" ToggleType="checkbox" placement="bottom"
                    [ngClass]="{'mat-button-toggle-checked': colStylePro.bold }" (click)="setColBold(colStylePro)"
                    [value]="true">
                    <i class="db fa fa-bold" aria-hidden="true"></i>
                  </mat-button-toggle>
                  <mat-button-toggle tooltip="Italic" placement="bottom"
                    [ngClass]="{'mat-button-toggle-checked': colStylePro.italic }" (click)="setColItalic(colStylePro)"
                    [value]="true">
                    <i class="db fa fa-italic" aria-hidden="true"></i>
                  </mat-button-toggle>
                  <mat-button-toggle tooltip="Underline" placement="bottom"
                    [ngClass]="{'mat-button-toggle-checked': colStylePro.underline }"
                    (click)="setColUnderline(colStylePro)" [value]="true">
                    <i class="db fa fa-underline" aria-hidden="true"></i>
                  </mat-button-toggle>
                </div>
                <div class="db col-lg-5">
                  <div style="margin:1px;">
                    <mat-button-toggle-group name="colFontAlign" [(ngModel)]="colStylePro.align">
                      <mat-button-toggle value="left" tooltip="Align Left" placement="bottom">
                        <i class="db fa fa-align-left" aria-hidden="true"></i>
                      </mat-button-toggle>

                      <mat-button-toggle value="center" tooltip="Align Center" placement="bottom">
                        <i class="db fa fa-align-center" aria-hidden="true"></i>
                      </mat-button-toggle>
                      <mat-button-toggle value="right" tooltip="Align Right" placement="bottom">
                        <i class="db fa fa-align-right" aria-hidden="true"></i>
                      </mat-button-toggle>
                      <mat-button-toggle value="justify" tooltip="Align Justify" placement="bottom">
                        <i class="db fa fa-align-justify" aria-hidden="true"></i>
                      </mat-button-toggle>
                    </mat-button-toggle-group>
                  </div>
                </div>

              </div>
            </div>
            <div class="db col-lg-6" style="border-left:1px solid #ccc ;">
              <div class="db form-group row" style="margin-bottom:0px;">
                <label class="db col-lg-12">Header Styles </label>
              </div>
              <div class="db form-group row" style="margin-bottom:0px;">
                <div>
                  <section class="db pull-left">
                    <select style="font-size:12px;width:110px;margin-left: 5px;height: 27px;"
                      [(ngModel)]="hdrStylePro.fontFamily" name="hdrFontFamily">
                      <option value="Arial" style="font-family:Arial">Arial</option>
                      <option style="font-family:Helvetica" value="Helvetica" selected>Helvetica</option>
                      <option style="font-family:Verdana" value="Verdana">Verdana</option>
                      <option style="font-family:'Courier New', Courier, monospace" value="courier">Courier</option>
                      <option style="font-family:'Roboto', sans-serif" value="Roboto">Roboto</option>
                      <option style="font-family:'Open Sans', sans-serif;" value="Open Sans">Open Sans
                      </option>
                      <option style="font-family:'Bellefair', serif;" value="Bellefair">Bellefair</option>
                      <option style="font-family:'Fresca', sans-serif;" value="Fresca">Fresca</option>
                      <option style="font-family:'Open Sans Condensed', sans-serif;" value="Open Sans Condensed">Open
                        Sans
                        Condensed
                      </option>
                      <option style="font-family:'Indie Flower', cursive;" value="Indie Flower">Indie Flower
                      </option>
                      <option style="font-family:'Josefin Sans', sans-serif;" value="Josefin Sans">Josefin Sans
                      </option>
                      <option style="font-family:'Inconsolata', monospace;" value="Inconsolata">Inconsolata</option>
                      <option style="font-family:'Pacifico', cursive;" value="Pacifico">Pacifico</option>
                      <option style="font-family:'Cinzel', serif;" value="Cinzel">Cinzel</option>
                      <option style="font-family:'Schoolbell', cursive;" value="Schoolbell">Schoolbell</option>
                      <option style="font-family:'Tangerine', cursive;" value="Tangerine">Tangerine</option>
                      <option style="font-family:'ZCOOL XiaoWei', serif;" value="ZCOOL XiaoWei">ZCOOL XiaoWei
                      </option>
                      <option style="font-family:'ZCOOL QingKe HuangYou', cursive" value="ZCOOL QingKe HuangYou">ZCOOL
                        QingKe
                        HuangYou</option>
                      <option style="font-family:'Gloria Hallelujah', cursive;" value="Gloria Hallelujah">Gloria
                        Hallelujah
                      </option>
                    </select>

                    <select style="font-size:12px;width:60px;margin-left: 5px;height: 27px;"
                      [(ngModel)]="hdrStylePro.fontSize" name="hdrFontSize">
                      <option value="12">12</option>
                      <option value="15">15</option>
                      <option value="16">16</option>
                      <option value="18">18</option>
                      <option value="22">22</option>
                      <option value="24">24</option>
                      <option value="26">26</option>
                      <option value="28">28</option>
                      <option value="24">24</option>
                      <option value="30">30</option>
                      <option value="32">32</option>
                      <option value="35">35</option>
                      <option value="36">36</option>
                      <option value="40">40</option>
                      <option value="48">48</option>
                      <option value="50">50</option>
                      <option value="54">54</option>
                      <option value="60">60</option>
                      <option value="66">66</option>
                      <option value="72">72</option>
                      <option value="80">80</option>
                      <option value="88">88</option>
                      <option value="96">96</option>
                      <option value="100">100</option>
                    </select>
                  </section>
                </div>
                <div class="db col-lg-2">
                  <div style="margin-top: 0px;position:relative;right:7px;">
                    <input type="text"
                      style="width: 25px; height: 25px; font-size: 12px; margin-left: 6px; cursor:pointer;background: rgb(255, 255, 255); color: transparent;"
                      [cpPosition]="'top-left'" [(colorPicker)]="hdrStylePro.fill" [style.background]="hdrStylePro.fill"
                      [value]="hdrStylePro.fill" (colorPickerChange)="setHeaderFill()">
                  </div>
                </div>
              </div>
              <div class="db form-group row" style="margin-bottom:0px;position: relative;left: 2%;">
                <div class="db col-lg-3.5">
                  <mat-button-toggle tooltip="Bold" placement="bottom"
                    [ngClass]="{'mat-button-toggle-checked': hdrStylePro.bold }" (click)="setHdrBold(hdrStylePro)"
                    [value]="true">
                    <i class="db fa fa-bold" aria-hidden="true"></i>
                  </mat-button-toggle>
                  <mat-button-toggle tooltip="Italic" placement="bottom"
                    [ngClass]="{'mat-button-toggle-checked': hdrStylePro.italic }" (click)="setHdrItalic(hdrStylePro)"
                    [value]="true">
                    <i class="db fa fa-italic" aria-hidden="true"></i>
                  </mat-button-toggle>
                  <mat-button-toggle tooltip="Underline" placement="bottom"
                    [ngClass]="{'mat-button-toggle-checked': hdrStylePro.underline }"
                    (click)="setHdrUnderline(hdrStylePro)" [value]="true">
                    <i class="db fa fa-underline" aria-hidden="true"></i>
                  </mat-button-toggle>
                </div>
                <div class="db col-lg-5">
                  <div style="margin:1px;">
                    <mat-button-toggle-group name="hdrFontAlign" [(ngModel)]="hdrStylePro.align">
                      <mat-button-toggle value="left" tooltip="Align Left" placement="bottom">
                        <i class="db fa fa-align-left" aria-hidden="true"></i>
                      </mat-button-toggle>

                      <mat-button-toggle value="center" tooltip="Align Center" placement="bottom">
                        <i class="db fa fa-align-center" aria-hidden="true"></i>
                      </mat-button-toggle>
                      <mat-button-toggle value="right" tooltip="Align Right" placement="bottom">
                        <i class="db fa fa-align-right" aria-hidden="true"></i>
                      </mat-button-toggle>
                      <mat-button-toggle value="justify" tooltip="Align Justify" placement="bottom">
                        <i class="db fa fa-align-justify" aria-hidden="true"></i>
                      </mat-button-toggle>
                    </mat-button-toggle-group>
                  </div>
                </div>

              </div>
            </div>
          </div>
          <div style="text-align: center;padding-top:15px;">
            <button class="db btn save_btn" style="font-size: 11px;position: relative;right: 5%" type="submit"
              [disabled]="addColumn.invalid" *ngIf="columnName==0">Add Column</button>
            <button class="db btn cancel_btn" style="font-size: 11px;position: relative;right: 9%;" *ngIf="columnName!=0"
              type="button" (click)="btnDelColumn()">Remove Column</button>
            <button class="db btn save_btn" style="font-size: 11px;position: relative;right: 5%;" type="submit"
              [disabled]="addColumn.invalid" *ngIf="columnName!=0">Update Column</button>
            <button class="db btn cancel_btn" style="font-size: 11px;position: relative;right: 2%;" type="button"
              (click)="modalRef.hide()">Cancel</button>

          </div>

        </form>




      </div>
    </div>
  </ng-template>
  <div class="db openModal popupbg signature_fst_popup" role="document" *ngIf="signature_first_popup">
    <div class="db signature_form" *ngIf="signaturepopup">
      <div class="db form-group">
        <label>Signature Name <span class="db required">*</span></label>
        <input value="" class="db form-control" id="signature_name" [(ngModel)]="selectedsignature_name">
      </div>
      <div class="db form-group">
        <label>Id <span class="db required">*</span></label>
        <input value="" class="db form-control" id="signature_id" [(ngModel)]="selectedsignature_id">
      </div>

      <div class="db form-group" class="db mt-20">
        <button type="button" class="db btn" (click)="savesignature(signaturepopups)"
          style="margin-right: 10px;">{{signaturechangebtn}}</button>
        <button type="button" class="db btn" (click)="closesignaturefirstpopup()">Cancel</button>
      </div>
    </div>
  </div>
  <div class="drag_box" >
    <div class="edrag" id="longtextdrag" [style.top.px]="mouseyposition+15" [style.left.px]="mousexposition+15">
     <span style="border: 1px solid gray;">Type your text here...</span>
         </div>
    <div class="edrag" id="slabeldrag" [style.top.px]="mouseyposition+15" [style.left.px]="mousexposition+15">
      <span style="border: 1px solid blue;">Add Label Text</span>
         </div>
    <div class="edrag" id="textvariabledrag" [style.top.px]="mouseyposition+15" [style.left.px]="mousexposition+15">
      <span>Add Text</span>
         </div>
         <div class="edrag" id="freeflowdrag" [style.top.px]="mouseyposition+15" [style.left.px]="mousexposition+15">
          <img style="width: 120px;" src="assets/images/designtool/sign/signature.png" />
             </div>
         <div class="edrag" id="acccsigndrag" [style.top.px]="mouseyposition+15" [style.left.px]="mousexposition+15">
          <img style="width: 120px;" src="assets/images/designtool/sign/accc_signature.png" />
             </div>
         <div class="edrag" id="acccinitdrag" [style.top.px]="mouseyposition+15" [style.left.px]="mousexposition+15">
          <img style="width: 120px;" src="assets/images/designtool/sign/initials.png" />
             </div>
         <div class="edrag" id="tabledrag" [style.top.px]="mouseyposition+15" [style.left.px]="mousexposition+15">
          <img style="width: 60px;" src="assets/svg/tabletool.svg" />
             </div>
             <div class="edrag" id="logodrag" [style.top.px]="mouseyposition+15" [style.left.px]="mousexposition+15">
              <img style="width: 60px;" [src]="activelogo" />
                 </div>
         <div class="edrag" id="rectangledrag" [style.top.px]="mouseyposition+15" [style.left.px]="mousexposition+15">
          <img style="width: 60px;" src="assets/svg/rectangle.svg" />
             </div>
             <div class="edrag" id="ellipsedrag" [style.top.px]="mouseyposition+15" [style.left.px]="mousexposition+15">
              <img style="width: 60px;" src="assets/svg/elli.svg" />
                 </div>
                 <div class="edrag" id="circledrag" [style.top.px]="mouseyposition+15" [style.left.px]="mousexposition+15">
                  <img style="width: 60px;" src="assets/svg/circle.svg" />
                     </div>
                     <div class="edrag" id="hlinedrag" [style.top.px]="mouseyposition+15" [style.left.px]="mousexposition+15">
                      <img style="width: 60px;" src="assets/svg/hline.svg" />
                         </div>
                         <div class="edrag" id="vlinedrag" [style.top.px]="mouseyposition+15" [style.left.px]="mousexposition+15">
                          <img style="width: 60px;" src="assets/svg/vline.svg" />
                             </div>
         <div class="edrag" id="imagevariabledrag" [style.top.px]="mouseyposition+15" [style.left.px]="mousexposition+15">
          <img style="width: 60px;" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGQAAABkCAIAAAD/gAIDAAAABmJLR0QA/wD/AP+gvaeTAAAGrElEQVR4nO2cwWvTUBjA39KaS5vulLSupqD1pojMHYQNPHjbmMPNUpx4EquCun9Ahnhd8WCmnhWr0zGl3fSgyAqDDcWyVWQbZNVqupXZg0gycKfn4WEYc+3yJVmTbu93ykvzvpf3472Xr6GvTRhjRDEG4/QNNBJUFgAqCwCVBYDKAkBlAaCyAFBZAKgsAFQWACoLAJUFgMoCQGUBoLIAUFkAqCwAVBYAr/UQiqKk0+nXr18Xi0VFUdbW1qzHtAWfzyeK4sGDB7u6unp6eg4cOGA1IrZAqVRKJBJerw3GdxqGYWKxWLFYtNJf87LS6TTHcQghlmXj8fizZ88WFxc1TbNyN/aiadri4uLTp0/j8TjLsgghjuMymYzpgCZl3bt3j2EYhFAsFvv69avp5utGoVDo6+sjQ0ySJHNBzMhKp9MMw3g8nrt375pr1SmSyaTH42EYxtz4AssqlUpk9m00tbq6euvWrePHj/t8PgcXpiNHjmx7/8lkEiEUCARWVlagfQfLunTpEpl9+pnR0VGe5wcGBj58+OCqNasavb29CKFEIgGtCJP148cPj8fDsqy+To2OjkYikXw+D23YQZaWlliW9Xq9pVIJVBEmS5IkhFA8HifF1dVVnucbyxQhFoshhO7fvw+qBcvg37x5gxDq6ekhRUmS+vv7jx07ZuvKUw9IF0h3jAOTVSgUEEInTpwgxfHx8f7+flAEl9DW1ob+dcc4TRjyKxqO4zRNU1XV7/eTYrlcJseNhaZpHMf5/X5VVY3XgslqampCCOlVmppg1V3Fpr4YobHfOszNzV24cCEcDrMsK4ri1atXi8XizjXXwLIeP37c2dnZ3t7+8ePHtbW1bDYbDodPnjz57t27nWoS9OzcVAVa3Uby+XwoFJJledP5mZmZYDBo5O2Cie436pp18eLFtra2gYGB/z+6c+dOuVx++PBh7Qgm1qxGHVktLS1fvnzZ8iNZliORyLYRTHS/UUcWy7K/fv3a8nv7+vp6c3Pznz9/akfYQ09DnuerPfgURQmFQjvRaKPKOn36dLWnXiqV6uzs3JFWQZN2UxVodRv5/Pnzlk/D6enpYDD4/fv3bSOY6T7satfIwhg/evQoFApJkqQoyvr6uizLt2/fDgaDb9++rVYlGo3qx3tLFsY4n8/rGXwkErl27VrtMbXp5l0nK5fLtbe3+3y+jo6OXC4Has52jh49qh+7Ttbk5KQgCCMjI5qmjYyMCIIwOTkJanHncJesqakpQRDev39f44yDuEgWGVP/j6Nq5+uDGxf42iPIwfHlugXeiAunfLlLlnELjvhykSzoemRx/TKRlLgldTDXc9O+rCcljsmyMqdM1LUlKXFGlvVsABTBSlLi8DS0a502GMdiUuLwAm9jhrnt0DAydmpf47Ase3PxGl01PlVrXOmi1MEWtpxK0Mle7frdJgv/11Vzy+KWtXahLLyhq/YmJbtTFv639NiblOxaWRjjbDZr/Wm70dduloUxnpqaCgaDFvM4fT7uclnY1vG1+2Vh+3ztCVnYpvm4V2RhO3ztIVnYsq+9JQtbe3dWV1lki5OqqnpRP64n5nz9/v07EAjoxwghvWgQ2E+O9u/fjxBaWVkhxWg0Oj8/D4pgCx0dHS9evDh//nw2mzVea35+/vDhw+S4XC4jhFpaWkDtwmRFo1GEUC6XI8Xu7u5UKgWKYBenTp16/vx5PB437iuVSnV3d5PjT58+oX/dAQAah8PDw2jDRqefP3/yPD83NwcKYiPGX3LNzs4KglCpVEiRbHR68OABqDmYLEVRvF4vy7KFQoGcGRsbE0XR5b5mZ2dFUXz16hUpyrJcjy10GOPLly8jhPr6+vQzY2NjPM/fuHFjZmbGkfW+mi9VVaenp69fvy4IwsuXL/XzZ8+eRQhduXIF2hBY1vLyMnkmJpNJ/WSlUhkcHGxtbXXVpieO41pbWwcHB/XZhzEeGhpCCDU3N5fL5R2XhTHOZDJkQ/lGXw3B0NAQ2VA+MTFhorrJrFKSJPJXBb29vUtLS+aC1BNZlsnsYxhmeHjYXBDzKfj4+HggEEAIsSwbi8VSqdTCwoIja1Y1VFVdWFh48uTJuXPn9u3bR2afuTFFsPR9pVKp3Lx5syH+XsXr9SYSCRN/T7ARG/aTLC8vZzKZiYmJb9++KYqiaZot3bOO3+8XRfHQoUNdXV1nzpwJh8MWAzbwVtT606jbURyBygJAZQGgsgBQWQCoLABUFgAqCwCVBYDKAkBlAaCyAFBZAKgsAFQWACoLAJUFgMoC8BfcAuDWBZqA4gAAAABJRU5ErkJggg==" />
             </div>
    <div class="edrag" id="esignaturedrag" [style.top.px]="mouseyposition+15" [style.left.px]="mousexposition+15">
  <img src="assets/images/designtool/sign/esignature.png" />
     </div>
     <div class="edrag" id="einitialdrag" [style.top.px]="mouseyposition+15" [style.left.px]="mousexposition+15">
      <img src="assets/images/designtool/sign/einitial.png" />
         </div>
     <div class="edrag" id="estampdrag" [style.top.px]="mouseyposition+15" [style.left.px]="mousexposition+15">
      <img src="assets/images/designtool/sign/rubber_stamp.png" />
      
  </div>
  <div class="edrag" id="echeckbox" [style.top.px]="mouseyposition+15" [style.left.px]="mousexposition+15">
  <img style="width: 24px;" src="./assets/images/designtool/sign/checkbox.png" />
  </div>
  <div class="edrag" id="everified" [style.top.px]="mouseyposition+15" [style.left.px]="mousexposition+15">
   <img style="width: 24px;" src="./assets/images/designtool/sign/verified.png" />
  
         </div>
     <div class="edrag" id="datesigneddrag" [style.top.px]="mouseyposition+15" [style.left.px]="mousexposition+15">
     <span>{{todaydate}}</span>
         </div>
  </div>
</body>

<ng-template #hyperlink>
  <div class="db container popupbg">
    <div class="db modal-header">
      <h5 class="db heading-3">Hyperlink</h5>
    </div>
      <div class="db content" style="margin: 10px auto;">
        <div class="db form-wrapper" style="width: 100% !important;">
          <div class="db form-group">
            <label class="db form-label">URL</label>
            <input type="text" class="db form-control" style="width: 100% !important;" [(ngModel)]="activehurl">
          </div>
          <div class="db form-group" class="db mt-20">
            <button type="button" class="db btn save_btn" style="margin-right: 10px;    background-color: #6EACAF !important;
            border-color: #6EACAF !important;"
              (click)="sethyperlink()">Done</button>
            <button type="button" class="db btn cancel_btn" (click)="closexml();activehurl=''">Cancel</button>
          </div>
        </div>
      </div>
  </div>
</ng-template>
<div class="modal wholepopup fade bd-example-modal-lg" id="displayimgmodal" style="top: 100px;">
  <div class="modal-dialog modal-lg">
      <div class="modal-content">
          <div class="modal-header">
              My Images
              <button type="button" class="close" data-dismiss="modal">&times;</button>
          </div>
          <div class="form-group" id="displayuserimages" style="background-color: white !important;"></div>
      </div>
  </div>
</div>

<div class="modal wholepopup fade bd-example-modal-lg" id="searchpixabaymodal" style="top: 100px;">
  <div class="modal-dialog modal-lg">
      <div class="modal-content">
          <div class="modal-header">
              Pixabay Images
              <button type="button" class="close" data-dismiss="modal">&times;</button>
          </div>
         <form class="form-inline searchForm" style="background: white;">
              <input class="form-control mr-sm-2" type="search" placeholder="Search" aria-label="Search" name="pixabayimage" id="pixabayimage" (keyup.enter)="searchpixabayimg()">
              <button class="btnSearch" type="submit" (click)="searchpixabayimg()"><i class="fa fa-search"></i></button>
          </form>
          <div class="" id="pixabayimg" style="height: 400px!important;overflow: auto;    background: white;">
              <ul class="imagesList" id="pixabaysection">
              </ul>
          </div>
      </div>
  </div>
</div>


ts
import { Component, OnInit, Renderer2, TemplateRef, ViewChild, ElementRef, Output, HostListener, EventEmitter, Input, Console } from '@angular/core';
import { Router, ActivatedRoute, NavigationExtras } from '@angular/router';
import { UserService } from '../../../shared/services/user.service';
import { BsModalService } from 'ngx-bootstrap/modal';
import { BsModalRef } from 'ngx-bootstrap/modal/bs-modal-ref.service';
import { DomSanitizer } from '@angular/platform-browser';
import { Http,Headers} from '@angular/http';
import { ToastrService } from 'ngx-toastr';
import { CreateUtils } from '../create.utils';
import { SignaturePad } from 'ngx-signaturepad/signature-pad'
import {formatDate} from '@angular/common';
import 'jquery-ui-dist/jquery-ui';
import "fabric";
import { Chart } from 'chart.js';
import PSD from 'psd.js/dist/psd.min';
declare var pdfjsLib: any;
import * as fileSaver from 'file-saver';
import 'fabric-history';
import 'ruler.js';
import { from, Observable, Subscription } from 'rxjs';
import { wrapIntoObservable } from '@angular/router/src/utils/collection';
import * as _ from 'lodash';
import { environment } from '../../../../environments/environment';
import { map } from 'rxjs/operators';
import { NgIdleKeepaliveModule } from '@ng-idle/keepalive';
import { compileNgModule } from '@angular/core/src/render3/jit/module';
import { DomAdapter } from '@angular/platform-browser/src/dom/dom_adapter';
import { CdkDragDrop, moveItemInArray, transferArrayItem } from '@angular/cdk/drag-drop';
import { style } from '@angular/animations';
import { ModalDirective } from 'ngx-bootstrap/modal';
import { Idle, DEFAULT_INTERRUPTSOURCES } from '@ng-idle/core';
import { Keepalive } from '@ng-idle/keepalive';
import { CallserviceService } from 'src/app/shared/callservice.service';
import { ISubscription } from "rxjs/Subscription";
import {DataService} from '../data.service';
import html2canvas from 'html2canvas';
 declare const fabric: any;
declare var $: any;
declare var WebFont: any;
declare const ruler: any;
@Component({
  selector: 'app-designbuilder',
  templateUrl: './designbuilder.component.html',
  styleUrls: ['./designbuilder.component.scss']
})
export class DesignbuilderComponent implements OnInit {
  @ViewChild(SignaturePad) public signaturePad: SignaturePad; 
  @ViewChild('esignconfig') esignconfig: TemplateRef<any>;
 public signaturePadOptions: Object = { // passed through to szimek/signature_pad constructor
   'minWidth': 5,
   'canvasWidth': 430,
   'canvasHeight': 100
 };
  dashboardmenu:boolean=false;
  @ViewChild('fileSelect') fileSelects: ElementRef;
  @ViewChild('pdfdownload') pdfdownload: TemplateRef<any>;
  modalRef: BsModalRef;
  model = { option: 'fixed' };
  todaydate:any=formatDate(new Date(), 'MM/dd/yyyy', 'en');
  createpgname:any="new_page";
  barcodetypes: Array<string>;
  updateValue: boolean;
  isAdmin:boolean=true;
  zoomsize=1;
  stampimgpreview: any="";
  sfname:any="";
 sfinitial:any="";
 stampdefname: any="";
 stampdformat: any='';
 hoveredtext: any="";
 private pixabayquery: any = 'hospital';
   textdirection: string="";
   activecstamp: any="";
     stampimg: any=null;
  headertrue: boolean=false;
  footertrue: boolean=false;
  savestateaction: boolean = true;
  selectedCountry: string;
  getitems: any;
  epreviewsign: any='';
  esignupimg: any=null;
@ViewChild('initials') initials: ElementRef;
@ViewChild('fname') fname: ElementRef;
@ViewChild("output") output: ElementRef;
@ViewChild("stamplogo1") stamplogo1: ElementRef;
@ViewChild("stamplogo2") stamplogo2: ElementRef;
@ViewChild("stamplogo3") stamplogo3: ElementRef;
@ViewChild("stamplogo4") stamplogo4: ElementRef;
@ViewChild("stamplogo5") stamplogo5: ElementRef;
@ViewChild("imgvar") imgvar: ElementRef;
  galleryvalue:any="";
  searchText;
  mousexposition: any=0;
  mouseyposition: any=0;
  commentdisplaystatus: boolean=true;
  activeCustomers = [
    'John',
    'Watson'
  ];
  objProps = new Map < string,
  any > ();
  objPropKeys: Array < string > = ['canvasFill', 'canvasImage', 'id', 'hue', 'contrast', 'sharpen', 'blurimg', 'brightness', 'saturation', 'opacity', 'fill', 'fontSize', 'lineHeight', 'charSpacing', 'setrotate', 'fontWeight', 'fontStyle', 'textAlign', 'fontFamily', 'strokeWidth', 'TextDecoration', 'strokeDash', 'strokeGap', 'zoomPercent', 'textoffsetX', 'textBrightness', 'catg', 'catgname'];
  sizetype: string='px';
  mstatus0: any="none";
  mcsetting: boolean=false;
  mcleft:any=0;
  mcright:any=0;
  mctop:any=0;
  mcbottom:any=0;
  sizewhtype: string='px';
  sizexytype: string='px';
  zoomMax: number = 23;
  SCALE_FACTOR = 1.2;
  showcolumnwidth: boolean=false;
  showpagecontextmenu: boolean=false;
  fileContent: any;
  selectedRow: any;
  dictcategory: any;
  base64File: string = null;
  filename: string = null;
  api_url: any = environment.swagss;
  isCollapsed: boolean = true;
 // sizetype="px";
  sizetypes=[
    {'type':'in'},
    {'type':'pt'},
    {'type':'px'},
    {'type':'cm'}
  ]
  public canvas: any;
  public props: any = {
    canvasFill: '#ffffff',
    canvasImage: '',
    id: null,
    opacity: null,
    fill: null,
    fontSize: null,
    lineHeight: null,
    charSpacing: null,
    fontWeight: null,
    fontStyle: null,
    textAlign: null,
    fontFamily: null,
    TextDecoration: '',
    strokeWidth: 0,
    stroke: null
  };
  @ViewChild('templateTableProperties') tempTableProperties: TemplateRef<any>;
  @ViewChild('templateAddcolum') tempAddcolumRef: TemplateRef<any>;
  @ViewChild('templateAddrow') tempAddrowRef: TemplateRef<any>;
 
  // constructor(private dialog: MatDialog) { }
  naviDate: any;
  downloadType0="PDF Template";
  subscription: Subscription;
  subscription1: ISubscription
  layers: any;
  layers0: any;
  letters: any;
  newstyle: any;
  layers1: any;
  filedata: string | ArrayBuffer;
  arr: any;
  tmparr: { id: number; values: any; }[];
  objstyle: any;
  layer3=[];
  currentfolder: any;
  openModal0: boolean = false;
  showerror: boolean = false;
  objectnames: any;
  showcontextmenu: boolean = false;
  myStyles: any;
  signaturepopup: boolean = false;
  signaturepopuptwo: boolean = false;
  isChecked: boolean = false;
  signatureitems: any;
  myHtml: any;
  myHtml1: any;
  rulexmlitems: string;
  rulexmlslabel: string;
  rulexmlstextvariable: string;
  rulexmlrect: string;
  rulexmlcircle: string;
  rulexmllines: string;
  rulexmlimage: string;
  rulexmlslabelvariable: string;
  rulexmlslabelvariable0: string;
  datadictionaryjson: string;
  nondatadictionaryjson: string;
  pages: string;
  savedrulexml: any;
  rulexmlflowpara: string;
  viewjson: any;
  viewsignaturejson: any;
  savedsignjson: any;
  rulexmlvar: string;
  rulebarcode: string;
  lt: any;
  ln: any;
  barcodemsg1: any;
  barcodemsg: any;
  menufile: boolean=false;
  menuedit: boolean=false;
  menuview: boolean=false;
  tmpselect="Show Variable Field";
  imgsrc: any;
  docname: any;
  pgsizetype: boolean=true;
  createpgheight=1056;
  createpgwidth=816;
  viewTableDataJsonsingle:any;
  viewTableDataJson=[];
  columndata: {};
  columns: {};
  newpagename: any;
  templateid: any;
  viewstaticTableDataJson=[];
  viewstaticTableDataJsonsingle: any;
  tblcolumndata: {};
  columndynamicdata={};
  tblcolumns={};
  signature_first_popup: boolean = false;
  layer4: any[];
  currelatedobj: any;
  h=[];
  isRedoing: boolean=false;
  currenttmpwidth: number=816;
  currenttmpheight: number=1056;
  columnwidth: number=90;
  imgsrc1: any;
  showsignaturecontextmenu: boolean=false;
  selectedsignature: any;
  signaturechangebtn="Create";
  selectedsignature_id: any="";
  selectedsignature_name: any="";
  showleftsidepanel: boolean=false;
  showrightsidepanel: boolean=false;
  textdiv: boolean=false;
  shapesdiv: boolean=false;
  signaturediv: boolean=false;
  dropdownmenus: boolean=false;
  pdfmenus: boolean=false;
  searchlistdata: any;
  docnamenew: any;
  showrightsidepanel0: boolean=false;
  textsrc: string='./assets/svg/typetool.svg';
  imagesrc: string='./assets/svg/imagetool.svg';
  tablesrc: string='./assets/svg/tabletool.svg';    
  previewicon: string='./assets/svg/preview-icon.svg';    
  pdfdownloadimage: string='./assets/svg/pdf-download.svg'; 

  shareicon: string='./assets/svg/share-icon.svg';  
  signaturesrc: string='./assets/svg/sign_tool.svg';  
  shapessrc: string='./assets/svg/square.svg';  
  shorttextsrc: string='./assets/svg/small_text.svg';  
  labelsrc: string='./assets/svg/label.svg';  
  longtextsrc: string='./assets/svg/long_text.svg';  
  rectsrc: string='./assets/svg/rectangle.svg';  
  circlesrc: string='./assets/svg/circle.svg';  
  ellipsesrc: string='./assets/svg/elli.svg';  
  vlinesrc: string='./assets/svg/vline.svg';  
  hlinesrc: string='./assets/svg/hline.svg';  
  fontsizearray=[];
  objposition: any='order';
  documentname: any;
  createtoolkit={};
  generaldata: any;
  personaldata: any;
  showcontextmenugp: boolean=false;
  pagediv: boolean;
  bgstyle: any;
  showrightsidecomments0: boolean=false;
  overallcomments: any;
  comments: any=[];
  activerplycommentid: any;
  showreplydetaildiv: boolean=false;
  showreplytxt: boolean=false;
  activepin: any;
  userid: any;
  reply_flag: any;
  showhfsection: boolean=false;
  activehfheight: any=30;
  headerheight: any;
  footerheight: any;
  idleState: any='Not started.';
  timedOut: boolean=false;
  lastPing?: Date = null;
  title = 'angular-idle-timeout';
  isRun = false; 
  @ViewChild('cancel0', {}) cancel0: ModalDirective;
  showmarginoption: boolean=false;
  marginstatus: boolean=false;
  olddata: any;
  sessionrole: string;
  operationMessage: any;
  pdfurl: any;
  filename1: string="";
  activesignature: any;
  selectedsignid: any;
  activehurl: any;
  panelOpen: string = '';
  dragacbjtect: string="";
  esignatureconfiginfo: any;
  isDown: boolean = false;
  showcontentupdatepopup: boolean=false;
  private headers = new Headers({
    'Content-Type': 'application/json'
});
  duplicateremove: boolean;
  photoORbg: boolean=false;
  videos: any = [];
  origvideos: any = [];
  activelogo: any;
  userName: any= 'guest';
  loadedtemplateid: number;
  bgimages: any[];
  origbgimages: any[];
  elementcount: any;
  public pagenumber: number = 1;
  public per_page: number = 30;
  env = {
    production: false,
    
   API_URL: '',
   SERVER_URL: '',
   baseUrl: '',  
  assetUrl: '',  

   // API_URL: 'https://strapi.graphicsfactory.com/',
    //SERVER_URL: 'https://www.graphicsfactory.com/editor/',
   // baseUrl: 'https://strapi.graphicsfactory.com',  
   // assetUrl: 'https://strapi.graphicsfactory.com',
    //baseUrl: 'http://localhost:4200', //add  proxy in package.json "start": "ng serve --proxy-config proxy.js",
    //assetUrl: 'http://localhost:4200/',
    }
    private gfquery: any = 'nature';
    public gfpagenumber: number = 1;
    f = fabric.Image.filters;
    public offsetX: any;
    public offsetY: any;
  public glowcolor: any;public blur: any;
  scale: any=1;
  ctype: string;
  importtype: boolean=false;
  folderpathpdf: any=null;
  pdfurls: any;
  canvasarray:any[];
  @HostListener('document:click', ['$event'])
  clickout(event) {
    if(event.target.innerHTML=="File" || event.target.innerHTML=="Edit" || event.target.innerHTML=="View") {
    //  console.log("clicked inside");
    } else {
  this.menufile=false;
  this.menuedit=false;
  this.menuview=false;
    }
    if(event.path && (event.path[0].className!="ecstructure" && event.path[2].className!="ecstructure" && event.path[0].id!="addtext04")){
      $(".drag_box .edrag").css("display","none");
      this.dragacbjtect="";
    }
    if(this.editable && event.target.classList.length>0 && event.target.classList[1]!="selected"){
      //this.showrightsidepanel='0';
      setTimeout(() => {
        var mstatus= $('.bhoechie-tab-content').hasClass('show');
        if(this.panelOpen!=""){
        this.mstatus0 = $("."+this.panelOpen).css('display');
        }else{
          this.mstatus0="none"
        }
        if(event.target.className=="menutoggle"){
          this.mstatus0="none"
        }
        if(mstatus==false && this.mstatus0=="none"){
          $(".structuredocsec .card-body").css('margin-left','auto');
        }
      }, 100);
      this.removedropdown('fontfamilydiv','fontfamilyselected')
      this.removedropdown('fontsizediv','fontsizeselected')
      this.removedropdown('template','templateselected')
      this.removedropdown('whchangediv','whchangeselected')
      this.removedropdown('xychangediv','xychangeselected')
      this.removedropdown('angledivs','angleselecteds')
      this.removedropdown('objpositiondivs','objpositionselecteds')
      this.removedropdown('whchangedivs','whchangeselecteds')
      this.removedropdown('xychangedivs','xychangeselecteds')
      this.removedropdown('anglediv','angleselected')
      this.removedropdown('objpositiondiv','objpositionselected')
    }
    if(event.path[3].className && event.path[3].className!="db air__subbar__breadcrumb dashboardicon"){
      this.dashboardmenu=false;  }
  }
  @HostListener('document:mousemove', ['$event']) 
  onMouseMove(e) {
    this.mousexposition=e.clientX;
    this.mouseyposition=e.clientY;
  }
  @HostListener("window:scroll", [])
  onWindowScroll(event) {
    if(window.pageYOffset==0){
      $('.air__sidebar').css("top","75px");
      $('.air__sidebarl').css("top","75px");
    }
    else{
      $('.air__sidebar').css("top","0px");
    $('.air__sidebarl').css("top","0px");
    }
  }
  
  constructor(private http: Http,private callservice: CallserviceService,private idle: Idle, private keepalive: Keepalive,private router: Router, private renderer: Renderer2, private userService: UserService, private modalService: BsModalService,
    private sanitizer: DomSanitizer,private dataService: DataService, private route: ActivatedRoute, private toast: ToastrService, private eRef: ElementRef) {
      this.subscription1=this.callservice.componentMothodcalled1$.subscribe(
        ()=> {
         this.btnSaveJsonClick();
        }
      )
      this.subscription = this.userService.navItem$
      .subscribe(item => {
        this.naviDate = item
        if (item)
          localStorage.setItem("localData", JSON.stringify(this.naviDate));
      }
      )
    this.barcodetypes = ['fixed', 'variable'];
  }
  pgRuler: any;
  chRuler: any;
 
  public textString: string;
  public selectedObj: any = {
    width: 0,
    height: 0,
    translateX: 0,
    translateY: 0
  };
  public selectedItem: string;
  formid: any;
  designid: any;
  param: any;
 
  public selectedProperty: any = {
    textAlign: 'left',
    fontWeight: 300,
    fontStyle: null,
    underline: null,
    overline: null,
    fontFamily: 'Helvetica',
    fontSize: 16,
    lineHeight: null,
    charSpacing: null,
    opacity: 0,
    fill: null,
    strokeWidth: 0,
    stroke: null,
    pageFill: null
  };
  private fbcSizeObj: any = {
    width: 816,
    height: 1056
  }
  dataVariable: any = []
  tableView: any = 'Grid'
  customCollapsedHeight: string = '39px';
  customExpandedHeight: string = '39px';
  customaccordianCollapsedHeight: string = '50px';
  showrightsidecomments:boolean = false
  rightsidecomments(){
    this.showrightsidecomments=!this.showrightsidecomments;
 }
  @HostListener('window:keydown', ['$event'])
  handleKeyDown(e: KeyboardEvent) {
    if (!this.editable) { return }
    switch (e.keyCode) {
      case 82: /* Ruler */
        if (e.altKey) {
          this.btnToggleRuler()
        }
        break;
      case 90: /* Undo */
        if (e.ctrlKey && !this.selectedObj.canvas.getActiveObject().isEditing) {
          this.btnUndoClick()
        }
        if (e.ctrlKey) {
          this.btnZoomResetClick()
        }
        break;
      case 89: /* Redo */
        if (e.ctrlKey && !this.selectedObj.canvas.getActiveObject().isEditing) {
          this.btnRedoClick()
        }
        break;
      case 107: /* Zoom In */
        if (e.ctrlKey) {
          this.btnZoomInClick()
        }
        break;
      case 187: /* Zoom In */
        if (e.ctrlKey && e.shiftKey) {
          this.btnZoomInClick()
        }
        break;
      case 109: /* Zoom Out */
      case 189: /* Zoom Out */
        if (e.ctrlKey) {
          this.btnzoom()
        }
        break;
      case 48: /* Zoom Reset */
        if (e.ctrlKey) {
          this.btnZoomResetClick()
        }
        break;
      case 38:  /* Up arrow */
      if (this.selectedObj.canvas.getActiveObject() && this.selectedItem != 'empty' && !this.selectedObj.canvas.getActiveObject().isEditing) {
        this.selectedObj.canvas.getActiveObject().top -= 5;
        this.selectedObj.canvas.renderAll();
      }
        break;
      case 40:  /* Down arrow  */
      if (this.selectedObj.canvas){
        if (this.selectedObj.canvas.getActiveObject() && this.selectedItem != 'empty' && !this.selectedObj.canvas.getActiveObject().isEditing) {
          this.selectedObj.canvas.getActiveObject().top += 5;
          this.selectedObj.canvas.renderAll();
        }}
        break;
      case 37:  /* Left arrow  */
        if (this.selectedObj.canvas.getActiveObject() && this.selectedItem != 'empty' && !this.selectedObj.canvas.getActiveObject().isEditing) {
          this.selectedObj.canvas.getActiveObject().left -= 5;
          this.selectedObj.canvas.renderAll();
        }
        break;
      case 39:  /* Right arrow  */
        if (this.selectedObj.canvas.getActiveObject() && this.selectedItem != 'empty' && !this.selectedObj.canvas.getActiveObject().isEditing) {
          this.selectedObj.canvas.getActiveObject().left += 5;
          this.selectedObj.canvas.renderAll();
        }
        break;
        case 13:  /* Enter  */
        if (this.selectedObj.canvas.getActiveObject() && this.selectedObj.objtype!="flowpara" && this.selectedItem != 'empty' && this.selectedObj.canvas.getActiveObject().isEditing) {
         return false
        }
        break;
     case 46:  /* delete */
      if(this.selectedObj.objtype=="header" || this.selectedObj.objtype=="footer"){
        this.headertrue=false;  
        this.footertrue=false;  
        }  
      if (this.selectedObj.canvas.getActiveObject() && this.selectedItem != 'empty' && !this.selectedObj.canvas.getActiveObject().isEditing) {
          this.btnSelObjDel();
        }
        break;

    }
  }
  state$: Observable<object>;
  editable: boolean;
  ngAfterViewInit() {
    // this.signaturePad is now available
    this.signaturePad.set('minWidth', 5); // set szimek/signature_pad options at runtime
    this.signaturePad.clear(); // invoke functions from szimek/signature_pad API
  }
  ngOnInit() {
    for(var z=7;z<=100;z++){
      this.fontsizearray.push(z);
    }
    this.userService.getallcount().subscribe(data => {
      this.operationMessage = data.overallinbox;
    }) 
    this.getFonts();
    this.getTexts();
    this.backgroundcolor();
    this.strokecolorSpectrum();
   //this.loaduserimages();
    this.gettoolkitdata();
    this.getUserTemplates();
    this.getTemplates();
    this.getTempCategory();
  //  this.getImageCategory();
    this.getTempSizes();
    this.getBGImageCategory();
    this.getVideos();
    this.getBgimages();    
    this.colorbgSpectrum();
    this.searchgflib();
     this.gettoolkitdata();
    this.modalService.onHide
      .subscribe(() => {
        $("#frmaddColumn").trigger("reset");
      });
    this.userService.searchlistdata().subscribe(data => {
      this.searchlistdata=data;
    });
    this.sessionrole = localStorage.getItem("role");
    this.userid = localStorage.getItem("userid");
    if (!this.naviDate)
      this.naviDate = JSON.parse(localStorage.getItem("localData"));
    $("div.bhoechie-tab-menu>div.list-group>a").click(function Layout(e) {
      $(this).siblings('a.active').removeClass("active");
      $(this).addClass("active");
      var index = $(this).index();
      $("div.bhoechie-tab>div.bhoechie-tab-content").removeClass("active");
      $("div.bhoechie-tab>div.bhoechie-tab-content").eq(index).addClass("active");
 
    });
 
    this.selectedItem = "empty";
    this.designid = this.naviDate.designid
if(this.naviDate.routerpage != 'Submitted' && this.naviDate.routerpage != 'Approved'){
    this.editable = true;
  }else{
    this.editable = false;
  }
  if(this.editable===false){
  this.tmpselect="Sample Data";
  this.bgstyle={
    ['background-color']: '#333333'
  };
  this.btnPreviewClick();
}else{
  this.tmpselect="Show Variable Field";
  this.bgstyle={
    ['background-color']: '#dce6e8'
  };
}
 this.editform();
    this.getLogoList();
    this.getsignatureList();
    this.getotherImageList();
    this.getdocumentcategory();
    this.getdataxml();
    var designid ={
      "designproductid":this.naviDate.designid
    }
    this.userService.getoverallcomments(designid).subscribe(data => {
      this.overallcomments=data;
    });
    setTimeout(() => {
      this.renderLayers();
    //  this.Templateactions(this.tmpselect);
    this.selectedItem="empty";
   /* var canvas=this.tempobj;
    this.layers.filter(x => {
      if(x.objtype=="header" || x.objtype=="footer"){
        var obj = x;
          obj.set('visible', false);
          canvas.discardActiveObject().renderAll();
          if (this.seletecdPg > 0) {
            var innPgCanvas = this.arrPageCanvas[this.seletecdPg - 1];
            innPgCanvas.renderAll();
          }
      }
    });*/
    }, 1000);
  }
  reset() {
    this.idle.watch();
    //xthis.idleState = 'Started.';
    this.timedOut = false;
  }
  checkheaderfooteritems(){
    var canvas = this.tempobj;
    var innPgCanvas = this.arrPageCanvas[this.seletecdPg - 1];
    this.layers.filter(x => {
      if(x.objtype=="header"){
this.headerheight=x.height;
      }
      var obj = x;
      if(this.headerheight!=0 && x.objtype!="header" && x.objtype!="footer" && this.headerheight>x.top){
        obj.set('shadow', 'headeritem');
        canvas.discardActiveObject().renderAll();
        if (this.seletecdPg > 0) {
          innPgCanvas.renderAll();
        }
      }else{
        obj.set('shadow', null);
        canvas.discardActiveObject().renderAll();
        if (this.seletecdPg > 0) {
          innPgCanvas.renderAll();
        }
      }
      if(x.objtype=="footer"){
        this.footerheight=x.top;
              }
      if(this.footerheight!=0 && x.objtype!="footer" && x.objtype!="header" && this.footerheight<x.top){
        obj.set('shadow', 'footeritem');
        canvas.discardActiveObject().renderAll();
        if (this.seletecdPg > 0) {
          innPgCanvas.renderAll();
        }
      }
    });
  }
  uploadlogo1() {
    var data = this.pdfurl;
    var str = "";
    var innPgCanvas = this.arrPageCanvas[this.seletecdPg - 1];
    fabric.Image.fromURL(data, (image) => {
      image.set({
        left: 0,
        top: 0,
        angle: 0,
        cornersize: 4,
        hasRotatingPoint: true,
        lockMovementX: false,
        lockMovementY: false,
        peloas: 12,
        width: 1024,
        hasControls: false,
        height: image.height,
        tmp_width: image.width,
        tmp_height: image.height,
        objtype: 'logo',
  src1: str,
  id: this.randomId()
        // fixedWidth: 150,
      }).scale(0.9);
      image.setControlsVisibility({
        bl: true,
        br: true,
        tl: true,
        tr: true,
        mt: true,
        mb: true,
        mtr: false,
        mr: true,
        ml: true
      });
      this.extendlogo(image, image.id, image.objtype, image.src1, image.tmp_width, image.tmp_height);
      innPgCanvas.add(image);
    innPgCanvas.setActiveObject(image).renderAll();
    var canvas = this.tempobj;
    canvas.sendToBack(image);
    this.renderLayers();
     });
     this.emptycontrols();
     this.gettimefun();
  }
  getFullYear() {
    return new Date().getFullYear();
  }
  addheader(val){
    var canvas = this.tempobj;
    var innPgCanvas = this.arrPageCanvas[this.seletecdPg - 1];
    var obj:any;
    this.layers.filter(x => {
      if(x.objtype=="header" && val=="header"){
        obj = x;
          obj.set('visible', true);
          canvas.discardActiveObject().renderAll();
          if (this.seletecdPg > 0) {
            innPgCanvas.renderAll();
          }
          this.headertrue=true;
      }
      if(x.objtype=="footer" && val=="header"){
        obj = x;
          obj.set('visible', true);
          canvas.discardActiveObject().renderAll();
          if (this.seletecdPg > 0) {
            innPgCanvas.renderAll();
          }
          this.footertrue=true;
      }
    });
    if(val=="header"){
    if(this.headertrue===false){
    this.headertrue=true;
    let add = new fabric.Rect({
      width: 810, height: 100, left: 0, top: 0, angle: 0,lockMovementX:false,lockMovementY:false,
      fill: '#ff572240', stroke: '#ff5722', allpage:false,curpageid:0, text: "header", objtype: 'header', strokeWidth: 1, rx: 0, ry: 0
    });
    if (add) {
      this.extend0hf(add, this.randomId(), add.objtype, add.text,add.allpage,add.curpageid);
      innPgCanvas.add(add);
//      this.activehfheight=add.height-50;
      canvas.sendBackwards(add);
      this.emptycontrols();
      innPgCanvas.setActiveObject(add).renderAll();
      this.renderLayers();
    }
  }
}else{
  if(this.footertrue===false){
    this.footertrue=true;
    let add = new fabric.Rect({
      width: 810, height: 100, left: 0, top: 950, angle: 0,lockMovementX:false,lockMovementY:false,
      fill: '#ffc10745', stroke: '#ffc107', allpage:false,curpageid:0, text: "footer", objtype: 'footer', strokeWidth: 1, rx: 0, ry: 0
    });
    if (add) {
      this.extend0hf(add, this.randomId(), add.objtype, add.text,add.allpage,add.curpageid);
      innPgCanvas.add(add);
//      this.activehfheight=add.height-50;
      canvas.sendBackwards(add);
      this.emptycontrols();
      innPgCanvas.setActiveObject(add).renderAll();
      this.renderLayers();
    }
  }
}
  }
  hideheader(){
   this.layers.filter(x => {
      if(x.objtype=="header"){
      var canvas = this.tempobj;
    var obj = x;
      obj.set('visible', false);
      canvas.discardActiveObject().renderAll();
      if (this.seletecdPg > 0) {
        var innPgCanvas = this.arrPageCanvas[this.seletecdPg - 1];
       innPgCanvas.renderAll();
      }
    }
    });
    this.checkheaderfooteritems();
    this.headertrue=false;
  }
  hidefooter(){
    var canvas = this.tempobj; 
    var obj: any;
   this.layers.filter(x => {
      if(x.objtype=="footer"){
     obj = x;
      obj.set('visible', false);
      canvas.discardActiveObject().renderAll();
      if (this.seletecdPg > 0) {
        var innPgCanvas = this.arrPageCanvas[this.seletecdPg - 1];
        innPgCanvas.renderAll();
      }
    }
    });
    this.checkheaderfooteritems();
    this.footertrue=false;
  }
  closehfpopup(){
    this.showhfsection=false;
  }
  addNewPage1(viewport) {
    this.userService.designaddpage(this.naviDate.designid, this.arrTemplateList.length + 1, this.createpgname,viewport.width,viewport.height).subscribe(data => {
    // console.log("addpage", data)
      var newPage = {
        "templateid": data.templateid,
        "name": data.name,
        "width": data.templatejson[1].page.width,
        "height": data.templatejson[1].page.height,
        "sequenceno": data.sequenceno,
        "designitem_fk": data.designitem_fk
      }
      let pNum: number = 1;
      for (var inItem in this.arrTemplateList) {
        pNum++;
      }
      this.arrTemplateList.push(newPage);
      this.currPage = this.arrTemplateList.length;
      this.fbPageCanvas.loadFromJSON(data.templatejson, this.fbPageCanvas.renderAll.bind(this.fbPageCanvas), function (o, object) {
        fabric.log(o, object);
      })
    this.tempobj.setWidth(viewport.width);
    this.tempobj.setHeight(viewport.height);
    this.currenttmpwidth=viewport.width;  
    this.currenttmpheight=viewport.height;  
      var dataURL = this.fbPageCanvas.toDataURL({
        format: 'jpeg',
        quality: 0.8
      });
      // console.log('base644',dataURL)
      this.getFCVmodified(this.fbPageCanvas);
    }, error => {
      alert("Failed to add page, Please try again later...")
    });
  }
  addline(styles,lineval){
    var innPgCanvas = this.arrPageCanvas[this.seletecdPg - 1];
   var sposition: any;
  sposition=styles[0].value.split(" ");
  //console.log(sposition[4])
  var topc=792-sposition[2];
   var topc1=792-sposition[5];
  //var elementstyle = styles[0].value.replaceAll(sposition[2], topc);
  //console.log(elementstyle)
  
  var scaleX = 1;
  var scaleY = 1;
  var left = Math.round(sposition[1]);
  var top =Math.round(topc);
  
  var tempScaleX = scaleX * this.scale;
  var tempScaleY = scaleY * this.scale;
  var tempLeft = left * this.scale;
  var tempTop = top * this.scale;
  
   /*let add = new fabric.Line([Math.round(sposition[1]), Math.round(topc), sposition[4], Math.round(topc1)], ({
      left: Math.round(tempLeft), top: Math.round(tempTop), fill: '#000000', stroke: '#000000', objtype: 'lines', strokeWidth: 1, text: "lines", angle: 0, "scaleX": tempScaleX, "scaleY": tempScaleY
    }));*/
    //console.log(add)  
    let add =new fabric.Path(styles[0].value);
    add.set({ fill: 'transparent', stroke: '#000000', angle: 0, objtype: 'lines', left: Math.round(tempLeft), top: Math.round(tempTop)+12, "scaleX": tempScaleX, "scaleY": tempScaleY, 
    text: 'lines' });
    /*
    new fabric.Path('path', {
      strokeLineCap: styles[0].value,
      objtype: 'lines',
      text: 'lines'
   });*/
    if (add) {
     //add.width=Math.round(add.width)
      this.extend0(add, this.randomId(), add.objtype, add.text);
      innPgCanvas.add(add);
      innPgCanvas.bringToFront(add);
      //var canvas = this.tempobj;
      //canvas.sendBackwards(add);
      this.emptycontrols();
      innPgCanvas.setActiveObject(add).renderAll();
      this.renderLayers();
    }
  }
  saveval(val){
    this.selectedObj.set('text', val);
    if (this.seletecdPg > 0) {
      var innPgCanvas = this.arrPageCanvas[this.seletecdPg - 1];
      innPgCanvas.renderAll();
      this.renderLayers();
    }
    this.showcontentupdatepopup=false;
  }
  openCity(evt, cityName) {
    var i, tabcontent, tablinks;
    tabcontent = document.getElementsByClassName("tabcontent");
    for (i = 0; i < tabcontent.length; i++) {
      tabcontent[i].style.display = "none";
    }
    tablinks = document.getElementsByClassName("tablinks");
    for (i = 0; i < tablinks.length; i++) {
      tablinks[i].className = tablinks[i].className.replace(" active", "");
    }
    document.getElementById(cityName).style.display = "block";
    evt.currentTarget.className += " active";
  }
  openCity1(evt, cityName) {
    var i, tabcontent, tablinks;
    tabcontent = document.getElementsByClassName("tabcontent1");
    for (i = 0; i < tabcontent.length; i++) {
      tabcontent[i].style.display = "none";
    }
    tablinks = document.getElementsByClassName("tablinks1");
    for (i = 0; i < tablinks.length; i++) {
      tablinks[i].className = tablinks[i].className.replace(" active", "");
    }
    document.getElementById(cityName).style.display = "block";
    evt.currentTarget.className += " active";
  }
  uploadesignature(event){
    let me=this;
     let file = event.target.files[0];
     let reader = new FileReader();
     reader.readAsDataURL(file);
     reader.onload = function () {
   me.epreviewsign=reader.result;
      // console.log(reader.result);
     };
     reader.onerror = function (error) {
      me.epreviewsign="";
       console.log('Error: ', error);
     };
  }
  adddefaultstampimg(){
    html2canvas(this.output.nativeElement).then(canvas => {
    let self=this;
    var img=new Image();
           img.src=canvas.toDataURL();
        img.onload=function(){
          self.selectedObj.setElement(img);
        }
        var innPgCanvas = self.arrPageCanvas[self.seletecdPg - 1];
        self.extendstamp(self.selectedObj, self.selectedObj.id, self.selectedObj.objtype, self.selectedObj.tmp_width,self.selectedObj.tmp_height);
         innPgCanvas.setActiveObject(self.selectedObj).renderAll();
         innPgCanvas.renderAll();
         self.emptycontrols();
         self.gettimefun();
         $('#closestamppopup').trigger('click');
    });
  }
  uploadtsamp(event){
    let me=this;
     let file = event.target.files[0];
     let reader = new FileReader();
     reader.readAsDataURL(file);
     reader.onload = function () {
   me.stampimgpreview=reader.result;
      // console.log(reader.result);
     };
     reader.onerror = function (error) {
      me.stampimgpreview="";
      //  console.log('Error: ', error);
     };
  }
  createstamp(){
    let self=this;
     var img=new Image();
            //  var canvas = self.tempobj;
            img.src=self.activecstamp;
         img.onload=function(){
           self.selectedObj.setElement(img);
         }
         var innPgCanvas = self.arrPageCanvas[self.seletecdPg - 1];
         self.extendstamp(self.selectedObj, self.selectedObj.id, self.selectedObj.objtype, self.selectedObj.tmp_width,self.selectedObj.tmp_height);
          innPgCanvas.setActiveObject(self.selectedObj).renderAll();
          innPgCanvas.renderAll();
          self.emptycontrols();
          self.gettimefun();
          $('#closestamppopup').trigger('click');
   }
  getactivestamp(type,cclass){
    this.activecstamp="";
    if(this.textdirection=="Vertical"){
    $('.'+cclass+'').css("transform","rotate(90deg)");
    $('.'+cclass+'').css("writing-mode","inherit");
    }
    if(type=="stamplogo1"){
     html2canvas(this.stamplogo1.nativeElement).then(canvas => {
       this.activecstamp= canvas.toDataURL();
     });
   }else if(type=="stamplogo2"){
     html2canvas(this.stamplogo2.nativeElement).then(canvas => {
       this.activecstamp= canvas.toDataURL();
     });
   }else if(type=="stamplogo3"){
     html2canvas(this.stamplogo3.nativeElement).then(canvas => {
       this.activecstamp= canvas.toDataURL();
     });
   }else if(type=="stamplogo4"){
     html2canvas(this.stamplogo4.nativeElement).then(canvas => {
       this.activecstamp= canvas.toDataURL();
     });
   }else{
     html2canvas(this.stamplogo5.nativeElement).then(canvas => {
       this.activecstamp= canvas.toDataURL();
     });
   }
   //console.log(this.activecstamp)
   }
  drawStart() {
    // will be notified of szimek/signature_pad's onBegin event
    // console.log('begin drawing');
  }
  drawComplete() {
    // will be notified of szimek/signature_pad's onEnd event
     console.log(this.signaturePad.toDataURL());
   }
   updatestampimg(){
     let self=this;
       var img=new Image();
              //  var canvas = self.tempobj;
              img.src=this.stampimgpreview;
           img.onload=function(){
             self.selectedObj.setElement(img);
           }
           var innPgCanvas = self.arrPageCanvas[self.seletecdPg - 1];
           self.extendstamp(self.selectedObj, self.selectedObj.id, self.selectedObj.objtype, self.selectedObj.tmp_width,self.selectedObj.tmp_height);
            innPgCanvas.setActiveObject(self.selectedObj).renderAll();
            innPgCanvas.renderAll();
            self.emptycontrols();
            self.gettimefun();
            $('#closestamppopup').trigger('click');
     }
   updateesignimg(){
     let self=this;
       var img=new Image();
              //  var canvas = self.tempobj;
              img.src=this.epreviewsign;
           img.onload=function(){
             self.selectedObj.setElement(img);
           }
           var innPgCanvas = self.arrPageCanvas[self.seletecdPg - 1];
           self.extendesignature(self.selectedObj, self.selectedObj.id, self.selectedObj.objtype, self.selectedObj.esignatureconfigdata, self.selectedObj.status, self.selectedObj.tmp_width,self.selectedObj.tmp_height);
            innPgCanvas.setActiveObject(self.selectedObj).renderAll();
            innPgCanvas.renderAll();
            self.emptycontrols();
            self.gettimefun();
            $('#closeep').trigger('click');
     }
   updatedrawesign(){
   let self=this;
     var img=new Image();
            //  var canvas = self.tempobj;
            img.src=this.signaturePad.toDataURL();
         img.onload=function(){
           self.selectedObj.setElement(img);
         }
         var innPgCanvas = self.arrPageCanvas[self.seletecdPg - 1];
         self.extendesignature(self.selectedObj, self.selectedObj.id, self.selectedObj.objtype, self.selectedObj.esignatureconfigdata, self.selectedObj.status, self.selectedObj.tmp_width,self.selectedObj.tmp_height);
          innPgCanvas.setActiveObject(self.selectedObj).renderAll();
          innPgCanvas.renderAll();
          self.emptycontrols();
          self.gettimefun();
          $('#closeep').trigger('click');
   }
  closeepopup(){
    if (this.seletecdPg > 0) {
      var innPgCanvas = this.arrPageCanvas[this.seletecdPg - 1];
      var arrSel = innPgCanvas.getActiveObjects();
      for (var index in arrSel) {
        innPgCanvas.remove(arrSel[index]);
      }
      innPgCanvas._discardActiveObject();
    }
    this.modalRef.hide();
    innPgCanvas.renderAll();
  }
  addesignstyle(){
    var canvas = document.createElement("canvas");
      canvas.width = 620;
      canvas.height = 80;
      var ctx = canvas.getContext('2d');
      var fonts= $('.spreviewdiv p').css('font-family')
      ctx.font = `50px `+fonts+``;
      var text = $(".spreviewdiv").text();
      ctx.fillText(text,10,50);
      var img1 = document.createElement("img");
      img1.src=canvas.toDataURL();
      let self=this;
      var img=new Image();
             img.src=img1.src;
          img.onload=function(){
            self.selectedObj.setElement(img);
          }
          var innPgCanvas = self.arrPageCanvas[self.seletecdPg - 1];
          self.extendesignature(self.selectedObj, self.selectedObj.id, self.selectedObj.objtype, self.selectedObj.esignatureconfigdata, self.selectedObj.status, self.selectedObj.tmp_width,self.selectedObj.tmp_height);
           innPgCanvas.setActiveObject(self.selectedObj).renderAll();
           innPgCanvas.renderAll();
           self.emptycontrols();
           self.gettimefun();
           $('#closeep').trigger('click');
  }
  esignfontlist(val,val1){
    if(val!="" || val1!=""){
    $('.spreviewdiv1').css("display", "block");
    }
  }
  selectesignstyle(font){
    $('.spreviewdiv1').css("display", "none");
    $('.spreviewdiv p').css("font-family", font+", cursive");
  }
  setglowoffsetX() {
    var canvas = this.tempobj;
      var activeObject = canvas.getActiveObject();
      this.offsetX = this.props.offsetX;
      if (activeObject) {
          activeObject.setShadow({
              blur: this.blur,
              color: this.glowcolor,
              offsetX: this.offsetX,
              offsetY: this.offsetY,
          });
      }
      canvas.renderAll();
  }
  
  setglowoffsetY() {
    var canvas = this.tempobj;
      var activeObject = canvas.getActiveObject();
      this.offsetY = this.props.offsetY;
      if (activeObject) {
          activeObject.setShadow({
              blur: this.blur,
              color: this.glowcolor,
              offsetX: this.offsetX,
              offsetY: this.offsetY
          });
      }
      canvas.renderAll();
  }
  setStorkeWidth() {
    this.changeObjectStyle('strokeWidth', this.objProps.get('strokeWidth'));
  }
  changeObjectStyle(style, value) {
    let lthis = this;
    var canvas = this.tempobj;
    let obj = canvas.getActiveObject();
    if (obj) {
        if (obj.paths) {
            for (let i = 0; i < obj.paths.length; i++) {
                this.setActiveStyle(style, value, obj.paths[i]);
            }
        } else if (obj.type == "group") {
            let objects = obj.getObjects();
            for (let i = 0; i < objects.length; i++) {
                this.setActiveStyle(style, value, objects[i]);
            }
        } else this.setActiveStyle(style, value, obj);
    } else {
        let grpobjs = canvas.getActiveObjects();
        if (grpobjs) {
            grpobjs.forEach(function(object) {
                if (object.paths) {
                    for (let i = 0; i < object.paths.length; i++) {
                        lthis.setActiveStyle(style, value, obj.paths[i]);
                    }
                } else lthis.setActiveStyle(style, value, obj);
            });
        }
    }
    canvas.renderAll();
  }
  setKerning() {
    var canvas = this.tempobj;
    var obj = canvas.getActiveObject();
    canvas.discardActiveObject().renderAll();
    this.setActiveStyle('kerning', this.objProps.get('kerning'), obj);
    canvas.setActiveObject(obj);
  }
  flip() {
    this.setActiveStyle('flipped', this.props.flip, null);
  }
  setCharSpacing() {
    this.setActiveStyle('charSpacing', this.objProps.get('charSpacing'), null);
  }
  setLineHeight() {
    this.setActiveStyle('lineHeight', this.objProps.get('lineHeight'), null);
  }
  nostroke(event: any) {
    var isStroke = event.target.checked;
    var canvas = this.tempobj;
    var obj = canvas.getActiveObject();
    if (obj && isStroke == true) {
        obj.prevstroke = obj.stroke;;
        this.changeObjectColor('stroke', 'Transparent');
    } else if (obj && isStroke == false) {
        if (obj.prevstroke) {
            obj.set('stroke', obj.prevstroke);
            this.changeObjectColor('stroke', obj.prevstroke);
        } else
            obj.set('onfill', false);
    }
   canvas.renderAll();
  }
  setDiameter() {
    var canvas = this.tempobj;
    var obj = canvas.getActiveObject();
   canvas.discardActiveObject().renderAll();
    this.setActiveStyle('diameter', this.objProps.get('diameter'), obj);
    canvas.setActiveObject(obj);
  }
  setCtxtsize() {
    var canvas = this.tempobj;
    var obj = canvas.getActiveObject();
    canvas.discardActiveObject().renderAll();
    this.setActiveStyle('fontSize', this.objProps.get('ctxtsize'), obj);
    canvas.setActiveObject(obj);
  }
  setrotate() {
    var canvas = this.tempobj;
    var obj = canvas.getActiveObject();
    if (obj) {
        this.rotateObject(this.props.setrotate);
    }
}
setHue() {
  var rotVal = this.props.hue;
  this.applyFilter(21, new this.f.HueRotation({
      rotation: rotVal
  }));
  this.applyFilterValue(21, 'rotation', rotVal);
}
setOpacity() {
  var canvas = this.tempobj;
  var obj = canvas.getActiveObject();
// console.log(this.objProps.get('opacity'))
  if (obj) {
      this.setActiveStyle('opacity', this.objProps.get('opacity'), null);
  }
  console.log(this.selectedObj.get('opacity'))
}
setActiveStyle(styleName, value, object) {
  var canvas = this.tempobj;
  object = object || canvas.getActiveObject();
  if (!object) return;
  if (object.setSelectionStyles && object.isEditing) {
      var style = {};
      style[styleName] = value;
      object.setSelectionStyles(style);
      object.setCoords();
  } else {
      object.set(styleName, value);
  }
  object.setCoords();
  canvas.renderAll();
}
setSaturation() {
  this.applyFilter(7, new this.f.Saturation({
      saturation: this.roundValue(this.props.saturation)
  }));
  this.applyFilterValue(7, 'saturation', this.roundValue(this.props.saturation));
}

setBrightness() {
  this.applyFilter(5, new this.f.Brightness({
      brightness: this.props.brightness
  }));
  this.applyFilterValue(5, 'brightness', this.props.brightness);
}
setContrast() {
  this.applyFilter(6, new this.f.Contrast({
      contrast: this.roundValue(this.props.contrast)
  }));
  this.applyFilterValue(6, 'contrast', this.roundValue(this.props.contrast));
}
sepia() {
  this.removepresets();
  this.applyFilter(3, new this.f.Sepia());
}

blackwhite() {
  this.removepresets();
  this.applyFilter(19, new this.f.BlackWhite());
}

polaroid() {
  this.removepresets();
  this.applyFilter(15, new this.f.Polaroid());
}
vintage() {
  this.removepresets();
  this.applyFilter(9, new this.f.Vintage());
}

kodachrome() {
  this.removepresets();
  this.applyFilter(18, new this.f.Kodachrome());
}

technicolor() {
  this.removepresets();
  this.applyFilter(14, new this.f.Technicolor());
}
removepresets() {
  this.applyFilter(3, false, true);
  this.applyFilter(9, false, true);
  this.applyFilter(14, false, true);
  this.applyFilter(15, false, true);
  this.applyFilter(18, false, true);
  this.applyFilter(19, false, true);
}
setblurimg() {
  this.applyFilter(11, new this.f.Blur({
      blurimg: this.props.blurimg
  }));
  this.applyFilterValue(11, 'blur', this.props.blurimg);
}

sharpen() {
  this.applyFilter(12, new this.f.Convolute({
      matrix: [0, -1, 0,
          -1, 5, -1,
          0, -1, 0
      ]
  }));
}
roundValue(value) {
  return Math.round(value);
}
applyFilterValue(index, prop, value) {
  var canvas = this.tempobj;
  var obj = canvas.getActiveObject();
  if (obj && obj.type == 'image') {
      if (obj.filters[index]) {
          obj.filters[index][prop] = value;
          obj.applyFilters();
          canvas.renderAll();
      }
  }
}
applyFilter(index, filter, force = false) {
  var canvas = this.tempobj;
  var obj = canvas.getActiveObject();
  if (obj && obj.type == 'image') {
      if (obj.filters[index] && !force) return;
      obj.filters[index] = false;
      obj.applyFilters();
      canvas.renderAll();
      obj.filters[index] = filter;
      obj.applyFilters();
      canvas.renderAll();
  }
}
rotateObject(angleOffset) {
  var canvas = this.tempobj;
    var obj = canvas.getActiveObject();
    obj.rotate(angleOffset);
    obj.setCoords();
    canvas.renderAll();
}
  get_url_extension(url) {
    return url.split(/\#|\?/)[0].split('.').pop().trim();
  }
  getBGImageCategory() {
    this.http.get('./assets/studioassets/templates/bgimagescategories.json', {
        headers: this.headers
    }).subscribe(data => {
        if (data) {
            this.BGImageCategorylistSection(data);
        }
    });
  }
  BGImageCategorylistSection(data) {
    let bgimgcatlist = JSON.parse(( < any > data)._body);
    $('#bgimgcatg').empty();
    $('.bgimagecatid').empty();
    $('#bgimgcatg').append($('<option selected value="">Select Category</option>'));
    $('.bgimagecatid').append($('<option selected value="">Select Category</option>'));
    for (let bgimgcatgy of bgimgcatlist) {
        var bgimgcatg = $('<option value="' + bgimgcatgy.id + '">' + bgimgcatgy.name + '</option>');
        var bgimagecatid = $('<option value="' + bgimgcatgy.id + '">' + bgimgcatgy.name + '</option>');
        var shpecatid = $('<option value="' + bgimgcatgy.id + '">' + bgimgcatgy.name + '</option>');
        $('#bgimgcatg').append(bgimgcatg);
        $('.bgimagecatid').append(bgimagecatid);
    }
  }
  Background() {
    this.closeAllPanels('bg-area');
    this.canvasmove();
    //this.refreshSection('bgimglist');
}
TempCategorylistSection(data) {
  let tempcatlist = JSON.parse(( < any > data)._body);
  $('#tempcatg').empty();
  $('#tempcatg').append($('<option selected value="">Select Category</option>'));
  $('.tempcatid').empty();
  $('.tempcatid').append($('<option value="">All Categories</option>'));
  for (let tempcatgy of tempcatlist) {
      var tempcatg = $('<option value="' + tempcatgy.id + '">' + tempcatgy.name + '</option>');
      $('#tempcatg').append(tempcatg);
      var tempcatid = $('<option value="' + tempcatgy.id + '">' + tempcatgy.name + '</option>');
      $('.tempcatid').append(tempcatid);
  }
}
  gettempcatg() {
    this.userService.gettemplates().subscribe(data => {
// console.log(data)
    })
    this.props.catgname = $('#tempcatg option:selected').text();
    if (this.props.catg != "") {
        this.http.get('./assets/studioassets/templates/templates.json', {   
        //this.http.get(this.getBaseURL('/templates'), {
            headers: this.headers
        }).subscribe(data => {
            if (data) {
       this.updatetemplatesection(data, 'templatelist', true, parseInt(this.props.catg));
            }
        });
    } else {
       this.getTemplates();
    }
}
getTemplates() {
 /* this.userService.gettemplates().subscribe(data => {
    console.log(data)
        })*/
  this.http.get('./assets/studioassets/templates/templates.json', {   
  //this.http.get(this.getBaseURL('/templates'), {
      headers: this.headers
  }).subscribe(data => {
      if (data) {
          $('#templatelist').empty();
          this.updatetemplatesection(data, 'templatelist', true);
          //this.refreshSection('templatelist');
      }
  });
}
getUserTemplates() {
/*  this.http.get(this.getBaseURL('/usertemplates?userid=' + this.userName), {
      headers: this.headers
  }).subscribe(data => {
      if (data) {
          $('#mydesignslist').empty();
          this.updatetemplatesection(data, 'mydesignslist', false);
          //this.refreshSection('mydesignslist');
      }
  });*/
}
searchGFImg() {
  this.gfquery = $("#gfquery").val();
  this.gfpagenumber = 1;
  $('#gflibsection').empty();
  this.searchgflib();
}
updateTextSection(data) {
  let texts = [];
  $('#textsection').empty();
  var texthtmldata = '';
  for (let text of texts) {
          var textlist = '<div class="col-lg-4 col-md-3 col-sm-12 imgsection" style="padding: 5px;float: left;"><img style="background-color:white; max-width: 100%;width: 250px;" class="textimg img" data-id="' + text.id + '" src="' + text.png + '"/></div>';
      texthtmldata += textlist;
  }
  var $grid = $('#textsection');
  /*if ($grid.length) {
      $grid.isotope({
          itemSelector: 'div',
          masonry: {
              columnWidth: 'div'
          }
      });
      texthtmldata = $(texthtmldata);
      $grid.isotope().append(texthtmldata).isotope('appended', texthtmldata).isotope('layout');
      CreateUtils.showtexts();
      this.initEvents();
  }*/
  $grid.append(texthtmldata);
  this.initEvents();
}
Videos(istoggle = true) {
  this.closeAllPanels('videos-area', istoggle);
  this.canvasmove();
  this.refreshSection('videoslist');
}
updatetemplatesection(data, section, isAdminDesign, catid = 0) {
  let tempimgs = [];
      tempimgs = JSON.parse(( < any > data)._body);
  $('#' + section).empty();
  var htmldata = '';
  for (let tempimg of tempimgs) {
      var tempname = tempimg.name;
      var templid = tempimg.id;

      var tmpclass = 'class="admintemp col-sm-6 border-items mb-12"';
      //var freetext = '<img src="assets/studioassets/images/free.png" width="75px"/>';
      if (catid && (catid !== tempimg.category.id)) continue;

      var deleteicon = '';
          var tempimglist = '<div class="col-sm-6 border-items mb-12 usertemp" style="padding:5px;"  data-id="' + templid + '"><img style="max-width: 140px; max-height: 140px; background: white; border-radius: 15px; z-index: 100000;" src="' + tempimg.image + '"  data-id="' + tempimg.id + '"></div>';
      htmldata += tempimglist;
  }

  /*var $grid = $('#'+section);
  if ($grid.length) {
      $grid.isotope({
          itemSelector: 'div',
          masonry: {
              columnWidth: 'div'
          }
      });
      htmldata = $(htmldata);
      $grid.isotope().append(htmldata).isotope('appended', htmldata).isotope('layout');
      this.initEvents();
      this.refreshSection(section);
  }*/
  var $grid = $('#' + section);
  $grid.append(htmldata);
 // this.initEvents();
}
  saveheaderconfig(hval,fval){
   // var canvas = this.tempobj;
    var obj: any;
    var innPgCanvas = this.arrPageCanvas[this.seletecdPg - 1];
 this.layers.filter(x => {
      if(x.objtype=="header"){
       obj = x;
      obj.set('allpage', hval);
      obj.set('curpageid', this.currPage);
      this.extend0hf(obj, this.randomId(), obj.objtype, obj.text,hval,this.currPage);
      innPgCanvas.setActiveObject(obj).renderAll();
      this.renderLayers();
      if (this.seletecdPg > 0) {
        innPgCanvas.renderAll();
      }
    }
    if(x.objtype=="footer"){
    obj = x;
      obj.set('allpage', fval);
      obj.set('curpageid', this.currPage);
      this.extend0hf(obj, this.randomId(), obj.objtype, obj.text,fval,this.currPage);
      innPgCanvas.setActiveObject(obj).renderAll();
      this.renderLayers();
      if (this.seletecdPg > 0) {
        innPgCanvas.renderAll();
      }
    }
    });
    this.showhfsection=false;
  }
  updatecommentstatus(){
    this.commentdisplaystatus=!this.commentdisplaystatus;
  }
  setupmargin(){
    this.showmarginoption=!this.showmarginoption;
  }
  resetmargin(){
    this.mcsetting=false;
    this.mcleft=0;
    this.mctop=0;
    this.mcright=0;
    this.mcbottom=0;
    this.loadPagefromJson(this.olddata);
    this.showmarginoption=false;
  }
 savemarginconfig(mleft,mright,mtop,mbottom,marginconfig){
  var mwidth=0;
  var mheight=0;
  var innPgCanvas = this.arrPageCanvas[this.seletecdPg - 1];
  var canvas = this.tempobj;
  var obj: any;
    mwidth=810-(parseInt(mright)+parseInt(mleft));
    mheight=1050-(parseInt(mtop)+parseInt(mbottom));
    if(mwidth>0){
    //  console.log(mwidth)
    }else{mwidth=0;}
    if(mheight>0){
      // console.log(mheight)
    }else{mheight=0;}
   if(this.marginstatus===false){
let add = new fabric.Rect({
 width: mwidth, height: mheight, left: parseInt(mleft), top: parseInt(mtop), angle: 0, strokeDashArray: [5, 5],
  fill: 'transparent', stroke: '#000', id: this.randomId(), text: "marginsetup", objtype: 'margins', strokeWidth: 1, rx: 0, ry: 0, lockMovementX:true, lockMovementY:true
});
 this.extend0(add, add.id, add.objtype, add.text);
  innPgCanvas.add(add);
  add.sendToBack(); 
  innPgCanvas.setActiveObject(add).renderAll();
  this.renderLayers();
  this.marginstatus=true;
  }
  if(this.marginstatus===true){
    for (var b = 0; b < this.layers.length; b++) {
      if(this.layers[b].objtype=="margins"){
      obj = canvas.item(b);
    this.selectItemAfterAdded(obj);
    this.selectedObj.set('left', parseInt(mleft));
    this.selectedObj.set('top', parseInt(mtop));
    this.selectedObj.set('width', mwidth);
    this.selectedObj.set('height', mheight);
      if (this.seletecdPg > 0) {
          innPgCanvas.renderAll();
          this.renderLayers();
        }
      }
    }
  }
  if(marginconfig===true){
    for (var o = 0; o < this.layers.length; o++) {
      if(this.layers[o].objtype=="margins"){
      obj = canvas.item(o);
    this.selectItemAfterAdded(obj);
    this.selectedObj.set('visible', true);
      if (this.seletecdPg > 0) {
          innPgCanvas.renderAll();
          this.renderLayers();
        }
      }
    }
  }else{
    for (var i = 0; i < this.layers.length; i++) {
      if(this.layers[i].objtype=="margins"){
    obj = canvas.item(i);
    this.selectItemAfterAdded(obj);
    this.selectedObj.set('visible', false);
      if (this.seletecdPg > 0) {
          innPgCanvas.renderAll();
          this.renderLayers();
        }
      }
    } 
  }
  for (var q = 0; q < this.layers.length; q++) {
    obj = canvas.item(q);
  this.selectItemAfterAdded(obj);
  if(this.layers[q].objtype!="margins" && this.layers[q].left<mleft){
  this.selectedObj.set('left', parseInt(mleft));
  }
  else if(this.layers[q].objtype!="margins" && this.layers[q].top<mtop){
    this.selectedObj.set('top', parseInt(mtop));
    }
    var calmright=(parseInt(this.layers[q].left)+parseInt(this.layers[q].width));
    var calmright1=parseInt(mleft)+mwidth;
    var setleft=calmright1-parseInt(this.layers[q].width);
    if(this.layers[q].objtype!="margins" && calmright>calmright1){
      this.selectedObj.set('left', setleft);
      }
      var calmbottom=(parseInt(this.layers[q].top)+parseInt(this.layers[q].height));
    var calmbottom1=parseInt(mtop)+mheight;
    var setbottom=calmbottom1-parseInt(this.layers[q].height);
    if(this.layers[q].objtype!="margins" && calmbottom>calmbottom1){
      this.selectedObj.set('top', setbottom);
      }
    if (this.seletecdPg > 0) {
        innPgCanvas.renderAll();
        this.renderLayers();
      }
}
  this.showmarginoption=false;  
}
  watermarkvalue:any;
  checkValue(event: any){
    this.watermarkvalue = event
    if( event == 'on'){
      this.btnpdfdownload()
     
    }
    else{
      this.watermarktext=""
     this.modalRef.hide()
    }
 }
 setglowblur(){
// console.log("test");
 }
 triggerfileimage(){
  // console.log("test");
}
onImageFileChanged(e){
  // console.log(e);
}
  pdfactions(e){
    this.downloadType=e;
    if(e=="templatewithsampledata"){
    this.downloadType0="PDF Template (Sample Data)";
    }
    if(e=="templatewithoutvariable"){
      this.downloadType0="PDF Template (No variable)";
      }
      if(e=="templatewithdata"){
        this.downloadType0="PDF Template (Data)";
        }
        if(e=="templatewithvariable"){
          this.downloadType0="PDF Template";
          }
  }
  replydetail(id){
    this.activerplycommentid=id;
    this.showreplydetaildiv=!this.showreplydetaildiv;
      }
      replybtn(replytxt,pinid,commentid){
        this.activepin=pinid;
        if(this.showreplytxt===true && replytxt!=''){
        var obj={
          "commentid": String(commentid),
          "content": String(replytxt),
          "designproduct_fk": String(this.naviDate.designid),
          "pinid": String(pinid),
          "useraccount_fk":this.userid,
          "doctype": String(this.naviDate.formtypeid)
        }
        this.userService.replycomments(obj).subscribe(data1 => {
          this.userService.getoverallcomments(this.naviDate.designid).subscribe(data => {
            this.overallcomments=data;
          });
        });
      }
      this.showreplytxt=!this.showreplytxt;
      }
  gettoolkitdata(){
    let toolkit_JsonObj={"typevalue":1}
    this.userService.gettoolkitinfo(toolkit_JsonObj).subscribe(data => {
      this.generaldata=data;
    });
    let personalToolkit_JsonObj={"typevalue":2}
    this.userService.getpersonaltoolkitinfo(personalToolkit_JsonObj).subscribe(data => {
      this.personaldata=data;
    });
  }
  toolkitdrag(content){
    if(content!=null){
var conjson=JSON.parse(content);
var innPgCanvas = this.arrPageCanvas[this.seletecdPg - 1];
for(var e=0;e<conjson.length;e++){
  var lefts=conjson[e].left;
  var tops=conjson[e].top;
  if (conjson[e].objtype == "stext") {
    let textString = conjson[e].text;
    let text = new fabric.Textbox(textString, {
      left: lefts,
      top: tops,
      width: conjson[e].width,
      fontSize: conjson[e].fontSize,
      angle: conjson[e].angle,
      textAlign: conjson[e].textAlign,
      fontWeight: conjson[e].fontWeight,
      fontStyle:conjson[e].fontStyle,
      underline:conjson[e].underline,
      overline:conjson[e].overline,
      linethrough: conjson[e].linethrough,
      fontFamily: conjson[e].fontFamily,
      editingBorderColor: 'blue',
      showTextBoxBorder: true,
      textboxBorderColor: 'yellow',
      hasRotatingPoint: true,
      lockMovementX: false,
      objtype: 'stext',
      breakWords: true,
      variable: conjson[e].variable,
      objsampledata: conjson[e].objsampledata,
      objstyle: conjson[e].objstyle,
      objtext: conjson[e].objtext,
      objcategory: conjson[e].objcategory,
      linkURL: conjson[e].linkURL
    });
    text.setControlsVisibility({
      bl: false,
      br: false,
      tl: false,
      tr: false,
      mt: false,
      mb: false,
      mtr: false,
      mr: true,
      ml: true
    });
    this.extend1(text, conjson[e].id, conjson[e].objtype, conjson[e].objsampledata, conjson[e].objtext, conjson[e].objcategory, conjson[e].breakWords,conjson[e].linkURL);
    this.tempobj.add(text);
    this.selectItemAfterAdded(text);
    this.renderLayers();
  }
  if (conjson[e].objtype == "slabel") {
    let textString = conjson[e].text;
    let text = new fabric.Textbox(textString, {
      left: lefts,
     top: tops,
      width: conjson[e].width,
      fontSize: conjson[e].fontSize,
      fontWeight: conjson[e].fontWeight,
      fontStyle:conjson[e].fontStyle,
      underline:conjson[e].underline,
      overline:conjson[e].overline,
      linethrough: conjson[e].linethrough,
      textAlign: conjson[e].textAlign,
      fontFamily: conjson[e].fontFamily,
      editingBorderColor: 'gray',
      showTextBoxBorder: true,
      textboxBorderColor: 'blue',
      hasRotatingPoint: false,
      breakWords: true,
      objtype: 'slabel',
      linkURL:'',
      variable: conjson[e].variable,
      angle: conjson[e].angle
    });
    text.setControlsVisibility({
      bl: false,
      br: false,
      tl: false,
      tr: false,
      mt: false,
      mb: false,
      mtr: false,
      mr: true,
      ml: true
    });
    this.extend(text, conjson[e].id, 'slabel',text.linkURL);
    this.tempobj.add(text);
    this.selectItemAfterAdded(text);
    this.renderLayers();
  }
  if(conjson[e].objtype == 'flowpara'){
    let textString = conjson[e].text;
    let text = new fabric.Textbox(textString, {
      left: lefts,
      top: tops,
      fontFamily: conjson[e].fontFamily,
      angle: conjson[e].angle,
      translateX: conjson[e].translateX,
      translateY: conjson[e].translateY,
      fill: conjson[e].fill,
      width: conjson[e].width,
      linethrough: conjson[e].linethrough,
      height: conjson[e].height,
      textLength:conjson[e].textLength,
      textAlign: conjson[e].textAlign,
      fontSize: conjson[e].fontSize,
      fontWeight: conjson[e].fontWeight,
      fontStyle:conjson[e].fontStyle,
      underline:conjson[e].underline,
      overline:conjson[e].overline,
      editingBorderColor: 'blue',
      showTextBoxBorder: true,
      textboxBorderColor: 'gray',
      lockMovementX: false,
      hasRotatingPoint: true,
      variable: conjson[e].variable,
      breakWords: false,
      objtype: 'flowpara',
      linkURL:''
    });
    text.setControlsVisibility({
      bl: true,
      br: true,
      tl: true,
      tr: true,
      mt: false,
      mb: false,
      mtr: false,
      mr: true,
      ml: true
    });
    this.extendflow(text, conjson[e].id, 'flowpara', text.breakWords,text.linkURL);
    this.tempobj.add(text);
    this.selectItemAfterAdded(text);
    this.renderLayers();
  }
  if(conjson[e].objtype == 'imgvar'){
     const imgsrc=conjson[e]._originalElement.currentSrc;
      fabric.Image.fromURL(imgsrc, (image) => {
        image.set({
        left: lefts,
        top: tops,
        width: image.width,
        height: image.height,
        tmp_width: image.width,
        tmp_height: image.height,
        opacity: 1.0,
        objtype: 'imgvar',
        cacheKey: 'imgvar',
        imgvarvalue: conjson[e].imgvarvalue,
        id: conjson[e].id
      });
      this.extendimgvar(image, image.id, image.objtype, image.cacheKey, image.imgvarvalue, image.tmp_width, image.tmp_height);
      innPgCanvas.add(image);
      this.emptycontrols();
      innPgCanvas.setActiveObject(image).renderAll();
      this.renderLayers();
    });
  }
  if (conjson[e].objtype == "rect" || conjson[e].objtype == "circle" || conjson[e].objtype == "vline" || conjson[e].objtype == "hline" || conjson[e].objtype == "ellipse") {
    let add: any;
//    var points = this.regularPolygonPoints(6, 50);
  //  var points1 = this.starPolygonPoints(5, 50, 25);
    switch (conjson[e].objtype) {
      case 'rect':
        add = new fabric.Rect({
          width: conjson[e].width, height: conjson[e].height, left: conjson[e].left, top: conjson[e].top, angle: conjson[e].angle,
          fill: conjson[e].fill, stroke: conjson[e].stroke, text: conjson[e].text, objtype: conjson[e].objtype, strokeWidth: conjson[e].strokeWidth, rx: conjson[e].rx, ry: conjson[e].ry
        });
        break;
      case 'circle':
        add = new fabric.Circle({
          radius: conjson[e].radius, left: conjson[e].left, top: conjson[e].top, fill: conjson[e].fill, objtype: conjson[e].objtype, stroke: conjson[e].stroke, strokeWidth: conjson[e].strokeWidth, text: conjson[e].text, angle: conjson[e].angle
        });

        break;
      case 'hline':
        add = new fabric.Line([10, 100, 200, 100], ({
          left: conjson[e].left, top: conjson[e].top, fill: conjson[e].fill, stroke: conjson[e].stroke, objtype: conjson[e].objtype, strokeWidth: conjson[e].strokeWidth, text: conjson[e].text, angle: conjson[e].angle
        }));

        break;
      case 'vline':
        add = new fabric.Line([150, 10, 150, 200], ({
          left: conjson[e].left, top: conjson[e].top, fill: conjson[e].fill, stroke: conjson[e].stroke, objtype: conjson[e].objtype, strokeWidth: conjson[e].strokeWidth, text: conjson[e].text, angle: conjson[e].angle
        }));

        break;
      case 'ellipse':
        add = new fabric.Ellipse({
          left: conjson[e].left, top: conjson[e].top,
          rx: conjson[e].rx,
          ry: conjson[e].ry,
          fill: conjson[e].fill,
          stroke: conjson[e].stroke,
          strokeWidth: conjson[e].strokeWidth,
          objtype: conjson[e].objtype,
          text: conjson[e].text
        });

        break;
    }
    if (add) {
      this.extend0(add, conjson[e].id, add.objtype, add.text);
      innPgCanvas.add(add);
      var canvas = this.tempobj;
      canvas.sendToBack(add);
      this.emptycontrols();
      innPgCanvas.setActiveObject(add).renderAll();
      this.renderLayers();
    }
  }
  if(conjson[e].objtype == 'logo'){
    const imgsrc=conjson[e].src;
     fabric.Image.fromURL(imgsrc, (image) => {
       image.set({
       left: lefts,
       top: tops,
       width: image.width,
       height: image.height,
       tmp_width: image.width,
       tmp_height: image.height,
       objtype: 'logo',
       angle: 0,
       cornersize: 0,
    hasRotatingPoint: true,
    id: this.randomId()
     });
     this.extendlogo(image, image.id, image.objtype, image.src1, image.tmp_width, image.tmp_height);
     innPgCanvas.add(image);
   innPgCanvas.setActiveObject(image).renderAll();
   this.renderLayers();
    });
    this.emptycontrols();
   this.gettimefun();
 }
 if (conjson[e].objtype == "barcode") {
  const imgsrc=conjson[e].src;
  const databarcode_val0=conjson[e].barcode_val0;
  const databarcode_val=conjson[e].barcode_val;
  const datalabel_name=conjson[e].label_name;
  const datalabel_type=conjson[e].label_type;
  fabric.Image.fromURL(imgsrc, (image) => {
    image.set({
    left: lefts,
    top: tops,
    angle: 0,
    cornersize: 0,
    hasRotatingPoint: true,
    width: image.width,
    height: image.height,
   tmp_width: image.width,
    tmp_height: image.height,
    cacheKey: 'barcode',
    objtype: 'barcode',
    barcode_val0: databarcode_val0,
    barcode_val: databarcode_val,
    label_name: datalabel_name,
    label_type: datalabel_type,
    id: this.randomId()
  }).scale(0.9);
  var innPgCanvas = this.arrPageCanvas[this.seletecdPg - 1];
  this.extendbarcode(image, image.id, image.objtype, image.cacheKey,image.barcode_val0, image.barcode_val,image.label_name,image.label_type, image.tmp_width, image.tmp_height);
  innPgCanvas.add(image);
  this.emptycontrols();
  innPgCanvas.setActiveObject(image).renderAll();
  this.renderLayers();
});
}
if (conjson[e].objtype == "table") {
      var addColumIcon = "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAOEAAADhCAMAAAAJbSJIAAAAhFBMVEX///8AAAAvLy8yMjLu7u719fXq6uqmpqbT09Pl5eXi4uL5+fnX19e8vLzt7e3Ozs6vr6+EhIRiYmJ4eHhra2vExMRycnIkJCSMjIzb29ufn59mZmZXV1fKysq0tLSBgYFJSUlBQUGSkpJbW1tKSkocHBwVFRU7OzsMDAygoKAXFxciIiI7eJOAAAAL00lEQVR4nO1d6XriOBDMJDgGAjE3hCPB5Jhk5v3fb5c1BLrVsmW7uu3Zb+pnArIKWX2rdXPzF38RgE4/GY7W4+litplMJpvZYjpej4ZJv9P0xOrjPolXk9sfftxOVnFy3/Q0q+F+ftjmUKPYHuZ/Fs3+aPYZzO6Mz8Wo1/TEgxANF79KszvjfTp8aJpAPjqjt8rsztiO2iuAnuvTO5EcNk1FQncBopdhOmiaEEX0lacSquEubs+W7E3h9DKM26FCBhMlfkfM+k3Tu0lQ0sWH12Y3ZFeb3xHbp8b4DSz4HfHazLvamYVOcLmfHuJ5d/DtS3T6g+48Pkz3y9AhXiJ7guugmc3Ww37e5KL+cL0JGik2Y5ZhV2xZ7w+7UPOrMz/sC8dbdlUZUURFL+hylZRV1w+71XvBqFMVMhKGBYsXV/WC+us0f+gdlIcPD7kaPo3reQad+GfTyzjPm8AKIdb7q5wnfKrvxpec5cP5PM85C3mAPUXCo//JC6zlMfDrkK2iz+EXMWO8X37v91gS+MNO8O6PF524w73Xqf5Sed6NLzi4edR53r/ovXqeuVB4WMfjxae6ln9yJz92D9+MT54fUz9mNJIf/AH2/z1acIx9iowHj8iBvjzP4iN+WrltA9nLAorUWHzAGveAQshifI4a/ksafWnrd3dFdw0kBQ7S2C+YsUtA9NieESOLzjzs/SgBURgAVlHag8tmIrWixqr9W0s/3AQx3SqIpFhHzXjqThjSUoZySM5bLZEnvRfNZr6kTVPD7u/gX4raEKyrZfXRBGO7+VR7153UtupYrrv02YZ0l7B1Kmpn11L6aCC2LqDvUqyk+d2QxUdbSggEihUcjZ4zyK92rOARAsXyHrHrsLRlBY9w9+Jr2SHcIFDzUvQarkQtGZ1yjbWm9SCHKyZKbUVX1bevhsfxeX6X+baTvm7SFvXBCd+U0IqO8TfTm2cNpHyawVkb5x2905xndUR8nh+h33QCzUg9gYzkDvhEV2Hfc6QULGQxGB9LT9/HsDCgs53CfEX+LVTYt3eRX1uUBc+dgzTkS9zgvgVNhjp2oPfigS9HgAnu2KOguCiPh4CKDrhD/Fn8Fb7uoFSda0OARA7XioVJ8IR9YY+ZhxDPRZVVfLBxizwgnqgHiYRHhyBsEfmaFPxyXFOgrDUpRAaJyN+4blC+4PhNP4ySo2LSAZX64PI0N2DNnSaYapaqVN5Qg/MXJM+NYktY2m/2QsrG46xdFo/Y+D/JdyHOrddlyHWtXzyydwmYI9RlyJW4V5xyuQt0A5QZ8sCUTycyrwlZIqfM8IZVhHqU3L3eEqoz5Isof4o5FdAqR22GfBHlwJniEuozZO6+qGuZqsCWO6kz5OFBSdEFfKQ69BkyR1HYY8z6B1cj6DPk9pj7ARZCBpfhGjD8KiJA51AjNS7CgCGLnjp2DcvIocuMDRhyD43/mxWvoXOFFgyZ0clfU1p2gXObTrBgyCI2zG9gFhs8l2bCkBll9J9x3j8BMGHIjFPq6lO3IsdJrggThszXpw6G8ktqxJC+psQ2ZWIIf7DIhmHXT4PqisplYn7YMGSv4nVqJCX/UThUbMSQKv0r65vFVBWq8I0Y0njvVTKRuo/v+CdbMWRq/fIPqg3xusKMIdMXF41Iz2uOFJ5sxXDhYeJjjoMVQ3rQ7duDYoJG4cFmDKnh9i1qqKLcKzzYjCHTiOe/0qVVOdFkxpCmXs7hNGrOoVKzBGYMaeHC2aqhjoVKIakZQ6r4zsEYKkpVqrnNGNJU4imsTUWphkVjyJBaNScfgsaCgyrDSsOMIV2uU1CU6hCd/ihmDFlILfsbTcnotA6xY0iPKGZRUaoOy1il0WiR3oZAboxwF/TddFqq3SdVF1nNAnXww2sGO1rtEl1MwwU8ZZNVftNzmcHqMLfZEBzBPzxN0GQxNer6h+YNC9phwRFKkbr5mYFGU+CB74N78EsbgZuRqvxMqtBym8Cfyqpl4gWBuRTqKK2FyYaNw4uLLBDmmdOYU6b7JB1ZBDsxekFY7cST8B2qI8MYWjI7I6zYlQqIzEKrsg8tmZWbGjVMs7jha91hrFDhx89KSiZ1h7GCKUN+BMACgZ4r+U7GkMaDwzR+TvtENYSFyKR9SK22sPZyQusGdYRZzPRwTnY0lOq2wMRT+O0cKARmNSVtUcm34OW2+gjsXShpfMmjKoat8xTuW0h2KfXxg6sUbE3T4EpC+stnvgX1qMJT3FErfXwaEs78Q+pRlYlEWcVpygSp6Z7Llp6WJWp0BrWMtdEcaRaxoBHhvcpzm40mimFiMOwY0iSM+Mc/OzNDK4XPLiW1T1R6WpoxpELlXI8/Jn9V6dNixpAGOc9dJKgKUUlcmDGkyuKcoqDWiUbBkB1D6uyeTVDWDUDjwQ3VYkQFfwbCiiFdrEsLCSpMNfrLWjGkdvflaBMtN9EQNVYMfUyoiN0rPNmKYep5G5nDrnB/hBFDFse9SlfRZtkK99UYMaTb8Dr8SMNtgf2kysCIIbXOrstKaCAD1u/jAiOG9I7X6wo9djYP32nWhiGjQaJz9Igp/jiCDcN1zvg0qATrq/ING4YpGZ9mVFn0E96M1YQhU3pUJTBFAn9NTRiyw9rsv9Q0hRcomjCkBQncC2T31aBDGRYM2QFLHqtgPiJa6VswZDlNx/Zk6TLw0y0Y0tHdUAVr8wWORxkwZPvM9XKZNN1jH2/AkDW5Ej7BWhJgTz/pM2TJPinpzz6CzdDoM2RNhsQFYn3doHaNOkNmdP8UP8Tan0DPP6kzZHtMrlbnpVzIRdRmyAt6PR9jWWtkpyhthqzDp89g4U3PgIuozJAvodeFZ3YNUJwqM2TdAv1N8nkBCU4n6jIsMW9mF+B8fV2GbPS8+jBe6ASzTlOBIcwJ5TeV5hau8W64qElIxUWoU3L8ioT8Ej/ezRXlJ0oXwqI6G/Be0AXSg58UATn70g1uoDwlL3Utum2E60TZwCsP9+4hlFX4zsYtrNLknbdB2UTnPhHUEvJ67OJ95bxPIKXIdzioMaNzBWVAapBfHYsqA6OaCJTBcw5+BIkvfvMuSqpr3FHCr8QJsyKchQfeM3M8p/E+hlmDzoUEgSNv+PeQ2TbVu4JCHT5H7imkTBFw5hlwBcsJzr1yjd0AnIuUT7OEfHbOi+j0IagHx9YtIxJd/fwH3J33q9TX3fMiwbe2GcE9LV+ysY7r7rT9DsvSV+K4XnngwSMTuPeQlm9n6d5f1JLbgI+A3CUrbMX/2X3ArgneGorCtdUV4wXOTY/tuJfbsdVqeNNCDLB5iSqcCqzeNNdV/M3fCyx0janjwQpbWqUMPBxfwoxqSQfpoGiTdwNLcdea4UCplVBjnkaUamwb6V6/22bMG0GIQjaNRFGjFLzaRCA+j+OmHIG9SigEE2kaoFak4o93q3JO0Qv5bDzMaxUparRu92IszgCouJzAzX9IrQychOcmMkCdck+PCIWTGS4i6RLTH/Cu3II9j35RPJC3yI93uMbq3MpPetN9VZOl57EaD/O1pHnR8/17Tvj9BJ0+sh6B9i9WOhx7ng2oKMb9/S4VOPa9/DQjm4/SzcWn9wZrASRugOGMV4XzkVfI6UnzBpOrDyOPWDtC3XnL68z6cUDEcQZ5rdJ+GcQYIv/7c1zIUu1yXNyvc5ZP6VoDF7IN941tXHUlnw7+fX7EJ/jeST8i0ZO5wt2htLiL5oV9/Ew9toBeZtv1LvSFvZ+v0sLx7jRuh8mDGxEX8LmI5708ntHT8FD0QmTQuN+nAI8+i8rB8m16iOfdQf8U9nt47A+SYXxYpLJXJGCsqwN96O6LpwbBprlkQpIa8JvYxks4dtrruLEWMC66uRZATUybzwQd0XeLRzFYtSNfeUS0/l0835JIG9APuUj87lwV4Kr7gHgYoaTOpH31SWc8juqLncWwPTUfMuYvwZaKg5/lLfZm0I+DLboL3qfPbaiDCEdveHjl9dQ+LDfrXXsUQylESTx+9cR0j/i826xGg2asaige+7vhaP0yXcw2k8lkM1tMx1+jYdL7Q9ftL6zxD+6vj+j7lvsPAAAAAElFTkSuQmCC";
    var addColumnImg = document.createElement('img');
    addColumnImg.src = addColumIcon;
    var settingIcon = "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAOEAAADhCAMAAAAJbSJIAAAAgVBMVEX///8AAACFhYWNjY19fX38/Pz29vZubm7Y2Nj09PSvr6/v7+/5+floaGjr6+uIiIjR0dHKysrc3NxTU1MxMTG1tbVjY2N1dXWioqJNTU28vLzj4+NGRkaWlpbDw8OpqakqKio7OztbW1sPDw8jIyMbGxt4eHibm5sXFxdBQUEuLi4K5pU9AAAPd0lEQVR4nNVd6UIyOwy9rIIgqyCLiCzqh+//gFdEYU6aJunC4vlL6TTTNnsy//13bswnD4+bEoPN6/ijcfbHnx39Z464Ez5n115hGtprmb49nlvXXmUCOv90Ar/wd49qx0TfFwbXXmkkalsrhaXmtdcah3czgaX1tdcahbmdwFKpf+3VxuAuhMLptVcbgXoIgaXSHxQZL2EU3l97veFYhFF4d+31hgOu4bbKYFgcsbr2esPxVlx/hx2yKw5pX3h9yajBGeTHVIpD5pddXzoGxdV7BPp9cczLZdeXjlFx9V1+TKM4ZnHZ9aUDWOmIH9P808wUDEOfeVQc83bR5WXAa3H1dc8geA0XXV462sW1v/pGdf8wMwUm4rWNgB2ZHDbtVi3fIjk0PsbT1XC86GkDYe1eNhnGTHvVx8MLW55LTW8X+ON2KY+F8+dhpcT+GMszvqwKYx94JSkRsxLgn7iPoHP63TBFfvQozVd7wKefwxbpligqwmgY6B8GzFS4YT3n4aVqNCUecE6Xnfc+gCzf+Gc1aqaVEoPMKsIT9wzvDasti4Me/NMCQ5qOeJdbZ8U/XLm4YfC6zbjVvxAPjcAkB2S64cg9qvclH4RXFwrBqbQhDGfu3ldB0NXcCd9xQjEukG0XPUf0B8Utmk2ZAZKywk34WeCTffHRuXZRcwv+hlZqEz5MIVnvY37Kxc+NLCuPzrOLBr/n/hy2fa4nUc6xXHKP8tdrmz/qj86wiybH7lP9w/ubyNVn3r+Vukv/bzlJdAlcmR58gqh9NPX/A6bupieS6BI4024/hfwA9aYBPoi2nk4i1QYPDqOaIbJ7hBZzUaLgRbx9K7guiQnsxiXwR7b5pTCFamfZg3C/FzrjLrqs/Ojy82lSiPXSYq92lh6ZgTgpDtl20buD33B1F4JqL8Ac71XZhJQTQMvPtIv8HSwsSlrQU3jIs9cViCSWmkviUziBLlumXuma73DtGP3ZBFbpK7nKL0fiJPRh7g4xbveRM+gL7ymZFfMqM+OYeWEuiaGODUdhYuMKnR0d1vX5Rq2oO4eHN0IdEgOzHZwIri9wgusp50gbQQ330WeaOCSGOVyH5N/+yFDjxB/usnn5Tu+t7B9EzWfJb+SAWqZS6Kv2o9mtciZvdQ5q01ZkyWQXdyEP6NkJ/MK8Mp1Wc8f/5suPD00hIrsYMv19CIFXBO5iyEUEa++WE0GAKYVcE6DwljOyxrEUwindnm19yUCVI4SVo5EbofNdBq14TkOS0m6V1aBGFWZCERX4NjNciX7nDeKxIDr1TSZHUuMg8O/EuRtsm5wftU3aEqnqfXvJ5sRCf738BGcGtU3Dt4Aq39ljrmmglQ4x14he5NtSbYjpPYyahBrbqdZ7TtAwUOTaiCcj7j2dBdS+j1VJcpx1RK3ebDXryWlNVFDE8wjqvI9PPas17isPu9/0mdfdQ+W+EU8oiRelmAbjHFO1+xU+/LLr9qOyu2nQMSXnr03mEvxCHtRmclBiPAveSmJRJF4eKjL0UBKgwTl4Kd4DXVgktpfKAEkARgzKU2gVskc8h8hayv+ShRgRGXbfeX9lpG+PlZ1Goq6l266kyM66kg71KWsYWt/dBP4WzhlcYL6QkcLAqqdvGOsRcA8zqMuEc5ne9MBeH1vE1sT2YxYkApMlni1/wXMUAhPjR7su2U1GEl4s0sINHtthSRrNvIloYBjcWW1DqpaAlUHLIRG9RArx+brPtSNlHGyn64enh/VUuqb/DHuC/0ir60PdW2dcNKZ3xPOiX1x6p7/wqgO6PwIveprW9glzqVvoRte/MZ5xDtemT2XVSYThSRVTqJaqW8iW4L9N/HpVffLG/UWVGriJKf4VlPbaDWETDTVPNJfPsdF0TXSTJWTtB07EMJAPw1OY1NRP7T/ITuOVb3y/mix05eDaFu9qubmOmhxHAyM+hhtUT+6m9Nof7OY6aocbmFR0WAXvlVLL5XKZEC+0K2WUS48Rztg0FzykimCFotEvPIZF5Jqf5P/akQEmrLx9D2po4in5jZRdhPsWaNaeIsiB12zeP/pB+un8ZXK3Ig+UbWnqWohpqUNJlI8eoz09P010Olv95Tul7QD5f4QbBqUnHUF0dkU60WtxfHZ12edfTn1WfvarzfIhpS65OGWYagwyqxLdCK9VNyVVybWW65BXODjWRUvUWvkue5X8H2CeXVutjBHVBhIwjhfAxDsg6xhqM7hCsqL2OjTvBRpCKY27hgEzySV1exyvlk6g7Acjhysly5TwZPG4CzVTv/hhVpbaI9HxjjUhaQYp8g9PU5QDmPJMB4cLY/Ddioofhm9SO3jgg8WhbCI9wV6zsjTlEg8ePii1W2dIaqu/JPCIvdWu+8aGsv0F0j49kREerUj9ge65rKtsZrxQgl94SON04CLwJmqja50vDdOn3uwx86sGr+vFaGAIX+IpT2/ZhQ5fY8By/rIY84exytYar7ujhtkzAG7/HI0O4NSHtI9qD2YVh5wp2lmlYfe+EZhqCa8uR1oRcK5wK6w+AGb1Bhc7KML7A7yGOfrj4DGNmQEC10BhzBkDsyJPp9VVccoYLR6s42QKwQFlcR4GLjBGvualEE5EYKqGB8CdYzrV5aUQOF+e5D5w28WEsfNSCKw04v8cilPG+ELzUviWuBptzhj+npVCEBa5+sUUvW4xim5WCqH2JFdxjbVBlg+3TyFYDBHc63wU5mq/BU6DiHqd893DXK2pwMd0bQrBWZKL09zUKQXOnivX/aY4DUj814j/c1glzpmXQvAGR/yfQ3HKmFbmeSkErpCn6SYYiDHcKy+F4OfJU2wKEezr2xbgWw9q3OCFpVO2iLwUgjcyLjJKAcHgmMLHvBSiBzdHwTCWWcfMAO6//4ph322MIwnCHjm+wAUmfrhB1myAY+UfyT6clu97gUoE3JocWg24PENudr0x6jrpVc9czvJ2WLlvmJ3XGMNPP6Z4SG2en3ZjVBnyebllIe18XBkNLPsJf0r3tuGCtNH7fRNTEGbaZ5lexwvNjw05AEJbZCMgPK/wPkPdUdvSuPBT9spiilmM/CoCo5GyCuHtfnpC2VkgD1ko4dhECgMms9R1fF8zS9dC8UlY35Z2EzGsK1YaWL6ZdThRbaVl4R5i4JNc5UvlYhgacFb5aTnIgheFUIodPAyYST9778exHb0SSxQbJKEmPtJN8oxlYaiuGfJe1Ga3MlMjCSuxbUJIToG8hWLvzS/syBHvKK1gZVcorSSJi9DQ1CU5RULclMcy85bb/a6nueY35MWROxH3FTWSaqDouD7+OPxSrQXdsdVblofsf2XNhlaQx3CbsBxh95C+7ZMQjIy82bsv0+cpHvuL53nDIX2sjEJNoj1ayNmU0TSbJTBXv+Xk+it/gMGx/iFM/lMUTleDD8kxCG4pi6mX0SkgYDVoJcCuimHPFXbrbTQFHs50fEQIE7o0Kefm7Brrnpja/XflLyg5E5yYMI8aHVw5CzWp4Uxmneqzw34bJlp4oNWg8Y42Vy6pHTdOf1Y9YqgbpHhp8TCIOcl7sCr8duJ3+TQ/2IR79XCj6Zv0TTp0AKgCwOMSGc84YdWceb6xoEY/0DI0dUHwApmyuol+r8/UqeV2WoGbCSRbmOijRQ1Ol+JKPf5Yrcd/0wnELfyXRiDxhRgEzwV6KqBYSu1ARooaLJZf0EfVCTQ5uAexIpNTWlFamW61/QsmFCZXJKro6S5o0u7LlOY8j+tP82kKIRNmluFr17iJlmP0n6nWw4HRvYM6bI6c3Tjh0wrtUnNntbaQ9+WIOqMKaBevjZBeWGu784rc8vS0ZFIWFWKoNKzfhRqHOOeoUpHKS6n/K6ygYm75JFc3MEeFvLfUoCw5asE6YG0mi8encNuOer3SvmxAwztRMYmex005rMRdIlo8mpKnRAvb4pXcwejUv3TzuburjBJsHnIs4ryzBxDJnZw/Wqvvkb0HbbzIIJ6Xf2f+6rcd1DUXKzLoec/5qZxE0Ph23CxUUMTk0J0Nqxz3h6Qw5MlZywXqEopJkKBOvrN8sD0e1EQLl2P0MqdmkWQHCeiF+6NIpCTjN7AzgfapDt0Ccgg2NyMoTiARxNBmDmQL85ROZgZR68OMAqKu5cluzg5064XVYqLGnaL4nRPzhFWiD+LGBMUJQVFqBJiFN/xpOVhnUCS/qM+kdpw5J0A/DRL68G5ukpF+AwVG0F/xHuqOonlSDI+dcfmx1J5LJGLQ/MSjK9tNne/38ZSTH80Ph2gnzkkIDHNJ0Ywj6W0e85bLuRSf2kmWC1yOrjEwJZKGAb272C469xYZogjkAK19UzppX4FJUU4OtWcXe+RVJNPYdkIePKNzCAzuze7EctldZL4hz+U9msG6kLngupu4F5zX5jY5c0mc8/He51in44sn1OF+udolMOKZbjEDJdHN1TqiHC5DB8x5OIIwHJfAKNtAIbEux1025V4Aa21UlKDqungIXQIjP5DgvtTCFbO06hsvLZejfm+p+CiYfy6B0d9iEXbR8iGnPfQYrTlc/EtGth3cw+Vsh12cS13uwp5uib/94MBwMu7gHu5B3e9i0IdkZOeCperqhCX3h8SPlLivuD8P+5STXG4jlQcwGLoXJ/mLT8ZTJLB6idsI1VkL2wXN8EkrC4nTJqNt/UIyTLyZfouv99JQeyHn+WaXgcQDw6wt2Q+OiK5avhfw5jclVU0gy0KgSuL2JCVfuGsl5WxyvUV3BQVM6YaciUBF+GGW1NxlBVIzRTevqII6aEsq4s1GoLiLbi7FC122MDGxYO4Y0eJnOBkJ9O/iM5ur1X4BLVMwGYvDtn1ekfUxnKwE+kj0Zq/CcD8zheCBXzVhu6/rKdmBYA7q1m/rgtbjZ6ZQmi4k+zIM5wyhFEdVkxIx+7bFACuV1LsW1aNytBhxMFgVH/Eq2rgQZvdX6oGJKbusZ8Wr/ZSjSwyH/tGQG2vpaPAyvKOgsYr29F73W3Js1pNz0feNxmwymRkSa0CM+TRT0EpNnWjaKcX+eQHsz/dGIBsiwzdTLwoTMwVWmt6v/rIAZuoTXWfosnw5gFnk00yBld5soNmH4uJ9bNIy5naxKq6eZ++QGpiry/LlAF0oePXuT7NSwkx5PglRgRtOh/AAfeJlDjDir7FSU1sfwFk1sfPA4CgrQP226g1C/2hYEZkN9otA6wGESAkcXw2rAAJzdZG+LDwf6WaRPeHoMjA0/ftBaj321WCK7ZbMpbe3CBs/ze4XvCSEdI0jbq7OIQwtpQ9cqZslUeyqaM6qO16/eXsuv5yfvv8BqVq2HEo894AAAAAASUVORK5CYII=";
    var settingImg = document.createElement('img');
    settingImg.src = settingIcon
 
    //end
    var svgData = '<svg xmlns="http://www.w3.org/2000/svg" width="275px" height="65px">' +
      '<foreignObject width="100%" height="100%">' +
      '<div xmlns="http://www.w3.org/1999/xhtml" id="viewBody" width="100%" height="100%">' +
      '<table id="viewTable" style="font-family: arial, sans-serif;border-collapse: collapse;table-layout:fixed;"><thead><tr><th style="background-color: #dddddd;border: 1px solid #000;text-align: left;padding: 8px;line-height:15px;width:74px;max-width:74px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;font-family:Arial;font-size:12px;">Column 1</th><th style="background-color: #dddddd;border: 1px solid #000;text-align: left;padding: 8px;line-height:15px;width:74px;max-width:74px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;font-family:Arial;font-size:12px;">Column 2</th><th style="background-color: #dddddd;border: 1px solid #000;text-align: left;padding: 8px;line-height:15px;width:74px;max-width:74px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;font-family:Arial;font-size:12px;">Column 3</th></tr></thead><tbody><tr><td style="background-color:white;border: 1px solid #000;text-align: left;padding: 8px;line-height:15px;width:74px;max-width:74px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;font-family:Arial;font-size:12px;">&lt;&lt;col1&gt;&gt;</td><td style="background-color:white;border: 1px solid #000;text-align: left;padding: 8px;line-height:15px;width:74px;max-width:74px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;font-family:Arial;font-size:12px;">&lt;&lt;col2&gt;&gt;</td><td style="background-color:white;border: 1px solid #000;text-align: left;padding: 8px;table-layout:fixed;line-height:15px;width:74px;max-width:74px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;font-family:Arial;font-size:12px;">&lt;&lt;col3&gt;&gt;</td></tr></tbody></table>' +
      '</div>' +
      '</foreignObject>' +
      '</svg>';
      var img = new Image();
    img.setAttribute('crossOrigin', 'anonymous');
    var svg = new Blob([svgData], { type: 'image/svg+xml' });
   // var base64Data = window.btoa(svgData);
    //console.log("data:image/svg+xml;base64," + base64Data);
    window.URL.createObjectURL(svg);
    img.src = conjson[e].src;
    img.height = conjson[e].height;//((line-height + top padding + bottom padding) * no. of rows) + (border line count)= ((15px + 8px + 8px) * 2) + (3)
    img.width = conjson[e].width;//(width + left padding + right padding) * no. of column + border line count
//  const imgsrc=;
  var imgInstance = new fabric.Image(img, {
    left: lefts,
    top: tops,
    opacity: conjson[e].opacity,
    variable: "",
    objtype: "table",
    cacheKey: "table",
    staticjson: conjson[e].staticjson,
    dynamicjson: conjson[e].dynamicjson,
    width: conjson[e].width,
    height: conjson[e].height,
    rx: 0,
    stroke: conjson[e].stroke
  });
  imgInstance.setControlsVisibility({
    bl: true,
    br: true,
    tl: true,
    tr: true,
    mt: true,
    mb: true,
    mtr: false,
    mr: true,
    ml: true
  });
   canvas=this.tempobj;
canvas.add(imgInstance);
  var ranId = conjson[e].id;
  imgInstance.id = ranId;
//  this.setDefaultTableProperty(imgInstance,svgData);
  canvas.setActiveObject(imgInstance);
  canvas.bringForward(imgInstance);
  canvas.renderAll();
  this.renderLayers();
  this.tableactions();
this.gettimefun();
}
 //this.tempobj.add(conjson[e]);
//this.selectItemAfterAdded(conjson[e]);
  this.renderLayers();
}
}
  }
  createtoolkits(value,tools){
    var dd=[];
    var dd0=[];
    this.layer3[0].group._objects.filter(x => {
      dd.push(x.id);
    });
    var canvas = this.tempobj;
    var obj0 = canvas.item(0);
    this.selectItemAfterAdded(obj0);
    canvas.setActiveObject(obj0);
    this.layers.filter(y => {
      dd.forEach(y1 => {
        if(y1==y.id){
          dd0.push(y)
        }
    });
  })
    var dd00=JSON.stringify(dd0);
   const obj={
      "category": value.toolkittype,
      "contentjson": dd00,
      "descriptions": ""+value.toolkitdescription+"",
      "toolkitname": ""+value.toolkitname+""
    };
  this.userService.toolkitcreation(obj).subscribe(data => {
      this.toast.success('Successfully Saved', '', { progressBar: true });
      this.gettoolkitdata();
      value.toolkitname='';
      value.toolkittype='';
      value.toolkitdescription='';
    });
    this.modalRef.hide();
  }
  gotosharepage(){
    var obje = {
      "documentname":this.documentname,
      "documentid":this.designid,
      "doctype": this.naviDate.formtypeid
    }
    this.userService.changeNav(obje)
    this.router.navigate(['/client/notificationshare']);
  }
  opendropdown(val,selectedval){
    const optionsList = document.querySelectorAll(".option");
    const optionsContainer = document.querySelector("."+val+"");
    optionsContainer.classList.toggle("active");
    optionsList.forEach(o => {
      o.addEventListener("click", () => {
       // selected.innerHTML = o.querySelector("label").innerHTML;
        optionsContainer.classList.remove("active");
      });
    });
  }
  removedropdown(val,selectedval){
    const selected = document.querySelector("."+selectedval+"");
    if(selected!=null){
    const optionsContainer = document.querySelector("."+val+"");
    optionsContainer.classList.remove("active");
    }
  }
  
propertydata: any;
btnEditClick(event) {
  var obje = {
    "routerpage":event.status,
    "tablename":String(this.naviDate.tablename),
    "content":"Editable",
    "designid": event.designproductId,
    "mode": "edit",
    "formtypeid": event.formtypeId
  }
  this.userService.changeNav(obje)
//  console.log(obje);
  if (event.formtypeId ==1){ 
   this.ngOnInit();
    this.router.navigate([`/designbuildersearch`]);
}
  else if (event.formtypeId ==2){ this.router.navigate([`/htmldocbuilder`]);
  }
  else if (event.formtypeId ==3) {this.router.navigate([`/surveybuilder`]);}
}
  changeobjposition(e){
    this.objposition=e.target.value;
    var canvas = this.tempobj;
    if (this.seletecdPg > 0) {
      var innPgCanvas = this.arrPageCanvas[this.seletecdPg - 1];
    if(e.target.value=='sendtoback'){
    canvas.sendToBack(this.selectedObj);
    this.emptycontrols();
    innPgCanvas.setActiveObject(this.selectedObj).renderAll();
    }
    else if(e.target.value=='sendtobottom'){
      canvas.sendBackwards(this.selectedObj);
      this.emptycontrols();
      innPgCanvas.setActiveObject(this.selectedObj).renderAll();
      }
      else if(e.target.value=='bringtotop'){
        canvas.bringForward(this.selectedObj);
        this.emptycontrols();
        innPgCanvas.setActiveObject(this.selectedObj).renderAll();
        }else{
      canvas.bringToFront(this.selectedObj);
      this.emptycontrols();
      innPgCanvas.setActiveObject(this.selectedObj).renderAll();
    }
  }
  }
  toolkitsrc = './assets/svg/toolkit.svg'
  imagechangeoverout(value){
    if(value=='text'){
    this.textsrc='./assets/svg/typetool.svg'; 
    }
    else if(value=='image'){
    this.imagesrc='./assets/svg/imagetool.svg'; 
    }else if(value=='page'){
      this.pagesrc='./assets/svg/page.svg'; 
      }else if(value=='toolkit'){
        this.toolkitsrc='./assets/svg/toolkit.svg'; 
        }else if(value=='datadictionary'){
          this.datadictionarysrc='./assets/svg/dict.svg'; 
          }else if(value=='datavariable'){
            this.varsrc='./assets/svg/var.svg'; 
            }
    else if(value=='preview'){
      this.previewicon='./assets/svg/preview-icon.svg'; 
      }
      else if(value=='share'){
        this.shareicon='./assets/svg/share-icon.svg'; 
        }
        else if(value=='signature'){
          this.signaturesrc='./assets/svg/sign_tool.svg'; 
          }
          else if(value=='shapes'){
            this.shapessrc='./assets/svg/square.svg'; 
            }
            else if(value=='stext'){
              this.shorttextsrc='./assets/svg/small_text.svg'; 
              }
              else if(value=='label'){
                this.labelsrc='./assets/svg/label.svg'; 
                }
                else if(value=='ltext'){
                  this.longtextsrc='./assets/svg/long_text.svg'; 
                  }
                  else if(value=='rectangle'){
                    this.rectsrc='./assets/svg/rectangle.svg'; 
                    }
                    else if(value=='hline'){
                      this.hlinesrc='./assets/svg/hline.svg'; 
                      }
                      else if(value=='vline'){
                        this.vlinesrc='./assets/svg/vline.svg'; 
                        }
                        else if(value=='ellipse'){
                          this.ellipsesrc='./assets/svg/elli.svg'; 
                          }
                          else if(value=='circle'){
                            this.circlesrc='./assets/svg/circle.svg'; 
                            }
      else{
    this.tablesrc='./assets/svg/tabletool.svg'; 
    }
  }
  pagesrc:any = './assets/svg/page.svg'
  datadictionarysrc:any ='./assets/svg/dict.svg'
  varsrc:any='./assets/svg/var.svg';
  imagechangeover(value){
    if(value=='text'){
    this.textsrc='./assets/svg/type-tool-hover.svg'; 
    }
    else if(value=='image'){
    this.imagesrc='./assets/svg/imagetool-hover.svg'; 
    }else if(value=='toolkit'){
      this.toolkitsrc='./assets/svg/toolkit-hover.svg'; 
      }else if(value=='datadictionary'){
        this.datadictionarysrc='./assets/svg/dict-hover.svg'; 
        }else if(value=='datavariable'){
          this.varsrc='./assets/svg/var-hover.svg'; 
          }
    else if(value=='page'){
      this.pagesrc='./assets/svg/page-hover.svg'; 
      }
    else if(value=='preview'){
      this.previewicon='./assets/svg/preview-icon-hover.svg'; 
      }
      else if(value=='share'){
        this.shareicon='./assets/svg/share-icon-hover.svg'; 
        }
        else if(value=='shapes'){
          this.shapessrc='./assets/svg/square-hover.svg'; 
          }
        else if(value=='signature'){
          this.signaturesrc='./assets/svg/sign_tool_active.svg'; 
          }
          else if(value=='stext'){
            this.shorttextsrc='./assets/svg/small_text-hover.svg'; 
            }
            else if(value=='label'){
              this.labelsrc='./assets/svg/label-hover.svg'; 
              }
              else if(value=='ltext'){
                this.longtextsrc='./assets/svg/long_text-hover.svg'; 
                }
                else if(value=='rectangle'){
                  this.rectsrc='./assets/svg/rectangle-hover.svg'; 
                  }
                  else if(value=='hline'){
                    this.hlinesrc='./assets/svg/hline-hover.svg'; 
                    }
                    else if(value=='vline'){
                      this.vlinesrc='./assets/svg/vline-hover.svg'; 
                      }
                      else if(value=='ellipse'){
                        this.ellipsesrc='./assets/svg/elli-hover.svg'; 
                        }
                        else if(value=='circle'){
                          this.circlesrc='./assets/svg/circle-hover.svg'; 
                          }
        else{
    this.tablesrc='./assets/svg/tabletool-hover.svg'; 
    }
  }
  getdocumentcategory() {
    this.userService.getdocumentcategory().subscribe(data => {
      this.dictcategory = data;
      this.getitem();
    })
  }
  getitem() {
    this.userService.getitem().subscribe(data => {
      this.getitems = data;
      this.dataChanged(this.dictcategory[0].categoryid);
    })
  }
  logoList: any;
  getLogoList() {
    this.userService.logoimage().subscribe(data => {
      this.logoList = data;
    })
  }
  itemnames: any = [];
  // clientlist: any;
  // itemid: any = [];
  bkpItemNames: any = [];
  selItemid: any;
  selItemObj: any;
  dataChanged($event) {
    this.selectedCountry = $event
    this.itemnames = [];
    this.selItemid = "";
    this.selItemObj = [];
    // this.itemid = [];
    this.bkpItemNames = [];
    if (this.getitems) {
      for (var i = 0; i < this.getitems.length; i++) {
        this.getitems[i].open = false
        if (this.selectedCountry == this.getitems[i].categoryid) {
           this.itemnames.push(this.getitems[i]);
        }
      }
    }
    this.mainpage = [];
    if (this.itemnames.length > 0) {
      var protyItem = this.itemnames[0].property;
      this.selItemid = this.itemnames[0].itemid;
      this.selItemObj = this.itemnames[0];
      for (var r = 0; r < protyItem.length; r++) {
        this.mainpage.push(protyItem[r]);
      }
    }
    this.selectedItem="empty";
  }
 
  mainpage: any = [];
  open(event, chFolder) {
    this.currentfolder = event['itemname'];
   this.selItemid = event.itemid;
    this.selItemObj = event;
 
    if (!chFolder) {
      var em = document.getElementById("fold" + event.itemid);
      if (em) {
        if (em.classList.contains("mdi-folder-open")) {
          em.setAttribute("class", "mdi-folder-multiple float-left pull-left folderspace ");
        } else {
          em.setAttribute("class", "mdi mdi-folder-open float-left pull-left folderspace");
        }
      }
    }
 
    this.mainpage = [];
    var subitems = this.selItemObj.subitemname;
    for (var i = 0; i < subitems.length; i++) {
      var subEntry = {
        "flname": subitems[i].itemname,
        "selItems": subitems[i]
      }
      this.mainpage.push(subEntry);
    }
    var protyItem = this.selItemObj.property;
    for (var y = 0; y < protyItem.length; y++) {
      this.mainpage.push(protyItem[y]);
    }
  }
  signatureimageList: any;
  getsignatureList() {
    this.userService.signatureimages().subscribe(data => {
      this.signatureimageList = data;
    })
  }
 
  
  usrLogColor:any;
  icons:any;
backgroundcolor(){
  this.icons=this.naviDate.mode
  this.usrLogColor = "#dde2ec";
            if(this.naviDate.mode =='view'){
              this.usrLogColor = "#000000";
            }
            else {
              this.usrLogColor="#dde2ec";
            }
}
  otherimageList: any;
  getotherImageList() {
    this.userService.otherimages().subscribe(data => {
      this.otherimageList = data;
    })
  }
  config = {
    backdrop: true,
    ignoreBackdropClick: true
  };
  openModal(template: TemplateRef<any>) {
    // this.modalRef = this.modalService.show(template);
    this.modalRef = this.modalService.show(template, this.config);
  }
 
  //template
  templatedata() {
    var obje = {
      "templateid": this.formid
    }
    this.userService.templatexml(obje).subscribe(data => {
      this.btnBrouchcreateForm(data)
    })
  }
  watermarktest:any;
  close(){
    this.watermarktest = false
    this.modalRef.hide();
    
  }
  save(){
    this.modalRef.hide();
  }
  downloadType: any = 'templatewithvariable'
  watermark: boolean
  variablebackground: boolean;
  watermarktext:any = "";
  btnDownLoadPDFFile() {
    if(this.modalRef!=undefined){
    this.modalRef.hide();
    }
    let data = {
      'designproductid': String(this.naviDate.designid),
      'downloadType': this.downloadType,
      'watermark': this.watermarkvalue,
      'variablebackground': this.variablebackground ? 'on' : 'off',
      'design':this.naviDate.tablename,
      'watermarktext' : this.watermarktext
    }
    this.userService.downloadPDFstrucDOC(data).subscribe(
      response => {
        let blob: any = new Blob([response], { type: "application/pdf;" });
      fileSaver.saveAs(blob, 'pdf' + this.naviDate.designid + '.pdf');
        // console.log("downloadRes", response);
      })
     
      
  }
 

 
  arrTemplateList: any = [];
  currPage: any = 1;
  tablemode: any;
  contenttype: any;
  editform() {
    if (this.naviDate.tablename == "design") {
      this.contenttype = this.naviDate.content
      this.tablemode = this.naviDate.tablename
    }
    else {
      this.tablemode = this.naviDate.tablename
      this.contenttype = this.naviDate.content
    }
    let jsonObjLoadPageList=
    {"designproductid":this.naviDate.designid,
     "typename":this.tablemode,
     "typeid":this.naviDate.formtypeid
    }
    this.userService.loadpagelist(jsonObjLoadPageList).subscribe(data => {
      if (data.length>0) {
      this.docnamenew=data[0].name;
        this.reply_flag=data[0].reply_flag;
        if(this.reply_flag===true){
          let jsonObj={
            "designproductid":this.naviDate.designid,
            "templateid":1,
            "typename":this.naviDate.tablename
           }
          this.userService.loaduspagetemplate(jsonObj).subscribe(data0 => {
            this.comments=data0[0].templatejson[0].objects;
          });
        }
        this.arrTemplateList = data.sort((e1, e2) => {
          if (e1.sequenceno > e2.sequenceno) {
            return 1;
          }
          if (e1.sequenceno < e2.sequenceno) {
            return -1;
          }
          return 0;
        });
      } else {
        this.arrTemplateList = data;
      }
      if (this.arrTemplateList.length) {
        this.loadTemplateJson(this.currPage);
        this.initPagesView();
      }
    })
    /////////////////
  }
 
  ////// Single page layout change
  fbPageCanvas: any;
  initfbPageCanvas() {
    var dvMainPage = document.getElementById("dvIndPage");
    var newCanvas = document.createElement("canvas");
    newCanvas.setAttribute('id', 'page1');
    dvMainPage.appendChild(newCanvas);
    this.savestateaction = true;
    this.fbPageCanvas = new fabric.Canvas(newCanvas);
    fabric.Object.prototype.set({
      borderColor: 'transparent',
      cornerColor: 'grey',
      cornerSize: 6,
      transparentCorners: false,
      fireRightClick: true,  // <-- enable firing of right click events
      fireMiddleClick: true
    });
    this.fbPageCanvas.index = 0;
    this.fbPageCanvas.state = [];
    fabric.util.addListener(document.getElementsByClassName('upper-canvas')[0], 'contextmenu', function (e) {
      e.preventDefault();
    });
    fabric.Object.prototype.setControlsVisibility({
      mtr: false,
    });
  var _wrapLine = function(_line, lineIndex, desiredWidth, reservedSpace) {
      var lineWidth = 0,
          splitByGrapheme = this.splitByGrapheme,
          graphemeLines = [],
          graphemeLines1 = [],
          line = [],
          // spaces in different languges?
          words = splitByGrapheme ? fabric.util.string.graphemeSplit(_line) : _line.split(this._wordJoiners),
          word = '',
          offset = 0,
          infix = splitByGrapheme ? '' : ' ',
          wordWidth = 0,
          infixWidth = 0,
          largestWordWidth = 0,
          lineJustStarted = true,
          additionalSpace = splitByGrapheme ? 0 : this._getWidthOfCharSpacing();
          
      reservedSpace = reservedSpace || 0;
      desiredWidth -= reservedSpace;
      for (var i = 0; i < words.length; i++) {
          // i would avoid resplitting the graphemes
          word = fabric.util.string.graphemeSplit(words[i]);
          wordWidth = this._measureWord(word, lineIndex, offset);
          offset += word.length;
          
          // Break the line if a word is wider than the set width
          if (this.breakWords && wordWidth >= desiredWidth) {
          
            if (!lineJustStarted) {
                line.push(infix);
                  lineJustStarted = true;
              }
            
              // Loop through each character in word
              for (var w = 0; w < word.length; w++) {
                var letter = word[w];
                  var letterWidth = this.getMeasuringContext().measureText(letter).width * this.fontSize / this.CACHE_FONT_SIZE;
                  if (lineWidth + letterWidth > desiredWidth) {
                    graphemeLines.push(line);
                    if(graphemeLines1.length==0){
                      graphemeLines1.push(line);
                      }
                      line = [];
                      lineWidth = 0;
                  } else {
                    line.push(letter);
                      lineWidth += letterWidth;
                  }
              }
              word = '';
          } else {
            lineWidth += infixWidth + wordWidth - additionalSpace;
          }
  
          if (lineWidth >= desiredWidth && !lineJustStarted) {
              graphemeLines.push(line);
              if(graphemeLines1.length==0){
              graphemeLines1.push(line);
              }
              line = [];
              lineWidth = wordWidth;
              lineJustStarted = true;
          } else {
              lineWidth += additionalSpace;
          }
  
          if (!lineJustStarted) {
              line.push(infix);
          }
          line = line.concat(word);
  
          infixWidth = this._measureWord([infix], lineIndex, offset);
          offset++;
          lineJustStarted = false;
          // keep track of largest word
          if (wordWidth > largestWordWidth && !this.breakWords) {
              largestWordWidth = wordWidth;
          }
      }
  
      i && graphemeLines.push(line);
     
  
      if (largestWordWidth + reservedSpace > this.dynamicMinWidth) {
          this.dynamicMinWidth = largestWordWidth - additionalSpace + reservedSpace;
      }
    if(graphemeLines1.length==0){
      i && graphemeLines1.push(line);
    //  return graphemeLines;
    }  

   // console.log("aaa",this.objtype)
  if(this.objtype!='flowpara'){
       return graphemeLines1;   
  }else{
    return graphemeLines;   
  }
  };
  fabric.util.object.extend(fabric.Textbox.prototype, {
     _wrapLine: _wrapLine
  });
    fabric.Textbox.prototype.setControlsVisibility({
      bl: false,
      br: false,
      tl: false,
      tr: false,
      mt: false,
      mb: false,
      mtr: false,
      mr: true,
      ml: true
    });
    fabric.Line.prototype.setControlsVisibility({
      bl: false,
      br: false,
      tl: false,
      tr: false,
      mt: false,
      mb: false,
      mtr: false,
      mr: true,
      ml: true
    });
    fabric.Rect.prototype.setControlsVisibility({
      bl: true,
      br: true,
      tl: true,
      tr: true,
      mt: true,
      mb: true,
      mtr: false,
      mr: true,
      ml: true
    });
    fabric.Circle.prototype.setControlsVisibility({
      bl: true,
      br: true,
      tl: true,
      tr: true,
      mt: true,
      mb: true,
      mtr: false,
      mr: true,
      ml: true
    });
    fabric.Text.prototype.setControlsVisibility({
      bl: false,
      br: false,
      tl: false,
      tr: false,
      mt: false,
      mb: false,
      mtr: false,
      mr: true,
      ml: true
    });
    fabric.IText.prototype.setControlsVisibility({
      bl: false,
      br: true,
      tl: false,
      tr: false,
      mt: false,
      mb: false,
      mtr: false,
      mr: false,
      ml: false
    });
    var originalRender = fabric.Textbox.prototype._render;
    fabric.customTable = fabric.util.createClass(fabric.Group, {
      type: 'customTable',
      initialize: function () {
 
          this._objects.push(
              new fabric.Group([
                  new fabric.Image()
              ]));
      }
  });
    fabric.Textbox.prototype._render = function (ctx) {
      originalRender.call(this, ctx);
      //     console.log(this.textboxBorderColor);
      //Don't draw border if it is active(selected/ editing mode)
      if (this.active) return;
      if (this.showTextBoxBorder) {
        var w = this.width,
          h = this.height,
          x = -this.width / 2,
          y = -this.height / 2;
        ctx.beginPath();
        ctx.moveTo(x, y);
        ctx.lineTo(x + w, y);
        ctx.lineTo(x + w, y + h);
        ctx.lineTo(x, y + h);
        ctx.lineTo(x, y);
        ctx.closePath();
        var stroke = ctx.strokeStyle;
        ctx.strokeStyle = this.textboxBorderColor;
        ctx.stroke();
        ctx.strokeStyle = stroke;
      }
    }
    //    this.setObjectStyleforSelection();
    fabric.Textbox.prototype.cacheProperties = fabric.Textbox.prototype.cacheProperties.concat('active');
    //    console.log("testt");
    //Event Listerner
    this.fbPageCanvas.on({
      'object:moving': (e) => {
        var obj = e.target;
        if(obj.height > obj.canvas.height || obj.width > obj.canvas.width){
          return;
      }  
        let selectedObject = e.transform.target;
        this.selectedObj = selectedObject;
        if (selectedObject.type !== 'group' && selectedObject) {
          if(e.target.lockMovementX===false || e.target.objtype=='margins'){
          this.setObjectStyleforSelection();
          }
const objtop=parseInt(selectedObject.top)+parseInt(selectedObject.height)+2;
          $(".topline").css("top", parseInt(selectedObject.top)+1);
          $(".leftline").css("left", parseInt(selectedObject.left));
          if(selectedObject.objtype=="stext" || selectedObject.type=="textbox" || selectedObject.objtype=="slabel" || selectedObject.objtype=="flowpara"){
          $(".rightline").css("left", parseInt(selectedObject.left)+parseInt(selectedObject.width)+5);
          }
          if(selectedObject.objtype=="table"){
            $(".rightline").css("left", parseInt(selectedObject.left)+parseInt(selectedObject.width)+2);
            }
             if(this.selectedItem=="shape"){
            $(".rightline").css("left", parseInt(selectedObject.left)+parseInt(selectedObject.width)+3);
          }
          if(selectedObject.type=="image" && (selectedObject.objtype=="imgvar" || selectedObject.objtype=="signature")){
            $(".rightline").css("left", parseInt(selectedObject.left)+parseInt(selectedObject.tmp_width)+2);
          }
          if(selectedObject.type=="image" && selectedObject.objtype!="imgvar" && selectedObject.objtype!="signature"){
            $(".rightline").css("left", parseInt(selectedObject.left)+parseInt(selectedObject.tmp_width)-10);
          }
          $(".botline").css("top", objtop);
          if(this.selectedItem=='text'){
          $(".showlines").css("display", 'block');
          }
        } else if (selectedObject.type === 'group') {
          this.selectedItem = "group";
          // console.log('group');
        }
        // if object is too big ignore
        if(obj.type!='image'){ 
        if (obj.currentHeight > obj.canvas.height || obj.currentWidth > obj.canvas.width) {
          return;
        }
        obj.setCoords();
        // top-left  corner
        if (obj.getBoundingRect().top < 0) {
          obj.top = 0;
           }
           if (obj.getBoundingRect().left < 0) {
                obj.left = 0;
              }
           // bot-right corner
           if (obj.getBoundingRect().top + obj.getBoundingRect().height > obj.canvas.height) {
       obj.top = obj.canvas.height-50;
        }
           if (obj.getBoundingRect().left + obj.getBoundingRect().width > obj.canvas.width) {
             // obj.top = Math.min(obj.top, obj.canvas.height - obj.getBoundingRect().height + obj.top - obj.getBoundingRect().top);
              obj.left = 0;
      //          obj.left = Math.min(obj.left, obj.canvas.width - obj.getBoundingRect().width + obj.left - obj.getBoundingRect().left);
            }
          }
      },
      'object:scaling': (e) => {
        // console.log(e.transform.target)
        let selectedObject = e.transform.target;
        this.selectedObj = selectedObject
        if (selectedObject.type !== 'group' && selectedObject) {
          if(selectedObject.lockMovementX===false){
          this.setObjectStyleforSelection();
          }
        } else if (selectedObject.type === 'group') {
          this.selectedItem = "group";
          // console.log('group');
        }
        this.toggleUniform();
        this.saveState();
      },
      'object:added': (e) => {
        if(!this.isRedoing){
          this.h = [];
        }
        this.isRedoing = false;
        this.getFCVmodified(this.fbPageCanvas);
        this.tempobj = this.fbPageCanvas;
        let selectedObject = e.target;
        this.selectedObj = selectedObject;
        if (selectedObject.type !== 'group' && selectedObject) {
          if(e.target.lockMovementX===false || e.target.objtype=='margins'){
          this.setObjectStyleforSelection();
          }
        } else if (selectedObject.type === 'group') {
          this.selectedItem = "group";
          console.log('group');
        }
        this.saveState();
      },
      'object:selected': (e) => {
        e.target.bringToFront();
        let selectedObject = e.target;
        this.selectedObj = selectedObject
        if (selectedObject.type !== 'group' && selectedObject) {
          if(e.target.lockMovementX===false || e.target.objtype=='margins'){
          this.setObjectStyleforSelection();
          }
        } else if (selectedObject.type === 'group') {
          this.selectedItem = "group";
          // console.log('group');
        }
      },
      'object:removed': (e) => {
        this.getFCVmodified(this.fbPageCanvas);
      },
      'object:modified': (e) => {
       // console.log(e.target)
        if(e.target){
        var obj = e.target;
        var obheight=obj.height+obj.top;
        var obwidth=obj.width+obj.left;
        if(obj.type!='image'){ 
        if(obheight > obj.canvas.height || obwidth > obj.canvas.width){
          obj.width=800;
          obj.left=0;
          return;
      }
     
      if (obj.getBoundingRect().top < 0) {
     obj.top = 0;
      }
      if (obj.getBoundingRect().left < 0) {
           obj.left = 0;
         }
      // bot-right corner
      if (obj.getBoundingRect().top + obj.getBoundingRect().height > obj.canvas.height) {
  obj.top = obj.canvas.height-50;
   }
      if (obj.getBoundingRect().left + obj.getBoundingRect().width > obj.canvas.width) {
        // obj.top = Math.min(obj.top, obj.canvas.height - obj.getBoundingRect().height + obj.top - obj.getBoundingRect().top);
         obj.left = 0;
 //          obj.left = Math.min(obj.left, obj.canvas.width - obj.getBoundingRect().width + obj.left - obj.getBoundingRect().left);
       }
      }
    }
        $(".showlines").css("display", 'none');
        this.getFCVmodified(this.fbPageCanvas);
        let selectedObject
        if(e.transform && e.transform.target){
        selectedObject = e.transform.target;
         }else{
        selectedObject = e.target;
        this.selectedObj = selectedObject;
        }
        this.selectedObj = selectedObject;
        // if(this.selectedObj.cacheKey && this.selectedObj.cacheKey=='table'){
        //   this.viewTableDataJsonsingle.x=this.selectedObj.left;
        //   this.viewTableDataJsonsingle.y=this.selectedObj.top;
        //   this.viewTableDataJsonsingle.columns[0].y=this.selectedObj.top*31;
        // }
        if (selectedObject.type !== 'group' && selectedObject) {
          if(e.target.lockMovementX===false || e.target.objtype=='margins'){
          this.setObjectStyleforSelection();
          }
          if(selectedObject.objtype=='table'){
            if(selectedObject.dynamicjson!=''){
            selectedObject.dynamicjson.x=e.target.left;
            selectedObject.dynamicjson.y=e.target.top;
            if(selectedObject.dynamicjson.hasRowTitle===true){
              selectedObject.dynamicjson.columns.x=parseInt(e.target.left)+parseInt(selectedObject.dynamicjson.rowTitleWidth);
              selectedObject.dynamicjson.columns.width=parseInt(e.target.width)-parseInt(selectedObject.dynamicjson.rowTitleWidth);
            }else{
                selectedObject.dynamicjson.columns.x=e.target.left;
                selectedObject.dynamicjson.columns.width=parseInt(e.target.width);
              }
              if(selectedObject.hasTitle===true){
                selectedObject.dynamicjson.columns.y=parseInt(e.target.top)+31;
              }
              else{
                selectedObject.dynamicjson.columns.y=e.target.top;
              }
            }
          }
        } else if (selectedObject.type === 'group') {
          this.selectedItem = "group";
        }
      //  this.saveState();
      },
      'selection:created': (e) => {//object:selected 
        let selectedObject = e.target;
        this.selectedObj = selectedObject
        if (selectedObject.type !== 'group' && selectedObject) {
          if(e.target.lockMovementX===false || e.target.objtype=='margins'){
          this.setObjectStyleforSelection();
          }
        } else if (selectedObject.type === 'group') {
          this.selectedItem = "group";
          console.log('group');
        }
        this.objsingleproperty();
      },
      'selection:updated': (e) => {
        let selectedObject = e.target;
        this.selectedObj = selectedObject
        if(this.isDynCompSel){
          // console.log("dyn sel");
          var selObjj = this.tempobj.getActiveObject();
          if(selObjj.objtype ==='slabel' || selObjj.objtype ==='stext' || selObjj.objtype ==='flowpara'){
          this.dynamicFontSizeText=selObjj.text
          this.dynamicFontSizeId=selObjj.id
          // console.log("selection id"+this.dynamicFontSizeId);
         }
         else{
          this.dynamicFontSizeText=" "
          this.dynamicFontSizeId=" "
           return;
         }
        }

        if (selectedObject.type !== 'group' && selectedObject) {
          if(e.target.lockMovementX===false || e.target.objtype=='margins'){
      this.setObjectStyleforSelection();
          }
        } else if (selectedObject.type === 'group') {
        this.selectedItem = "group";
      // console.log('group');
        }
        this.objsingleproperty()
      },
      'mouse:down': (e) => {
        if(e.target==null){
          return
        }
        this.isDown = true;
     //  this.getObjectSelected(this.fbPageCanvas);
      },
      'mouse:dblclick': (e) => {
        if(e.target==null){
          return
        }
        if(e.target.objtype=="esignature" || e.target.objtype=="einitial"){
          var evals: any;
          if(e.target.esignatureconfigdata!=""){
          evals=JSON.parse(e.target.esignatureconfigdata);
          if(evals.signertype=="I am only the Signer" || (evals.signertype=="Add Signers" && e.target.status==true)){
            $('#openepopup').trigger('click');
            this.epreviewsign="";
            this.initials.nativeElement.value = '';
            this.fname.nativeElement.value = '';
            this.esignupimg=null;
            this.signaturePad.clear();
          }
        }
        }
        if(e.target.objtype=="stamp"){
         this.stampimgpreview="";
         this.sfname="";
         this.textdirection="";
        this.sfinitial="";
        this.activecstamp="";
        this.stampdefname="";
        this.stampdformat="";
         this.stampimg=null;
         $('#openstamppopup').trigger('click');
        }
        if(e.target.objtype=="checkbox" || e.target.objtype=="radiocheck"){
        this.changecheckboxsource();
        this.changeradiochecksource();
        }
        if(e.target && (e.target.objtype=="stext" || e.target.objtype=="slabel")){
          this.showcontentupdatepopup=true;
  }else{this.showcontentupdatepopup=false;}
      },
      'mouse:up:before': (e) => {
//        this.getObjectSelected(this.fbPageCanvas);
if(e.target==null || this.chGrid){
  if(this.dragacbjtect=="datesigneddrag"){
    this.dragaddText3(e.e);
  }
  if(this.dragacbjtect=="estampdrag"){
    this.stampfpopup(e.e);
  }
  if(this.dragacbjtect=="esignaturedrag"){
    this.createesigninfo(e.e);
  }
  

if(this.dragacbjtect=="echeckbox"){
this.check(e.e);
}
if(this.dragacbjtect=="everified"){
this.radiocheck(e.e);
}

  if(this.dragacbjtect=="einitialdrag"){
    this.createesigninfo1(e.e);
  }
  if(this.dragacbjtect=="freeflowdrag"){
    this.btnAddfreeflowSignClick(e.e);
  }
  if(this.dragacbjtect=="acccsigndrag"){
    this.btnAddacccSignClick(e.e);
  }
  if(this.dragacbjtect=="acccinitdrag"){
    this.btnAddaccinitSignClick(e.e);
  }
  if(this.dragacbjtect=="logodrag"){
    this.uploadlogo(e.e);
  }
  if(this.dragacbjtect=="textvariabledrag"){
    this.dragtextbox(e.e);
  }
  if(this.dragacbjtect=="slabeldrag"){
    this.dragaddText2(e.e);
  }
  if(this.dragacbjtect=="longtextdrag"){
    this.dragaddText1(e.e);
  }
  if(this.dragacbjtect=="imagevariabledrag"){
    this.btnAddImgVarClick(e.e);
  }
  if(this.dragacbjtect=="rectangledrag"){
 this.btnAddShapes('rect', e.e);
  }
  if(this.dragacbjtect=="ellipsedrag"){
    this.btnAddShapes('ellipse', e.e);
     }
     if(this.dragacbjtect=="circledrag"){
      this.btnAddShapes('circle', e.e);
       }
       if(this.dragacbjtect=="hlinedrag"){
        this.btnAddShapes('hline', e.e);
         }
         if(this.dragacbjtect=="vlinedrag"){
          this.btnAddShapes('vline', e.e);
           }
           if(this.dragacbjtect=="tabledrag"){
            this.btnCreateTable(e.e);
             }
  this.dragacbjtect="";
  $(".edrag").css("display","none");
this.showcontextmenu=false;
  return
}
         this.contextmenu();
        if(e.target && e.target.objtype){
       if(e.target.objtype=="signature" && e.target.relatedobj!=''){
            this.selectedsignid=e.target.signature_id;
       this.updateline(true);
          }else{
            this.selectedsignid=0;
            this.updateline(false);
          }
        e.target.bringToFront();
        let selectedObject = e.target;
        this.selectedObj = selectedObject
        if (selectedObject.type !== 'group' && selectedObject) {
          if(e.target.lockMovementX===false || e.target.objtype=='margins'){
          this.setObjectStyleforSelection();
          }
        } else if (selectedObject.type === 'group') {
          this.selectedItem = "group";
          console.log('group');
        }
      }else if(e.target){
        e.target.sendToBack(); 
        this.showcontextmenu=false;
      }else{
        this.showcontextmenu=false;
      }
      },
      'mouse:up': (e) => {
        this.getObjectSelected(this.fbPageCanvas);
 
      },
      'selection:cleared': (e) => {
        this.selectedItem = "empty";
        this.updateValue = false;
        this.selectedObj = null;
        //this.checkvariable();
        // this.resetPanels();
      },
      'after:render': (e) => {
        //   this.checkvariable();
      }
    });
    let self=this;
    this.fbPageCanvas.on('mouse:over', function(e) {
      var obj=e.target;
      if(obj && (obj.objtype=="stext" || obj.objtype=="slabel")){
        self.hoveredtext=obj.text;
        $(".activehover").css("left",Math.round(obj.left)+"px");
        $(".activehover").css("top",(Math.round(obj.top)-20)+"px");
        $(".activehover").css("display","block");
      }else{
        self.hoveredtext="";
        $(".activehover").css("display","none");
      }
   //   console.log(obj)
    });
    this.fbPageCanvas.on('mouse:out', function(e) {
      $(".activehover").css("display","none");
      self.hoveredtext="";
 //     console.log(e.target)
    });
    this.fbPageCanvas.setWidth(this.fbcSizeObj.width);
    this.fbPageCanvas.setHeight(this.fbcSizeObj.height);
    this.tempobj = this.fbPageCanvas;
    this.arrPageCanvas.push(this.fbPageCanvas);
  }
  updateline(status){
   var innPgCanvas = this.arrPageCanvas[this.seletecdPg - 1];
//    var canvas = this.arrPageCanvas[this.seletecdPg - 1];
    if(status!==false){
    this.layers.filter(x5=> {
if(this.selectedsignid==x5.text && x5.objtype=='vline0' && x5.type=="line"){
var obj = x5;
obj.set('visible', status);
innPgCanvas.renderAll();
}
    });
  }else{
    this.layers.filter(x5=> {
      if(x5.objtype=='vline0' && x5.type=="line"){
      var obj = x5;
      obj.set('visible', status);
      innPgCanvas.renderAll();
      }
          });
  }
  }
  initPagesView() {
      this.initfbPageCanvas();
    //   if(!this.editable){
    // this.Templateactions('Sample Data');
    // }else{
    //   this.Templateactions('Show All');
    // }
    /*var dataURL = this.fbPageCanvas.toDataURL({
      format: 'jpeg',
      quality: 0.8
    })*/
this.docname="";
    if(this.arrTemplateList[0].name){
      this.docname=this.arrTemplateList[0].name;
       }
       var dataURL = this.fbPageCanvas.toDataURL({
        format: 'jpeg',
        quality: 0.8
      })
      var iPage = 1;
      for (const pgtemp in this.arrTemplateList) {
        // Create thumbnail components
        var dvPageThum = document.getElementById("dvIndThumb");// dvPagesThumb
        var dvInPgThum = document.createElement('div');
        // dvInPgThum.setAttribute('class', 'indPageList');
        dvInPgThum.setAttribute('style', 'display: grid;justify-content: center;align-items: center;margin: 5px;');
        dvInPgThum.setAttribute('id', 'thumpage' + iPage.toString());
   
        /// create thumbnail page image
        var img = document.createElement('img');
        img.setAttribute('id', 'imagepage' + iPage.toString());
        // img.setAttribute('style', 'box-shadow: 0 4px 8px 0 rgba(0, 0, 0, 0.1), 0 6px 20px 0 rgba(0, 0, 0, 0.1);');      
        if (iPage == 1) {
          img.setAttribute('style', 'box-shadow: rgba(0, 0, 0, 0.1) 0px 1px 1px 0px, rgba(0, 0, 0, 0.1) 0px 3px 8px 0px; border:0px solid rgb(88, 103, 221);width:100% !important;height:auto !important;');
        } else {
          img.setAttribute('style', 'box-shadow: rgba(0, 0, 0, 0.1) 0px 1px 1px 0px, rgba(0, 0, 0, 0.1) 0px 3px 8px 0px;width:100% !important;height:auto !important;');
        }
//        img.setAttribute('crossOrigin', 'anonymous');
        // var dataURL = fbNewCanvas.toDataURL({
        //   format: 'jpeg',
        //   quality: 0.8
        // })
        img.src = dataURL;
        if (this.fbcSizeObj.height > this.fbcSizeObj.width) {
          var imgWidth = (this.fbcSizeObj.width / this.fbcSizeObj.height) * 100;
          img.width = imgWidth;
          img.height = 100;
        } else {
          var imgHeight = (this.fbcSizeObj.height / this.fbcSizeObj.width) * 100;
          img.height = imgHeight;
          img.width = 100;
        }
        // img.width = 100;
        // img.height = 100;
        // img.addEventListener('click',this.btnThumbImgClick());
        img.onclick = (event) => {
          this.btnThumbImgClick(event);
        };
        dvInPgThum.appendChild(img);
   
        /// create page number text
//        var pgTxt = document.createElement('p');
  //      pgTxt.setAttribute('style', 'font-size: 16px;font-weight: bold;text-align: center;margin:5px 0 0 0;');
    //    pgTxt.setAttribute('id', 'parapage' + iPage.toString());
      //  pgTxt.innerText = iPage.toString();// this.arrPageCanvas.length.toString();
        //dvInPgThum.appendChild(pgTxt);
        dvPageThum.appendChild(dvInPgThum);
        iPage++;
      }
}
setactivelogo(e){
  this.activelogo=e.target.src;
}
changedevice(e){
  if(e=="mobile"){
    $(".csPagesThumb1").css("width","320px");
    $(".csPagesThumb1").css("height","480px");
$( ".fa-mobile" ).addClass( "active" );
$( ".fa-tablet" ).removeClass( "active" );
$( ".fa-desktop" ).removeClass( "active" );
    this.zoomsize=0.99;
  }
  if(e=="tablet"){
    $(".csPagesThumb1").css("width","600px");
    $(".csPagesThumb1").css("height","960px");
    $( ".fa-tablet" ).addClass( "active" );
    $( ".fa-mobile" ).removeClass( "active" );
    $( ".fa-desktop" ).removeClass( "active" );
    this.zoomsize=0.98;
  }
  if(e=="desktop"){
    this.zoomsize=5.5;
    $(".csPagesThumb1").css("width","816px");
    $(".csPagesThumb1").css("height","1056px");
    $( ".fa-desktop" ).addClass( "active" );
    $( ".fa-mobile" ).removeClass( "active" );
    $( ".fa-tablet" ).removeClass( "active" );
    this.zoomsize=1;
  }
//  this.naviDate.pdf=this.naviDate.pdf;
}
  loadTemplateJson(temp_id) {
    var curTmplate = this.arrTemplateList[temp_id - 1];//match page with object
    let loadJsonObj={
      "designproductid":this.naviDate.designid,
      "templateid":curTmplate.templateid,
      "typename":this.naviDate.tablename
    }
    this.userService.loadpagetemplate(loadJsonObj).subscribe(data => {
      this.olddata=data;
      this.documentname=data[0].name;
      this.mcright=data[0].margin_right;
      this.mcbottom=data[0].margin_bottom;
      this.mcsetting=data[0].margin_setting;
      if(data[0].templatejson[1]==undefined){
        this.currenttmpwidth=816;  
        this.currenttmpheight=1056; 
        this.tempobj.setWidth(816);
    this.tempobj.setHeight(1056);
      }else{
//        this.currenttmpwidth=data[0].templatejson[1].page.width;  
        this.currenttmpwidth=816;  
        this.currenttmpheight=data[0].templatejson[1].page.height; 
//    this.tempobj.setWidth(data[0].templatejson[1].page.width);
    this.tempobj.setWidth(816);
    this.tempobj.setHeight(data[0].templatejson[1].page.height);
      }
      // this.btnBrouchcreateForm(data)     
      this.loadPagefromJson(data);
    })
  }
  loadPagefromJson(pageJson) {
    let s_json = pageJson[0].templatejson;
    let self = this;
      // console.log("json", s_json[0]);
      var jsPage = s_json[0];
      if (jsPage.length) {
        // console.log(jsPage[0]);
        self.loadpagefun(s_json[0])
      } else {
        self.loadpagefun(jsPage)
      }
    this.getFCVmodified(this.fbPageCanvas);
      this.getrulejson();
      this.generatesignaturejson();
      // if(!this.editable){
      //   this.Templateactions('Sample Data');
      //   }else{
      //     this.Templateactions('Show All');
      //   }
  }
  loadpagefun(jsPage){
    let self = this;
    this.fbPageCanvas.loadFromJSON(jsPage, this.fbPageCanvas.renderAll.bind(this.fbPageCanvas), function (o, object) {
 //console.log(object.height)
      self.setcondnvalue(object, self);
    });
  }
  //////////////////////////
  setcondnvalue(object, self) {
    if (object) {
      if (object.objtype == "stext") {
        self.extend1(object, object.id, object.objtype, object.objsampledata, object.objtext, object.objcategory,object.breakWords,object.linkURL);
       self.setheight0(object)
      }
      if (object.objtype == "table") {
        self.extendtable(object, object.id, object.objtype, object.cacheKey, object.staticjson, object.dynamicjson);
      }
      if (object.objtype == "barcode") {
        self.extendbarcode(object, object.id, object.objtype, object.cacheKey,object.barcode_val0, object.barcode_val,object.label_name,object.label_type, object.tmp_width, object.tmp_height);
        self.setanony(object);
      }
      if (object.objtype == "slabel" || object.objtype == "date") {
        self.extend(object, object.id, 'slabel',object.linkURL);
        self.setheight0(object)
      }
      if (object.objtype == "flowpara") {
        self.extendflow(object, object.id, 'flowpara', false,object.linkURL);
        self.setheight0(object)
      }
      if (object.objtype == "imgvar") {
        self.extendimgvar(object, object.id, object.objtype, object.cacheKey, object.imgvarvalue, object.tmp_width, object.tmp_height);
        self.setanony(object);
      }
      if (object.objtype == "signature") {
        self.extendimgsignature(object, object.id, object.handletype,object.objtype, object.cacheKey, object.signature_name, object.signature_id);
        self.extendimgsignature0(object, object.id, object.handletype,object.objtype, object.cacheKey, object.signature_name, object.signature_id,object.relatedobj,object.dependantvariable,object.datetimevariable, object.tmp_width, object.tmp_height);
        self.setanony(object);
      }
      if (object.objtype == "rect" || object.objtype == "margins" || object.objtype == "circle" || object.objtype == "vline" || object.objtype == "hline" || object.objtype == "vline0" || object.objtype == "ellipse") {
        self.extend0(object, object.id, object.objtype, object.text);
      }
      else if (object.objtype == "esignature" || object.objtype == "einitial") {
        this.extendesignature(object, object.id, object.objtype, object.esignatureconfigdata, self.selectedObj.status, object.tmp_width,object.tmp_height);
        self.setanony(object);
      }else if (object.objtype == "stamp") {
       this.extendstamp(object, object.id, object.objtype, object.tmp_width,object.tmp_height);
        self.setanony(object);
      }
      if(object.objtype == "margins"){
      this.savemarginconfig(object.left,this.mcright,object.top,this.mcbottom,this.mcsetting);
     this.mctop=object.top;
     this.mcleft=object.left;
      }
      if(object.objtype == "header" || object.objtype == "footer"){
        self.extend0hf(object, object.id, object.objtype, object.text, object.allpage, object.curpageid);
      }
      if (object.objtype == "logo" || (object.type == "image" && object.objtype == undefined)) { 
       object.objtype="logo"
        self.extendlogo(object, object.id, object.objtype, object.src1, object.tmp_width, object.tmp_height); self.setanony(object);}
    }
    else if (object.objtype == "radiocheck") { 
      self.extendradio(object, object.id, object.objtype, object.checkboxvalue, object.tmp_width, object.tmp_height);
     self.setanony(object);
     }
     else if (object.objtype == "checkbox") { 
       self.extendcheck(object, object.id, object.objtype, object.checkboxvalue, object.tmp_width, object.tmp_height);
      self.setanony(object);
      }
    else if(object.objtype == "chart"){
     self.extendchart(object, object.id, object.objtype, object.chartdata, object.chartbgcolor, object.charttype, object.charttitle, object.tmp_width, object.tmp_height);
     self.setanony(object);
   }
   else if(object.objtype=="video"){
     self.setanony(object);
   }
   else{
    var canvas = this.tempobj;
//     var obj = canvas.item(object);
 //   this.selectItemAfterAdded(object);
  object.set('objtype', 'newtemplate');
  self.extend(object, object.id, 'newtemplate');
  }
  if (object.type == "image" && object.objtype == undefined) { 
    object.objtype="logo"
     self.extendlogo(object, object.id, object.objtype, object.src1, object.tmp_width, object.tmp_height); self.setanony(object);
 }
  }
  setheight0(object){
    var canvas = this.tempobj;
    var obj = canvas.item(object);
    this.selectItemAfterAdded(obj);
  //  var point = obj.regularPolygonPoints(object.originX, object.originY);
  //object.set('height', h);
  object.set('originY', 'top');
//  if(object.id=="textArea_20" && object.text=="VIOL/SUSP"){
  //  object.set('originY', 'center');
//    object.set('lineHeight', -6);
 // object.set('top', 490);
  //}
  /*if(object.objtype!='flowpara'){
  object.set('lineHeight', h);
  }*/
  //object.setPositionByOrigin(point, object.originX, object.originY);
  object.setCoords();
  }
  setanony(object){
    var canvas = this.tempobj;
    var obj = canvas.item(object);
     this.selectItemAfterAdded(obj);
   object.set('crossOrigin', 'anonymous');
   canvas.renderAll();
  }
  ///// Fabric pages variables.
  arrPageList = [];
  arrPageCanvas: Array<any> = [];
  seletecdPg: number = 1;
  oltargeted: any;
  temporary: any;
  btnCreateNewCanvas() {
 
    // console.log(this.fbcSizeObj.width);
    // console.log(this.fbcSizeObj.height);
    this.btnAddPageClick();
  }
  btnReSizingCanvas() {
    if (this.tempobj) {
      // console.log(this.tempobj.width);
      // console.log(this.tempobj.height);
      this.tempobj.setWidth(this.fbcSizeObj.width);
      this.tempobj.setHeight(this.fbcSizeObj.height);
    }
  }
  signaturerightclick(i,$event: MouseEvent){
    $event.preventDefault();
    this.showsignaturecontextmenu=true;
    this.selectedsignature=i;
  }
  signaturerightedit(i){
    this.signature_first_popup=true;
    this.showsignaturecontextmenu=false;
    this.signaturepopup=true;
    this.signaturechangebtn="Done";
    var canvas = this.arrPageCanvas[this.seletecdPg - 1];
    var obj = canvas.item(i);
    this.selectItemAfterAdded(obj);
    canvas.setActiveObject(obj);
    this.selectedsignature_name=this.layers[i].signature_name;
    this.selectedsignature_id=this.layers[i].signature_id;
 /*console.log(this.layers[i].group._objects)
 canvas.discardActiveObject().renderAll();
 var sel = new fabric.ActiveSelection(this.layers[i].group._objects, {
  canvas: canvas,
});
 //console.log(canvas.getObjects())
 canvas.setActiveObject(sel);
 canvas.requestRenderAll();*/
  }
  addNewPage() {
    this.userService.designaddpage(this.naviDate.designid, this.arrTemplateList.length + 1, this.createpgname,this.createpgwidth,this.createpgheight).subscribe(data => {
    // console.log("addpage", data)
      var newPage = {
        "templateid": data.templateid,
        "name": data.name,
        "width": data.templatejson[1].page.width,
        "height": data.templatejson[1].page.height,
        "sequenceno": data.sequenceno,
        "designitem_fk": data.designitem_fk
      }
      let pNum: number = 1;
      for (var inItem in this.arrTemplateList) {
        pNum++;
      }
      this.arrTemplateList.push(newPage);
      this.currPage = this.arrTemplateList.length;
      this.fbPageCanvas.loadFromJSON(data.templatejson, this.fbPageCanvas.renderAll.bind(this.fbPageCanvas), function (o, object) {
        fabric.log(o, object);
      })
    this.tempobj.setWidth(this.createpgwidth);
    this.tempobj.setHeight(this.createpgheight);
    this.currenttmpwidth=this.createpgwidth;  
    this.currenttmpheight=this.createpgheight;  
      var dataURL = this.fbPageCanvas.toDataURL({
        format: 'jpeg',
        quality: 0.8
      });
//      console.log('base644',dataURL)
      this.getFCVmodified(this.fbPageCanvas);
    }, error => {
      alert("Failed to add page, Please try again later...")
    });
  }
  createpagewidth(createpagewidth: any) {
    throw new Error("Method not implemented.");
  }
 
  btnAddPageClick() {
    if (!this.editable) { return }
    // console.log(this.updateValue);
    // console.log(this.editable);
    if (this.updateValue && this.editable) {
      if (confirm('Do you want save the pages?')) {
        var resJSONdata: any = [];
        var resSVGdata: any;
        if (this.fbPageCanvas) {
          resJSONdata.push(this.fbPageCanvas);
          resSVGdata = this.fbPageCanvas.toSVG();
          var images = $('#imagepage1').attr('src');
          var curTmplate = this.arrTemplateList[this.currPage - 1];//match page with object
          var obj = {
            "designproductid": this.naviDate.designid,//this.naviDate.designid,
            "templateid": curTmplate.templateid,
            "templatejson": JSON.stringify(resJSONdata),
            "templatexml": resSVGdata,
            "templatesvg":resSVGdata,
            "templatehtml": "",
            "css": "",
            "image":images,
            "margin_right":this.mcright,
            "margin_bottom":this.mcbottom,
            "margin_setting":this.mcsetting
          }
          // console.log("json transfer", obj)//singlePageSaveTemplate
          this.userService.singlePageSaveTemplate(obj).subscribe(data => {
            // console.log(data)
            this.toast.success('Successfully Saved', '', { progressBar: true });
            this.addNewPage();
          })
          if (this.viewjson) {
            var pagedata = { "id": this.naviDate.designid, "mode": this.naviDate.tablename, "data": this.myHtml1 ? this.myHtml1 : this.viewjson };
            this.userService.submit_rulejsonurl(pagedata).subscribe(data => {
 
            });
          }
          if (this.viewsignaturejson != '' && this.viewsignaturejson != undefined) {
            var signdata = { "id": this.naviDate.designid, "mode": this.naviDate.tablename, "data": this.myHtml ? this.myHtml : this.viewsignaturejson };
            this.userService.submit_signjsonurls(signdata).subscribe(data => {
 
            });
          }
        }
      } else {
        this.addNewPage();
      }
    } else {
      this.addNewPage();
    }
  }
  renamepagepopup(renamepage){
    // console.log(this.arrTemplateList);
    this.arrTemplateList.filter(x => {
      if(x.sequenceno==this.currPage){
        this.newpagename=x.name;
      }
    });
    if (!this.editable) { return }
    this.modalRef = this.modalService.show(renamepage, { class: 'modal-md', backdrop: 'static' });
  }
  updatemasterdocname(){
    var val = ((document.getElementById("masterdocname") as unknown as HTMLInputElement).value);
    var obj={
      "masterdocname": ""+val+"",
      "mode": this.naviDate.tablename,
      "productid": ""+this.naviDate.designid+""
    }
    this.userService.submit_masterdocname(obj).subscribe(data => {
    });
    this.modalRef.hide();
  }
  savenewpgname(){
    this.arrTemplateList.filter(x => {
      if(x.sequenceno==this.currPage){
        this.templateid=x.templateid;
      }
    });
    var obj={
      "newpage_name": ""+this.newpagename+"",
      "templateid": this.templateid
    }
    this.userService.update_newpagename(obj).subscribe(data => {
      if (data == 'updated') {
        if (this.naviDate.tablename == "design") {
          this.contenttype = this.naviDate.content
          this.tablemode = this.naviDate.tablename
        }
        else {
          this.tablemode = this.naviDate.tablename
          this.contenttype = this.naviDate.content
        }
        let jsonObjLoadPageList=
        {"designproductid":this.naviDate.designid,
         "typename":this.tablemode,
         "typeid":this.naviDate.formtypeid
        }
        this.userService.loadpagelist(jsonObjLoadPageList).subscribe(data => {
          if (data.length>0) {
            this.docnamenew=data[0].name;
            this.arrTemplateList = data.sort((z1, z2) => {
              if (z1.sequenceno > z2.sequenceno) {
                return 1;
              }
              if (z1.sequenceno < z2.sequenceno) {
                return -1;
              }
              return 0;
            });
          }
        });
      }
    });
    this.modalRef.hide();
  }
  newpagepopup(newpage){
    this.createpgname="new_page";
    this.createpgheight=1056;
  this.createpgwidth=816;
    if (!this.editable) { return }
    this.modalRef = this.modalService.show(newpage, { class: 'modal-md', backdrop: 'static' });
  }
  updatemastername(masterdoc){
    if (!this.editable) { return }
    this.modalRef = this.modalService.show(masterdoc, { class: 'modal-md', backdrop: 'static' });
  }
  drop(event: CdkDragDrop<string[]>) {
    // console.log(this.arrTemplateList);
    if (event.previousContainer === event.container) {
      console.log('dropped Event', `> dropped '${event.item.data}' into '${event.container.id}'`);
      moveItemInArray(
        event.container.data,
        event.previousIndex,
        event.currentIndex
      );
    } else {
      console.log('dropped Event', `> dropped '${event.item.data}' into '${event.container.id}'`);
      transferArrayItem(
        event.previousContainer.data,
        event.container.data,
        event.previousIndex,
        event.currentIndex
      );
    }
 
  }
  createpage(){
      var resJSONdata: any = [];
      var resSVGdata: any;
      if (this.fbPageCanvas) {
        resJSONdata.push(this.fbPageCanvas);
        const page={
          "width":this.currenttmpwidth,
          "height":this.currenttmpheight
        }
        resJSONdata.push({"page":page});
        resSVGdata = this.fbPageCanvas.toSVG();
        var images = $('#imagepage1').attr('src');
        var curTmplate = this.arrTemplateList[this.currPage - 1];//match page with object
        var obj = {
          "designproductid": this.naviDate.designid,//this.naviDate.designid,
          "templateid": curTmplate.templateid,
          "templatejson": JSON.stringify(resJSONdata),
          "templatexml": resSVGdata,
          "templatesvg":resSVGdata,
          "templatehtml": "",
          "css": "",
          "image":images,
          "margin_right":this.mcright,
          "margin_bottom":this.mcbottom,
          "margin_setting":this.mcsetting
        }
        // console.log("json transfer", obj)//singlePageSaveTemplate
        this.userService.singlePageSaveTemplate(obj).subscribe(resdata => {
          this.toast.success('Successfully Saved', '', { progressBar: true });
          this.addNewPage();
        })
        if (this.viewjson) {
          var pagedata = { "id": this.naviDate.designid, "mode": this.naviDate.tablename, "data": this.myHtml1 ? this.myHtml1 : this.viewjson };
          this.userService.submit_rulejsonurl(pagedata).subscribe(data => {
 
          });
        }
        if (this.viewsignaturejson != '' && this.viewsignaturejson != undefined) {
          var signdata = { "id": this.naviDate.designid, "mode": this.naviDate.tablename, "data": this.myHtml ? this.myHtml : this.viewsignaturejson };
          this.userService.submit_signjsonurls(signdata).subscribe(data => {
 
          });
        }
      }
  else {
    this.addNewPage();
  }
  this.modalRef.hide();
  }
  pagesizetype(event){
    const val=event.target.value;
    if(val=='custom'){
this.pgsizetype=false;
    }else{
      this.pgsizetype=true;
    }
  }
  pageonrightclick($event: MouseEvent){
    $event.preventDefault();
    this.showpagecontextmenu=true;
  }
 
   tableAddRowIcon(isEnable){    
    let self = this;
    function addRow() {
      self.readTabledata();
      self.modalRef = self.modalService.show(self.tempAddrowRef, self.config);
    }
    function renderIcon(icon0) {
      return function renderIcons(ctx, left, top, styleOverrides, fabricObject) {
        var size = this.cornerSize;
        ctx.save();
        ctx.translate(left, top);
        ctx.rotate(fabric.util.degreesToRadians(fabricObject.angle));
        ctx.drawImage(icon0, -size / 2, -size / 2, size, size);
        ctx.restore();
      }
    }
    if(!isEnable){  
      var addRowIcon = "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAOEAAADhCAMAAAAJbSJIAAAAdVBMVEX///8AAADa2toSEhLV1dWlpaXPz8/o6OhhYWH29va0tLR1dXXKysqGhoa2trbY2NgMDAyYmJhVVVVNTU14eHi8vLzGxsZbW1urq6toaGhAQECDg4MICAgYGBgvLy9wcHCPj48gICDt7e04ODhFRUUlJSWVlZVmN+ZTAAADBklEQVR4nO3d23LaMBCAYdnYgCEcHIw5lXAIyfs/Yju9sMUMlbXLlMx6/u+aHfH3KpJl6hwAAAAAAAAAADBnmPTGiELzKLSPQvsotI9C+yi0j0L7KLSPQvsotI9C+yi0j0L7KLSPQvsotI9C+yi0j8K/lgOp58bvv6J48V/iwjIVWy/b8Uo+Pm6nj0P5+EFYOHv8kbBtM75XTBcfzXitWf0kK3zTrFE047lmfNaMa6bd/AWF7kcLJxRSGIPCMAo7UOgojEFhGIUdKHQUxqAwzEDhz+4PhYWlZo12D/quGb8140PNeCUrTM6Z+KRk65/TiMcz/5xmLV488wMjTxOlp13L58bvp588quO81D4K7aPQPgrto9C+mMJLPp8IvfvjpXB8/u0/49xJ156X0sLx44+EndvAQj49Ojbjms1XsZIVqp5Rjppx1ear3R0o/n3857Ps8SkMoDCMwg4UOgpjUBhGYQcKHYUxKAyjsMNrC7ea6dfeL51o1qib8ZNmfNOMp5rxUlZ4XMiXuHoHNYozAm+PvlNs8mv/6V7MSdRgLPbpz2+k0/45VnITL77xxzlN7AEK7aPQPgrto9C+qMJVNRWpxnfXvm6y6en07m++y044Xe2lhR/Xx58J8u7eKXYH7c4kqRSLp1+ywrliDbdoxlUvaJ66vmCYcPdkcI/PG5aOwhgUhlHYgUJHYQwKwyjsQKGjMAaFYRR2EBaqbtCmzfi3Zry9Qas5YJDeoN1orum2P9U0UHzHtL3orblifL3JCpPVORcqd974p3h89uGNT6XT+fnuKIrTRPsotI9C+yi0j0L7KPxjUBdiqfeX5UQ+7j0d24/k41v/Dc2IQtUGr33GudOMt69IZprxmayw/zdo+7/Hp/AxCsMo7EChozAGhWEUdqDQURiDwjAKO7yi8Ppc4eGlhWfNGnkzvlJMX9vnY2vN6sL/hSU5vC2EstL7EdFTncqm09p7g/CSSxdPaz+Qs7YeoNA+Cu2j0D4K7aPQvn8UFllvqH4AFQAAAAAAAAAA4D/7Da5WmILnWwsAAAAAAElFTkSuQmCC"
      var addRowImg = document.createElement('img');
      addRowImg.src = addRowIcon;    
      fabric.Image.prototype.controls.addrowControl = new fabric.Control({
        x: 0.5,
        y: -0.5,
        offsetY: -15,
        offsetX: -10,
        cursorStyle: 'pointer',
        mouseUpHandler: addRow,
        render: renderIcon(addRowImg),
        cornerSize: 30
      });
    }else{
      fabric.Image.prototype.controls.addrowControl = new fabric.Control({
      });
    }
  }
  tableactions() {
    let self = this
    function addColumn() {
      //self.openpopup=self.dialog.open(DailogComponent,{hasBackdrop:true,disableClose: true})
      self.fontSize = 12;
      self.fontFamily = "Arial"
      self.FontSize = 12;
      self.FontFamily = "Arial";
      self.readColumnData();
      self.modalRef = self.modalService.show(self.tempAddcolumRef, self.config);
    }
 
    function addRow() {
      self.readTabledata();
      self.modalRef = self.modalService.show(self.tempAddrowRef, self.config);
 
    }
 
    function setting() {
      self.fontSize = 12;
      self.fontFamily = "Arial"
      self.readTableProp();
      //  self.openpopup1=self.dialog.open(PropertiesdailogComponent,{hasBackdrop:true,disableClose: true})
      self.modalRef = self.modalService.show(self.tempTableProperties, self.config)
 
    }
 
    function renderIcon(icon) {
      return function renderIcons(ctx, left, top, styleOverride, fabricObject) {
        var size = this.cornerSize;
        ctx.save();
        ctx.translate(left, top);
        ctx.rotate(fabric.util.degreesToRadians(fabricObject.angle));
        ctx.drawImage(icon, -size / 2, -size / 2, size, size);
        ctx.restore();
      }
    }
    if (this.seletecdPg > 0) {
      var addColumIcon = "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAOEAAADhCAMAAAAJbSJIAAAAhFBMVEX///8AAAAvLy8yMjLu7u719fXq6uqmpqbT09Pl5eXi4uL5+fnX19e8vLzt7e3Ozs6vr6+EhIRiYmJ4eHhra2vExMRycnIkJCSMjIzb29ufn59mZmZXV1fKysq0tLSBgYFJSUlBQUGSkpJbW1tKSkocHBwVFRU7OzsMDAygoKAXFxciIiI7eJOAAAAL00lEQVR4nO1d6XriOBDMJDgGAjE3hCPB5Jhk5v3fb5c1BLrVsmW7uu3Zb+pnArIKWX2rdXPzF38RgE4/GY7W4+litplMJpvZYjpej4ZJv9P0xOrjPolXk9sfftxOVnFy3/Q0q+F+ftjmUKPYHuZ/Fs3+aPYZzO6Mz8Wo1/TEgxANF79KszvjfTp8aJpAPjqjt8rsztiO2iuAnuvTO5EcNk1FQncBopdhOmiaEEX0lacSquEubs+W7E3h9DKM26FCBhMlfkfM+k3Tu0lQ0sWH12Y3ZFeb3xHbp8b4DSz4HfHazLvamYVOcLmfHuJ5d/DtS3T6g+48Pkz3y9AhXiJ7guugmc3Ww37e5KL+cL0JGik2Y5ZhV2xZ7w+7UPOrMz/sC8dbdlUZUURFL+hylZRV1w+71XvBqFMVMhKGBYsXV/WC+us0f+gdlIcPD7kaPo3reQad+GfTyzjPm8AKIdb7q5wnfKrvxpec5cP5PM85C3mAPUXCo//JC6zlMfDrkK2iz+EXMWO8X37v91gS+MNO8O6PF524w73Xqf5Sed6NLzi4edR53r/ovXqeuVB4WMfjxae6ln9yJz92D9+MT54fUz9mNJIf/AH2/z1acIx9iowHj8iBvjzP4iN+WrltA9nLAorUWHzAGveAQshifI4a/ksafWnrd3dFdw0kBQ7S2C+YsUtA9NieESOLzjzs/SgBURgAVlHag8tmIrWixqr9W0s/3AQx3SqIpFhHzXjqThjSUoZySM5bLZEnvRfNZr6kTVPD7u/gX4raEKyrZfXRBGO7+VR7153UtupYrrv02YZ0l7B1Kmpn11L6aCC2LqDvUqyk+d2QxUdbSggEihUcjZ4zyK92rOARAsXyHrHrsLRlBY9w9+Jr2SHcIFDzUvQarkQtGZ1yjbWm9SCHKyZKbUVX1bevhsfxeX6X+baTvm7SFvXBCd+U0IqO8TfTm2cNpHyawVkb5x2905xndUR8nh+h33QCzUg9gYzkDvhEV2Hfc6QULGQxGB9LT9/HsDCgs53CfEX+LVTYt3eRX1uUBc+dgzTkS9zgvgVNhjp2oPfigS9HgAnu2KOguCiPh4CKDrhD/Fn8Fb7uoFSda0OARA7XioVJ8IR9YY+ZhxDPRZVVfLBxizwgnqgHiYRHhyBsEfmaFPxyXFOgrDUpRAaJyN+4blC+4PhNP4ySo2LSAZX64PI0N2DNnSaYapaqVN5Qg/MXJM+NYktY2m/2QsrG46xdFo/Y+D/JdyHOrddlyHWtXzyydwmYI9RlyJW4V5xyuQt0A5QZ8sCUTycyrwlZIqfM8IZVhHqU3L3eEqoz5Isof4o5FdAqR22GfBHlwJniEuozZO6+qGuZqsCWO6kz5OFBSdEFfKQ69BkyR1HYY8z6B1cj6DPk9pj7ARZCBpfhGjD8KiJA51AjNS7CgCGLnjp2DcvIocuMDRhyD43/mxWvoXOFFgyZ0clfU1p2gXObTrBgyCI2zG9gFhs8l2bCkBll9J9x3j8BMGHIjFPq6lO3IsdJrggThszXpw6G8ktqxJC+psQ2ZWIIf7DIhmHXT4PqisplYn7YMGSv4nVqJCX/UThUbMSQKv0r65vFVBWq8I0Y0njvVTKRuo/v+CdbMWRq/fIPqg3xusKMIdMXF41Iz2uOFJ5sxXDhYeJjjoMVQ3rQ7duDYoJG4cFmDKnh9i1qqKLcKzzYjCHTiOe/0qVVOdFkxpCmXs7hNGrOoVKzBGYMaeHC2aqhjoVKIakZQ6r4zsEYKkpVqrnNGNJU4imsTUWphkVjyJBaNScfgsaCgyrDSsOMIV2uU1CU6hCd/ihmDFlILfsbTcnotA6xY0iPKGZRUaoOy1il0WiR3oZAboxwF/TddFqq3SdVF1nNAnXww2sGO1rtEl1MwwU8ZZNVftNzmcHqMLfZEBzBPzxN0GQxNer6h+YNC9phwRFKkbr5mYFGU+CB74N78EsbgZuRqvxMqtBym8Cfyqpl4gWBuRTqKK2FyYaNw4uLLBDmmdOYU6b7JB1ZBDsxekFY7cST8B2qI8MYWjI7I6zYlQqIzEKrsg8tmZWbGjVMs7jha91hrFDhx89KSiZ1h7GCKUN+BMACgZ4r+U7GkMaDwzR+TvtENYSFyKR9SK22sPZyQusGdYRZzPRwTnY0lOq2wMRT+O0cKARmNSVtUcm34OW2+gjsXShpfMmjKoat8xTuW0h2KfXxg6sUbE3T4EpC+stnvgX1qMJT3FErfXwaEs78Q+pRlYlEWcVpygSp6Z7Llp6WJWp0BrWMtdEcaRaxoBHhvcpzm40mimFiMOwY0iSM+Mc/OzNDK4XPLiW1T1R6WpoxpELlXI8/Jn9V6dNixpAGOc9dJKgKUUlcmDGkyuKcoqDWiUbBkB1D6uyeTVDWDUDjwQ3VYkQFfwbCiiFdrEsLCSpMNfrLWjGkdvflaBMtN9EQNVYMfUyoiN0rPNmKYep5G5nDrnB/hBFDFse9SlfRZtkK99UYMaTb8Dr8SMNtgf2kysCIIbXOrstKaCAD1u/jAiOG9I7X6wo9djYP32nWhiGjQaJz9Igp/jiCDcN1zvg0qATrq/ING4YpGZ9mVFn0E96M1YQhU3pUJTBFAn9NTRiyw9rsv9Q0hRcomjCkBQncC2T31aBDGRYM2QFLHqtgPiJa6VswZDlNx/Zk6TLw0y0Y0tHdUAVr8wWORxkwZPvM9XKZNN1jH2/AkDW5Ej7BWhJgTz/pM2TJPinpzz6CzdDoM2RNhsQFYn3doHaNOkNmdP8UP8Tan0DPP6kzZHtMrlbnpVzIRdRmyAt6PR9jWWtkpyhthqzDp89g4U3PgIuozJAvodeFZ3YNUJwqM2TdAv1N8nkBCU4n6jIsMW9mF+B8fV2GbPS8+jBe6ASzTlOBIcwJ5TeV5hau8W64qElIxUWoU3L8ioT8Ej/ezRXlJ0oXwqI6G/Be0AXSg58UATn70g1uoDwlL3Utum2E60TZwCsP9+4hlFX4zsYtrNLknbdB2UTnPhHUEvJ67OJ95bxPIKXIdzioMaNzBWVAapBfHYsqA6OaCJTBcw5+BIkvfvMuSqpr3FHCr8QJsyKchQfeM3M8p/E+hlmDzoUEgSNv+PeQ2TbVu4JCHT5H7imkTBFw5hlwBcsJzr1yjd0AnIuUT7OEfHbOi+j0IagHx9YtIxJd/fwH3J33q9TX3fMiwbe2GcE9LV+ysY7r7rT9DsvSV+K4XnngwSMTuPeQlm9n6d5f1JLbgI+A3CUrbMX/2X3ArgneGorCtdUV4wXOTY/tuJfbsdVqeNNCDLB5iSqcCqzeNNdV/M3fCyx0janjwQpbWqUMPBxfwoxqSQfpoGiTdwNLcdea4UCplVBjnkaUamwb6V6/22bMG0GIQjaNRFGjFLzaRCA+j+OmHIG9SigEE2kaoFak4o93q3JO0Qv5bDzMaxUparRu92IszgCouJzAzX9IrQychOcmMkCdck+PCIWTGS4i6RLTH/Cu3II9j35RPJC3yI93uMbq3MpPetN9VZOl57EaD/O1pHnR8/17Tvj9BJ0+sh6B9i9WOhx7ng2oKMb9/S4VOPa9/DQjm4/SzcWn9wZrASRugOGMV4XzkVfI6UnzBpOrDyOPWDtC3XnL68z6cUDEcQZ5rdJ+GcQYIv/7c1zIUu1yXNyvc5ZP6VoDF7IN941tXHUlnw7+fX7EJ/jeST8i0ZO5wt2htLiL5oV9/Ew9toBeZtv1LvSFvZ+v0sLx7jRuh8mDGxEX8LmI5708ntHT8FD0QmTQuN+nAI8+i8rB8m16iOfdQf8U9nt47A+SYXxYpLJXJGCsqwN96O6LpwbBprlkQpIa8JvYxks4dtrruLEWMC66uRZATUybzwQd0XeLRzFYtSNfeUS0/l0835JIG9APuUj87lwV4Kr7gHgYoaTOpH31SWc8juqLncWwPTUfMuYvwZaKg5/lLfZm0I+DLboL3qfPbaiDCEdveHjl9dQ+LDfrXXsUQylESTx+9cR0j/i826xGg2asaige+7vhaP0yXcw2k8lkM1tMx1+jYdL7Q9ftL6zxD+6vj+j7lvsPAAAAAElFTkSuQmCC";
      var addColumnImg = document.createElement('img');
      addColumnImg.src = addColumIcon;
      var settingIcon = "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAOEAAADhCAMAAAAJbSJIAAAAgVBMVEX///8AAACFhYWNjY19fX38/Pz29vZubm7Y2Nj09PSvr6/v7+/5+floaGjr6+uIiIjR0dHKysrc3NxTU1MxMTG1tbVjY2N1dXWioqJNTU28vLzj4+NGRkaWlpbDw8OpqakqKio7OztbW1sPDw8jIyMbGxt4eHibm5sXFxdBQUEuLi4K5pU9AAAPd0lEQVR4nNVd6UIyOwy9rIIgqyCLiCzqh+//gFdEYU6aJunC4vlL6TTTNnsy//13bswnD4+bEoPN6/ijcfbHnx39Z464Ez5n115hGtprmb49nlvXXmUCOv90Ar/wd49qx0TfFwbXXmkkalsrhaXmtdcah3czgaX1tdcahbmdwFKpf+3VxuAuhMLptVcbgXoIgaXSHxQZL2EU3l97veFYhFF4d+31hgOu4bbKYFgcsbr2esPxVlx/hx2yKw5pX3h9yajBGeTHVIpD5pddXzoGxdV7BPp9cczLZdeXjlFx9V1+TKM4ZnHZ9aUDWOmIH9P808wUDEOfeVQc83bR5WXAa3H1dc8geA0XXV462sW1v/pGdf8wMwUm4rWNgB2ZHDbtVi3fIjk0PsbT1XC86GkDYe1eNhnGTHvVx8MLW55LTW8X+ON2KY+F8+dhpcT+GMszvqwKYx94JSkRsxLgn7iPoHP63TBFfvQozVd7wKefwxbpligqwmgY6B8GzFS4YT3n4aVqNCUecE6Xnfc+gCzf+Gc1aqaVEoPMKsIT9wzvDasti4Me/NMCQ5qOeJdbZ8U/XLm4YfC6zbjVvxAPjcAkB2S64cg9qvclH4RXFwrBqbQhDGfu3ldB0NXcCd9xQjEukG0XPUf0B8Utmk2ZAZKywk34WeCTffHRuXZRcwv+hlZqEz5MIVnvY37Kxc+NLCuPzrOLBr/n/hy2fa4nUc6xXHKP8tdrmz/qj86wiybH7lP9w/ubyNVn3r+Vukv/bzlJdAlcmR58gqh9NPX/A6bupieS6BI4024/hfwA9aYBPoi2nk4i1QYPDqOaIbJ7hBZzUaLgRbx9K7guiQnsxiXwR7b5pTCFamfZg3C/FzrjLrqs/Ojy82lSiPXSYq92lh6ZgTgpDtl20buD33B1F4JqL8Ac71XZhJQTQMvPtIv8HSwsSlrQU3jIs9cViCSWmkviUziBLlumXuma73DtGP3ZBFbpK7nKL0fiJPRh7g4xbveRM+gL7ymZFfMqM+OYeWEuiaGODUdhYuMKnR0d1vX5Rq2oO4eHN0IdEgOzHZwIri9wgusp50gbQQ330WeaOCSGOVyH5N/+yFDjxB/usnn5Tu+t7B9EzWfJb+SAWqZS6Kv2o9mtciZvdQ5q01ZkyWQXdyEP6NkJ/MK8Mp1Wc8f/5suPD00hIrsYMv19CIFXBO5iyEUEa++WE0GAKYVcE6DwljOyxrEUwindnm19yUCVI4SVo5EbofNdBq14TkOS0m6V1aBGFWZCERX4NjNciX7nDeKxIDr1TSZHUuMg8O/EuRtsm5wftU3aEqnqfXvJ5sRCf738BGcGtU3Dt4Aq39ljrmmglQ4x14he5NtSbYjpPYyahBrbqdZ7TtAwUOTaiCcj7j2dBdS+j1VJcpx1RK3ebDXryWlNVFDE8wjqvI9PPas17isPu9/0mdfdQ+W+EU8oiRelmAbjHFO1+xU+/LLr9qOyu2nQMSXnr03mEvxCHtRmclBiPAveSmJRJF4eKjL0UBKgwTl4Kd4DXVgktpfKAEkARgzKU2gVskc8h8hayv+ShRgRGXbfeX9lpG+PlZ1Goq6l266kyM66kg71KWsYWt/dBP4WzhlcYL6QkcLAqqdvGOsRcA8zqMuEc5ne9MBeH1vE1sT2YxYkApMlni1/wXMUAhPjR7su2U1GEl4s0sINHtthSRrNvIloYBjcWW1DqpaAlUHLIRG9RArx+brPtSNlHGyn64enh/VUuqb/DHuC/0ir60PdW2dcNKZ3xPOiX1x6p7/wqgO6PwIveprW9glzqVvoRte/MZ5xDtemT2XVSYThSRVTqJaqW8iW4L9N/HpVffLG/UWVGriJKf4VlPbaDWETDTVPNJfPsdF0TXSTJWTtB07EMJAPw1OY1NRP7T/ITuOVb3y/mix05eDaFu9qubmOmhxHAyM+hhtUT+6m9Nof7OY6aocbmFR0WAXvlVLL5XKZEC+0K2WUS48Rztg0FzykimCFotEvPIZF5Jqf5P/akQEmrLx9D2po4in5jZRdhPsWaNaeIsiB12zeP/pB+un8ZXK3Ig+UbWnqWohpqUNJlI8eoz09P010Olv95Tul7QD5f4QbBqUnHUF0dkU60WtxfHZ12edfTn1WfvarzfIhpS65OGWYagwyqxLdCK9VNyVVybWW65BXODjWRUvUWvkue5X8H2CeXVutjBHVBhIwjhfAxDsg6xhqM7hCsqL2OjTvBRpCKY27hgEzySV1exyvlk6g7Acjhysly5TwZPG4CzVTv/hhVpbaI9HxjjUhaQYp8g9PU5QDmPJMB4cLY/Ddioofhm9SO3jgg8WhbCI9wV6zsjTlEg8ePii1W2dIaqu/JPCIvdWu+8aGsv0F0j49kREerUj9ge65rKtsZrxQgl94SON04CLwJmqja50vDdOn3uwx86sGr+vFaGAIX+IpT2/ZhQ5fY8By/rIY84exytYar7ujhtkzAG7/HI0O4NSHtI9qD2YVh5wp2lmlYfe+EZhqCa8uR1oRcK5wK6w+AGb1Bhc7KML7A7yGOfrj4DGNmQEC10BhzBkDsyJPp9VVccoYLR6s42QKwQFlcR4GLjBGvualEE5EYKqGB8CdYzrV5aUQOF+e5D5w28WEsfNSCKw04v8cilPG+ELzUviWuBptzhj+npVCEBa5+sUUvW4xim5WCqH2JFdxjbVBlg+3TyFYDBHc63wU5mq/BU6DiHqd893DXK2pwMd0bQrBWZKL09zUKQXOnivX/aY4DUj814j/c1glzpmXQvAGR/yfQ3HKmFbmeSkErpCn6SYYiDHcKy+F4OfJU2wKEezr2xbgWw9q3OCFpVO2iLwUgjcyLjJKAcHgmMLHvBSiBzdHwTCWWcfMAO6//4ph322MIwnCHjm+wAUmfrhB1myAY+UfyT6clu97gUoE3JocWg24PENudr0x6jrpVc9czvJ2WLlvmJ3XGMNPP6Z4SG2en3ZjVBnyebllIe18XBkNLPsJf0r3tuGCtNH7fRNTEGbaZ5lexwvNjw05AEJbZCMgPK/wPkPdUdvSuPBT9spiilmM/CoCo5GyCuHtfnpC2VkgD1ko4dhECgMms9R1fF8zS9dC8UlY35Z2EzGsK1YaWL6ZdThRbaVl4R5i4JNc5UvlYhgacFb5aTnIgheFUIodPAyYST9778exHb0SSxQbJKEmPtJN8oxlYaiuGfJe1Ga3MlMjCSuxbUJIToG8hWLvzS/syBHvKK1gZVcorSSJi9DQ1CU5RULclMcy85bb/a6nueY35MWROxH3FTWSaqDouD7+OPxSrQXdsdVblofsf2XNhlaQx3CbsBxh95C+7ZMQjIy82bsv0+cpHvuL53nDIX2sjEJNoj1ayNmU0TSbJTBXv+Xk+it/gMGx/iFM/lMUTleDD8kxCG4pi6mX0SkgYDVoJcCuimHPFXbrbTQFHs50fEQIE7o0Kefm7Brrnpja/XflLyg5E5yYMI8aHVw5CzWp4Uxmneqzw34bJlp4oNWg8Y42Vy6pHTdOf1Y9YqgbpHhp8TCIOcl7sCr8duJ3+TQ/2IR79XCj6Zv0TTp0AKgCwOMSGc84YdWceb6xoEY/0DI0dUHwApmyuol+r8/UqeV2WoGbCSRbmOijRQ1Ol+JKPf5Yrcd/0wnELfyXRiDxhRgEzwV6KqBYSu1ARooaLJZf0EfVCTQ5uAexIpNTWlFamW61/QsmFCZXJKro6S5o0u7LlOY8j+tP82kKIRNmluFr17iJlmP0n6nWw4HRvYM6bI6c3Tjh0wrtUnNntbaQ9+WIOqMKaBevjZBeWGu784rc8vS0ZFIWFWKoNKzfhRqHOOeoUpHKS6n/K6ygYm75JFc3MEeFvLfUoCw5asE6YG0mi8encNuOer3SvmxAwztRMYmex005rMRdIlo8mpKnRAvb4pXcwejUv3TzuburjBJsHnIs4ryzBxDJnZw/Wqvvkb0HbbzIIJ6Xf2f+6rcd1DUXKzLoec/5qZxE0Ph23CxUUMTk0J0Nqxz3h6Qw5MlZywXqEopJkKBOvrN8sD0e1EQLl2P0MqdmkWQHCeiF+6NIpCTjN7AzgfapDt0Ccgg2NyMoTiARxNBmDmQL85ROZgZR68OMAqKu5cluzg5064XVYqLGnaL4nRPzhFWiD+LGBMUJQVFqBJiFN/xpOVhnUCS/qM+kdpw5J0A/DRL68G5ukpF+AwVG0F/xHuqOonlSDI+dcfmx1J5LJGLQ/MSjK9tNne/38ZSTH80Ph2gnzkkIDHNJ0Ywj6W0e85bLuRSf2kmWC1yOrjEwJZKGAb272C469xYZogjkAK19UzppX4FJUU4OtWcXe+RVJNPYdkIePKNzCAzuze7EctldZL4hz+U9msG6kLngupu4F5zX5jY5c0mc8/He51in44sn1OF+udolMOKZbjEDJdHN1TqiHC5DB8x5OIIwHJfAKNtAIbEux1025V4Aa21UlKDqungIXQIjP5DgvtTCFbO06hsvLZejfm+p+CiYfy6B0d9iEXbR8iGnPfQYrTlc/EtGth3cw+Vsh12cS13uwp5uib/94MBwMu7gHu5B3e9i0IdkZOeCperqhCX3h8SPlLivuD8P+5STXG4jlQcwGLoXJ/mLT8ZTJLB6idsI1VkL2wXN8EkrC4nTJqNt/UIyTLyZfouv99JQeyHn+WaXgcQDw6wt2Q+OiK5avhfw5jclVU0gy0KgSuL2JCVfuGsl5WxyvUV3BQVM6YaciUBF+GGW1NxlBVIzRTevqII6aEsq4s1GoLiLbi7FC122MDGxYO4Y0eJnOBkJ9O/iM5ur1X4BLVMwGYvDtn1ekfUxnKwE+kj0Zq/CcD8zheCBXzVhu6/rKdmBYA7q1m/rgtbjZ6ZQmi4k+zIM5wyhFEdVkxIx+7bFACuV1LsW1aNytBhxMFgVH/Eq2rgQZvdX6oGJKbusZ8Wr/ZSjSwyH/tGQG2vpaPAyvKOgsYr29F73W3Js1pNz0feNxmwymRkSa0CM+TRT0EpNnWjaKcX+eQHsz/dGIBsiwzdTLwoTMwVWmt6v/rIAZuoTXWfosnw5gFnk00yBld5soNmH4uJ9bNIy5naxKq6eZ++QGpiry/LlAF0oePXuT7NSwkx5PglRgRtOh/AAfeJlDjDir7FSU1sfwFk1sfPA4CgrQP226g1C/2hYEZkN9otA6wGESAkcXw2rAAJzdZG+LDwf6WaRPeHoMjA0/ftBaj321WCK7ZbMpbe3CBs/ze4XvCSEdI0jbq7OIQwtpQ9cqZslUeyqaM6qO16/eXsuv5yfvv8BqVq2HEo894AAAAAASUVORK5CYII=";
      var settingImg = document.createElement('img');
      settingImg.src = settingIcon
      var addRowIcon = "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAOEAAADhCAMAAAAJbSJIAAAAdVBMVEX///8AAADa2toSEhLV1dWlpaXPz8/o6OhhYWH29va0tLR1dXXKysqGhoa2trbY2NgMDAyYmJhVVVVNTU14eHi8vLzGxsZbW1urq6toaGhAQECDg4MICAgYGBgvLy9wcHCPj48gICDt7e04ODhFRUUlJSWVlZVmN+ZTAAADBklEQVR4nO3d23LaMBCAYdnYgCEcHIw5lXAIyfs/Yju9sMUMlbXLlMx6/u+aHfH3KpJl6hwAAAAAAAAAADBnmPTGiELzKLSPQvsotI9C+yi0j0L7KLSPQvsotI9C+yi0j0L7KLSPQvsotI9C+yi0j8K/lgOp58bvv6J48V/iwjIVWy/b8Uo+Pm6nj0P5+EFYOHv8kbBtM75XTBcfzXitWf0kK3zTrFE047lmfNaMa6bd/AWF7kcLJxRSGIPCMAo7UOgojEFhGIUdKHQUxqAwzEDhz+4PhYWlZo12D/quGb8140PNeCUrTM6Z+KRk65/TiMcz/5xmLV488wMjTxOlp13L58bvp588quO81D4K7aPQPgrto9C+mMJLPp8IvfvjpXB8/u0/49xJ156X0sLx44+EndvAQj49Ojbjms1XsZIVqp5Rjppx1ear3R0o/n3857Ps8SkMoDCMwg4UOgpjUBhGYQcKHYUxKAyjsMNrC7ea6dfeL51o1qib8ZNmfNOMp5rxUlZ4XMiXuHoHNYozAm+PvlNs8mv/6V7MSdRgLPbpz2+k0/45VnITL77xxzlN7AEK7aPQPgrto9C+qMJVNRWpxnfXvm6y6en07m++y044Xe2lhR/Xx58J8u7eKXYH7c4kqRSLp1+ywrliDbdoxlUvaJ66vmCYcPdkcI/PG5aOwhgUhlHYgUJHYQwKwyjsQKGjMAaFYRR2EBaqbtCmzfi3Zry9Qas5YJDeoN1orum2P9U0UHzHtL3orblifL3JCpPVORcqd974p3h89uGNT6XT+fnuKIrTRPsotI9C+yi0j0L7KPxjUBdiqfeX5UQ+7j0d24/k41v/Dc2IQtUGr33GudOMt69IZprxmayw/zdo+7/Hp/AxCsMo7EChozAGhWEUdqDQURiDwjAKO7yi8Ppc4eGlhWfNGnkzvlJMX9vnY2vN6sL/hSU5vC2EstL7EdFTncqm09p7g/CSSxdPaz+Qs7YeoNA+Cu2j0D4K7aPQvn8UFllvqH4AFQAAAAAAAAAA4D/7Da5WmILnWwsAAAAAAElFTkSuQmCC"
      var addRowImg = document.createElement('img');
      addRowImg.src = addRowIcon;
      //end
      fabric.Image.prototype.controls.addColumnControl = new fabric.Control({
        x: 0.5,
        y: -0.5,
        offsetY: -18,
        offsetX: -80,
        cursorStyle: 'pointer',
        mouseUpHandler: addColumn,
        render: renderIcon(addColumnImg),
        cornerSize: 30
      });
      fabric.Image.prototype.controls.settingControl = new fabric.Control({
        x: 0.5,
        y: -0.5,
        offsetY: -18,
        offsetX: -45,
        cursorStyle: 'pointer',
        mouseUpHandler: setting,
        render: renderIcon(settingImg),
        cornerSize: 30
      });
      var dynamic = true;
      // self.tblProperty.forEach((key:any,value: number) => {
      //   if(this.selectedObj.id==value){
      //     dynamic =  key[0].dynamicData
      //   }
      // })
      if(this.selectedObj.dynamicjson==""){
        dynamic = false;
      }else{
        let tblJs = this.selectedObj.dynamicjson;
        dynamic = tblJs.dynamicData;
      }

if(dynamic){
  fabric.Image.prototype.controls.addrowControl = new fabric.Control({})
}else{
  this.tableAddRowIcon(false)
}
      // fabric.Object.prototype.controls.addrowControl = new fabric.Control({
      //   x: 0.5,
      //   y: -0.5,
      //   offsetY: -9,
      //   offsetX: -9,
      //   cursorStyle: 'pointer',
      //   mouseUpHandler: addRow,
      //   render: renderIcon(addRowImg),
      //   cornerSize: 30
      // });
    }
  }
  emptycontrols() {
    delete fabric.Image.prototype.controls.addColumnControl;
    delete fabric.Image.prototype.controls.settingControl;
    delete fabric.Image.prototype.controls.addrowControl;
  }
  /// Event Listerner events
  setObjectStyleforSelection() {
    //    console.log("aaaaa");
    //console.log(this.selectedObj.type);
    var canvas = this.tempobj
    this.updateValue = true;
    switch (this.selectedObj.objtype) {
      case 'flowpara':
        this.selectedItem = "text";
        this.selectedProperty.opacity = this.selectedObj.opacity * 100;
        this.selectedProperty.breakWords = false;
        this.selectedProperty.fill = this.selectedObj.fill;
        this.selectedProperty.fontFamily = this.selectedObj.fontFamily;
        this.selectedProperty.fontSize = this.selectedObj.fontSize;
        this.selectedProperty.fontWeight = this.selectedObj.fontWeight;
        this.selectedProperty.fontStyle = this.selectedObj.fontStyle;
        this.selectedProperty.underline = this.selectedObj.underline;
        this.selectedProperty.overline = this.selectedObj.overline;
        this.selectedProperty.linethrough = this.selectedObj.linethrough;
        this.selectedProperty.textAlign = this.selectedObj.textAlign;
        this.selectedProperty.stroke = this.selectedObj.stroke;
        this.selectedProperty.width = this.selectedObj.width;
        this.selectedProperty.height = this.selectedObj.height;
        this.selectedProperty.translateX = this.selectedObj.translateX;
        this.selectedProperty.translateY = this.selectedObj.translateY;
        this.selectedProperty.strokeWidth = this.selectedObj.strokeWidth;
        this.selectedProperty.__corner = this.selectedObj.__corner;
        this.selectedProperty.left = this.selectedObj.left;
        this.selectedProperty.top = this.selectedObj.top;
        this.selectedObj.setControlsVisibility({
          bl: true,
          br: true,
          tl: true,
          tr: true,
          mt: false,
          mb: false,
          mtr: false,
          mr: true,
          ml: true
        });
        if(this.editable===true || this.tmpselect!='Sample Data'){
          this.selectedObj.set({
            editingBorderColor: 'blue',
            showTextBoxBorder: true,
            textboxBorderColor: 'gray'
          })
        }else{
          this.selectedObj.set({
            showTextBoxBorder: false
          })
        }
        break;
        case 'video':
          this.selectedItem = "video";
          this.selectedProperty.hasControls = false;
          this.selectedObj.setControlsVisibility({
            bl: false,
            br: false,
            tl: false,
            tr: false,
           mt: false,
            mb: false,
            mtr: false,
            mr: false,
            ml: false
          });
          break;
          case 'date':
            this.selectedItem = "date";
            this.selectedProperty.objtype = this.selectedObj.objtype;
            this.selectedProperty.editable = this.selectedObj.editable;
            this.selectedProperty.borderColor = this.selectedObj.borderColor;
            this.selectedProperty.borderScaleFactor = this.selectedObj.borderScaleFactor;
            this.selectedObj.setControlsVisibility({
              bl: false,
              br: false,
              tl: false,
              tr: false,
              mt: false,
              mb: false,
              mtr: false,
              mr: false,
              ml: false
            });
         this.selectedObj.set({
                editingBorderColor: '#fff',
                showTextBoxBorder: true,
                textboxBorderColor: '#ffff7f',
              })
            break;
         
      case 'slabel':
        this.selectedItem = "text";
        this.selectedProperty.opacity = this.selectedObj.opacity * 100;
        this.selectedProperty.fill = this.selectedObj.fill;
        this.selectedProperty.breakWords = true;
        this.selectedProperty.fontFamily = this.selectedObj.fontFamily;
        this.selectedProperty.strokeWidth = this.selectedObj.strokeWidth;
        this.selectedProperty.fontSize = this.selectedObj.fontSize;
        this.selectedProperty.text = this.selectedObj.text;
        this.selectedProperty.left = this.selectedObj.left;
        this.selectedProperty.top = this.selectedObj.top;
        this.selectedProperty.linethrough = this.selectedObj.linethrough;
        this.selectedProperty.stroke = this.selectedObj.stroke;
        this.selectedProperty.width = this.selectedObj.width;
        this.selectedProperty.height = this.selectedObj.height;
        this.selectedProperty.fontWeight = this.selectedObj.fontWeight;
        this.selectedProperty.fontStyle = this.selectedObj.fontStyle;
        this.selectedProperty.underline = this.selectedObj.underline;
        this.selectedProperty.overline = this.selectedObj.overline;
        this.selectedProperty.textAlign = this.selectedObj.textAlign;
        this.selectedProperty.strokeWidth = this.selectedObj.strokeWidth;
        this.selectedProperty.__corner = this.selectedObj.__corner;
        this.selectedProperty.objtype = this.selectedObj.objtype;
        this.selectedObj.setControlsVisibility({
          bl: false,
          br: false,
          tl: false,
          tr: false,
          mt: false,
          mb: false,
          mtr: false,
          mr: true,
          ml: true
        });
        if(this.editable===true || this.tmpselect!='Sample Data'){
          this.selectedObj.set({
            editingBorderColor: 'gray',
            showTextBoxBorder: true,
            textboxBorderColor: 'blue'
          })
        }else{
          this.selectedObj.set({
            showTextBoxBorder: false
          })
        }
        break;
        case 'newtemplate':
          this.selectedItem = "others";
          this.selectedProperty.opacity = this.selectedObj.opacity * 100;
          this.selectedProperty.fill = this.selectedObj.fill;
          this.selectedProperty.fontFamily = this.selectedObj.fontFamily;
          this.selectedProperty.strokeWidth = this.selectedObj.strokeWidth;
          this.selectedProperty.fontSize = this.selectedObj.fontSize;
          this.selectedProperty.text = this.selectedObj.text;
          this.selectedProperty.objtype = this.selectedObj.objtype;
          this.selectedProperty.left = this.selectedObj.left;
          this.selectedProperty.top = this.selectedObj.top;
          this.selectedProperty.linethrough = this.selectedObj.linethrough;
          this.selectedProperty.stroke = this.selectedObj.stroke;
          this.selectedProperty.width = this.selectedObj.width;
          this.selectedProperty.height = this.selectedObj.height;
          this.selectedProperty.fontWeight = this.selectedObj.fontWeight;
          this.selectedProperty.fontStyle = this.selectedObj.fontStyle;
          this.selectedProperty.underline = this.selectedObj.underline;
          this.selectedProperty.overline = this.selectedObj.overline;
          this.selectedProperty.textAlign = this.selectedObj.textAlign;
          this.selectedProperty.strokeWidth = this.selectedObj.strokeWidth;
          this.selectedProperty.__corner = this.selectedObj.__corner;
          this.selectedProperty.objtype = this.selectedObj.objtype;
          this.selectedObj.setControlsVisibility({
            bl: false,
            br: false,
            tl: false,
            tr: false,
            mt: false,
            mb: false,
            mtr: false,
            mr: true,
            ml: true
          });
          if(this.editable===true || this.tmpselect!='Sample Data'){
            this.selectedObj.set({
              editingBorderColor: 'gray',
              showTextBoxBorder: true,
              textboxBorderColor: 'blue'
            })
          }else{
            this.selectedObj.set({
              showTextBoxBorder: false
            })
          }
          break;
        
      case 'stext':
        this.selectedItem = "text";
        this.selectedProperty.opacity = this.selectedObj.opacity * 100;
        this.selectedProperty.fill = this.selectedObj.fill;
        this.selectedProperty.breakWords = true;
        this.selectedProperty.fontFamily = this.selectedObj.fontFamily;
        this.selectedProperty.height = this.selectedObj.height;
        this.selectedProperty.fontSize = this.selectedObj.fontSize;
        this.selectedProperty.fontWeight = this.selectedObj.fontWeight;
        this.selectedProperty.fontStyle = this.selectedObj.fontStyle;
        this.selectedProperty.underline = this.selectedObj.underline;
        this.selectedProperty.overline = this.selectedObj.overline;
        this.selectedProperty.linethrough = this.selectedObj.linethrough;
        this.selectedProperty.textAlign = this.selectedObj.textAlign;
        this.selectedProperty.fontSize = this.selectedObj.fontSize;
        this.selectedProperty.stroke = this.selectedObj.stroke;
        this.selectedProperty.width = this.selectedObj.width;
        this.selectedProperty.left = this.selectedObj.left;
        this.selectedProperty.top = this.selectedObj.top;
        this.selectedProperty.strokeWidth = this.selectedObj.strokeWidth;
        this.selectedProperty.__corner = this.selectedObj.__corner;
        this.selectedProperty.objtype = this.selectedObj.objtype;
        this.selectedProperty.variable = this.selectedObj.variable;
        this.selectedProperty.objsampledata = this.selectedObj.objsampledata;
        this.selectedProperty.objstyle = this.selectedObj.objstyle;
        this.selectedProperty.objtext = this.selectedObj.objtext;
        this.selectedProperty.objcategory = this.selectedObj.objcategory;
        this.selectedProperty.linkURL = this.selectedObj.linkURL;
        this.selectedObj.setControlsVisibility({
          bl: false,
          br: false,
          tl: false,
          tr: false,
          mt: false,
          mb: false,
          mtr: false,
          mr: true,
          ml: true
        });
      if(this.editable===true || this.tmpselect!='Sample Data'){
        this.selectedObj.set({
          editingBorderColor: 'blue',
          showTextBoxBorder: true,
          textboxBorderColor: 'yellow'
        })
      }else{
        this.selectedObj.set({
          showTextBoxBorder: false
        })
      }
        break;
      case 'rect':
        this.selectedItem = "shape";
        this.selectedProperty.opacity = this.selectedObj.opacity * 100;
        this.selectedProperty.fill = this.selectedObj.fill;
        this.selectedProperty.angle = this.selectedObj.angle;
        this.selectedProperty.stroke = this.selectedObj.stroke;
        this.selectedProperty.width = this.selectedObj.width;
        this.selectedProperty.height = this.selectedObj.height;
        this.selectedProperty.translateX = this.selectedObj.translateX;
        this.selectedProperty.translateY = this.selectedObj.translateY;
        this.selectedProperty.strokeWidth = this.selectedObj.strokeWidth;
        this.selectedProperty.rx = this.selectedObj.rx;
        this.selectedProperty.ry = this.selectedObj.ry;
        this.selectedProperty.objtype = this.selectedObj.objtype;
        this.selectedProperty.text = this.selectedObj.text;
        this.selectedProperty.left = this.selectedObj.left;
        this.selectedProperty.top = this.selectedObj.top;
        this.emptycontrols();
        canvas.sendBackwards(this.selectedObj);
        this.selectedObj.setControlsVisibility({
          bl: true,
          br: true,
          tl: true,
          tr: true,
          mt: true,
          mb: true,
          mtr: false,
          mr: true,
          ml: true
        });
        break;
        case 'margins':
          this.selectedItem = "margins";
          this.selectedProperty.opacity = this.selectedObj.opacity * 100;
          this.selectedProperty.fill = this.selectedObj.fill;
          this.selectedProperty.angle = this.selectedObj.angle;
          this.selectedProperty.stroke = this.selectedObj.stroke;
          this.selectedProperty.width = this.selectedObj.width;
          this.selectedProperty.height = this.selectedObj.height;
          this.selectedProperty.translateX = this.selectedObj.translateX;
          this.selectedProperty.translateY = this.selectedObj.translateY;
          this.selectedProperty.strokeWidth = this.selectedObj.strokeWidth;
          this.selectedProperty.rx = this.selectedObj.rx;
          this.selectedProperty.ry = this.selectedObj.ry;
          this.selectedProperty.objtype = this.selectedObj.objtype;
          this.selectedProperty.lockMovementX = this.selectedObj.lockMovementX;
          this.selectedProperty.lockMovementY = this.selectedObj.lockMovementY;
          this.selectedProperty.text = this.selectedObj.text;
          this.selectedProperty.left = this.selectedObj.left;
          this.selectedProperty.top = this.selectedObj.top;
          this.emptycontrols();
          this.selectedObj.sendToBack(); 
        this.selectedObj.setControlsVisibility({
            bl: true,
            br: true,
            tl: true,
            tr: true,
            mt: true,
            mb: true,
            mtr: false,
            mr: true,
            ml: true
          });
          break;
        case 'header':
        this.selectedItem = "header";
        this.selectedProperty.opacity = this.selectedObj.opacity * 100;
        this.selectedProperty.fill = this.selectedObj.fill;
        this.selectedProperty.angle = this.selectedObj.angle;
        this.selectedProperty.stroke = this.selectedObj.stroke;
        this.selectedProperty.width = this.selectedObj.width;
        this.selectedProperty.height = this.selectedObj.height;
        this.selectedProperty.translateX = this.selectedObj.translateX;
        this.selectedProperty.translateY = this.selectedObj.translateY;
        this.selectedProperty.strokeWidth = this.selectedObj.strokeWidth;
        this.selectedProperty.rx = this.selectedObj.rx;
        this.selectedProperty.ry = this.selectedObj.ry;
        this.selectedProperty.lockMovementX = this.selectedObj.lockMovementX;
        this.selectedProperty.lockMovementY = this.selectedObj.lockMovementY;
        this.selectedProperty.objtype = this.selectedObj.objtype;
        this.selectedProperty.text = this.selectedObj.text;
        this.selectedProperty.left = this.selectedObj.left;
        this.selectedProperty.top = this.selectedObj.top;
        this.selectedProperty.allpage = this.selectedObj.allpage;
        this.emptycontrols();
        canvas.sendBackwards(this.selectedObj);
        this.selectedObj.setControlsVisibility({
          bl: false,
          br: false,
          tl: false,
          tr: false,
          mt: false,
          mb: true,
          mtr: false,
          mr: false,
          ml: false
        });
        break;
        case 'footer':
          this.selectedItem = "footer";
          this.selectedProperty.opacity = this.selectedObj.opacity * 100;
          this.selectedProperty.fill = this.selectedObj.fill;
          this.selectedProperty.angle = this.selectedObj.angle;
          this.selectedProperty.stroke = this.selectedObj.stroke;
          this.selectedProperty.width = this.selectedObj.width;
          this.selectedProperty.height = this.selectedObj.height;
          this.selectedProperty.translateX = this.selectedObj.translateX;
          this.selectedProperty.translateY = this.selectedObj.translateY;
          this.selectedProperty.strokeWidth = this.selectedObj.strokeWidth;
          this.selectedProperty.rx = this.selectedObj.rx;
          this.selectedProperty.ry = this.selectedObj.ry;
          this.selectedProperty.lockMovementX = this.selectedObj.lockMovementX;
          this.selectedProperty.lockMovementY = this.selectedObj.lockMovementY;
          this.selectedProperty.objtype = this.selectedObj.objtype;
          this.selectedProperty.text = this.selectedObj.text;
          this.selectedProperty.left = this.selectedObj.left;
          this.selectedProperty.top = this.selectedObj.top;
          this.selectedProperty.allpage = this.selectedObj.allpage;
          this.emptycontrols();
          var canvas20 = this.tempobj;
          canvas20.sendBackwards(this.selectedObj);
          this.selectedObj.setControlsVisibility({
            bl: false,
            br: false,
            tl: false,
            tr: false,
            mt: true,
            mb: false,
            mtr: false,
            mr: false,
            ml: false
          });
          break;
          case 'stamp':
            this.selectedItem = "image";
            this.selectedProperty.opacity = this.selectedObj.opacity * 100;
            this.selectedProperty.fill = this.selectedObj.fill;
            this.selectedProperty.stroke = this.selectedObj.stroke;
            this.selectedProperty.width = this.selectedObj.width;
            this.selectedProperty.height = this.selectedObj.height;
            this.selectedProperty.tmp_width = this.selectedObj.tmp_width;
            this.selectedProperty.tmp_height = this.selectedObj.tmp_height;
            this.selectedProperty.scaleX = this.selectedObj.scaleX;
            this.selectedProperty.scaleY = this.selectedObj.scaleY;
            this.selectedProperty.left = this.selectedObj.left;
            this.selectedProperty.top = this.selectedObj.top;
            this.selectedProperty.strokeWidth = this.selectedObj.strokeWidth;
            this.selectedProperty.rx = this.selectedObj.rx;
            this.selectedProperty.ry = this.selectedObj.ry;
            this.selectedProperty.objtype = this.selectedObj.objtype;
            this.emptycontrols();
            this.selectedObj.setControlsVisibility({
              bl: true,
              br: true,
              tl: true,
              tr: true,
              mt: false,
              mb: false,
              mtr: false,
              mr: false,
              ml: false
            });
            break;
        
          case 'esignature':
          case 'einitial':
            this.selectedItem = "image";
            this.selectedProperty.opacity = this.selectedObj.opacity * 100;
            this.selectedProperty.fill = this.selectedObj.fill;
            this.selectedProperty.stroke = this.selectedObj.stroke;
            this.selectedProperty.width = this.selectedObj.width;
            this.selectedProperty.height = this.selectedObj.height;
            this.selectedProperty.tmp_width = this.selectedObj.tmp_width;
            this.selectedProperty.tmp_height = this.selectedObj.tmp_height;
            this.selectedProperty.scaleX = this.selectedObj.scaleX;
            this.selectedProperty.scaleY = this.selectedObj.scaleY;
            this.selectedProperty.left = this.selectedObj.left;
            this.selectedProperty.top = this.selectedObj.top;
            this.selectedProperty.strokeWidth = this.selectedObj.strokeWidth;
            this.selectedProperty.rx = this.selectedObj.rx;
            this.selectedProperty.ry = this.selectedObj.ry;
            this.selectedProperty.objtype = this.selectedObj.objtype;
            this.selectedProperty.esignatureconfigdata = this.selectedObj.esignatureconfigdata;
            this.selectedProperty.status = this.selectedObj.status;
            this.emptycontrols();
            this.selectedObj.setControlsVisibility({
              bl: true,
              br: true,
              tl: true,
              tr: true,
              mt: false,
              mb: false,
              mtr: false,
              mr: false,
              ml: false
            });
            break;
         
      case 'signature':
        this.selectedItem = "image";
        this.selectedProperty.opacity = this.selectedObj.opacity * 100;
        this.selectedProperty.fill = this.selectedObj.fill;
        this.selectedProperty.stroke = this.selectedObj.stroke;
        this.selectedProperty.width = this.selectedObj.width;
        this.selectedProperty.height = this.selectedObj.height;
        this.selectedProperty.tmp_width = this.selectedObj.tmp_width;
        this.selectedProperty.tmp_height = this.selectedObj.tmp_height;
        this.selectedProperty.scaleX = this.selectedObj.scaleX;
        this.selectedProperty.scaleY = this.selectedObj.scaleY;
        this.selectedProperty.left = this.selectedObj.left;
        this.selectedProperty.top = this.selectedObj.top;
        this.selectedProperty.strokeWidth = this.selectedObj.strokeWidth;
        this.selectedProperty.rx = this.selectedObj.rx;
        this.selectedProperty.ry = this.selectedObj.ry;
        this.selectedProperty.objtype = this.selectedObj.objtype;
        this.selectedProperty.handletype = this.selectedObj.handletype;
        this.selectedProperty.cacheKey = this.selectedObj.cacheKey;
        this.selectedProperty.signature_name = this.selectedObj.signature_name;
        this.selectedProperty.signature_id = this.selectedObj.signature_id;
        this.emptycontrols();
        if(this.selectedObj.handletype == 'freeflowsignature'){
        this.selectedObj.setControlsVisibility({
          bl: true,
          br: true,
          tl: true,
          tr: true,
          mt: true,
          mb: true,
          mtr: false,
          mr: true,
          ml: true
        });
      }else{
        this.selectedObj.setControlsVisibility({
          bl: true,
          br: true,
          tl: true,
          tr: true,
          mt: false,
          mb: false,
          mtr: false,
          mr: false,
          ml: false
        });
      }
        break;
      case 'table':
        this.selectedItem = "table";
        this.selectedProperty.opacity = this.selectedObj.opacity * 100;
        this.selectedProperty.fill = this.selectedObj.fill;
        this.selectedProperty.stroke = this.selectedObj.stroke;
        this.selectedProperty.width = this.selectedObj.width;
        this.selectedProperty.height = this.selectedObj.height;
        this.selectedProperty.translateX = this.selectedObj.translateX;
        this.selectedProperty.translateY = this.selectedObj.translateY;
        this.selectedProperty.strokeWidth = this.selectedObj.strokeWidth;
        this.selectedProperty.rx = this.selectedObj.rx;
        this.selectedProperty.ry = this.selectedObj.ry;
        this.selectedProperty.objtype = this.selectedObj.objtype;
        this.selectedProperty.cacheKey = this.selectedObj.cacheKey;
        this.selectedProperty.text = this.selectedObj.text;
        this.selectedProperty.left = this.selectedObj.left;
        this.selectedProperty.top = this.selectedObj.top;
        this.selectedProperty.staticjson = this.selectedObj.staticjson;
        this.selectedProperty.dynamicjson = this.selectedObj.dynamicjson;
        if(this.selectedObj.dynamicjson != ""){
          this.selectedObj.dynamicjson.x = this.selectedObj.left
          this.selectedObj.dynamicjson.y = this.selectedObj.top
          this.selectedObj.dynamicjson.width = this.selectedObj.width
          this.selectedObj.dynamicjson.height = this.selectedObj.height
        }else if(this.selectedObj.staticjson != ""){
          this.selectedObj.staticjson.x = this.selectedObj.left
          this.selectedObj.staticjson.y = this.selectedObj.top
          this.selectedObj.staticjson.width = this.selectedObj.width
          this.selectedObj.staticjson.height = this.selectedObj.height
        }
        this.tableactions();
        this.selectedObj.setControlsVisibility({
          bl: false,
          br: false,
          tl: false,
          tr: false,
          mt: false,
          mb: false,
          mtr: false,
          mr: false,
          ml: false
        });
        break;
      case 'circle':
        this.selectedItem = "shape";
        this.selectedProperty.opacity = this.selectedObj.opacity * 100;
        this.selectedProperty.fill = this.selectedObj.fill;
        this.selectedProperty.stroke = this.selectedObj.stroke;
        this.selectedProperty.strokeWidth = this.selectedObj.strokeWidth;
        this.selectedProperty.width = this.selectedObj.width;
        this.selectedProperty.height = this.selectedObj.height;
        this.selectedProperty.translateX = this.selectedObj.translateX;
        this.selectedProperty.translateY = this.selectedObj.translateY;
        this.selectedProperty.objtype = this.selectedObj.objtype;
        this.selectedProperty.text = this.selectedObj.text;
        this.selectedProperty.left = this.selectedObj.left;
        this.selectedProperty.top = this.selectedObj.top;
        this.selectedProperty.__corner = this.selectedObj.__corner;
        this.emptycontrols();
        this.selectedObj.setControlsVisibility({
          bl: true,
          br: true,
          tl: true,
          tr: true,
          mt: true,
          mb: true,
          mtr: false,
          mr: true,
          ml: true
        });
        break;
      case 'hline':
        this.selectedItem = "shape";
        this.selectedProperty.opacity = this.selectedObj.opacity * 100;
        this.selectedProperty.fill = this.selectedObj.fill;
        this.selectedProperty.stroke = this.selectedObj.stroke;
        this.selectedProperty.strokeWidth = this.selectedObj.strokeWidth;
        this.selectedProperty.width = this.selectedObj.width;
        this.selectedProperty.height = this.selectedObj.height;
        this.selectedProperty.translateX = this.selectedObj.translateX;
        this.selectedProperty.translateY = this.selectedObj.translateY;
        this.selectedProperty.__corner = this.selectedObj.__corner;
        this.selectedProperty.objtype = this.selectedObj.objtype;
        this.selectedProperty.text = this.selectedObj.text;
        this.selectedProperty.left = this.selectedObj.left;
        this.selectedProperty.top = this.selectedObj.top;
        this.emptycontrols();
        this.selectedObj.setControlsVisibility({
          bl: true,
          br: true,
          tl: true,
          tr: true,
          mt: true,
          mb: true,
          mtr: false,
          mr: true,
          ml: true
        });
        break;
        case 'connector':
        this.selectedItem = "shape";
        this.selectedProperty.opacity = this.selectedObj.opacity * 100;
        this.selectedProperty.fill = this.selectedObj.fill;
        this.selectedProperty.height = this.selectedObj.height;
        this.selectedProperty.translateX = this.selectedObj.translateX;
        this.selectedProperty.translateY = this.selectedObj.translateY;
        this.selectedProperty.__corner = this.selectedObj.__corner;
        this.selectedProperty.objtype = this.selectedObj.objtype;
        this.selectedProperty.stroke = this.selectedObj.stroke;
        this.selectedProperty.strokeWidth = this.selectedObj.strokeWidth;
        this.selectedProperty.width = this.selectedObj.width;
        this.selectedProperty.text = this.selectedObj.text;
        this.selectedProperty.left = this.selectedObj.left;
        this.selectedProperty.top = this.selectedObj.top;
        this.emptycontrols();
        this.selectedObj.setControlsVisibility({
          bl: true,
          br: true,
          tl: true,
          tr: true,
          mt: true,
          mb: true,
          mtr: false,
          mr: true,
          ml: true
        });
        break;
      case 'vline':
        this.selectedItem = "shape";
        this.selectedProperty.opacity = this.selectedObj.opacity * 100;
        this.selectedProperty.fill = this.selectedObj.fill;
        this.selectedProperty.stroke = this.selectedObj.stroke;
        this.selectedProperty.width = this.selectedObj.width;
        this.selectedProperty.height = this.selectedObj.height;
        this.selectedProperty.translateX = this.selectedObj.translateX;
        this.selectedProperty.translateY = this.selectedObj.translateY;
        this.selectedProperty.__corner = this.selectedObj.__corner;
        this.selectedProperty.objtype = this.selectedObj.objtype;
        this.selectedProperty.text = this.selectedObj.text;
        this.selectedProperty.left = this.selectedObj.left;
        this.selectedProperty.top = this.selectedObj.top;
        this.selectedProperty.strokeWidth = this.selectedObj.strokeWidth;
        this.emptycontrols();
        this.selectedObj.setControlsVisibility({
          bl: true,
          br: true,
          tl: true,
          tr: true,
          mt: true,
          mb: true,
          mtr: false,
          mr: true,
          ml: true
        });
        break;
        case 'vline0':
          this.selectedItem = "shape";
          this.selectedProperty.opacity = this.selectedObj.opacity * 100;
          this.selectedProperty.fill = this.selectedObj.fill;
          this.selectedProperty.stroke = this.selectedObj.stroke;
          this.selectedProperty.width = this.selectedObj.width;
          this.selectedProperty.height = this.selectedObj.height;
          this.selectedProperty.translateX = this.selectedObj.translateX;
          this.selectedProperty.translateY = this.selectedObj.translateY;
          this.selectedProperty.__corner = this.selectedObj.__corner;
          this.selectedProperty.objtype = this.selectedObj.objtype;
          this.selectedProperty.text = this.selectedObj.text;
          this.selectedProperty.left = this.selectedObj.left;
          this.selectedProperty.top = this.selectedObj.top;
          this.selectedProperty.strokeWidth = this.selectedObj.strokeWidth;
          this.emptycontrols();
          this.selectedObj.setControlsVisibility({
            bl: false,
            br: false,
            tl: false,
            tr: false,
            mt: false,
            mb: false,
            mtr: false,
            mr: false,
            ml: false
          });
          break;
      case 'ellipse':
        this.selectedItem = "shape";
        this.selectedProperty.opacity = this.selectedObj.opacity * 100;
        this.selectedProperty.fill = this.selectedObj.fill;
        this.selectedProperty.stroke = this.selectedObj.stroke;
        this.selectedProperty.strokeWidth = this.selectedObj.strokeWidth;
        this.selectedProperty.width = this.selectedObj.width;
        this.selectedProperty.height = this.selectedObj.height;
        this.selectedProperty.left = this.selectedObj.left;
        this.selectedProperty.top = this.selectedObj.top;
        this.selectedProperty.__corner = this.selectedObj.__corner;
        this.selectedProperty.objtype = this.selectedObj.objtype;
        this.selectedProperty.text = this.selectedObj.text;
        this.emptycontrols();
        this.selectedObj.setControlsVisibility({
          bl: true,
          br: true,
          tl: true,
          tr: true,
          mt: true,
          mb: true,
          mtr: false,
          mr: true,
          ml: true
        });
        break;
      case 'triangle':
        this.selectedItem = "shape";
        this.selectedProperty.fill = this.selectedObj.fill;
        this.selectedProperty.opacity = this.selectedObj.opacity * 100;
        this.selectedProperty.stroke = this.selectedObj.stroke;
        this.selectedProperty.strokeWidth = this.selectedObj.strokeWidth;
        this.selectedProperty.width = this.selectedObj.width;
        this.selectedProperty.height = this.selectedObj.height;
        this.selectedProperty.translateX = this.selectedObj.translateX;
        this.selectedProperty.translateY = this.selectedObj.translateY;
        this.selectedProperty.__corner = this.selectedObj.__corner;
        this.selectedProperty.objtype = this.selectedObj.objtype;
        this.selectedProperty.text = this.selectedObj.text;
        this.selectedProperty.left = this.selectedObj.left;
        this.selectedProperty.top = this.selectedObj.top;
        this.emptycontrols();
        this.selectedObj.setControlsVisibility({
          bl: true,
          br: true,
          tl: true,
          tr: true,
          mt: true,
          mb: true,
          mtr: false,
          mr: true,
          ml: true
        });
        break;
      case 'imgvar':
        this.selectedItem = "image";
        this.selectedProperty.opacity = this.selectedObj.opacity * 100;
        this.selectedProperty.width = this.selectedObj.width;
        this.selectedProperty.height = this.selectedObj.height;
        this.selectedProperty.tmp_width = this.selectedObj.tmp_width;
        this.selectedProperty.tmp_height = this.selectedObj.tmp_height;
        this.selectedProperty.left = this.selectedObj.left;
        this.selectedProperty.scaleX = this.selectedObj.scaleX;
        this.selectedProperty.scaleY = this.selectedObj.scaleY;
        this.selectedProperty.top = this.selectedObj.top;
        this.selectedProperty.objtype = this.selectedObj.objtype;
        this.selectedProperty.cacheKey = this.selectedObj.cacheKey;
        this.selectedProperty.id = this.selectedObj.id;
        this.selectedProperty.imgvarvalue = this.selectedObj.imgvarvalue;
        this.emptycontrols();
        this.selectedObj.setControlsVisibility({
          bl: true,
          br: true,
          tl: true,
          tr: true,
          mt: true,
          mb: true,
          mtr: false,
          mr: true,
          ml: true
        });
        break;
        case 'logo':
          this.selectedItem = "image";
          this.selectedProperty.opacity = this.selectedObj.opacity * 100;
          this.selectedProperty.width = this.selectedObj.width;
          this.selectedProperty.height = this.selectedObj.height;
          this.selectedProperty.tmp_width = this.selectedObj.tmp_width;
          this.selectedProperty.tmp_height = this.selectedObj.tmp_height;
          this.selectedProperty.scaleX = this.selectedObj.scaleX;
          this.selectedProperty.scaleY = this.selectedObj.scaleY;
          this.selectedProperty.left = this.selectedObj.left;
          this.selectedProperty.top = this.selectedObj.top;
          this.selectedProperty.objtype = this.selectedObj.objtype;
          this.selectedProperty.id = this.selectedObj.id;
          this.emptycontrols();
          this.selectedObj.setControlsVisibility({
            bl: true,
            br: true,
            tl: true,
            tr: true,
            mt: true,
            mb: true,
            mtr: false,
            mr: true,
            ml: true
          });
          break;
          case 'radiocheck':
            case 'checkbox':
              this.selectedItem = "image";
            this.selectedProperty.opacity = this.selectedObj.opacity * 100;
            this.selectedProperty.width = this.selectedObj.width;
            this.selectedProperty.opacity = this.selectedObj.opacity;
            this.selectedProperty.height = this.selectedObj.height;
            this.selectedProperty.tmp_width = this.selectedObj.tmp_width;
            this.selectedProperty.tmp_height = this.selectedObj.tmp_height;
            this.selectedProperty.scaleX = this.selectedObj.scaleX;
            this.selectedProperty.scaleY = this.selectedObj.scaleY;
            this.selectedProperty.left = this.selectedObj.left;
            this.selectedProperty.top = this.selectedObj.top;
            this.selectedProperty.objtype = this.selectedObj.objtype;
            this.selectedProperty.id = this.selectedObj.id;
            this.selectedProperty.checkboxvalue = this.selectedObj.checkboxvalue;
            this.emptycontrols();
            this.selectedObj.setControlsVisibility({
              bl: true,
              br: true,
              tl: true,
              tr: true,
              mt: true,
              mb: true,
              mtr: false,
              mr: true,
              ml: true
            });
            break;  
          case 'chart':
            this.selectedItem = "chart";
            this.selectedProperty.opacity = this.selectedObj.opacity * 100;
            this.selectedProperty.width = this.selectedObj.width;
            this.selectedProperty.opacity = this.selectedObj.opacity;
            this.selectedProperty.chartdata = this.selectedObj.chartdata;
            this.selectedProperty.chartbgcolor = this.selectedObj.chartbgcolor;
            this.selectedProperty.charttype = this.selectedObj.charttype;
            this.selectedProperty.charttitle = this.selectedObj.charttitle;
            this.selectedProperty.height = this.selectedObj.height;
            this.selectedProperty.tmp_width = this.selectedObj.tmp_width;
            this.selectedProperty.tmp_height = this.selectedObj.tmp_height;
            this.selectedProperty.scaleX = this.selectedObj.scaleX;
            this.selectedProperty.scaleY = this.selectedObj.scaleY;
            this.selectedProperty.left = this.selectedObj.left;
            this.selectedProperty.top = this.selectedObj.top;
            this.selectedProperty.objtype = this.selectedObj.objtype;
            this.emptycontrols();
            this.selectedObj.setControlsVisibility({
              bl: false,
              br: false,
              tl: false,
              tr: false,
              mt: false,
              mb: false,
              mtr: false,
              mr: false,
              ml: false
            });
            break;
       
      case 'barcode':
        this.selectedItem = "image";
        this.selectedProperty.opacity = this.selectedObj.opacity * 100;
        this.selectedProperty.width = this.selectedObj.width;
        this.selectedProperty.height = this.selectedObj.height;
        this.selectedProperty.tmp_width = this.selectedObj.tmp_width;
        this.selectedProperty.tmp_height = this.selectedObj.tmp_height;
        this.selectedProperty.left = this.selectedObj.left;
        this.selectedProperty.top = this.selectedObj.top;
        this.selectedProperty.scaleX = this.selectedObj.scaleX;
        this.selectedProperty.scaleY = this.selectedObj.scaleY;
        this.selectedProperty.objtype = this.selectedObj.objtype;
        this.selectedProperty.id = this.selectedObj.id;
        this.selectedProperty.cacheKey = this.selectedObj.cacheKey;
        this.selectedProperty.barcode_val0 = this.selectedObj.barcode_val0;
        this.selectedProperty.barcode_val = this.selectedObj.barcode_val;
        this.selectedProperty.label_name = this.selectedObj.label_name;
        this.selectedProperty.label_type = this.selectedObj.label_type;
        this.emptycontrols();
        this.selectedObj.setControlsVisibility({
          bl: true,
          br: true,
          tl: true,
          tr: true,
          mt: true,
          mb: true,
          mtr: false,
          mr: true,
          ml: true
        });
        break;
      case 'textbox':
        this.selectedItem = "text";
        // console.log("dfdf");
        //console.log(this.selectedObj.type);
        this.selectedProperty.textAlign = this.selectedObj.textAlign;
        this.selectedProperty.fontFamily = this.selectedObj.fontFamily;
        this.selectedProperty.fontWeight = this.selectedObj.fontWeight;
        this.selectedProperty.width = this.selectedObj.width;
        this.selectedProperty.height = this.selectedObj.height;
        this.selectedProperty.left = this.selectedObj.left;
        this.selectedProperty.top = this.selectedObj.top;
        this.selectedProperty.fontStyle = this.selectedObj.fontStyle;
        this.selectedProperty.fontSize = this.selectedObj.fontSize;
        this.selectedProperty.lineHeight = this.selectedObj.lineHeight;
        this.selectedProperty.charSpacing = this.selectedObj.charSpacing;
        this.selectedProperty.underline = this.selectedObj.underline;
        this.selectedProperty.overline = this.selectedObj.overline;
        this.selectedProperty.opacity = this.selectedObj.opacity * 100;
        this.selectedProperty.fill = this.selectedObj.fill;
        this.selectedProperty.stroke = this.selectedObj.stroke;
        this.selectedProperty.strokeWidth = this.selectedObj.strokeWidth;
        this.selectedObj.setControlsVisibility({
          bl: false,
          br: false,
          tl: false,
          tr: false,
          mt: false,
          mb: false,
          mtr: false,
          mr: true,
          ml: true
        });
        break;
      case 'i-text':
        this.selectedItem = "i-text";
        this.selectedProperty.textAlign = this.selectedObj.textAlign;
        this.selectedProperty.fontFamily = this.selectedObj.fontFamily;
        this.selectedProperty.fontWeight = this.selectedObj.fontWeight;
        this.selectedProperty.fontStyle = this.selectedObj.fontStyle;
        this.selectedProperty.fontSize = this.selectedObj.fontSize;
        this.selectedProperty.lineHeight = this.selectedObj.lineHeight;//
        this.selectedProperty.charSpacing = this.selectedObj.charSpacing;
        this.selectedProperty.underline = this.selectedObj.underline;
        this.selectedProperty.overline = this.selectedObj.overline;
        this.selectedProperty.opacity = this.selectedObj.opacity * 100;
        this.selectedProperty.fill = this.selectedObj.fill;
        this.selectedProperty.stroke = this.selectedObj.stroke;
        this.selectedProperty.strokeWidth = this.selectedObj.strokeWidth;
        this.selectedProperty.width = this.selectedObj.width;
        this.selectedProperty.height = this.selectedObj.height;
        this.selectedProperty.translateX = this.selectedObj.translateX;
        this.selectedProperty.translateY = this.selectedObj.translateY;
        break;
      case 'image':
        this.selectedItem = "image";
        this.selectedProperty.opacity = this.selectedObj.opacity * 100;
        this.selectedProperty.fill = this.selectedObj.fill;
        this.selectedProperty.stroke = this.selectedObj.stroke;
        this.selectedProperty.strokeWidth = this.selectedObj.strokeWidth;
        this.selectedProperty.__corner = this.selectedObj.__corner;
        this.selectedProperty.tmp_width = this.selectedObj.tmp_width;
        this.selectedProperty.tmp_height = this.selectedObj.tmp_height;
        this.selectedProperty.width = this.selectedObj.width;
        this.selectedProperty.height = this.selectedObj.height;
        this.selectedProperty.scaleX = this.selectedObj.scaleX;
        this.selectedProperty.scaleY = this.selectedObj.scaleY;
        this.selectedProperty.left = this.selectedObj.left;
        this.selectedProperty.top = this.selectedObj.top;
        this.selectedProperty.objtype = this.selectedObj.objtype;
        this.selectedProperty.src1 = this.selectedObj.src1;
        this.selectedObj.setControlsVisibility({
          bl: true,
          br: true,
          tl: true,
          tr: true,
          mt: false,
          mb: false,
          mtr: false,
          mr: false,
          ml: false
        });
        break;
      default:
        this.emptycontrols();
        this.selectedItem = "empty";
        this.selectedProperty = this.selectedObj;
        break;
    }
  }
 
 
  getObjectSelected(fbCanvas) {
    let selId = fbCanvas.getElement().id;// event.target.id;//imagepage5 + 5
    let pageId = selId.replace('page', '');
    if (pageId != this.seletecdPg) {
      this.seletecdPg = pageId;
      let pNum: number = 1;
      for (var index in this.arrPageCanvas) {
        var thumbElement = document.getElementById('imagepage' + pNum.toString()) as unknown as HTMLImageElement;
        thumbElement.style.border = "0";
        pNum++;
      }
      var thumbElement1 = document.getElementById('imagepage' + pageId.toString()) as unknown as HTMLImageElement;
      thumbElement1.style.border = "2px solid rgb(88, 103, 221)";
      thumbElement1.scrollIntoView(true);
      if (!this.selectedObj) {
        this.selectedItem = "empty";
        this.updateValue = false
      }
    }
  }
 
  getFCVmodified(fbCanvas) {
     // console.log(fbCanvas.getElement().id);//page1, imagepage1
    // var img = new Image();
    // img.setAttribute('crossOrigin', 'anonymous');
    // img.src = url;
    setTimeout(() => {
      ////Single page layout change
      // var imgThum = document.getElementById('image' + fbCanvas.getElement().id) as HTMLImageElement;
      var imgThum = document.getElementById('imagepage' + this.currPage.toString()) as unknown as HTMLImageElement;
      // var imgThum = document.getElementById("tstImage") as HTMLImageElement;
   imgThum.setAttribute('crossOrigin', 'anonymous');
 
      var dataURL = fbCanvas.toDataURL({
        format: 'jpeg',
        quality: 0.8
      })
      imgThum.src = dataURL;
    }, 100)
    this.saveState()
     this.renderLayers()
    //this.checkvariable()
  }
  gallery(){
    this.galleryvalue="Dashboard"
      }
      myprof(){
        // console.log("printing")
        this.galleryvalue="myprofile"
      }
      logout() {
        this.logoutstatus()
        this.userService.clientMasterId = 0;
        
        this.userService.clearSession();
        // window.localStorage.removeItem('clientMasterId');
        // window.localStorage.removeItem('clientMasterType');
        // window.localStorage.removeItem('hspName');
        window.localStorage.clear();
        this.router.navigate(['/login']);
      }
      logoutstatus(){
      this.userService.logoutstatus().subscribe(data => {
        // console.log("logoutdata",data)
      })
    }    
      library(){
        this.galleryvalue="Librarydocument"
      }
      Mydocument(){
        this.galleryvalue="mydocument"
      }
      datadictionary(){
        this.galleryvalue="datadictionary"
      }
      ImageGallery(){
        this.galleryvalue="imagegallery"
      }
      admin(){
        this.galleryvalue="admin"
      }
      report(){
        this.galleryvalue="report"
      }
      inbox(){
        this.galleryvalue="inbox"
      }
  /// Button Side Nav. Click
  btnTextHeaderClick() {
    if (this.seletecdPg > 0) {
      var innPgCanvas = this.arrTemplateList[this.seletecdPg - 1];
      var txtBox = new fabric.Textbox('Header sample', {
        width: 150,
        top: 250,
        left: 250,
        fontFamily: 'Helvetica',
        angle: 0,
        fontSize: 50,
        fixedWidth: 150,
        linkURL:''
      });
      txtBox.on('scaled', function () {
        // console.log(txtBox);
        // var newfontsize = (txtBox.fontSize * txtBox.scaleY);
        // // txtBox.set('fontSize', parseInt(newfontsize, 10));
 
        // txtBox.set('fontSize', Math.round(newfontsize));
        txtBox.set('scaleY', 1);
        if (txtBox.scaleX) {
          txtBox.set('scaleX', 1);
        }
        // txtBox.setScaleY(1);
      });
      txtBox.on('mouseover', function () {
        this._renderControls(innPgCanvas.contextTop, {
          hasControls: false
        })
      })
      txtBox.on('mousedown', function () {
        this.canvas.clearContext(innPgCanvas.contextTop);
      })
      txtBox.on('mouseout', function () {
        this.canvas.clearContext(innPgCanvas.contextTop);
      });
      this.extend(txtBox, this.randomId(), txtBox.type,txtBox.linkURL);
      innPgCanvas.add(txtBox);
      innPgCanvas.setActiveObject(txtBox).renderAll();
    }
  }
  storebarcode() {
    const val = ((document.getElementById("inp_barcodevalue") as unknown as HTMLInputElement).value);
    const type = this.model.option;
    if (val == '' && type=='fixed') {
      // console.log(val)
    }
    else if((val == '' || val.slice(0, 1)!='<') && type=='variable'){
      // console.log(val)
    } 
    else {
      if (this.selectedObj && this.selectedObj.type != 'group') {
        this.selectedObj.set('barcode_val', val);
        this.selectedObj.set('barcode_val0', type);
      }
      this.extendbarcode(this.selectedObj, this.selectedObj.id, this.selectedObj.objtype, this.selectedObj.cacheKey,this.selectedObj.barcode_val0, this.selectedObj.barcode_val,this.selectedObj.label_name,this.selectedObj.label_type,this.selectedObj.tmp_width,this.selectedObj.tmp_height);
      var innPgCanvas = this.arrPageCanvas[this.seletecdPg - 1];
      //innPgCanvas.add(this.selectedObj);
      this.emptycontrols();
      innPgCanvas.setActiveObject(this.selectedObj).renderAll();
      this.renderLayers();
 this.modalRef.hide();
    this.model = { option: 'fixed' };
    } 
  }
  closebarcodepopup() {
//    console.log(this.selectedProperty.barcodevalue);
    if (this.selectedProperty.barcode_val == '' || this.selectedProperty.barcode_val == undefined) {
      if (this.seletecdPg > 0) {
        var innPgCanvas = this.arrPageCanvas[this.seletecdPg - 1];
        var arrSel = innPgCanvas.getActiveObjects();
        for (var index in arrSel) {
          innPgCanvas.remove(arrSel[index]);
        }
        innPgCanvas._discardActiveObject();
      }
      innPgCanvas.renderAll();
    }
    this.modalRef.hide();
    this.renderLayers();
  }
  keyPress(event: any) {
 //   console.log(this.lt);
    if((this.lt=='PostnetZip' || this.lt=='EAN8' || this.lt=='PLANET') && this.model.option=="fixed"){
    const pattern = /[0-9\+\-\ ]/;
    let inputChar = String.fromCharCode(event.charCode);
    if (!pattern.test(inputChar)) {
      event.preventDefault();
    }
  }
  if(this.lt=='Barcode_128' && this.model.option=="fixed"){
    $("#inp_barcodevalue").css("text-transfor","uppercase");
  }
  if((this.lt=='2D_Barcode' || this.lt=='QR') && this.model.option=="fixed"){
    $("#inp_barcodevalue").css("text-transfor","none");
  }
  if(this.lt=='Barcode39' && this.model.option=="fixed"){
    $("#inp_barcodevalue").css("text-transfor","uppercase");
    const pattern = /^[ A-Za-z0-9-$/+%]*$/;
    let inputChar = String.fromCharCode(event.charCode);
    if (!pattern.test(inputChar)) {
      event.preventDefault();
    }
  }
  }
  /*btnTextBodyClick() {
    if (this.seletecdPg > 0) {
      var innPgCanvas = this.arrPageCanvas[this.seletecdPg - 1];
      var txtBox = new fabric.Textbox('Add Text', {
        width: 150,
        top: 250,
        left: 250,
        fontFamily: 'Helvetica',
        angle: 0,
        fontSize: 24,
        fixedWidth: 150,
        fixedHeight: 100
      });
      txtBox.on('scaled', function () {
        // console.log(txtBox);
        // var newfontsize = (txtBox.fontSize * txtBox.scaleY);
        // // // txtBox.set('fontSize', parseInt(newfontsize, 10));
        // txtBox.set('fontSize', Math.round(newfontsize));
        txtBox.set('scaleY', 1);
        if (txtBox.scaleX) {
          txtBox.set('scaleX', 1);
        }
        // txtBox.setScaleY(1);
      });
      txtBox.on('mouseover', function () {
        this._renderControls(innPgCanvas.contextTop, {
          hasControls: false
        })
      })
      txtBox.on('mousedown', function () {
        this.canvas.clearContext(innPgCanvas.contextTop);
      })
      txtBox.on('mouseout', function () {
        this.canvas.clearContext(innPgCanvas.contextTop);
      });
      this.extend(txtBox, this.randomId(), txtBox.type);
      innPgCanvas.add(txtBox);
      innPgCanvas.setActiveObject(txtBox).renderAll();
    }
  }*/
 
  btnAddShapes(shapetype, e) {
    if (this.seletecdPg > 0) {
      var innPgCanvas = this.arrPageCanvas[this.seletecdPg - 1];
      let add: any;
      var points = this.regularPolygonPoints(6, 50);
      var points1 = this.starPolygonPoints(5, 50, 25);
      switch (shapetype) {
        case 'rect':
          add = new fabric.Rect({
            width: 200, height: 100, left: e.layerX, top: e.layerY, angle: 0,
            fill: '#fff', stroke: '#000', text: "rectangle", objtype: 'rect', strokeWidth: 1, rx: 0, ry: 0
          });
 
          break;
        case 'square':
          add = new fabric.Rect({
            width: 100, height: 100, left: 100, top: 100, angle: 0,
            fill: '#fff', stroke: '#000', text: "square", strokeWidth: 1
          });
 
          break;
        case 'triangle':
          add = new fabric.Triangle({
            width: 100, height: 100, left: 100, top: 100, fill: '#fff', stroke: '#000', strokeWidth: 1, text: "triangle"
          });
 
          break;
        case 'circle':
          add = new fabric.Circle({
            radius: 50, left: e.layerX, id: this.randomId(), top: e.layerY, fill: '#fff', objtype: 'circle', stroke: '#000', strokeWidth: 1, text: "circle", angle: 0
          });
 
          break;
        case 'hline':
 
          add = new fabric.Line([10, 100, 200, 100], ({
            left: e.layerX, top: e.layerY, id: this.randomId(), fill: '#fff', stroke: '#000', objtype: 'hline', strokeWidth: 1, text: "horizontal line", angle: 0
          }));
 
          break;
        case 'vline':
          add = new fabric.Line([150, 10, 150, 200], ({
            left: e.layerX, id: this.randomId(), top: e.layerY, fill: '#fff', stroke: '#000', objtype: 'vline', strokeWidth: 1, text: "Vertical line", angle: 0
          }));
 
          break;
        case 'starpoly':
          add = new fabric.Polygon(points1, ({
            left: 100, top: 100, fill: '#fff', stroke: '#000', strokeWidth: 1, text: "star"
          }));
 
          break;
        case 'hexagonpoly':
          add = new fabric.Polygon(points, ({
            left: 100, top: 100, fill: '#fff', stroke: '#000', strokeWidth: 1, text: "hexagon"
          }));
 
          break;
        case 'semicircle':
          add = new fabric.Circle({
            left: 100,
            top: 100,
            id: this.randomId(),
            fill: '#fff',
            stroke: '#000',
            strokeWidth: 1,
            radius: 50,
            objtype: 'semicircle',
            startAngle: 0,
            endAngle: 1 * Math.PI,
            angle: '180', text: "Semicircle"
          });
 
          break;
        case 'trapezoid':
          add = new fabric.Polygon([
            { x: -20, y: 20 },
            { x: 60, y: 20 },
            { x: 100, y: 100 },
            { x: -60, y: 100 }
 
          ], ({
            left: 100, top: 100, fill: '#fff', stroke: '#000', strokeWidth: 1, text: "trapezoid"
          }));
 
          break;
        case 'octagon':
          add = new fabric.Polygon([
            { x: 850, y: 75 },
            { x: 958, y: 137.5 },
            { x: 958, y: 262.5 },
            { x: 850, y: 325 },
            { x: 742, y: 262.5 },
            { x: 742, y: 137.5 }
 
          ], ({
            left: 100, top: 100, fill: '#fff', stroke: '#000', strokeWidth: 1, text: "Octagon"
          }));
 
          break;
        case 'ellipse':
          add = new fabric.Ellipse({
            left: e.layerX, top: e.layerY, id: this.randomId(),
            /*-- Try same values rx, ry => circle  --*/
            rx: 75,
            ry: 50,
            fill: '#fff',
            stroke: '#000',
            strokeWidth: 1,
            objtype: 'ellipse',
            text: "ellipse"
          });
 
          break;
        case 'pentagon':
          add = new fabric.Polygon([
            { x: 200, y: 0 },
            { x: 250, y: 50 },
            { x: 240, y: 100 },
            { x: 150, y: 100 },
            { x: 140, y: 50 }
 
          ], ({
            left: 100, top: 100, fill: '#fff', stroke: '#000', strokeWidth: 1, text: "pentagon"
          }));
 
          break;
        case 'rhombus':
          add = new fabric.Rect({
            left: 100, top: 100, width: 100, height: 100, text: "rhombus", strokeWidth: 1, stroke: '#000', fill: '#fff', angle: 45
          });
 
          break;
      }
      if (add) {
        this.extend0(add, add.id, add.objtype, add.text);
        innPgCanvas.add(add);
        var canvas = this.tempobj;
        canvas.sendBackwards(add);
        this.emptycontrols();
        innPgCanvas.setActiveObject(add).renderAll();
        this.renderLayers();
      }
    }
  }
  getBaseURL(baseurl: any) {
    if (baseurl.indexOf(this.env.baseUrl) == -1) {
        baseurl = this.env.baseUrl + baseurl;
    }
    return baseurl;
  }
  getbgimgcatg() {
    this.props.catgname = $('#bgimgcatg option:selected').text();
    if (this.props.catg != "") {
        //alert(this.getBaseURL('/bgimages'))
        this.http.get(this.getBaseURL('/bgimages'), {
            headers: this.headers
        }).subscribe(data => {
            if (data) {
                this.updateBgimagesSection(data, parseInt(this.props.catg));
            }
        });
    } else {
        this.getBgimages();
    }
  }
  regularPolygonPoints(sideCount, radius) {
    var sweep = Math.PI * 2 / sideCount;
    var cx = radius;
    var cy = radius;
    var points = [];
    for (var i = 0; i < sideCount; i++) {
      var x = cx + radius * Math.cos(i * sweep);
      var y = cy + radius * Math.sin(i * sweep);
      points.push({ x: x, y: y });
    }
    return (points);
  }
  starPolygonPoints(spikeCount, outerRadius, innerRadius) {
    var cx = outerRadius;
    var cy = outerRadius;
    var sweep = Math.PI / spikeCount;
    var points = [];
    var angle = 0;
 
    for (var i = 0; i < spikeCount; i++) {
      var x = cx + Math.cos(angle) * outerRadius;
      var y = cy + Math.sin(angle) * outerRadius;
      points.push({ x: x, y: y });
      angle += sweep;
 
      x = cx + Math.cos(angle) * innerRadius;
      y = cy + Math.sin(angle) * innerRadius;
      points.push({ x: x, y: y });
      angle += sweep
    }
    return (points);
  }
 
  btnAddImgClick(event) {
    if (this.seletecdPg > 0) {
      var innPgCanvas = this.arrPageCanvas[this.seletecdPg - 1];
      var imgElement = event.target;
      // console.log("imgele", imgElement)
      var imgInstance = new fabric.Image(imgElement, {
        left: 100,
        top: 100,
        opacity: 1.0,
        objtype: 'logo',
        angle: 0,
        cornersize: 0,
       hasRotatingPoint: true,
       linkURL:''
      });
      imgInstance.scaleToWidth(innPgCanvas.width / 10);
      imgInstance.scaleToHeight(innPgCanvas.height / 10);
      this.extend(imgInstance, this.randomId(), imgInstance.objtype,imgInstance.linkURL);
      innPgCanvas.add(imgInstance);
      innPgCanvas.setActiveObject(imgInstance).renderAll();
      this.renderLayers();
    }
  }
  closesignaturepopup() {
    this.signaturepopup = false;
    this.modalRef.hide();
    if (this.selectedProperty.signature_id == '' || this.selectedProperty.signature_id == undefined) {
      if (this.seletecdPg > 0) {
        var innPgCanvas = this.arrPageCanvas[this.seletecdPg - 1];
        var arrSel = innPgCanvas.getActiveObjects();
        for (var index in arrSel) {
          innPgCanvas.remove(arrSel[index]);
        }
        innPgCanvas._discardActiveObject();
      }
      innPgCanvas.renderAll();
    }
    this.renderLayers();
  }
  closexml() {
    this.modalRef.hide();
  }
  createesigninfo(e){
    //this.esignatureconfiginfo=JSON.stringify(val);
    if (!this.editable) { return }
  // this.modalRef.hide();
    var innPgCanvas = this.arrPageCanvas[this.seletecdPg - 1];
    const src = 'assets/images/designtool/sign/esignature.png';
    fabric.Image.fromURL(src, (image) => {
      image.set({
      left: e.layerX,
      top: e.layerY,
      opacity: 1,
      angle: 0,
      objtype: 'esignature',
      cacheKey: 'esignature',
      width: image.width,
      height: image.height,
      tmp_width: image.width,
      tmp_height: image.height,
      id: this.randomId(),
      esignatureconfigdata: '',
      status: false
    }).scale(0.9);
    image.setControlsVisibility({
      bl: true,
      br: true,
      tl: true,
      tr: true,
      mt: false,
      mb: false,
      mtr: false,
      mr: false,
      ml: false
    });
  this.extendesignature(image, image.id, image.objtype, image.esignatureconfigdata, image.status, image.tmp_width,image.tmp_height);
  innPgCanvas.add(image);
    innPgCanvas.setActiveObject(image).renderAll();
    //this.renderLayers();
  });
    this.emptycontrols();
    this.gettimefun();
    this.modalRef = this.modalService.show(this.esignconfig, this.config);
    this.esignatureconfiginfo="";
  }
  createesigninfo1(e){
    //.esignatureconfiginfo=JSON.stringify(val);
   //this.modalRef.hide();
    var innPgCanvas = this.arrPageCanvas[this.seletecdPg - 1];
   const src = 'assets/images/designtool/sign/einitial.png';
    fabric.Image.fromURL(src, (image) => {
      image.set({
      left: e.layerX,
      top: e.layerY,
      opacity: 1,
      angle: 0,
      objtype: 'einitial',
      cacheKey: 'einitial',
      width: image.width,
      height: image.height,
      tmp_width: image.width,
      tmp_height: image.height,
      id: this.randomId(),
      esignatureconfigdata: '',
      status: false
    }).scale(0.9);
    image.setControlsVisibility({
      bl: true,
      br: true,
      tl: true,
      tr: true,
      mt: false,
      mb: false,
      mtr: false,
      mr: false,
      ml: false
    });
  this.extendesignature(image, image.id, image.objtype, image.esignatureconfigdata, image.status, image.tmp_width,image.tmp_height);
  innPgCanvas.add(image);
    innPgCanvas.setActiveObject(image).renderAll();
  //  this.renderLayers();
  });
    this.emptycontrols();
    this.gettimefun();
    this.modalRef = this.modalService.show(this.esignconfig, this.config);
    this.esignatureconfiginfo="";
  }
  createesigninfo00(val,esigninfo){
    this.esignatureconfiginfo=JSON.stringify(val);
    this.selectedObj.set('esignatureconfigdata', this.esignatureconfiginfo);
    this.extendesignature(this.selectedObj, this.selectedObj.id, this.selectedObj.objtype, this.selectedObj.esignatureconfigdata, this.selectedObj.status, this.selectedObj.tmp_width,this.selectedObj.tmp_height);
    var innPgCanvas = this.arrPageCanvas[this.seletecdPg - 1];
    this.emptycontrols();
    innPgCanvas.setActiveObject(this.selectedObj).renderAll();
    this.renderLayers();
    this.modalRef.hide()
  }
  closepopup() {
    this.openModal0 = false;
    this.modalRef.hide();
    // console.log(this.selectedProperty.imgvarvalue);
    if (this.selectedProperty.imgvarvalue == '' || this.selectedProperty.imgvarvalue == undefined) {
      if (this.seletecdPg > 0) {
        var innPgCanvas = this.arrPageCanvas[this.seletecdPg - 1];
        var arrSel = innPgCanvas.getActiveObjects();
        for (var index in arrSel) {
          innPgCanvas.remove(arrSel[index]);
        }
        innPgCanvas._discardActiveObject();
      }
      this.modalRef.hide();
      innPgCanvas.renderAll();
    }
    this.renderLayers();
  }
  hideLeftMenu() {
    $('.nav-link').removeClass('active');
    $(".menu-box").hide();
  }
  triggerpsdupload() {
    $('#folderpathpsd').trigger('click');
}

triggerpdfupload() {
    $('#folderpathpdf').trigger('click');
}

onPSDFileChanged(event: any) {            
  $(".se-pre-con").fadeIn('slow');
  
  var file = event.target.files[0],
      reader = new FileReader();
  var url = window.URL.createObjectURL(file);
  //console.log(url);
  this.readPSD(url);
}
readPSD(url) {
  PSD.fromURL(url).then((psd) => {
      //console.log(psd.tree().export());
      this.psdToCanvas(psd);
      //document.getElementById('ImageContainer').appendChild(psd.image.toPng());
  });
}

psdToCanvas(psd) {
  this.elementcount=1;
  var psdtree = psd.tree();
  var node = psdtree.root();
  var docname = node.get('document');
  var width = node.get('width');
  var height = node.get('height');

  //this.resetCanvas();
  var canvas = this.tempobj;
//  $("#canvaspages").html('');        
  
  this.addNewPage();
  this.currenttmpwidth=width;  
  this.currenttmpheight=height; 
this.tempobj.setWidth(width);
this.tempobj.setHeight(height);
//  canvas.width = width;
 // canvas.height = height;
//  this.setCanvasWidthHeight(width* this.canvasScale, height* this.canvasScale);
 // this.resizeDownCanvas();
 // this.resizeDownHeiCanvas();
  var root = psdtree.root();
  //console.log(root);
  //iterate psd tree
  this.processChild(root);
  canvas.calcOffset();
canvas.renderAll();
} 
processChild(child) {
  //console.log(child, child.hasChildren());
  if (child.hasChildren()) {
      var children = child.children();
      //console.log("children.length" + children.length)
      children.forEach((schild) => {
          this.processChild(schild);
      });
  } else {
      child.elementcount = this.elementcount++;
      if (child.layer && child.layer.image) {

          try {
              var img = child.layer.image.toBase64();
          } catch (err) {
              // console.log(err);
              return false;
          }

          // strip off the data: url prefix to get just the base64-encoded bytes
          //var data = img.replace(/^data:image\/\w+;base64,/, "");
          var data = img;

          ((ldata, lchild) => {

              const mime = this.guessImageMime(ldata);                    
              var imageInfo  = {x:lchild.left * 1, y:lchild.top * 1, 
                  url: ldata, 
                  left: lchild.left,
                  top: lchild.top,
                  width: lchild.width, 
                  height: lchild.height, 
                  elementcount: child.elementcount
              }
              this.addPSDImage(imageInfo);

          })(data, child);

      }

      var lec = child.elementcount;
      child = child.export();
      child.elementcount = lec;
      if (child.name == 'Shape') {
          //addShape(child);
      } else if (child.name == 'Image') {
          //addImage(child);
      }
      if (child.text) {
          //this.addPSDText(child);
          this.updateObjectsOrder();
      }
  }
}
guessImageMime(data) {
  if (data.charAt(0) == '/') {
      return "image/jpeg";
  } else if (data.charAt(0) == 'R') {
      return "image/gif";
  } else if (data.charAt(0) == 'i') {
      return "image/png";
  }
}
updateObjectsOrder() {
  var canvas = this.tempobj;
  var objs = canvas.getObjects();
  var tobjs = objs.length;
  for (var i = 1; i <= tobjs; i++) {
      var obj = this.findObj(i);
      if (obj) {
          //console.log(obj.elementcount);
          canvas.sendToBack(obj);
      }
  }
  canvas.renderAll();
}
findObj(index) {
  var objs = this.tempobj.getObjects();
  var resobj;
  objs.forEach(function(obj) {
      if (obj.elementcount === index)
          resobj = obj;
  });
  return resobj;
}
getAllSlidePages(designid){
  this.canvasarray=[];
    this.userService.getAllSlidePages(designid)
      .subscribe(data => {
        // console.log("canvasarray",data)
        for(var i=0;i<data.imagefile.length;i++){
      //  this.loadpagefun1(data.Templatejson[i][0]);
     this.canvasarray = data.imagefile;
        }
      })
}
presentSlideshow() {
  this.getAllSlidePages(this.naviDate.designid);
 
  setTimeout(() => {
    // console.log(this.canvasarray)
  if(this.canvasarray.length>0){
  var canvas=this.tempobj;
  this.dataService.sharedData = this.canvasarray;       
  this.dataService.wh = '{\"width\": ' + canvas.width + ', \"height\": ' + canvas.height + '}';
  //location.href = '/#/slider';
  // this.router.navigateByUrl('/presentationslide')
  }
}, 1000);
  // $(".se-pre-con").fadeIn("slow");
  // $("#slides").html('');
  // for (var i = 0; i < this.canvasarray.length; i++) {
  //     var imgsrc = this.canvasarray[i].toDataURL({
  //         format: 'png',
  //         multiplier: 0.5
  //     });
  //     $("#slides").append("<img data-slidr='" + (i+1) + "' src='"+  imgsrc + "'/>");
  // }
  // setTimeout(() => {
  //     slidr.create('slides', {
  //         after: function(e) { console.log('in: ' + e.in.slidr); },
  //         before: function(e) { console.log('out: ' + e.out.slidr); },
  //         breadcrumbs: true,
  //         controls: 'corner',
  //         direction: 'horizontal',
  //         fade: false,
  //         keyboard: true,
  //         overflow: true,
  //         pause: false,
  //         theme: '#222',
  //         timing: { 'cube': '0.5s ease-in' },
  //         touch: true,
  //         transition: 'cube'
  //     }).auto(1000, 'right', '1');
  //     $("#slideshowModal").modal('show');
  //     $(".se-pre-con").fadeOut("slow");
  // }, 3000);     
}
addPSDImage(imageinfo) {
  var canvas = this.tempobj;
  var url = imageinfo.url;
//  console.log(imageinfo.url)
  fabric.Image.fromURL(url, (img) => {
      img.set({
          width: imageinfo.width,
          height: imageinfo.height,
          left: imageinfo.left *  1,
          top: imageinfo.top *  1,
          elementcount: imageinfo.elementcount,
          scaleX: 1,
          scaleY: 1,
          originX: 'left',
          originY: 'top',
          objtype: 'logo',
        angle: 0,
        cornersize: 0,
       hasRotatingPoint: true
      });
      canvas.add(img);
      var innPgCanvas = this.arrPageCanvas[this.seletecdPg - 1];
      this.extend(img, this.randomId(), img.objtype,img.linkURL);
      innPgCanvas.add(img);
      innPgCanvas.setActiveObject(img).renderAll();
      this.renderLayers();
      img.setCoords();
      canvas.renderAll(); 
      this.updateObjectsOrder();
  });
}
  curvedText(curvedtxt) {
    var canvas = this.tempobj;
    var diameter = 800;
    var kerning = 0;
    var ctxtsize = 58;
    var left = canvas.width / 2;
    var top = canvas.height / 2;
    var actobj = canvas.getActiveObject();
    if (actobj && actobj.type == 'curved-text') {
        diameter = actobj.diameter;
        kerning = actobj.kerning;
        ctxtsize = actobj.fontSize;
        left = actobj.left;
        top = actobj.top;
        canvas.remove(actobj);
    }
    var curvedTextObj = new fabric.CurvedText(curvedtxt, {
        fontFamily: 'arial',
        fontSize: ctxtsize,
        textAlign: 'center',
        fill: '#000',
        scaleX: 1,
        scaleY: 1,
        diameter: diameter,
        kerning: kerning,
        lineHeight: 1,
        width: 400,
        left: 200,
        top: 200,
        objtype: 'slabel',
        breakWords: true,
        variable: '',
        id: this.randomId(),
        linkURL:''
    });
    curvedTextObj.setControlsVisibility({
      bl: false,
      br: false,
      tl: false,
      tr: false,
      mt: false,
      mb: false,
      mtr: false,
      mr: true,
      ml: true
    });
    this.extendflow(curvedTextObj, curvedTextObj.id, 'slabel', true,curvedTextObj.linkURL);
   canvas.add(curvedTextObj);
    canvas.setActiveObject(curvedTextObj);
    curvedTextObj.setCoords();
    canvas.calcOffset();
    canvas.renderAll();
  }
  getTempSizes() {
   }
   getTempCategory() {
    this.http.get('./assets/studioassets/templates/categories.json', {
    //this.http.get(this.env.API_URL + 'categories', {
        headers: this.headers
    }).subscribe(data1 => {
        if (data1) {
            this.TempCategorylistSection(data1);
        }
    });
}
getTexts() {
}
  setCanvasBG(src, options) {
    //console.log(src)
    var canvas = this.tempobj;
    canvas.setBackgroundImage(src, canvas.renderAll.bind(canvas), {
     // Optionally add an opacity lvl to the image
     backgroundImageOpacity: 0.5,
     // should the image be resized to fit the container?
     backgroundImageStretch: false
   });
   canvas.renderAll();
   }
   getVideoElement(url, width, height) {
    var videoE = document.createElement('video');
    videoE.className = "canvasvideo";
    if(width>400)
        width = 400;
    if(height>400)
        height = 400;  
    videoE.width = width;
    videoE.height = height;
    //videoE.muted = true;
    videoE.crossOrigin = "anonymous";
    var source = document.createElement('source');
    source.src = url;
    source.type = 'video/mp4';
    videoE.appendChild(source);
    return videoE;
  }
  addVideo(src, width, height, left, top) {
    var canvas = this.tempobj;
    var videoE = this.getVideoElement(src, width, height);
    var fab_video = new fabric.Image(videoE, {
        originX: 'left',
        originY: 'top',
        cusType: 'video',
        objtype: 'video',
        lockScalingX: true,
          lockScalingY: true,
          lockUniScaling: true,
        objectCaching: false,
        hasControls: false,
       opacity: 1,
       stroke: 'gray', //<-- set this
       strokeWidth: 10,
       video_src: src,
       id: this.randomId(),
       src1: src
    });
    fab_video.video_src = src;
  canvas.add(fab_video);   
  this.extendlogo(fab_video, fab_video.id, fab_video.objtype, fab_video.src1, fab_video.tmp_width, fab_video.tmp_height);
  this.renderLayers()
      this.emptycontrols();
    if(left && top) {
      fab_video.left = left; 
      fab_video.top = top; 
    } else
    canvas.renderAll();
  }
  
  getVideos() {
    var URL = './assets/template/videos.json';
    this.http.get(URL, {
    //this.http.get(this.getBaseURL('/bgimages'), {
        headers: this.headers
    }).subscribe(data => {
        this.updateVideosSection(data);
     //For Firefox we have to handle it in JavaScript 
       var vids = $("video"); 
        $.each(vids, function(){
            this.controls = false; 
        }); 
    });
  }
  updateVideosSection(data, catid = null) {
    let videos = [];
    if (data) {
        videos = JSON.parse(( < any > data)._body);
        this.videos = videos;
        this.origvideos = videos;
    } else {
        videos = this.videos;
    }
    $('#videoslist').empty();
    var videohtmldata = '';
    for (let video of videos) {
  
        if (catid && video.videosscategory && (catid !== video.videosscategory.id)) continue;
  
        //var videolistdata = '<div class="col-sm-3 border-items mb-2 imgsection" style="padding:5px;float: left;"><video width="400" controls="controls" class="adminvideo img" data-videosrc="' + video.videos.url + '" preload="metadata"><source src=' + video.videos.url + ' type="video/mp4"></video><span class="deletevideo" style="color: white; cursor: pointer !important; position: absolute; bottom: 10px; left: 8px; width: 15px; height: 20px; border-radius: 50%;" data-id="' + video.id + '"></span></div></br>';
        var videolistdata = '<div data-videosrc="' + video.videos.url + '" id="adminvideo'+video.videos.id+'" class="adminvideo col-sm-6 border-items mb-2 imgsection" style="padding:5px;float: left;"><video width="100%" controls="controls" class="img" preload="metadata"><source src=' + video.videos.url + ' type="video/mp4"></video><span class="deletevideo" style="color: white; cursor: pointer !important; position: absolute; bottom: 10px; left: 8px; width: 15px; height: 20px; border-radius: 50%;" data-id="' + video.id + '"></span></div>';
        videohtmldata += videolistdata;
    }
    var $grid = $('#videoslist');
    // $grid.isotope({
    //     itemSelector: 'div',
    //     masonry: {
    //         columnWidth: 'div'
    //     }
    // });
    // videohtmldata = $(videohtmldata);
    // $grid.isotope().append(videohtmldata).isotope('appended', videohtmldata).isotope('layout');                
    $grid.append(videohtmldata);
    $(".se-pre-con").fadeOut("slow");
    this.initEvents();
  }
  img_click(stock_url) {
    $("#searchpixabaymodal").modal('hide');
  var lthis=this;
  var xhr = new XMLHttpRequest();       
      xhr.open("GET", stock_url, true); 
     xhr.responseType = "blob";
      xhr.onload = function (e) {
              var reader = new FileReader();
              reader.onloadend = (e: any) => {
                 var obj={
                  "file": e.target.result
                 }
                lthis.userService.uploadstockimg(obj).subscribe(data => {
                 if (lthis.photoORbg) {
                    lthis.setCanvasBG(e.target.result, true);
                } else {
                    lthis.uploadlogonewimage(e.target.result);
                }
                }) 
              }
              var file = this.response;
              reader.readAsDataURL(file)
      };
      xhr.send();
  }
  getBgimages() {
    this.http.get('./assets/studioassets/templates/bgimages.json', {
        headers: this.headers
    }).subscribe(data => {
        this.updateBgimagesSection(data);
    });
}
updateBgimagesSection(data, catid = null) {
  let bgimgs = [];
  if (data) {
      bgimgs = JSON.parse(( < any > data)._body);
      this.bgimages = bgimgs;
      this.origbgimages = bgimgs;
  } else {
      bgimgs = this.bgimages;
  }
  $('#bgimglist').empty();
  var bghtmldata = '';
  for (let bgimg of bgimgs) {

      if (catid && bgimg.bgimagescategory && (catid !== bgimg.bgimagescategory.id)) continue;

      var bgimglistdata = '<div class="col-sm-3 border-items mb-2 imgsection" style="padding:5px;float: left;"><img style="max-width: 100%;width: 250px;" class="adminbgimg img" src="' + bgimg.bgimages.url + '"  data-imgsrc="' + bgimg.bgimages.url + '" /><span class="deletebgimg" style="color: white; cursor: pointer !important; position: absolute; bottom: 10px; left: 8px; width: 15px; height: 20px; border-radius: 50%;" data-id="' + bgimg.id + '"></span></div>';
      bghtmldata += bgimglistdata;
  }
  var $grid = $('#bgimglist');
  /*$grid.isotope({
      itemSelector: 'div',
      masonry: {
          columnWidth: 'div'
      }
  });
  bghtmldata = $(bghtmldata);
  $grid.isotope().append(bghtmldata).isotope('appended', bghtmldata).isotope('layout');
  CreateUtils.showbgimage();*/
  $grid.append(bghtmldata);
  $(".se-pre-con").fadeOut("slow");
  this.initEvents();
}
  colorbgSpectrum() {
    let lthis = this;
   $("#colorbgSelector").spectrum({
       flat: true,
        showAlpha: false,
        showPalette: true,
        hideAfterPaletteSelect: true,
        preferredFormat: "hex",
        showInput: true,
        localStorageKey: "spectrum.yourcolor",
        palette: [
            ["#ffffff", "#c1b7ad", "#a69d94", "#665a53", "#00b1a5", "#8ed4c4", "#50b9a2", "#006360"],
            ["#000000", "#d2d0cd", "#878788", "#444448", "#005798", "#2f89d9", "#213c7f", "#0f1931"],
            ["#ac002c", "#e6a997", "#b2554d", "#6c1e20", "#4ba6e1", "#93d3e5", "#00a5de", "#004b71"],
            ["#b91020", "#e07a65", "#d70033", "#871821", "#422266", "#9a91da", "#634f90", "#1b1528"],
            ["#f84c05", "#fda240", "#ff7900", "#c74800", "#ac87ba", "#dfaed4", "#926096", "#8c43b4"],
            ["#f8a800", "#f6ce58", "#eeb100", "#c17d00", "#ed64a7", "#ee84ac", "#e53285", "#d50063"],
            ["#ffe500", "#f7da33", "#fad700", "#ffbb00", "#bb678c", "#c77c98", "#a4446d", "#6e243c"],
            ["#00903a", "#9bdfaa", "#45844d", "#1e4624", "#4f2b1f", "#b9967d", "#825745", "#3d281e"],
            ["#8ad000", "#c4e767", "#98cf44", "#44932d", "#be8f60", "#d2b193", "#9a6843", "#4d270b"]
        ],
        move: function(color) {
            var bgcolorVal = color.toHexString();
            lthis.deleteCanvasBg();
            var canvas = lthis.tempobj;
            canvas.backgroundColor = bgcolorVal;
            canvas.renderAll();
           //lthis.__canvases.push(canvas);
  //          lthis.deleteCanvasBg();
            /*if (!lthis.props.canvasImage) {
                var bg = new fabric.Rect({
                    strokeWidth: 1,
                    fill: bgcolorVal,
                    opacity: 1,
                    selectable: false,
                    lockMovementX: true,
                    lockMovementY: true,
                    width: lthis.canvas.getWidth(),
                    height: lthis.canvas.getHeight()
                });
                lthis.canvas.add(bg);
                bg.center();
                lthis.canvas.sendToBack(bg);
                lthis.canvas.bgcolor = bgcolorVal;
                bg.bg = true;
            }*/
            $('#colorbgSelector').css('backgroundColor', bgcolorVal);
            lthis.colorpickercss();
        },
    });
  }
  deleteCanvasBg(){
    var canvas = this.tempobj;
    canvas.backgroundColor = '';
    canvas.backgroundImage='';
    canvas.renderAll();
  }
  uploadlogonewimage(src){
    var data = src;
    var canvas = this.tempobj;
    var str = data.replace(environment.swagss, '');
    var innPgCanvas = this.arrPageCanvas[this.seletecdPg - 1];
    fabric.Image.fromURL(data, (image) => {
      var object=image.set({
        left: canvas.getWidth() / 2,
        top: canvas.getHeight() / 2,
        angle: 0,
        cornersize: 4,
        hasRotatingPoint: true,
        peloas: 12,
        opacity: 1,
        width: image.width,
        height: image.height,
        tmp_width: image.width,
        tmp_height: image.height,
        objtype: 'logo',
  src1: str
        // fixedWidth: 150,
      }).scale(0.9);
      image.setControlsVisibility({
        bl: true,
        br: true,
        tl: true,
        tr: true,
        mt: true,
        mb: true,
        mtr: false,
        mr: true,
        ml: true
      });
      object.scaleToWidth(400);
      this.extendlogo(image, this.randomId(), image.objtype, image.src1, image.tmp_width, image.tmp_height);
      innPgCanvas.add(image);
    innPgCanvas.setActiveObject(image).renderAll();
    this.renderLayers();
    object.center();
    object.oldWidth = object.width;
    object.oldHeight = object.height;
    object.oldScaleX = object.scaleX;
    object.oldScaleY = object.scaleY;
    object.setCoords();
    canvas.renderAll();
     },{
      crossOrigin: 'anonymous'
    });
     this.emptycontrols();
     this.gettimefun();
  }
  initEvents() {
    let lthis = this;
    $('.menutoggle').unbind('click').on('click', function(e) {
        $('.menu-box').animate({
            width: "hide"
        });
        $(".structuredocsec .card-body").css('margin-left','auto');
        $('.nav-link').removeClass('active');
        this.mstatus0="none"
    });
  
    $('.nav-link').unbind('click').on('click', function(e) {
        $('.nav-link').not(this).removeClass('active');
  //      $(this).toggleClass('active');
    });
  
    $(".textimg").unbind('click').on('click', function(e) {
        e.preventDefault();
        var id = $(this).data('id');
    //    lthis.loadTexts(id);
    });
  
    $(".editwarningmsg").unbind('click').on('click', function(e) {
        e.preventDefault();
      //  lthis.showEditLoginWarning();
    });
  
    $(".admintemp").unbind('click').on('click', function(e) {
        e.preventDefault();
        var id = $(this).data('id');
      lthis.loadCanvasFromJSON(id, true);
    });
    $(".usertemp").unbind('click').on('click', function(e) {
        e.preventDefault();
        var id = $(this).data('id');
    lthis.loadCanvasFromJSON(id, false);
    });
    $(".deletetxt").unbind('click').on('click', function(e) {
        e.preventDefault();
        var id = $(this).data('id');
     //   lthis.delTxt(id);
    });
  
    $(".deletetemp").unbind('click').on('click', function(e) {
        e.preventDefault();
        var id = $(this).data('id');
       // lthis.delTemp(id);
    });
  
    $(".deletegrad").unbind('click').on('click', function(e) {
        e.preventDefault();
        var id = $(this).data('id');
     //  lthis.delGrad(id);
    });
  
    $(".deleteusertemp").unbind('click').on('click', function(e) {
        e.preventDefault();
        var id = $(this).data('id');
      ///  lthis.delUserTemp(id);
    });
  
    $(".adminimg").unbind('click').on('click', function(e) {
        e.preventDefault();
       //lthis.uploadlogonewimage(e.currentTarget.dataset.imgsrc);
        lthis.activelogo=e.currentTarget.dataset.imgsrc;
        lthis.datesigndragenable('logodrag')
      });
  
    
    $(".adminvideo").unbind('click').on('click', (e) => {
        e.preventDefault();            
        lthis.getVideoDimensionsOf(e.currentTarget.dataset.videosrc)
        .then(({width, height}) => {
         //   console.log("Video width: " + width) ;
           // console.log(e) ;
            lthis.addVideo(e.currentTarget.dataset.videosrc, width, height, false, false);
        });
        
    });
  
    $(".stockadminimg").unbind('click').on('click', function(e) {
        e.preventDefault();
    lthis.img_click(e.currentTarget.dataset.imgsrc);
    });
  
    $(".adminelementimg").unbind('click').on('click', function(e) {
        e.preventDefault();
        let el = e.target;
      //  lthis.addSVG(src, false);
    });
    $(".adminbgimg").unbind('click').on('click', function(e) {
        e.preventDefault();
        var element = e.currentTarget as HTMLElement
        let el = element.dataset.imgsrc;
   //    var src = el.dataset.imgsrc;
       lthis.setCanvasBG(el, false);
    });
    $(".stockadminbgimg").unbind('click').on('click', function(e) {
        e.preventDefault();
    lthis.img_click(e.currentTarget.dataset.imgsrc);
    });
    $(".deletebgimg").unbind('click').on('click', function(e) {
        e.preventDefault();
        var id = $(this).data('id');
      //  lthis.delBGImage(id);
    });
    $(".divcanvas").unbind('click').on('click', function(e) {
        e.preventDefault();
    //    lthis.selectCanvas('divcanvas' + $(this).data('id'));
    });
    $(".addnewpagebutton").unbind('click').on('click', function(e) {
        e.preventDefault();
    //    lthis.addnewpage();
    });
    $(".addnewpagebutton").unbind('click').on('click', function(e) {
        e.preventDefault();
     //   lthis.addnewpage();
    });
    $(".duplicatecanvas").unbind('click').on('click', function(e) {
        e.preventDefault();
        var id = $(this).attr('id');
        id = id.replace("duplicatecanvas", "");
    //    lthis.addNewCanvasPage(true, parseInt(id));
    });
    $(".gradientsections").unbind('click').on('click', function(e) {
        e.preventDefault();
        var selgrdcolor1 = "";
        var selgrdcolor2 = "";
        var selgrdcolortype = "";
        selgrdcolor1 = $(this).data('color1');
        selgrdcolor2 = $(this).data('color2');
        selgrdcolortype = $(this).data('type');
        if ($(this).data('type') == "gradientradial") {
      //      lthis.grdcolorone = selgrdcolor1;
        //    lthis.grdcolortwo = selgrdcolor2;
           // lthis.setRadialgradient(lthis.grdcolorone, lthis.grdcolortwo);
        }
    });
    $(".bggradientsections").unbind('click').on('click', function(e) {
        e.preventDefault();
        var selbggrdcolor1 = "";
        var selbggrdcolor2 = "";
        var selbggrdcolortype = "";
        selbggrdcolor1 = $(this).data('bgcolor1');
        selbggrdcolor2 = $(this).data('bgcolor2');
        selbggrdcolortype = $(this).data('bgtype');
        if ($(this).data('bgtype') == "gradientradial") {
          //  lthis.grdbgcolorone = selbggrdcolor1;
            //lthis.grdbgcolortwo = selbggrdcolor2;
           // lthis.setVerticalBGgradient(lthis.grdbgcolorone, lthis.grdbgcolortwo);
        }
    });
   // lthis.initDraggable();
   // lthis.initKeyboardEvents();
  }
  getVideoDimensionsOf(url){
    return new Promise(function(resolve){
        // create the video element
        let video = document.createElement('video');
  
        // place a listener on it
        video.addEventListener( "loadedmetadata", function () {
            // retrieve dimensions
            let height = this.videoHeight;
            let width = this.videoWidth;
            // send back result
            resolve({
                height : height,
                width : width
            });
        }, false );
  
        // start download meta-datas
        video.src = url;
    });
  }
  getFonts() {
    this.http.get('./assets/studioassets/templates/fonts.json', {
        headers: this.headers
    }).subscribe(data => {
        if (data) {
            this.FontlistSection(data);
        }
    });
}
loadCanvasFromJSON(tempid, isAdminDesign) {
  $(".se-pre-con").fadeIn("slow");
  let lthis = this;
  let url = '/templates/';
  let username = this.userName;
  this.loadedtemplateid = 0;

  if (!isAdminDesign) {
      url = '/usertemplates/';
  } else {
      username = 'robg';
  }


  this.loadedtemplateid = tempid;
  this.http.get('./assets/studioassets/templates/'+tempid+"/"+tempid+".json", {    
      headers: this.headers
  }).subscribe(data => {
    // console.log(data)
    const data0=JSON.parse(( < any > data)._body);
    const canvassetting=JSON.parse(data0[0]);
    this.tempobj.setWidth(canvassetting.width);
    this.tempobj.setHeight(canvassetting.height);
    this.currenttmpwidth=canvassetting.width;  
    this.currenttmpheight=canvassetting.height; 
    $(".csPagesThumb").css("width", canvassetting.width+"px");
    $(".card-body").css("width", canvassetting.width+"px");
    //$(".tempcan").css("width", canvassetting.width+"px");
    $(".csPagesThumb").css("height", canvassetting.height+"px");
    // console.log(canvassetting)
   this.loadpagefun(data0[1]);
  // var canvas = this.tempobj; 
//   canvas.setZoom(canvas.getZoom() / 1.1 ) ;
   this.tempobj.renderAll();
//   this.btnZoomInClick();
  });

}
FontlistSection(data) {
  let fontlist = JSON.parse(( < any > data)._body);
 // console.log(fontlist)
  $('#font_container').empty();
  $('#fontselect').empty();
  $('#fontselect').append($('<option value="Helvetica">Helvetica</option>'));
  for (let font of fontlist) {
      $("head").prepend("<style type=\"text/css\">" + "@font-face {\n" + "\tfont-family: " + font.name + ";\n" + "\tsrc: local(''), url('" + '/' + font.fonts.url + "') format('opentype');\n" + "}\n" + "\tp.tests {\n" + "\tfont-family: Bungee Inline !important;\n" + "}\n" + "</style>");

      var selected = '';
      if (font.name == 'Great Wishes') {
          selected = 'selected';
      }
      var fontselect = $('<option ' + selected + ' value="' + font.name + '" style="font-family:' + font.name + '">' + font.name + '</option>');

      $('#fontselect').append(fontselect);
  }
}
searchgflib() {
  var lthis = this;
  this.duplicateremove = true;
  $('#gflibsection').empty();

  var gflibhtmldata = '';
  var imglist = '';
  this.userService.getlocalstockimages().subscribe(stockdata => {
    stockdata.forEach(o => {
      const imgurl=this.api_url+o;
      imglist = '<div class="col-lg-3 ol-md-3 col-sm-3 imgsection" style="padding: 5px;float: left;"><img style="max-width: 100%;width: 250px;" class="adminimg img" src="' + imgurl + '"  data-imgsrc="' + imgurl + '" /></div>';
      gflibhtmldata += imglist;
    })
    var $grid = $('#gflibsection');
    $grid.isotope({
        itemSelector: 'div',
        masonry: {
            columnWidth: 'div'
        }
    });
    gflibhtmldata = $(gflibhtmldata);
    $grid.isotope().append(gflibhtmldata).isotope('appended', gflibhtmldata).isotope('layout');
    CreateUtils.showgflib();
    lthis.initEvents();
    lthis.duplicateremove = false;
  })


//  var URL = './assets/studioassets/templates/images.json';

 /* $.getJSON(URL, function(data) {

      console.log(data);

      if (parseInt(data.links_loop) > 0)
          $('#gflibsection').empty();

      var gflibhtmldata = '';
      var imglist = '';
      $.each(data.links_loop, function(i, gfimg) {
          //console.log(gfimg)
          var ext = lthis.get_url_extension(gfimg.edit_image);
          if (ext === 'svg') {
              imglist = '<div class="col-lg-3 ol-md-3 col-sm-3 imgsection" style="padding: 5px;float: left;"><img style="max-width: 100%;width: 250px;" class="adminelementimg img" src="' + gfimg.thumb + '"  data-imgsrc="' + gfimg.edit_image + '" /></div>';
              gflibhtmldata += imglist;
          } else {
              imglist = '<div class="col-lg-3 ol-md-3 col-sm-3 imgsection" style="padding: 5px;float: left;"><img style="max-width: 100%;width: 250px;" class="adminimg img" src="' + gfimg.thumb + '"  data-imgsrc="' + gfimg.edit_image + '" /></div>';
              gflibhtmldata += imglist;
          }
      });
   
  });*/
}
  changecheckboxsource() {
    if (this.selectedObj.objtype == "checkbox" && this.selectedObj.checkboxvalue == false) {
       let self = this;
       var img = new Image();
       img.src = "assets/images/check.png";
       img.onload = function () {
         self.selectedObj.setElement(img);
       }
       self.selectedObj.set('checkboxvalue', true);
       var innPgCanvas = self.arrPageCanvas[self.seletecdPg - 1];
       self.extendcheck(self.selectedObj, self.selectedObj.id, self.selectedObj.objtype, self.selectedObj.checkboxvalue, self.selectedObj.tmp_width, self.selectedObj.tmp_height);
       innPgCanvas.setActiveObject(self.selectedObj).renderAll();
       innPgCanvas.renderAll();
       self.emptycontrols();
       self.gettimefun();
       this.selectedObj.checkboxvalue = true;
     } else if (this.selectedObj.objtype == "checkbox" && this.selectedObj.checkboxvalue == true) {
     let self = this;
       var img = new Image();
       img.src = "assets/images/uncheck.png";
       img.onload = function () {
         self.selectedObj.setElement(img);
       }
       self.selectedObj.set('checkboxvalue', false);
       var innPgCanvas = self.arrPageCanvas[self.seletecdPg - 1];
       self.extendcheck(self.selectedObj, self.selectedObj.id, self.selectedObj.objtype, self.selectedObj.checkboxvalue, self.selectedObj.tmp_width, self.selectedObj.tmp_height);
       innPgCanvas.setActiveObject(self.selectedObj).renderAll();
       innPgCanvas.renderAll();
       self.emptycontrols();
       self.gettimefun();
       this.selectedObj.checkboxvalue = false;
     }
   }
   changeradiochecksource() {
    if (this.selectedObj.objtype == "radiocheck" && this.selectedObj.checkboxvalue == false) {
     let self = this;
       var img = new Image();
       img.src = "assets/images/radiocheck.png";
       img.onload = function () {
         self.selectedObj.setElement(img);
       }
       self.selectedObj.set('checkboxvalue', true);
       var innPgCanvas = self.arrPageCanvas[self.seletecdPg - 1];
       self.extendradio(self.selectedObj, self.selectedObj.id, self.selectedObj.objtype, self.selectedObj.checkboxvalue, self.selectedObj.tmp_width, self.selectedObj.tmp_height);
       innPgCanvas.setActiveObject(self.selectedObj).renderAll();
       innPgCanvas.renderAll();
       self.emptycontrols();
       self.gettimefun();
       this.selectedObj.checkboxvalue = true;
     }
     else if (this.selectedObj.objtype == "radiocheck" && this.selectedObj.checkboxvalue == true) {
       // this.selectedObj.src="assets/images/unchecked.png";
   
       let self = this;
       var img = new Image();
       //  var canvas = self.tempobj;
       img.src = "assets/images/radiobuttonuncheck.png";
       img.onload = function () {
         self.selectedObj.setElement(img);
       }
       self.selectedObj.set('checkboxvalue', false);
       var innPgCanvas = self.arrPageCanvas[self.seletecdPg - 1];
       self.extendradio(self.selectedObj, self.selectedObj.id, self.selectedObj.objtype, self.selectedObj.checkboxvalue, self.selectedObj.tmp_width, self.selectedObj.tmp_height);
       innPgCanvas.setActiveObject(self.selectedObj).renderAll();
       innPgCanvas.renderAll();
       self.emptycontrols();
       self.gettimefun();
       this.selectedObj.checkboxvalue = false;
     }
   }
  imagecheck: any;
innpag: boolean = false;
imagessc: any;
check(e) {
  if (!this.editable) { return }
  this.imagecheck = "assets/images/uncheck.png";
  var points = this.regularPolygonPoints(6, 50);
  var points1 = this.starPolygonPoints(5, 50, 25);
  var innPgCanvas = this.arrPageCanvas[this.seletecdPg - 1];
  fabric.Image.fromURL(this.imagecheck, (image) => {
    image.set({
      left: e.layerX,
      top: e.layerY,
      width: image.width,
      height: image.height,
      tmp_width: 20,
      tmp_height: 50,
      hoverCursor: 'pointer',
      selectable: true,
      hasControls: false,
      objtype: 'checkbox',
      checkboxvalue: false,
      angle: 0,
      cornersize: 0,
      hasRotatingPoint: true,
      id: this.randomId()

    });

    image.setControlsVisibility({
      bl: true,
      br: true,
      tl: true,
      tr: true,
      mt: false,
      mb: false,
      mtr: false,
      mr: false,
      ml: false
    });
    this.imagessc = image
    this.extendcheck(this.imagessc, image.id, image.objtype, image.checkboxvalue, image.tmp_width, image.tmp_height);
    innPgCanvas.add(this.imagessc);
    innPgCanvas.sendBackwards(this.imagessc);
    innPgCanvas.setActiveObject(this.imagessc).renderAll();
    this.renderLayers();
});
this.emptycontrols();
this.gettimefun()

}
radiocheck(e) {

  if (!this.editable) { return }
  this.imagecheck = "assets/images/radiobuttonuncheck.png";
  var points = this.regularPolygonPoints(6, 50);
  var points1 = this.starPolygonPoints(5, 50, 25);
  var innPgCanvas = this.arrPageCanvas[this.seletecdPg - 1];
  fabric.Image.fromURL(this.imagecheck, (image) => {
    image.set({
      left: e.layerX,
      top: e.layerY,
      width: image.width,
      height: image.height,
      tmp_width: image.width,
      tmp_height: image.height,
      hoverCursor: 'pointer',
      selectable: true,
      hasControls: false,
      objtype: 'radiocheck',
      checkboxvalue: false,
      angle: 0,
      cornersize: 0,
      hasRotatingPoint: true,
id: this.randomId()
    }).scale(0.9);

    image.setControlsVisibility({
      bl: true,
      br: true,
      tl: true,
      tr: true,
      mt: false,
      mb: false,
      mtr: false,
      mr: false,
      ml: false
    });
    this.imagessc = image
    this.extendradio(this.imagessc, image.id, image.objtype, image.checkboxvalue, image.tmp_width, image.tmp_height);
    innPgCanvas.add(this.imagessc);
    innPgCanvas.sendBackwards(this.imagessc);
    innPgCanvas.setActiveObject(this.imagessc).renderAll();
    this.renderLayers();
    this.emptycontrols();
    this.gettimefun()
  });
}

extendcheck(obj, id, objtype, checkboxvalue, tmp_width, tmp_height) {
  obj.toObject = (function (toObject) {
    return function () {
      return fabric.util.object.extend(toObject.call(this), {
        id: id,
        objtype: objtype,
        checkboxvalue: checkboxvalue,
        tmp_width: tmp_width,
        tmp_height: tmp_height
      });
    };
  })(obj.toObject);
}

extendradio(obj, id, objtype, checkboxvalue, tmp_width, tmp_height) {
  obj.toObject = (function (toObject) {
    return function () {
      return fabric.util.object.extend(toObject.call(this), {
        id: id,
        objtype: objtype,
        checkboxvalue: checkboxvalue,
        tmp_width: tmp_width,
        tmp_height: tmp_height
      });
    };
  })(obj.toObject);
}
  btnsaveyes(){
    this.btnSaveJsonClick()
    this.router.navigate(['/client/clientdashboard/clientdashboardview']);
    this.modalRef.hide()
  }
  btncancelno(){
    this.router.navigate(['/client/clientdashboard/clientdashboardview']);
    this.modalRef.hide()
  }
  saveimagevar_value() {
    const val = ((document.getElementById("imgvarval") as unknown as HTMLInputElement).value);
    if (val == '') {
      this.showerror = true;
    } else {
      this.showerror = false;
      if (this.selectedObj && this.selectedObj.type != 'group') {
        this.selectedObj.set('imgvarvalue', val);
      }
      this.extendimgvar(this.selectedObj, this.selectedObj.id, this.selectedObj.objtype, this.selectedObj.cacheKey, this.selectedObj.imgvarvalue, this.selectedObj.tmp_width, this.selectedObj.tmp_height); 
      var innPgCanvas = this.arrPageCanvas[this.seletecdPg - 1];
      //innPgCanvas.add(this.selectedObj);
      this.emptycontrols();
      innPgCanvas.setActiveObject(this.selectedObj).renderAll();
      this.renderLayers();
      this.openModal0 = false;
      this.modalRef.hide()
    }
  }
  //console.log(val);
  updatecanvaswidth(e){
   // console.log(this.fbcSizeObj);
   // console.log(e.target.value);
    this.tempobj.setWidth(e.target.value);
  }
  updatecanvasheight(e){
    this.tempobj.setHeight(e.target.value);
  }
  onPDFFileChanged(event: any) {
    var json: any;
   //this.pdfurls=event.target.files[0];
    var file = event.target.files[0],
        reader = new FileReader();
    reader.onload = () => {
     this.pdfurls=reader.result;
   setTimeout(() => {
    if(json.children[0].children[0].children[0].children[1].children.length>0){
   this.readPDF(reader.result);
    }
    }, 3000);
    }
   reader.readAsDataURL(file);
   setTimeout(() => {
   json = this.converter(document.getElementById("pdfview"));
   console.log(json.children[0].children[0].children[0].children[1].children.length)
   if(json.children[0].children[0].children[0].children[1].children.length>0){
   let noofpages=json.children[0].children[0].children[0].attributes[1].value;
   for(let b=0;b<noofpages;b++){
    var splitted = json.children[0].children[0].children[0].attributes[3].value.replace(/px/gi, '');
    splitted = splitted.replace('width: ', '');
  splitted = splitted.replace(' height: ', '');
  splitted = splitted.split(";", 2);
    const viewport={"width":splitted[0],"height":splitted[1]}
   this.addNewPage1(viewport);
  this.currenttmpwidth=viewport.width;  
  this.currenttmpheight=viewport.height; 
  this.tempobj.setWidth(viewport.width);
  this.tempobj.setHeight(viewport.height);
  let elestyle=[];
  setTimeout(() => {
  var elements = json.children[0].children[0].children[0].children[1];
  elements.children.forEach(elementval => {
   // console.log(elementval.children[0])
   var elementstyle = elementval.attributes[0].value.replace(/px/gi, '');
  elementstyle = elementstyle.replace(/ /gi, '');
   elementstyle = elementstyle.split(";", 20);
   elementstyle.forEach(elementstyle1 => {
    elestyle.push(elementstyle1.split(":", 30));
   });
   if(elestyle.length>1){
  // console.log(elestyle[1][1])
   const x=elestyle[0][1];
   const y=elestyle[1][1];
   const fontsize=elestyle[2][1];
   const fontfamily=elestyle[3][1];
   var scaleval=elestyle[4][1];
   if(scaleval){
   scaleval = scaleval.replace('scaleX(', '');
   scaleval = scaleval.replace(')', '');
   }else{
   scaleval=1;
   }
   var c = document.getElementById("page1") as any;
   var ctx = c.getContext("2d");
   ctx.font = fontsize + 'px ' + fontfamily;
   var txt = elementval.children[0];
   var width00=Math.round(ctx.measureText(txt).width)+15;
  //console.log(width00)
  this.addPDFText(elementval.children[0], x-10, y, width00, 19, fontsize, fontfamily, scaleval);
    }
    elestyle=[];
   
  });
  //this.btnSaveJsonClick();
  }, 1500);
   }
   }else{
    alert("pdf import failed, please upload again")
   }
  }, 1000);
  this.importtype=true;
   //reader.readAsArrayBuffer(file);
   var canvas=this.arrPageCanvas[this.seletecdPg - 1];
   canvas.renderAll();
  this.folderpathpdf=null;
  }
  converter(dom) {
    if (dom.nodeType === Node.TEXT_NODE) {
       return dom.nodeValue;
    }
    if (dom.nodeType === Node.DOCUMENT_NODE) {
        dom = dom.documentElement;
    }
    var obj:any = {};
    obj.nodeType = dom.nodeType;
    if (dom.nodeType === Node.ELEMENT_NODE) {
        obj.tagName = dom.tagName;
        obj.attributes = []; // Array.from(obj.attributes) gives us a lot of things we don't want
        for (let i = 0, len = dom.attributes.length; i < len; ++i) {
            const attr = dom.attributes[i];
            obj.attributes.push({name: attr.name, value: attr.value});
        }
        obj.children = [];
        for (let child = dom.firstChild; child; child = child.nextSibling) {
           obj.children.push(this.converter(child));
        }
    } else {
        obj.nodeValue = dom.nodeValue;
    }
   return obj;
  }
  readPDF(buffer) {
    var canvas = this.arrPageCanvas[this.seletecdPg - 1];
    //PDFJS.disableWorker = true;
    var loadingTask = pdfjsLib.getDocument(buffer);
    loadingTask.promise.then((pdf) => {       
        for (var i = 1; i <= 1; i++) {
            ((pn) => {
                pdf.getPage(i).then((page) => {              
                    this.scale=Math.min((816/612), (1024/792));
                    this.scale = this.scale.toFixed(1);
                    const scale = 1;
                 //   page._pageInfo.view[2]=816;
                   // page._pageInfo.view[3]=1024;
                    var viewport = page.getViewport({scale});  
  /*             console.log(viewport) 
                    viewport.height=1024;                      
                    viewport.width=816;                      
                    viewport.transform[5]=1024;                      
                    viewport.viewBox[2]=816;                      
                    viewport.viewBox[3]=1024;   */            
                   this.ctype = 'pixels';
                   page.pn = pn-1;                        
                    page.getOperatorList().then(opList => {
                        var svgGfx = new pdfjsLib.SVGGraphics(page.commonObjs, page.objs);                        
                        //svgGfx.embedFonts = true;
                        return svgGfx.getSVG(opList, viewport).then(svg => {
                            //console.log(svg.querySelectorAll("rect"))
            // console.log(svg)
                      var lines = svg.querySelectorAll("path"); 
                      
                            lines.forEach(line => {
                              this.addline(line.attributes,line)
                            })
                            var images = svg.querySelectorAll("image"); 
                            images.forEach(image => {
                                //console.log(image);                                    
  
                                var imgparent = image.parentNode;
                                //console.log(imgparent)
                                var imgtransform = imgparent.getAttribute('transform');
                               imgtransform = imgtransform.replace('matrix(', '');
                                imgtransform = imgtransform.replace(')', '');
                                imgtransform = imgtransform.split(" ");
                                //console.log(imgtransform);
                                var tx = pdfjsLib.Util.transform(viewport.transform, imgtransform);
                                //console.log(tx);
                                
                                const pt = svg.createSVGPoint();
  
                                // pass event coordinates
                                pt.x = tx[4];
                                pt.y = tx[5] + tx[3];
  
                                // transform to SVG coordinates
                                const svgP = pt.matrixTransform( svg.getScreenCTM().inverse() );
  
                                
                                var imageInfo  = {x:tx[4], y:tx[5] + tx[3], url: '', bwidth: '', bheight: '', width: '', height: '', transform: '', scaleX: tx[0]};
                                //imageInfo.x += parseInt(image.getAttribute('x'));
                                //imageInfo.y += parseInt(image.getAttribute('y'));
                                imageInfo.url = image.getAttribute('xlink:href');
                                imageInfo.width = image.getAttribute('width');
                                imageInfo.height = image.getAttribute('height');
                                imageInfo.bwidth = tx[0];
                                imageInfo.bheight = tx[3];
                                imageInfo.transform = image.getAttribute('transform');
                                this.addPDFImage(page.pn, imageInfo);
                            })
                            //console.log(svg.querySelectorAll("text"))
                            //console.log(typeof svg)
                        });
                    }).then(svgElement => {
                    });
                });
  
            })(i);
        }
     //   this.btnZoomInClick
     //   canvas.renderAll();
    });
  }
  addPDFImage(pageid, imageinfo) {  
    console.log('img')      
    var canvas = this.tempobj;
    var w = imageinfo.width.replace('px', '');
    var bw = imageinfo.bwidth;
    w = parseInt(w) * 1;
    var h = imageinfo.height.replace('px', '');
    var bh = imageinfo.bheight;
    if(bh < 0)
        bh *= -1;
    h = parseInt(h) * 1;
  
    // console.log(imageinfo.transform);        
    // var parts  = /scale\(\s*([^\s,)]+)[ ,]([^\s,)]+)/.exec(imageinfo.transform);
    // var scaleX = parts[1],
    //     scaleY = parts[2];
    // console.log(scaleX, scaleY);
  
    var xhr = new XMLHttpRequest;
    xhr.responseType = 'blob';
    
    xhr.onload = () => {
       var recoveredBlob = xhr.response;
    
       var reader = new FileReader;
    
       reader.onload = () => {
         var blobAsDataUrl = reader.result;
         
        //  var dataUrl: any = reader.result;
        //  var base64 = dataUrl.split(',')[1];
        //  console.log(base64)
        var scaleX = 1;
  var scaleY = 1;
  var left = Math.round(imageinfo.x);
  var top =Math.round(imageinfo.y);
        var tempScaleX = scaleX * this.scale;
  var tempScaleY = scaleY * this.scale;
  var tempLeft = left * this.scale;
  var tempTop = top * this.scale;
         fabric.Image.fromURL(blobAsDataUrl, (img) => {
             img.set({
                 //width: bw * this.canvasScale,
                 //height: bh * this.canvasScale,
                 left: tempLeft,
                 top: tempTop,
                 scaleX: tempScaleX,
                 scaleY: tempScaleY,
                 tmp_width: bw,
                 tmp_height: bh,
                 hoverCursor: 'pointer',
                 selectable: true,
                 hasControls: false,
                 objtype: 'logo',
                 angle: 0,
                 cornersize: 0,
              hasRotatingPoint: true,
              linkURL:''
             });
             img.scaleToWidth(bw*1);
             //img.scaleToHeight(bh*this.canvasScale);
             canvas.add(img);
             //canimg.center();
             img.setCoords();
             var innPgCanvas = this.arrPageCanvas[this.seletecdPg - 1];
             this.extend(img, this.randomId(), img.objtype,img.linkURL);
             innPgCanvas.add(img);
             innPgCanvas.setActiveObject(img).renderAll();
             this.renderLayers();
             canvas.renderAll(); 
         });
       };
    
       reader.readAsDataURL(recoveredBlob);
    };
    
    xhr.open('GET', imageinfo.url);
    xhr.send();
        
  }
  addPDFText(text0, x, y, width, height, fontSize, fontFamily, scaleX) {
    // console.log(text0)
    let text = new fabric.Textbox(text0, {
      left: Math.round(x),
      top: Math.round(y),
      fontFamily: fontFamily,
      angle: 0,
      scaleX: scaleX,
      linethrough: false,
      translateX: 100,
      translateY: 100,
      fill: '#000000',
      width: width,
      height: height,
      textLength:"200",
      textAlign: 'left',
      fontSize: Math.round(fontSize),
      fontWeight: 'normal',
      fontStyle:'normal',
      underline:'',
      overline:"",
      editingBorderColor: 'blue',
      showTextBoxBorder: true,
      textboxBorderColor: 'gray',
      hasRotatingPoint: true,
      variable: '',
      objtype: 'slabel',
      id: this.randomId(),
      linkURL:''
    });
    text.setControlsVisibility({
      bl: true,
      br: true,
      tl: true,
      tr: true,
      mt: false,
      mb: false,
      mtr: false,
      mr: true,
      ml: true
    });
    this.extend(text, text.id, 'flowpara',text.linkURL);
    this.tempobj.add(text);
    this.selectItemAfterAdded(text);
    $('#addtext06').val('');
    this.renderLayers();
    this.textString = '';
  }
  gotoeditablepage(){
    var obje = {
      "routerpage":"Inprogress",
      "tablename":String(this.naviDate.tablename),
      "content":"Editable",
      "designid": this.naviDate.designid,
      "mode": "edit",
      "formtypeid": 1
    }
    this.userService.changeNav(obje)
    this.router.navigate([`/designbuilder`]);
//    this.ngOnInit();
  }
  showheaderfooter(){
    if (!this.editable) { return }
    this.showhfsection = true;
      this.openModal0 = true;
  }
  electronictools(){
    const imgsrc="assets/images/unchecked.png";
    var innPgCanvas = this.arrPageCanvas[this.seletecdPg - 1];
      fabric.Image.fromURL(imgsrc, (image) => {
        image.set({
        left: 150,
        top: 150,
        width: image.width,
        height: image.height,
        tmp_width: image.width,
        tmp_height: image.height,
        hoverCursor: 'pointer',
        selectable: true,
        hasControls: false,
        objtype: 'logo',
        angle: 0,
        cornersize: 0,
     hasRotatingPoint: true,
     id: this.randomId()
      });
      this.extendlogo(image, image.id, image.objtype, image.src1, image.tmp_width, image.tmp_height);
      innPgCanvas.add(image);
    innPgCanvas.setActiveObject(image).renderAll();
    this.renderLayers();
     });
     this.emptycontrols();
     this.gettimefun();
  }
  btnAddImgVarClick(e) {
    //    console.log("a")
        if (!this.editable) { return }
        this.modalRef = this.modalService.show(this.imgvar, { class: 'modal-md', backdrop: 'static' });
        this.openModal0 = true;
        this.selectedProperty.imgvarvalue = '';
        const imgsrc='data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGQAAABkCAIAAAD/gAIDAAAABmJLR0QA/wD/AP+gvaeTAAAGrElEQVR4nO2cwWvTUBjA39KaS5vulLSupqD1pojMHYQNPHjbmMPNUpx4EquCun9Ahnhd8WCmnhWr0zGl3fSgyAqDDcWyVWQbZNVqupXZg0gycKfn4WEYc+3yJVmTbu93ykvzvpf3472Xr6GvTRhjRDEG4/QNNBJUFgAqCwCVBYDKAkBlAaCyAFBZAKgsAFQWACoLAJUFgMoCQGUBoLIAUFkAqCwAVBYAr/UQiqKk0+nXr18Xi0VFUdbW1qzHtAWfzyeK4sGDB7u6unp6eg4cOGA1IrZAqVRKJBJerw3GdxqGYWKxWLFYtNJf87LS6TTHcQghlmXj8fizZ88WFxc1TbNyN/aiadri4uLTp0/j8TjLsgghjuMymYzpgCZl3bt3j2EYhFAsFvv69avp5utGoVDo6+sjQ0ySJHNBzMhKp9MMw3g8nrt375pr1SmSyaTH42EYxtz4AssqlUpk9m00tbq6euvWrePHj/t8PgcXpiNHjmx7/8lkEiEUCARWVlagfQfLunTpEpl9+pnR0VGe5wcGBj58+OCqNasavb29CKFEIgGtCJP148cPj8fDsqy+To2OjkYikXw+D23YQZaWlliW9Xq9pVIJVBEmS5IkhFA8HifF1dVVnucbyxQhFoshhO7fvw+qBcvg37x5gxDq6ekhRUmS+vv7jx07ZuvKUw9IF0h3jAOTVSgUEEInTpwgxfHx8f7+flAEl9DW1ob+dcc4TRjyKxqO4zRNU1XV7/eTYrlcJseNhaZpHMf5/X5VVY3XgslqampCCOlVmppg1V3Fpr4YobHfOszNzV24cCEcDrMsK4ri1atXi8XizjXXwLIeP37c2dnZ3t7+8ePHtbW1bDYbDodPnjz57t27nWoS9OzcVAVa3Uby+XwoFJJledP5mZmZYDBo5O2Cie436pp18eLFtra2gYGB/z+6c+dOuVx++PBh7Qgm1qxGHVktLS1fvnzZ8iNZliORyLYRTHS/UUcWy7K/fv3a8nv7+vp6c3Pznz9/akfYQ09DnuerPfgURQmFQjvRaKPKOn36dLWnXiqV6uzs3JFWQZN2UxVodRv5/Pnzlk/D6enpYDD4/fv3bSOY6T7satfIwhg/evQoFApJkqQoyvr6uizLt2/fDgaDb9++rVYlGo3qx3tLFsY4n8/rGXwkErl27VrtMbXp5l0nK5fLtbe3+3y+jo6OXC4Has52jh49qh+7Ttbk5KQgCCMjI5qmjYyMCIIwOTkJanHncJesqakpQRDev39f44yDuEgWGVP/j6Nq5+uDGxf42iPIwfHlugXeiAunfLlLlnELjvhykSzoemRx/TKRlLgldTDXc9O+rCcljsmyMqdM1LUlKXFGlvVsABTBSlLi8DS0a502GMdiUuLwAm9jhrnt0DAydmpf47Ase3PxGl01PlVrXOmi1MEWtpxK0Mle7frdJgv/11Vzy+KWtXahLLyhq/YmJbtTFv639NiblOxaWRjjbDZr/Wm70dduloUxnpqaCgaDFvM4fT7uclnY1vG1+2Vh+3ztCVnYpvm4V2RhO3ztIVnYsq+9JQtbe3dWV1lki5OqqnpRP64n5nz9/v07EAjoxwghvWgQ2E+O9u/fjxBaWVkhxWg0Oj8/D4pgCx0dHS9evDh//nw2mzVea35+/vDhw+S4XC4jhFpaWkDtwmRFo1GEUC6XI8Xu7u5UKgWKYBenTp16/vx5PB437iuVSnV3d5PjT58+oX/dAQAah8PDw2jDRqefP3/yPD83NwcKYiPGX3LNzs4KglCpVEiRbHR68OABqDmYLEVRvF4vy7KFQoGcGRsbE0XR5b5mZ2dFUXz16hUpyrJcjy10GOPLly8jhPr6+vQzY2NjPM/fuHFjZmbGkfW+mi9VVaenp69fvy4IwsuXL/XzZ8+eRQhduXIF2hBY1vLyMnkmJpNJ/WSlUhkcHGxtbXXVpieO41pbWwcHB/XZhzEeGhpCCDU3N5fL5R2XhTHOZDJkQ/lGXw3B0NAQ2VA+MTFhorrJrFKSJPJXBb29vUtLS+aC1BNZlsnsYxhmeHjYXBDzKfj4+HggEEAIsSwbi8VSqdTCwoIja1Y1VFVdWFh48uTJuXPn9u3bR2afuTFFsPR9pVKp3Lx5syH+XsXr9SYSCRN/T7ARG/aTLC8vZzKZiYmJb9++KYqiaZot3bOO3+8XRfHQoUNdXV1nzpwJh8MWAzbwVtT606jbURyBygJAZQGgsgBQWQCoLABUFgAqCwCVBYDKAkBlAaCyAFBZAKgsAFQWACoLAJUFgMoC8BfcAuDWBZqA4gAAAABJRU5ErkJggg==';
        if (this.seletecdPg > 0) {
          var innPgCanvas = this.arrPageCanvas[this.seletecdPg - 1];
          fabric.Image.fromURL(imgsrc, (image) => {
            image.set({
            left: e.layerX,
            top: e.layerY,
            width: image.width,
            height: image.height,
            tmp_width: image.width,
            tmp_height: image.height,
            opacity: 1.0,
            objtype: 'imgvar',
            cacheKey: 'imgvar',
            imgvarvalue: '',
            id: this.randomId()
          });
          this.extendimgvar(image, image.id, image.objtype, image.cacheKey, image.imgvarvalue, image.tmp_width, image.tmp_height);
          innPgCanvas.add(image);
          this.emptycontrols();
          innPgCanvas.setActiveObject(image).renderAll();
          this.renderLayers();
        });
        }
      }
  btncancelClick(cancel) {
    this.modalRef = this.modalService.show(cancel, { class: 'modal-md', backdrop: 'static' });
    this.openModal0 = true;
  }
  checka:any;
  
  btnpdfdownload(){
    this.modalRef = this.modalService.show(this.pdfdownload, { class: 'modal-md', backdrop: 'static' });
    this.openModal0 = true;
   
  }
  
  savesignaturelistedit() {
    this.modalRef.hide();
    var innPgCanvas = this.arrPageCanvas[this.seletecdPg - 1];
    const signature_id = ((document.getElementById("signature_name1") as unknown as HTMLInputElement).value);
    const signature_name = ((document.getElementById("signature_id1") as unknown as HTMLInputElement).value);
    if (signature_id == '' || signature_name == '') { console.log(signature_id)
    } else {
      if (this.selectedObj && this.selectedObj.type != 'group') {
        this.selectedObj.set('signature_name', signature_name);
        this.selectedObj.set('signature_id', signature_id);
        if (this.seletecdPg > 0) {
          innPgCanvas.renderAll();
        }
      }
    }
    this.extendimgsignature(this.selectedObj, this.selectedObj.id, this.selectedObj.handletype,this.selectedObj.objtype, this.selectedObj.cacheKey, this.selectedObj.signature_name, this.selectedObj.signature_id);
    this.extendimgsignature0(this.selectedObj, this.selectedObj.id,  this.selectedObj.handletype,this.selectedObj.objtype, this.selectedObj.cacheKey, this.selectedObj.signature_name, this.selectedObj.signature_id, this.selectedObj.relatedobj,this.selectedObj.dependantvariable,this.selectedObj.datetimevariable,this.selectedObj.tmp_width,this.selectedObj.tmp_height);
    this.emptycontrols();
    innPgCanvas.setActiveObject(this.selectedObj).renderAll();
    this.renderLayers();
  }
  closesignaturefirstpopup(){
    const signature_id = ((document.getElementById("signature_id") as unknown as HTMLInputElement).value);
    const signature_name = ((document.getElementById("signature_name") as unknown as HTMLInputElement).value);
//    console.log(signature_id);
    if (signature_id == '' || signature_name == '') {
    this.signature_first_popup=false;  
       if (this.seletecdPg > 0) {
        var innPgCanvas = this.arrPageCanvas[this.seletecdPg - 1];
        var arrSel = innPgCanvas.getActiveObjects();
        for (var index in arrSel) {
          innPgCanvas.remove(arrSel[index]);
        }
        innPgCanvas._discardActiveObject();
      }
      this.modalRef.hide();
      innPgCanvas.renderAll();
    }else{
      this.signature_first_popup=false;  
    }
    this.renderLayers();  
  }
  savesignature(signaturepopups) {
    const signature_id = ((document.getElementById("signature_id") as unknown as HTMLInputElement).value);
    const signature_name = ((document.getElementById("signature_name") as unknown as HTMLInputElement).value);
    var innPgCanvas = this.arrPageCanvas[this.seletecdPg - 1];
    //    console.log(signature_id);
    if (signature_id == '' || signature_name == '') {console.log(signature_name)
    } else {
      this.modalRef = this.modalService.show(signaturepopups, { class: 'modal-md', backdrop: 'static'});
   //console.log("Sd");
   var canvas = this.tempobj;
   var selectfil=this.layer4;
      if(selectfil && selectfil.length!=0){
        for(var x=0; x<selectfil.length;x++) {
          if(selectfil[x].objtype=="signature"){
         this.selectItemAfterAdded(selectfil[x]);
            canvas.setActiveObject(selectfil[x]);
        this.selectedObj.set('signature_name', signature_name);
        this.selectedObj.set('signature_id', signature_id);
        this.selectedObj.set('relatedobj', JSON.stringify(this.layer4));
this.activesignature=selectfil[x];
        if (this.seletecdPg > 0) {
      innPgCanvas.renderAll();
        }
    
    this.extendimgsignature0(this.selectedObj, this.selectedObj.id, this.selectedObj.handletype,this.selectedObj.objtype, this.selectedObj.cacheKey, this.selectedObj.signature_name, this.selectedObj.signature_id, this.selectedObj.relatedobj, this.selectedObj.dependantvariable,this.selectedObj.datetimevariable,this.selectedObj.tmp_width,this.selectedObj.tmp_height);
   this.selectItemAfterAdded(this.selectedObj);
    //innPgCanvas.add(this.selectedObj);
    this.emptycontrols();
    innPgCanvas.setActiveObject(this.selectedObj).renderAll();
    this.renderLayers();
    this.signaturepopup = false;
    this.signature_first_popup=false;
    this.signaturepopuptwo = true;
    this.createlines();
          }
}
   }
   else{
    //console.log("else");
    this.selectedObj.set('signature_name', signature_name);
    this.selectedObj.set('signature_id', signature_id);
    this.selectedObj.set('relatedobj', JSON.stringify(this.layer4));
 
    if (this.seletecdPg > 0) {
      innPgCanvas.renderAll();
    }

this.extendimgsignature0(this.selectedObj, this.selectedObj.id, this.selectedObj.handletype,this.selectedObj.objtype, this.selectedObj.cacheKey, this.selectedObj.signature_name, this.selectedObj.signature_id, this.selectedObj.relatedobj, this.selectedObj.dependantvariable,this.selectedObj.datetimevariable,this.selectedObj.tmp_width,this.selectedObj.tmp_height);
this.selectItemAfterAdded(this.selectedObj);
//innPgCanvas.add(this.selectedObj);
this.emptycontrols();
innPgCanvas.setActiveObject(this.selectedObj).renderAll();
this.renderLayers();
this.signaturepopup = false;
this.signature_first_popup=false;
this.signaturepopuptwo = true;
   }
    //console.log(this.selectedObj.signature_name);
  }
}
  saveeditsignature() {
    this.modalRef.hide();
    var innPgCanvas = this.arrPageCanvas[this.seletecdPg - 1];
    this.signaturepopup = false;
    this.signaturepopuptwo = true;
    const signature_id = ((document.getElementById("signature_ids") as unknown as HTMLInputElement).value);
    const signature_name = ((document.getElementById("signature_names") as unknown as HTMLInputElement).value);
//    var datetimevariable=document.querySelectorAll('input[name="datetime_variable"]:checked');
var dtvar=[];
$("input:checkbox[name='datetime_variable']:checked").each(function(){
  dtvar.push($(this).val());
}); 
//console.log(dtvar);
if (signature_id == '' || signature_name == '') {
    } else {
      if (this.selectedObj && this.selectedObj.type != 'group') {
        this.selectedObj.set('signature_name', signature_name);
        this.selectedObj.set('signature_id', signature_id);
        this.selectedObj.set('datetimevariable', JSON.stringify(dtvar));
        if (this.seletecdPg > 0) {
          innPgCanvas.renderAll();
        }
      }
    }
    this.extendimgsignature0(this.selectedObj, this.selectedObj.id, this.selectedObj.handletype,this.selectedObj.objtype, this.selectedObj.cacheKey, this.selectedObj.signature_name, this.selectedObj.signature_id, this.selectedObj.relatedobj, this.selectedObj.dependantvariable,this.selectedObj.datetimevariable,this.selectedObj.tmp_width,this.selectedObj.tmp_height);
    this.selectItemAfterAdded(this.selectedObj);
    //innPgCanvas.add(this.selectedObj);
    this.emptycontrols();
    innPgCanvas.setActiveObject(this.selectedObj).renderAll();
    this.renderLayers();
    this.layer4=[];
  }
  editsignature(index, edisignaturepopuptwo) {
    var canvas = this.tempobj;
    var obj = canvas.item(index);
    this.selectItemAfterAdded(obj);
    canvas.setActiveObject(obj);
    if (!this.editable) { return }
    this.modalRef = this.modalService.show(edisignaturepopuptwo, { class: 'modal-md', backdrop: 'static' });
  //  console.log(this.selectedObj.get('relatedobj'));
    this.currelatedobj=JSON.parse(this.selectedObj.get('relatedobj'));
//  console.log(this.currelatedobj);
  }
  generatesignaturejson() {
    const id = this.naviDate.designid;
    const mode = this.naviDate.tablename;
    this.savedsignjson = '';
    let designSign_jsonObj={"id":id,"mode":mode}
     this.userService.get_signjsons(designSign_jsonObj).subscribe(data => {
      if (data.signature_json) {
       // data = JSON.parse(data.signature_json);
//        this.savedsignjson = data.signature_json;
        this.savedsignjson = '';
      //  console.log(this.savedsignjson);
        this.viewsignaturejson = this.savedsignjson;
      }
      if (this.seletecdPg > 0) {
        var canvas = this.arrPageCanvas[this.seletecdPg - 1];
        if (canvas.getObjects()) {
          this.layers = canvas.getObjects();
          this.signatureitems = "";
          this.myHtml = "";
          for (var i = 0; i < this.layers.length; i++) {
      //      console.log(this.layers[i].signature_name);
            if (this.layers[i].signature_name != '' && this.layers[i].signature_name != undefined) {
              //  this.signatureitems += '<signature sid="' + i + '" id="' + this.layers[i].signature_id + '" pageid="' + this.currPage + '" name="' + this.layers[i].signature_name + '" dependantid="" dateTimeIds="" />';
     var relatedobject=[];
              if(this.layers[i].relatedobj){
              relatedobject=JSON.parse(this.layers[i].relatedobj);
     }else{
      relatedobject=[];
     }
       var datetimevar="";
       var dependantvar="";
       var dtvar=[];
       if(this.layers[i].datetimevariable){
       dtvar=JSON.parse(this.layers[i].datetimevariable);
       }else{
        dtvar=[];
       }
         relatedobject.forEach(x => {
              if(x.type="textbox"){
                if(this.layers[i].datetimevariable!="[]"){
                  for (var _i = 0; _i < dtvar.length; _i++) {
                  // console.log(dtvar[_i])
                 if('<<'+dtvar[_i]+'>>'==x.text){
                   datetimevar+="sText_"+x.id+','
                 }
                }
                if(x.text=='<<'+this.layers[i].dependantvariable+'>>'){
                  dependantvar="sText_"+x.id
                }
              }
              }
              });
              datetimevar = datetimevar.slice(0, -1);
              this.signatureitems += `{
            "sid": "`+ this.layers[i].signature_name + `_` + i + `",
            "id": "`+ this.layers[i].signature_id + `",
            "name": "`+ this.layers[i].signature_name + `",
            "pageid": "`+ this.currPage + `",
            "dependantid": "`+dependantvar+`",
            "dateTimeIds": "`+datetimevar+`"
          },`;
            }
          }
          this.signatureitems = this.signatureitems.slice(0, -1);
          //this.myHtml = '<signatures productid="' + this.naviDate.designid + '">' + this.signatureitems + '</signatures>';
//          console.log(this.arrPageCanvas);
          const canvasdata = JSON.parse(this.arrPageCanvas[0].historyNextState);
          // console.log(canvasdata.objects.length);
          // console.log(this.savedsignjson);
          if (this.savedsignjson == "") {
            this.myHtml = `{
            "signatures": {
              "_productid": "`+ this.naviDate.designid + `",
              "signature": [`+ this.signatureitems + `]}}`;
          } else {
            if (canvasdata.objects.length == 0) {
              this.myHtml = "";
              var signdata = { "id": this.naviDate.designid, "mode": this.naviDate.tablename, "data": this.myHtml };
              this.userService.submit_signjsonurls(signdata).subscribe(data => {
                if (data == 'success') {
                  //  this.toast.success('Successfully Saved', '', { progressBar: true });
                }
              });
            } else {
              if (this.signatureitems != '') {
                var sdata=JSON.parse(this.signatureitems);
                this.savedsignjson.push(sdata);
              }
              this.savedsignjson = JSON.stringify(this.savedsignjson);
              this.myHtml = `{
                "signatures": {
                  "_productid": "`+ this.naviDate.designid + `",
                  "signature": `+ this.savedsignjson + `}}`;
            }
          }
          if (this.myHtml != "") {
            this.viewsignaturejson = JSON.parse(this.myHtml);
          } else { this.viewsignaturejson = ""; }
        }
      }
 
    });
  }
  viewsignaturexml(signaturexml) {
    this.generatesignaturejson();
    if (!this.editable) { return }
    this.modalRef = this.modalService.show(signaturexml, { class: 'modal-md', backdrop: 'static' });
  }
  getdataxml() {
    const id = this.naviDate.designid;
    const mode = this.naviDate.tablename;
    this.savedrulexml = '';
    let dataXml_Json={"id":id,"mode":mode}
    this.userService.getdataxml(dataXml_Json).subscribe(data => {
      this.fileContent=data.data_xml;
      // console.log(data);
    });
  }
  getrulejson() {
    const id = this.naviDate.designid;
    const mode = this.naviDate.tablename;
    this.savedrulexml = '';
    let designRule_JsonObj={"id":id,"mode":mode}
    this.userService.get_rulejson(designRule_JsonObj).subscribe(data => {
      //    console.log(data.rulejson);
      if (data.rulejson) {
        data = JSON.parse(data.rulejson);
        this.savedrulexml = data.solvedge.rule.page;
        this.viewjson = this.savedrulexml;
      }
      if (this.seletecdPg > 0) {
        this.createnondatadictionaryjson();
        this.createdatadictionaryjson();
        // console.log(this.nondatadictionaryjson);
        if (this.datadictionaryjson == undefined) {
          this.datadictionaryjson= '';
        }
        if (this.savedrulexml=='') {
          this.myHtml1 = `{"solvedge":{"rule":{"page": [{ "id": "` + this.currPage + `", 
          "datadictionary" : {
            `+ this.datadictionaryjson + `
          },
          "nondatadictionary": { "nongroup" : [{
            "element" : [
          `+ this.nondatadictionaryjson + `
            ]
          }]
          } }]}}}`;
          this.viewjson = JSON.parse(this.myHtml1);
        }
        else {
          if (this.savedrulexml && this.savedrulexml[this.seletecdPg - 1].id == this.currPage) {
            let cval = `{"solvedge":{"rule":{"page": [{ "id": "` + this.currPage + `", 
          "datadictionary" : {
            `+ this.datadictionaryjson + `
          },
          "nondatadictionary": { "nongroup" : [{
            "element" : [
          `+ this.nondatadictionaryjson + `
            ]
          }]
          } }]}}}`;
            this.myHtml1 = cval;
          } else {
            this.pages = `{ "id": "` + this.currPage + `", 
        "datadictionary" : {
          `+ this.datadictionaryjson + `
        },
        "nondatadictionary": { "nongroup" : [{
          "element" : [
        `+ this.nondatadictionaryjson + `
          ]
        }]
        } }`;
            // console.log(this.savedrulexml);
            if (this.pages != '') {
              this.savedrulexml = []
              this.savedrulexml.push(JSON.parse(this.pages));
            }
            this.savedrulexml = JSON.stringify(this.savedrulexml);
            this.myHtml1 = `{"solvedge":{"rule":{"page":` + this.savedrulexml + `}}}`;
            // console.log(this.myHtml1)
          }
          this.viewjson = JSON.parse(this.myHtml1);
        }
      }
    })
 
  }
  viewdataxml(dataxml) {
    this.getdataxml();
    if (!this.editable) { return }
    this.modalRef = this.modalService.show(dataxml, { class: 'modal-md', backdrop: 'static' });
  }
  viewrulexml(rulexml) {
    this.getrulejson();
    if (!this.editable) { return }
    this.modalRef = this.modalService.show(rulexml, { class: 'modal-md', backdrop: 'static' });
  }
  createnondatadictionaryjson() {
    if (this.seletecdPg > 0) {
      var canvas = this.arrPageCanvas[this.seletecdPg - 1];
      if (canvas.getObjects()) {
        this.layers = canvas.getObjects();
        this.rulexmlslabel = "";
        this.rulexmlstextvariable = "";
        this.rulexmlrect = "";
        this.rulexmlcircle = ""; this.rulexmlslabelvariable = "";
        this.rulexmllines = ""; this.rulexmlimage = "";
        this.nondatadictionaryjson = "";
        this.rulebarcode = "";
        this.rulexmlflowpara = "";
        this.rulexmlvar = "";
        for (var i = 0; i < this.layers.length; i++) {
          if ((this.layers[i].text && this.layers[i].objtype == 'stext' && this.layers[i].text.slice(0, 1) != '<') || (this.layers[i].text && this.layers[i].objtype == 'slabel' && this.layers[i].text.slice(0, 1) != '<')) {
            this.rulexmlslabel += `{
        "name": "`+ this.layers[i].text + `",
        "type": "`+ this.layers[i].objtype + `",
        "length" : "",
                "overflow" : "",
                "sampledata" : "",
                "isConstant" : "true"
      },`;
          }
          if (this.layers[i].text && this.layers[i].text.slice(0, 1) == '<' && (this.layers[i].objcategory == '' || this.layers[i].objcategory == undefined)) {
            const variabledatatext = this.layers[i].text.replace('<<', '');
            const variabledatatext0 = variabledatatext.replace('>>', '');
            //console.log(variabledatatext0);
            this.rulexmlvar += `{
            "name": "`+ variabledatatext0 + `",
            "type": "`+ this.layers[i].objtype + `",
            "length" : "",
            "overflow" : "",
            "sampledata" : "",
            "isConstant" : "true"
          },`;
          }
          if (this.layers[i].text && this.layers[i].objtype == 'flowpara' && this.layers[i].text.slice(0, 1) != '<') {
            this.rulexmlflowpara += `{
    "name": "`+ this.layers[i].text + `",
    "type": "`+ this.layers[i].objtype + `",
    "length" : "",
    "overflow" : "",
    "sampledata" : "",
    "isConstant" : "true"
  },`;
          }
          if (this.layers[i].objtype == 'rect') {
            this.rulexmlrect += `{
    "name": "`+ this.layers[i].text + `",
    "type": "`+ this.layers[i].objtype + `",
    "length" : "",
    "overflow" : "",
    "sampledata" : "",
    "isConstant" : "true"
  },`;
          }
          if (this.layers[i].objtype == 'circle' || this.layers[i].objtype == 'ellipse') {
            this.rulexmlcircle += `{
    "name": "`+ this.layers[i].text + `",
    "type": "`+ this.layers[i].objtype + `",
    "length" : "",
    "overflow" : "",
    "sampledata" : "",
    "isConstant" : "true"
  },`;
          }
          if (this.layers[i].objtype == 'hline' || this.layers[i].objtype == 'vline') {
            this.rulexmllines += `{
    "name": "`+ this.layers[i].text + `",
    "type": "`+ this.layers[i].objtype + `",
    "length" : "",
    "overflow" : "",
    "sampledata" : "",
    "isConstant" : "true"
  },`;
          }
          if (this.layers[i].objtype == 'imgvar') {
            var imgv='';
            if(this.layers[i].imgvarvalue.slice(0, 1) == '<'){
              const imgvarval =this.layers[i].imgvarvalue.replace('<<', '');
              imgv = imgvarval.replace('>>', '');
            }else{imgv=this.layers[i].imgvarvalue;}
            this.rulexmlimage += `{
    "name": "`+ imgv + `",
    "type": "`+ this.layers[i].objtype + `",
    "length" : "",
                "overflow" : "",
                "sampledata" : "",
                "isConstant" : "true"
  },`;
          }
          if (this.layers[i].objtype == 'barcode') {
            var bl='';
            if(this.layers[i].barcode_val.slice(0, 1) == '<'){
              const barcode_v =this.layers[i].barcode_val.replace('<<', '');
              bl = barcode_v.replace('>>', '');
            }else{bl=this.layers[i].barcode_val;}
            this.rulebarcode += `{
    "name": "`+ bl + `",
    "type": "`+ this.layers[i].objtype + `",
    "length" : "",
                "overflow" : "",
                "sampledata" : "",
                "isConstant" : "true"
  },`;
          }
          this.nondatadictionaryjson = this.rulexmlvar + this.rulebarcode + this.rulexmlimage;
        }
        this.nondatadictionaryjson = this.nondatadictionaryjson.slice(0, -1);
      }
    }
  }
  rightsidecomments0(){
    this.showrightsidecomments0=!this.showrightsidecomments0;
  }
  btnAddfreeflowSignClick(e) {
    this.selectedsignature_name='';
this.selectedsignature_id='';
//    if (!this.editable) { return }
   /* this.modalRef = this.modalService.show(signaturepopups, { class: 'modal-md', backdrop: false, keyboard: true,
    animated: true,
    ignoreBackdropClick: false});*/
    this.signature_first_popup=true;
    var innPgCanvas = this.arrPageCanvas[this.seletecdPg - 1];
   // var img = new Image();
    const src = 'assets/images/designtool/sign/signature.png';
    fabric.Image.fromURL(src, (image) => {
      image.set({
        left: e.layerX,
        top: e.layerY,
      opacity: 1,
      angle: 0,
      objtype: 'signature',
      relatedobj:'',
      dependantvariable:'',
      datetimevariable:'',
      handletype: 'freeflowsignature',
      cacheKey: 'sign area',
      width: image.width,
      height: image.height,
      tmp_width: image.width,
      tmp_height: image.height,
      signature_name: '',
      signature_id: '',
      id: this.randomId()
    }).scale(0.9);
    image.setControlsVisibility({
      bl: true,
      br: true,
      tl: true,
      tr: true,
      mt: true,
      mb: true,
      mtr: false,
      mr: true,
      ml: true
    });
    this.extendimgsignature0(image, image.id,  image.handletype,image.objtype, image.cacheKey, image.signature_name, image.signature_id, image.relatedobj, image.dependantvariable, image.datetimevariable, image.tmp_width, image.tmp_height);
    innPgCanvas.add(image);
    innPgCanvas.setActiveObject(image).renderAll();
    this.renderLayers();
  });
    this.signaturepopup = true;
    this.signaturepopuptwo = false;
    this.emptycontrols();
    this.gettimefun()
  }
  btnAddacccSignClick(e) {
    this.selectedsignature_name='';
this.selectedsignature_id='';
    if (!this.editable) { return }
    //this.modalRef = this.modalService.show(signaturepopups, { class: 'modal-md', backdrop: 'static' });
    this.signature_first_popup=true;
    var innPgCanvas = this.arrPageCanvas[this.seletecdPg - 1];
    const src = 'assets/images/designtool/sign/accc_signature.png';
    fabric.Image.fromURL(src, (image) => {
      image.set({
        left: e.layerX,
      top: e.layerY,
      opacity: 1,
      objtype: 'signature',
      relatedobj:'',
      angle: 0,
      dependantvariable:'',
      datetimevariable:'',
      handletype: 'acccsignature',
      cacheKey: 'sign area',
      width: image.width,
      height: image.height,
      tmp_width: image.width,
      tmp_height: image.height,
      signature_name: '',
      signature_id: '',
      id: this.randomId()
    }).scale(0.9);
    image.setControlsVisibility({
      bl: true,
      br: true,
      tl: true,
      tr: true,
      mt: false,
      mb: false,
      mtr: false,
      mr: false,
      ml: false
    });
    //this.extendimgsignature(image, this.randomId(),  image.handletype,image.objtype, image.cacheKey, image.signature_name, image.signature_id);
    this.extendimgsignature0(image, image.id,  image.handletype,image.objtype, image.cacheKey, image.signature_name, image.signature_id, image.relatedobj,image.dependantvariable,image.datetimevariable,image.tmp_width,image.tmp_height);
    innPgCanvas.add(image);
    innPgCanvas.setActiveObject(image).renderAll();
    this.renderLayers();
  });
    this.signaturepopup = true;
    this.signaturepopuptwo = false;
    this.emptycontrols();
    this.gettimefun()
  }
  gettimefun(){
    setTimeout(() => {
      if (this.seletecdPg > 0) {
        var innPgCanvas = this.arrPageCanvas[this.seletecdPg - 1];
        innPgCanvas.renderAll();
      }
    }, 100);
  }
  btnAddaccinitSignClick(signaturepopups) {
    this.selectedsignature_name='';
this.selectedsignature_id='';
    if (!this.editable) { return }
    this.signature_first_popup=true;
    //    this.modalRef = this.modalService.show(signaturepopups, { class: 'modal-md', backdrop: 'static' });
    var innPgCanvas = this.arrPageCanvas[this.seletecdPg - 1];
    const src = 'assets/images/designtool/sign/initials.png';
    fabric.Image.fromURL(src, (image) => {
      image.set({
      left: 100,
      top: 132,
      opacity: 1,
      angle: 0,
      objtype: 'signature',
      relatedobj:'',
      dependantvariable:'',
      datetimevariable:'',
      handletype: 'initsignature',
      cacheKey: 'sign area',
      width: image.width,
      height: image.height,
      tmp_width: image.width,
      tmp_height: image.height,
      signature_name: '',
      signature_id: '',
      id: this.randomId()
    }).scale(0.9);
    image.setControlsVisibility({
      bl: true,
      br: true,
      tl: true,
      tr: true,
      mt: false,
      mb: false,
      mtr: false,
      mr: false,
      ml: false
    });
//    this.extendimgsignature(image, this.randomId(), image.handletype,image.objtype, image.cacheKey, image.signature_name, image.signature_id);
this.extendimgsignature0(image, image.id,  image.handletype,image.objtype, image.cacheKey, image.signature_name, image.signature_id, image.relatedobj,image.dependantvariable,image.datetimevariable, image.tmp_width,image.tmp_height);
innPgCanvas.add(image);
    innPgCanvas.setActiveObject(image).renderAll();
    this.renderLayers();
  });
    this.signaturepopup = true;
    this.signaturepopuptwo = false;
    this.emptycontrols();
    this.gettimefun()
  }
  btnAddImgPolaroidClick(event: any) {
    let el = event.target;
    var innPgCanvas = this.arrPageCanvas[this.seletecdPg - 1];
    fabric.loadSVGFromURL(el.src, function (objects, options) {
      var obj = fabric.util.groupSVGElements(objects, options);
      innPgCanvas.add(obj).renderAll();
    });
    // this.extend(text, this.randomId());
  }
  getdependantvar(e){
    this.selectedObj.set('dependantvariable', e);
    this.extendimgsignature0(this.selectedObj, this.selectedObj.id, this.selectedObj.handletype,this.selectedObj.objtype, this.selectedObj.cacheKey, this.selectedObj.signature_name, this.selectedObj.signature_id, this.selectedObj.relatedobj, this.selectedObj.dependantvariable,this.selectedObj.datetimevariable,this.selectedObj.tmp_width,this.selectedObj.tmp_height);
    var innPgCanvas = this.arrPageCanvas[this.seletecdPg - 1];
    this.selectItemAfterAdded(this.layer3[0]);
    this.emptycontrols();
    innPgCanvas.setActiveObject(this.selectedObj).renderAll();
    this.renderLayers();
  }
  /// Button Click events  
  btnThumbImgClick(event) {
    this.selectedItem = "empty";
    this.showpagecontextmenu=false;
    let selId = event.target.id;//imagepage5 + 5
    let pageId = selId.replace('imagepage', '');
    if (this.currPage == pageId) {
      return;
    }
    var resJSONdata: any = [];
    var resSVGdata: any;
    var curTmplate = this.arrTemplateList[this.currPage - 1];//match page with object
var obj={};
var images = $('#imagepage1').attr('src');
    if (this.updateValue && this.editable) {
      if (confirm('Do you want save the pages?')) {
        if (this.fbPageCanvas) {
          resJSONdata.push(this.fbPageCanvas);
         const page={
            "width":this.currenttmpwidth,
            "height":this.currenttmpheight
         }
          resJSONdata.push({"page":page});
          resSVGdata = this.fbPageCanvas.toSVG();
          obj = {
            "designproductid": this.naviDate.designid,//this.naviDate.designid,
            "templateid": curTmplate.templateid,
            "templatejson": JSON.stringify(resJSONdata),
            "templatexml": resSVGdata,
            "templatesvg":resSVGdata,
            "templatehtml": "",
            "css": "",
            "image":images,
            "margin_right":this.mcright,
            "margin_bottom":this.mcbottom,
            "margin_setting":this.mcsetting
          }
          // console.log("json transfer", obj)//singlePageSaveTemplate
          this.userService.singlePageSaveTemplate(obj).subscribe(data => {
            // console.log(data)
            this.toast.success('Successfully Saved', '', { progressBar: true });
            this.currPage = pageId;
            this.loadTemplateJson(this.currPage);
          })
          if (this.viewjson) {
            var pagedata = { "id": this.naviDate.designid, "mode": this.naviDate.tablename, "data": this.myHtml1 ? this.myHtml1 : this.viewjson };
            this.userService.submit_rulejsonurl(pagedata).subscribe(data => {
 
            });
          }
          if (this.viewsignaturejson) {
            var signdata = { "id": this.naviDate.designid, "mode": this.naviDate.tablename, "data": this.myHtml ? this.myHtml : this.viewsignaturejson };
            this.userService.submit_signjsonurls(signdata).subscribe(data => {
 
            });
          }
        }
      } else {
        this.currPage = pageId;
       
        if (this.fbPageCanvas) {
          resJSONdata.push(this.fbPageCanvas);
          const page={
            "width":this.currenttmpwidth,
            "height":this.currenttmpheight
          }
          resJSONdata.push({"page":page});
          resSVGdata = this.fbPageCanvas.toSVG();
          obj = {
            "designproductid": this.naviDate.designid,//this.naviDate.designid,
            "templateid": curTmplate.templateid,
            "templatejson": JSON.stringify(resJSONdata),
            "templatexml": resSVGdata,
            "templatesvg":resSVGdata,
            "templatehtml": "",
            "css": "",
            "image":images,
            "margin_right":this.mcright,
            "margin_bottom":this.mcbottom,
            "margin_setting":this.mcsetting
          }
          this.userService.singlePageSaveTemplate(obj).subscribe(data => {
            this.loadTemplateJson(this.currPage);
          });
        }
      }
    } else {
      this.currPage = pageId;
    
       if (this.fbPageCanvas) {
       resJSONdata.push(this.fbPageCanvas);
         const page={
          "width":this.currenttmpwidth,
           "height":this.currenttmpheight
        }
         resJSONdata.push({"page":page});
         resSVGdata = this.fbPageCanvas.toSVG();
         obj = {
         "designproductid": this.naviDate.designid,//this.naviDate.designid,
          "templateid": curTmplate.templateid,
           "templatejson": JSON.stringify(resJSONdata),
           "templatexml": resSVGdata,
          "templatesvg":resSVGdata,
          "templatehtml": "",
          "css": "",
          "image":images,
          "margin_right":this.mcright,
           "margin_bottom":this.mcbottom,
          "margin_setting":this.mcsetting
         }
      this.userService.singlePageSaveTemplate(obj).subscribe(data => {
        this.loadTemplateJson(this.currPage);
        });
      }
    }
 //   console.log("else part called");
    this.currPage = pageId;
    let pNum: number = 1;
    var thumbElement: any;
    for (var inItem in this.arrTemplateList) {
      thumbElement = document.getElementById('imagepage' + pNum.toString()) as unknown as HTMLImageElement;
      thumbElement.style.border = "0";
            pNum++;
    }
      thumbElement = document.getElementById(event.target.id) as unknown as HTMLImageElement;
    thumbElement.style.border = "2px solid rgb(88, 103, 221)";
  }
  buttonshow: boolean;
  btnMenuClose(e) {
    this.buttonshow = false;
    var sender = e.target as HTMLButtonElement;
    var menuPanel = document.getElementById("dvControls");
    if(menuPanel && menuPanel.style!=null){
    if (menuPanel.style.display === "none") {
      sender.innerText = "<";
      menuPanel.style.display = "none";
    } else {
      sender.innerText = ">";
      menuPanel.style.display = "none";
    }
  }
  }
 
  btnPageClose(e) {
    var menuPgThumb = document.getElementById("dvPagesThumb");
    if (menuPgThumb.style.display === "none") {
      menuPgThumb.style.display = "flex";
    } else {
      menuPgThumb.style.display = "none";
    }
  }
  toolkitdiv:boolean;
  imagediv:boolean;
  dictionarydiv:boolean
  datadiv:boolean
  btnmenuclickshow(content){
if(content=='textdiv'){
  this.textdiv = !this.textdiv;
}
else if(content=='shapesdiv'){
  this.shapesdiv = !this.shapesdiv;
}
else if(content=='signaturediv'){
this.signaturediv = !this.signaturediv;
}
else if(content=='pagediv'){
  this.pagediv = !this.pagediv;
}else if(content=='toolkitdiv'){
  this.toolkitdiv = !this.toolkitdiv;
}else if(content=='imagediv'){
  this.imagediv = !this.imagediv;
}else if(content=='dictionarydiv'){
  this.dictionarydiv = !this.dictionarydiv;
}else if(content=='datadiv'){
  this.datadiv = !this.datadiv;
}
else{
  this.textdiv=false;  
  this.shapesdiv=false;  
  this.signaturediv=false;  
}
  }
 
 
  btnMenuClick() {
    if (!this.editable) { return }
    this.buttonshow = true;
    this.selectedItem = 'empty'
    var menuPanel = document.getElementById("dvControls");
    if (menuPanel.style.display === "none") {
      menuPanel.style.display = "flex";
 
    }
  }
  btnZoomInClick() {
   for (var index in this.arrPageCanvas) {
      var innPgCanvas = this.arrPageCanvas[index];
//      console.log(this.zoomMax);
      if (innPgCanvas.getZoom().toFixed(5) > this.zoomMax) {
        break;
      }
      innPgCanvas.setZoom(innPgCanvas.getZoom() * this.SCALE_FACTOR);
      innPgCanvas.setHeight(innPgCanvas.getHeight() * this.SCALE_FACTOR);
      innPgCanvas.setWidth(innPgCanvas.getWidth() * this.SCALE_FACTOR);
      innPgCanvas.renderAll();
    }
  }
  btnzoom(){
  //  console.log("Sdsd");  
    for (var index in this.arrPageCanvas) {
      var innPgCanvas = this.arrPageCanvas[index];
      if (innPgCanvas.getZoom().toFixed(5) <= 1) {
        break;
      }
      innPgCanvas.setZoom(innPgCanvas.getZoom() / this.SCALE_FACTOR);
      innPgCanvas.setHeight(innPgCanvas.getHeight() / this.SCALE_FACTOR);
      innPgCanvas.setWidth(innPgCanvas.getWidth() / this.SCALE_FACTOR);
      innPgCanvas.renderAll();
    }
  } 

  btnZoomResetClick() {
    for (var index in this.arrPageCanvas) {
      var innPgCanvas = this.arrPageCanvas[index];
      innPgCanvas.setHeight(innPgCanvas.getHeight() / innPgCanvas.getZoom());
      innPgCanvas.setWidth(innPgCanvas.getWidth() / innPgCanvas.getZoom());
      innPgCanvas.setZoom(1);
      innPgCanvas.renderAll();
    }
  }
 
  btnPagebgFillPlate() {
    if (this.seletecdPg > 0) {
      var innPgCanvas = this.arrPageCanvas[this.seletecdPg - 1];
      innPgCanvas.backgroundColor = this.selectedProperty.pageFill;
      innPgCanvas.renderAll();
      var imgThum = document.getElementById('imagepage' + innPgCanvas.getElement().id) as unknown as HTMLImageElement;
      imgThum.setAttribute('crossOrigin', 'anonymous');
      // var imgThum = document.getElementById("tstImage") as HTMLImageElement;
      var dataURL = innPgCanvas.toDataURL({
        format: 'jpeg',
        quality: 0.8
      })
      // console.log('base641',dataURL);
      imgThum.src = dataURL;
    }
  }
 
 
  btnPagebgFill(color) {
    // change canvas color
    if (this.seletecdPg > 0) {
      var innPgCanvas = this.arrPageCanvas[this.seletecdPg - 1];
      if (color == '1a') {
        innPgCanvas.backgroundColor = '#3f9bcc';
      }
      if (color == '2a') {
        innPgCanvas.backgroundColor = '#0ba72f';
      }
      if (color == '3a') {
        innPgCanvas.backgroundColor = '#f00';
      }
      if (color == '4a') {
        innPgCanvas.backgroundColor = '#010101';
      }
      if (color == '5a') {
        innPgCanvas.backgroundColor = '#ffd53c';
      }
      if (color == '6a') {
        innPgCanvas.backgroundColor = '#630da5';
      }
      //second row
      if (color == '1b') {
        innPgCanvas.backgroundColor = '#f1a1a1';
      }
      if (color == '2b') {
        innPgCanvas.backgroundColor = '#d6b0ff';
      }
      if (color == '3b') {
        innPgCanvas.backgroundColor = '#d2e7ef';
      }
      if (color == '4b') {
        innPgCanvas.backgroundColor = '#9be639';
      }
      if (color == '5b') {
        innPgCanvas.backgroundColor = '#ff9f4c';
      }
      if (color == '6b') {
        innPgCanvas.backgroundColor = '#ab6848';
      }
      //third row
      if (color == '1c') {
        innPgCanvas.backgroundColor = '#ffdabb';
      }
      if (color == '2c') {
        innPgCanvas.backgroundColor = '#e869d3';
      }
      if (color == '3c') {
        innPgCanvas.backgroundColor = '#31c5bf';
      }
      if (color == '4c') {
        innPgCanvas.backgroundColor = '#8a0404';
      }
      if (color == '5c') {
        innPgCanvas.backgroundColor = '#171cca';
      }
      if (color == '6c') {
        innPgCanvas.backgroundColor = '#a2a2a2';
      }
      innPgCanvas.renderAll();
      /// remove reference for array
      var imgThum = document.getElementById('imagepage' + innPgCanvas.getElement().id) as unknown as HTMLImageElement;
      imgThum.setAttribute('crossOrigin', 'anonymous');
      // var imgThum = document.getElementById("tstImage") as HTMLImageElement;
      var dataURL = innPgCanvas.toDataURL({
        format: 'jpeg',
        quality: 0.8
      })
      // console.log("base642",dataURL)
      imgThum.src = dataURL;
    }
  }
  btnBrouchcreateForm(data) {
    // console.log("datassssss", data)
    let s_json = data[0].templatejson
    for (var inse in s_json) {
      console.log("json", s_json[inse])
      this.btnAddPageClick();
      var innPgCanvas = this.arrPageCanvas[inse];
      innPgCanvas.loadFromJSON(s_json[inse], innPgCanvas.renderAll.bind(innPgCanvas), function (o, object) {
        fabric.log(o, object);
      });
    }
    this.renderLayers();
    //this.checkvariable();
    // if (this.seletecdPg > 0) {
    // var innPgCanvas = this.arrPageCanvas[this.seletecdPg - 1];
 
    // innPgCanvas.loadFromJSON(s_json, innPgCanvas.renderAll.bind(innPgCanvas), function (o, object) {
    //   fabric.log(o, object);
    // });
    // }
  }
  btnBrouch1Click() {
    if (this.seletecdPg > 0) {
      var innPgCanvas = this.arrPageCanvas[this.seletecdPg - 1];
      let s_json = [{ "version": "2.5.0", "objects": [], "background": "rgba(255,255,255,1)" }]
      innPgCanvas.loadFromJSON(s_json[0], innPgCanvas.renderAll.bind(innPgCanvas), function (o, object) {
        fabric.log(o, object);
      });
      this.renderLayers();
      //this.checkvariable();
      this.updateValue = true
    }
  }
  btnBrouch2Click() {
    if (this.seletecdPg > 0) {
      var innPgCanvas = this.arrPageCanvas[this.seletecdPg - 1];
      innPgCanvas.loadFromJSON(this.sjson1[0], innPgCanvas.renderAll.bind(innPgCanvas), function (o, object) {
        fabric.log(o, object);
      });
      this.renderLayers();
    //  this.checkvariable();
      this.updateValue = true
    }
  }
  btnBrouch3Click() {
    if (this.seletecdPg > 0) {
      var innPgCanvas = this.arrPageCanvas[this.seletecdPg - 1];
      innPgCanvas.loadFromJSON(this.sjson2[0], innPgCanvas.renderAll.bind(innPgCanvas), function (o, object) {
        fabric.log(o, object);
      });
      this.renderLayers();
     // this.checkvariable();
      this.updateValue = true
    }
  }
  btnConfirmPageDel() {
    if (!this.editable) { return }
    if (this.arrTemplateList.length > 1) {
      if (confirm('Are you want to delete this page ! if you delete this page it cannot retrieved')) {
        this.btnPageDel();
      }
    } else {
      alert("Can not delet single page.");
    }
  }
 
 
  btnPageDel() {
    /////SIngle page layout changes
    var curTmplate = this.arrTemplateList[this.currPage - 1];//match page with object
    this.userService.singlePageDelete(this.naviDate.designid, this.currPage, curTmplate.templateid).subscribe(data => {
      // console.log("datepag", data)
      this.toast.success('Successfully deleted', '', { progressBar: true });
      // this.arrTemplateList
 
      // this.arrTemplateList.splice(this.currPage - 1, 1);
      this.arrTemplateList = data.sort((n1, n2) => {
        if (n1.sequenceno > n2.sequenceno) { return 1; }
        if (n1.sequenceno < n2.sequenceno) { return -1; }
        return 0;
      });
      /// remove thumbnail icon and change page number
      var dvPageThum = document.getElementById('thumpage' + this.currPage);
      dvPageThum.remove();
      ///2 del 2 - 4
      for (var ival: number = this.currPage; ival <= this.arrTemplateList.length; ival++) {
        var parPage = document.getElementById('parapage' + (Number(ival) + 1));
        parPage.innerText = ival.toString();
        parPage.id = 'parapage' + ival;
        /// canvas, div, image, parapage
        var dvInPgThum = document.getElementById('thumpage' + (Number(ival) + 1));
        dvInPgThum.setAttribute('id', 'thumpage' + ival.toString());
 
        var img = document.getElementById('imagepage' + (Number(ival) + 1));
        img.setAttribute('id', 'imagepage' + ival.toString())
 
        // var canFb = document.getElementById('page' + (Number(ival) + 1));
        // canFb.setAttribute('id', 'page' + ival.toString())
      }
    }, error => {
      alert("Failed to delete page, Please try again later...")
    });
  }
  btnUndoClick() {
    this.savestateaction = false;
    var canvas = this.tempobj;
      var index = canvas.index;
      var state = canvas.state;
      if (index > 0) {
          index -= 1;
          this.removeObjects();
         canvas.loadFromJSON(state[index], () => {
              canvas.renderAll();
              this.savestateaction = true;
              canvas.index = index;
              //this.loadCurvedText();
              //this.renderVideo(state[index]);
          });
      } else {
          this.savestateaction = true;
      }
  }
 
  saveState() {
    var canvas = this.arrPageCanvas[this.seletecdPg - 1];
    if (this.savestateaction && canvas.state) {
        var newstate = [];
        var state = canvas.state;
        var index = canvas.index;
        for (var i = 0; i <= index; i++) {
            newstate.push(state[i]);
        }
        state = newstate;
        var myjson = JSON.stringify(canvas);
        state[++index] = myjson;
        if (state.length >= 80) state = state.splice(-5, 5);
       canvas.state = state;
        canvas.index = index;
    }
}
  btnRedoClick() {
    var canvas = this.tempobj;
    var index = canvas.index;
    var state =canvas.state;
    this.savestateaction = false;
    if (index < state.length - 1) {
        this.removeObjects();
        canvas.loadFromJSON(state[index + 1], () => {
            canvas.renderAll();
            this.savestateaction = true;
            index += 1;
           canvas.index = index;
          //  this.loadCurvedText();
            //this.renderVideo(state[index]);
        });
    } else {
        this.savestateaction = true;
    }  }
    removeObjects() {
      var canvas = this.tempobj;
      var objects = canvas.getObjects().filter(function(o) {
     o.excludeFromExport = false
          return o.excludeFromExport;
        });
      for (var i = 0; i < objects.length; i++) {
          canvas.remove(objects[i]);
      }
      canvas.renderAll();
  }
  btnSelObjDel() {
    if (!this.editable) { return }
    if (this.seletecdPg > 0) {
      var innPgCanvas = this.arrPageCanvas[this.seletecdPg - 1];
      // innPgCanvas.remove(innPgCanvas.getActiveObject());
      /// for multiple selection
 
 
      if (innPgCanvas.getActiveObject().objtype) {
        if (innPgCanvas.getActiveObjects().objtype == 'table') {
          // console.log("table del ref")
         // this.tblInputData.delete(arrSel.id);
        }
      }
 
      var arrSel = innPgCanvas.getActiveObjects();
      for (var index in arrSel) {
        innPgCanvas.remove(arrSel[index]);
      }
      innPgCanvas._discardActiveObject();
    }
    this.showcontextmenu = false;
    this.renderLayers();
    this.saveState();
  }
 
  btnSendBackClick() {
    if (!this.editable) { return }
    if (this.seletecdPg > 0) {
      var innPgCanvas = this.arrPageCanvas[this.seletecdPg - 1];
      // var selObject = innPgCanvas.getActiveObject();
      // innPgCanvas.sendToBack(selObject);    
 
      /// for multiple selection
      var arrSel = innPgCanvas.getActiveObjects();
      for (var index in arrSel) {
        innPgCanvas.sendToBack(arrSel[index]);
      }
      innPgCanvas._discardActiveObject();
      innPgCanvas.renderAll();
    }
    this.saveState();
  }
 
  btnBringFrontClick() {
    if (!this.editable) { return }
    if (this.seletecdPg > 0) {
      var innPgCanvas = this.arrPageCanvas[this.seletecdPg - 1];
      // var selObject = innPgCanvas.getActiveObject();
      // innPgCanvas.bringToFront(selObject);    
 
      /// for multiple selection
      var arrSel = innPgCanvas.getActiveObjects();
      for (var index in arrSel) {
        innPgCanvas.bringToFront(arrSel[index]);
      }
      innPgCanvas._discardActiveObject();
      innPgCanvas.renderAll();
    }
    this.saveState();
  }
 
  btnSendBackwardClick() {
    if (!this.editable) { return }
    if (this.seletecdPg > 0) {
      var innPgCanvas = this.arrPageCanvas[this.seletecdPg - 1];
      // var selObject = innPgCanvas.getActiveObject();
      // innPgCanvas.sendBackwards(selObject);    
 
      /// for multiple selection
      var arrSel = innPgCanvas.getActiveObjects();
      for (var index in arrSel) {
        innPgCanvas.sendBackwards(arrSel[index]);
      }
      innPgCanvas._discardActiveObject();
      innPgCanvas.renderAll();
    }
    this.saveState();
  }
 
  btnBringForwardClick() {
    if (this.seletecdPg > 0) {
      var innPgCanvas = this.arrPageCanvas[this.seletecdPg - 1];
      // var selObject = innPgCanvas.getActiveObject();
      // innPgCanvas.bringForward(selObject);    
 
      /// for multiple selection
      var arrSel = innPgCanvas.getActiveObjects();
      for (var index in arrSel) {
        innPgCanvas.bringForward(arrSel[index]);
      }
      innPgCanvas._discardActiveObject();
      innPgCanvas.renderAll();
    }
    this.saveState();
  }
  btnCloneClick() {
    if (!this.editable) { return }
    if (this.seletecdPg > 0) {
      var innPgCanvas = this.arrPageCanvas[this.seletecdPg - 1];
      var arrSel = innPgCanvas.getActiveObjects();

      for (var index in arrSel) {
        if(!innPgCanvas.getActiveObject().isEditing){
        var object = fabric.util.object.clone(arrSel[index]);
        object.set("top", object.top + 20);
        innPgCanvas.add(object);
        innPgCanvas.setActiveObject(object);
        if(object.type == 'text')
        innPgCanvas.getActiveObject().isEditing = true
        this.renderLayers();
        }else{
          alert('Please select an item..')
        }
      }
      //innPgCanvas._discardActiveObject();
      
    }
    this.showcontextmenu = false;
    this.saveState();
  }
 
 
  btnGroupClick() {
    if (!this.editable) { return }
    if (this.seletecdPg > 0) {
      var innPgCanvas = this.arrPageCanvas[this.seletecdPg - 1];
      if (!innPgCanvas.getActiveObject()) {
        return;
      }
      if (innPgCanvas.getActiveObject().type !== 'activeSelection') {
        return;
      }
      innPgCanvas.getActiveObject().toGroup();
      innPgCanvas.requestRenderAll();
    }
  }
 
  btnUnGroupClick() {
    if (!this.editable) { return }
    if (this.seletecdPg > 0) {
      var innPgCanvas = this.arrPageCanvas[this.seletecdPg - 1];
      if (!innPgCanvas.getActiveObject()) {
        return;
      }
      if (innPgCanvas.getActiveObject().type !== 'group') {
        return;
      }
      innPgCanvas.getActiveObject().toActiveSelection();
      innPgCanvas.requestRenderAll();
    }
    this.saveState();
  }
 
  btnTestClick() {
    if (!this.editable) { return }
    this.selectedItem = "activeSelection:Rect";
    this.updateValue = true
    let ival: number = 0;
    for (var index in this.arrPageCanvas) {
      ival++;
      if (ival == 3) {
        var innPgCanvas = this.arrPageCanvas[index];
        innPgCanvas.remove(innPgCanvas.getActiveObject());
        break;
      }
    }
  }
 
  // btnPreviewClick() {
  //   if (this.seletecdPg > 0) {
  //     let w = window.open('')
  //     var svgD;
  //     for (var index in this.arrPageCanvas) {
  //       var innPgCanvas = this.arrPageCanvas[index];      
  //       w.document.write(innPgCanvas.toSVG())
  //       svgD = svgD + innPgCanvas.toSVG();
  //     }      
  //     return 'data:image/svg+xml;utf8,' + encodeURIComponent(svgD)
  //   }
  // }
  btnToggleRuler() {
    if (!this.editable) { return }
    if (!this.pgRuler) {
      this.pgRuler = new ruler({
        container: document.querySelector('.canvas-container'),//dvPagesList reference to DOM element to apply rulers on
        rulerHeight: 15, // thickness of ruler
        fontFamily: 'arial',// font for points
        fontSize: '7px',
        strokeStyle: 'grey',
        lineWidth: 1,
       enableMouseTracking: true,
        enableToolTip: true
      });
      this.chRuler = false;
    }
    if (!this.chRuler && this.pgRuler) {
      this.pgRuler.api.toggleRulerVisibility(true);
      this.pgRuler.api.toggleGuideVisibility(true);
      this.chRuler = true;
      
    } else {
      this.pgRuler.api.toggleRulerVisibility(false);
      this.pgRuler.api.toggleGuideVisibility(false);
      this.chRuler = false;
    }
    this.saveState();
  }
 
  chGrid: boolean;
  gridGroup: any;
  btnToggleGrid() {
 
    var canvas = this.tempobj;
    if (!this.chGrid && canvas) {
      var gridsize = 1;
      var gridoption = {
        stroke: "#ebebeb",
        strokeWidth: 1,
        selectable: false,
        evented: false,
        hasControls:false,
        lockMovementX:false,
        lockMovementY:false
      };
      var gridLines = [];
      for (var xval = 1; xval < (canvas.height); xval += 10) {
        gridLines.push(new fabric.Line([xval, 0, xval, canvas.height], gridoption));
      }
      for (var x = 1; x < (canvas.height); x += 10) {
        gridLines.push(new fabric.Line([0, x, canvas.height, x], gridoption));
      }
      this.gridGroup = new fabric.Group(gridLines, {
        selectable: false,
        evented: false,
        hasControls:false,
        lockMovementX:false,
        lockMovementY:false
      })
      this.gridGroup.addWithUpdate();
      canvas.add(this.gridGroup);
      var innPgCanvas = this.arrPageCanvas[this.seletecdPg - 1];
      canvas.sendToBack(this.gridGroup);
      innPgCanvas.sendToBack(this.gridGroup);
      this.chGrid = true;
    } else {
      this.gridGroup && canvas.remove(this.gridGroup);
      this.chGrid = false;
    }
    this.saveState();
  }
 
 
  fontSize;
  fontFamily;
  FontSize;
  FontFamily;
 
  setElementStyle(element, style, fntFamily, fntSize) {
    //console.log("ele", element.style);
    //console.log("sty", style);
    element.style.fontFamily = fntFamily;
    element.style.fontSize = fntSize;
    element.style.color = style.fill;
    if(style.textalign){
      element.style.textAlign = style.textalign;
    }else{
      element.style.textAlign = style.align;
    }    
    if (style.bold) {
      element.style.fontWeight = "bold";
    } else {
      element.style.fontWeight = "normal";
    }
    if (style.italic) {
      element.style.fontStyle = "italic";
    } else {
      element.style.fontStyle = "normal";
    }
    if (style.underline) {
      element.style.textDecoration = "underline";
    } else {
      element.style.textDecoration = "none";
    }
  }
 
  createStyleProp(style, fntFamily, fntSize) {
    //console.log("sty1", style);
    let colStyle = {
      fontfamily: fntFamily,
      fontsize: fntSize,
      fill: style.fill,
      bold: style.bold,
      italic: style.italic,
      underline: style.underline,
      align: style.align,
      background: "#ffffff"
    }
    return colStyle;
  }
 
  changeJStoStyle(styleProp){
    return "font-family:" + styleProp.fontFamily + ";font-size:" + styleProp.fontSize + 
    ";fill:" + styleProp.fill + ";font-weight:" + styleProp.bold + ";font-style:" + styleProp.italic + 
    ";text-decoration:" + styleProp.underline + ";text-anchor:middle;"
  }
  updatecurwidth(value, val){
   var datFld1: any;
   var myTab: any;
   var arrColl: any;
   var mpColDt: any;
   var colDt: string[] = [];
   var isDynData: any;
   var tblHead: any;
   var tablewidth=0;
   var tblTh: any;
   var tblHRow: any;
   var textNsv: any;
   var txtNodeSv: any;
   var textN: any;
   var txtNode: any;
   var rowBody: any;
   var rowBodySvg: any;
   var tblBodySvg: any;
   var tblBody: any;
   var myTabSvg: any;
    this.colStylePro.align = value.colFontAlign;
    this.hdrStylePro.align = value.hdrFontAlign;
    if (this.columnName != "0") {//Update old column
      var selObjj = this.tempobj.getActiveObject();
      var tblJson;
      if(selObjj.dynamicjson != ""){
        tblJson = selObjj.dynamicjson;
      }else if(selObjj.staticjson != ""){
        tblJson = selObjj.staticjson;
      }else{
        return;
        // console.log("Object json error!!!");
      } 

      let parser = new DOMParser();
      let parsedHtml = parser.parseFromString(tblJson.svgData, 'text/html');//this.tblInputData.get(selObjj.id)
      myTab = parsedHtml.getElementById('viewTable') as HTMLTableElement;
 
      arrColl = tblJson.columns.column;
      mpColDt = tblJson.tableData;
      var selCl = arrColl[Number(this.columnName) - 1];
var hasDtFld = false;
      isDynData = tblJson.dynamicData;
      if (selCl.dataField != value.addDataField) {/// check data field changed             
        for(let item in mpColDt){
          if(item == value.addDataField){
            if(isDynData){
              if(!mpColDt[item][0].startsWith("<<")){
                mpColDt[item][0] = "<<" + mpColDt[item][0];
              }
              if(!mpColDt[item][0].endsWith(">>")){
                mpColDt[item][0] = mpColDt[item][0] + ">>";
              }
            }
            colDt = mpColDt[value.addDataField];
            hasDtFld = true;
            break;
          }
        }
        
      } else {
        // colData = colDynData.get(value.addDataField);
        colDt = mpColDt[this.addDataField];
        hasDtFld = true;
      }      
      // console.log("Coldat", colDt);

      selCl.label = value.addColumnname;
      selCl.dataField = value.addDataField;
      datFld1 = value.addDataField;
      if(tblJson.isDriverTable){
        datFld1 = value.addexcludedDataField;
      }
      // console.log(selCl);
      selCl.dataField1 = datFld1;
      selCl.textAlign = this.colStylePro.align;
      selCl.headerTextAlign = this.hdrStylePro.align;
      selCl.styles = this.changeJStoStyle(this.colStylePro);
      selCl.headerStyles = this.changeJStoStyle(this.hdrStylePro);
      selCl.prefix = value.addDataprefix;
      selCl.suffix = value.addDataSuffix;
      selCl.width = value.columnwidth;
 
      // let parsedHtmlSvg = parser.parseFromString(this.tblInputData.get(selObjj.id), 'text/html');
      // var myTabSvg = parsedHtmlSvg.getElementById('viewTable') as HTMLTableElement;
 
      tblHead = myTab.getElementsByTagName('thead')[0];
      // var tblHeadSvg = myTabSvg.getElementsByTagName('thead')[0];
 
      ///add header row column
      let tblHRow = tblHead.rows[0];
      tblHead.rows[0].style.width=value.columnwidth;
      tblHead.rows[0].style.maxWidth=value.columnwidth;
      tblTh = tblHRow.getElementsByTagName('th');
      let colInd = Number(this.columnName) - 1;
      var selTh = tblTh[colInd];
//      console.log("st00",selTh);

      this.setElementStyle(selTh, this.hdrStylePro, value.hdrFontFamily, value.hdrFontSize);
      selTh.innerHTML = value.addColumnname;
      selTh.style.maxWidth=(value.columnwidth-16)+'px';
      selTh.style.width=(value.columnwidth-16)+'px';
//selTh.setAttribute("style", "width:"+value.columnwidth+"px;max-width:"+value.columnwidth+"px;");
// console.log(selTh.style.width);
      let parsedHtmlSvg = parser.parseFromString(parsedHtml.documentElement.innerHTML, 'text/html');  
      myTabSvg = parsedHtmlSvg.getElementById('viewTable') as HTMLTableElement;

      tblBody = myTab.getElementsByTagName('tbody')[0];// as HTMLTableElement;
      tblBodySvg = myTabSvg.getElementsByTagName('tbody')[0];// as HTMLTableElement;
      for (var i = 0; i < tblBody.rows.length; i++) {
        rowBody = tblBody.rows[i];
        ///update prefix suffix values
        txtNode = rowBody.getElementsByTagName("td");
        for (var coli = 0; coli < txtNode.length; coli++) {
          let colPre = arrColl[coli];
          textN = txtNode[coli];
          if (coli == colInd) {
            this.setElementStyle(textN, this.colStylePro, value.colFontFamily, value.colFontSize);
            rowBodySvg = tblBodySvg.rows[i];
            txtNodeSv = rowBodySvg.getElementsByTagName("td");
            textNsv = txtNodeSv[coli];
            this.setElementStyle(textNsv, this.colStylePro, value.colFontFamily, value.colFontSize);
            if (hasDtFld) {
              textN.innerText = colPre.prefix + colDt[i] + colPre.suffix;
              textNsv.innerText = colDt[i];
            } else {
              textN.innerText = colPre.prefix + value.addDataField + colPre.suffix;
              textNsv.innerText = value.addDataField;
              colDt.push(value.addDataField);
            }
          } else {
            textN.innerText = colPre.prefix + textN.innerText + colPre.suffix;
          }
        }
      }
      for(var k=0;k<tblJson.columns.column.length;k++){
tablewidth+=parseInt(tblJson.columns.column[k].width);
      }
      var wdi = tablewidth + ((this.columnList.length + 1) + 1);// ((this.columnList.length + 1) * 91);
      var hei = (31 * (tblBody.rows.length + 1)) + (tblBody.rows.length + 1) + 1;// ((tblBody.rows.length + 1) * 37);
      
      var updSvgData = parsedHtml.getElementsByTagName('svg')[0];// as HTMLTableElement;
      var updSvg = parsedHtmlSvg.getElementsByTagName('svg')[0];// as HTMLTableElement;
      // updSvgData.setAttribute("height", hei.toString() + "px");
      updSvgData.setAttribute("width", wdi.toString() + "px");
      // console.log("svg data", updSvgData.outerHTML);
      // console.log("svg data", updSvg.outerHTML);
 
      var img = new Image();
      var svg = new Blob([updSvgData.outerHTML], { type: 'image/svg+xml' });
      window.URL.createObjectURL(svg);
      var b64 = 'data:image/svg+xml;base64,'+window.btoa(updSvgData.outerHTML);
      img.src = b64;
      // img.height = hei;
      // img.width = wdi;
      // console.log("heighsvg", updSvgData.style.height);
      selObjj.setSrc(img.src, () => {//img.src
        selObjj.set({ height: hei, width: wdi });
        this.tempobj.renderAll();
      });
      tblJson.columns.width=tablewidth;
      tblJson.width=wdi;
tblJson.x=this.layer3[0].left;
if(tblJson.hasRowTitle===true){
tblJson.columns.x=parseInt(this.layer3[0].left)+parseInt(tblJson.rowTitleWidth);
}else{
  tblJson.columns.x=this.layer3[0].left;
}
if(tblJson.hasTitle===true){
  tblJson.columns.y=parseInt(this.layer3[0].top)+31;
}
else{
  tblJson.columns.y=this.layer3[0].top;
}
      // this.columnList.push(value.addColumnname);
      if (!hasDtFld) {
        // colDynData.set(value.addDataField, colData);
        mpColDt[value.addDataField] = colDt;
      }
      tblJson.svgData = updSvg.outerHTML;
      // this.tblInputData.set(selObjj.id, updSvg.outerHTML);
      
    }
    
  }
  btnaddColumn(value, val) {    
    // console.log(value);
    this.colStylePro.align = value.colFontAlign;
    this.hdrStylePro.align = value.hdrFontAlign;
    var datFld1:any;
    var tblHRow:any;
    var selObjj = this.tempobj.getActiveObject();
      var tblJson;
      var myTab: any;
   var arrColl: any;
   var mpColDt: any;
   var colDt: string[] = [];
   var isDynData: any;
   var tblHead: any;
   var tablewidth=0;
   var tblTh: any;
   var textNsv: any;
   var txtNodeSv: any;
   var textN: any;
   var txtNode: any;
   var rowBody: any;
   var rowBodySvg: any;
   var tblBodySvg: any;
   var tblBody: any;
   var myTabSvg: any;
    if (this.columnName == "0") {//Create New column
      if(selObjj.dynamicjson != ""){
        tblJson = selObjj.dynamicjson;
      }else if(selObjj.staticjson != ""){
        tblJson = selObjj.staticjson;
      }else{
        return;
        console.log("Object json error!!!");
      }  

      let parser = new DOMParser();//this.tblInputData.get(selObjj.id)
      let parsedHtml = parser.parseFromString(tblJson.svgData, 'text/html');
      // let parsedHtmlSvg = parser.parseFromString(this.tblInputData.get(selObjj.id), 'text/html');
      let arrColl = tblJson.columns.column;
      let mpColDt = tblJson.tableData;
      // var colData: string[] = [];
      let colDt: string[] = [];
      var hasDtField = false;
 
      let vBorder = tblJson.columns.showVerticalDivider;// arrTbloth.showVborder;
      let hBorder = tblJson.columns.showHorizontalDivider;//arrTbloth.showHborder;
      let isDynData = tblJson.dynamicData;
      for(let item in mpColDt){
        if(item == value.addDataField){
          hasDtField = true;
          if(isDynData){
            if(!mpColDt[item][0].startsWith("<<")){
              mpColDt[item][0] = "<<" + mpColDt[item][0];
            }
            if(!mpColDt[item][0].endsWith(">>")){
              mpColDt[item][0] = mpColDt[item][0] + ">>";
            }
          }
          break;
        }
      }
     
 myTab = parsedHtml.getElementById('viewTable') as HTMLTableElement;
      // var myTabSvg = parsedHtmlSvg.getElementById('viewTable') as HTMLTableElement;
 
      tblHead = myTab.getElementsByTagName('thead')[0];
      // var tblHeadSvg = myTabSvg.getElementsByTagName('thead')[0];
      ///add header row column
      tblHRow = tblHead.rows[0];
      var colwidth=value.columnwidth-16;
      // console.log(colwidth);
      let th = parsedHtml.createElement("th");//background-color: #dddddd;
      th.setAttribute("style", "border: 1px solid #000;padding: 8px;line-height:15px;width:"+colwidth+"px;max-width:"+colwidth+"px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;");
      this.setElementStyle(th, this.hdrStylePro, value.hdrFontFamily, value.hdrFontSize);
 
      let text = parsedHtml.createTextNode(value.addColumnname);
      th.appendChild(text);
      tblHRow.appendChild(th);
 
      if(tblJson.rowHeaderBg){//} arrTbloth.rowHeaderBg){
        th.style.backgroundColor = tblJson.rowHeaderFill;
        // thSv.style.backgroundColor = arrTbloth.rowHeaderFill;
      }else{
        th.style.backgroundColor = "transparent";
        // thSv.style.backgroundColor = "transparent";
      }
 
    //  let colCnt = tblHRow.children.length;
      ///add body row column
      tblBody = myTab.getElementsByTagName('tbody')[0];// as HTMLTableElement;
  
      let parsedHtmlSvg = parser.parseFromString(parsedHtml.documentElement.innerHTML, 'text/html');  
      myTabSvg = parsedHtmlSvg.getElementById('viewTable') as HTMLTableElement;
      tblBodySvg = myTabSvg.getElementsByTagName('tbody')[0];// as HTMLTableElement;
      
      for (var i = 0; i < tblBody.rows.length; i++) {
      rowBody = tblBody.rows[i];
      rowBodySvg = tblBodySvg.rows[i];
        ///update prefix suffix values
      txtNode = rowBody.getElementsByTagName("td");
        for (var coli = 0; coli < txtNode.length; coli++) {
          let colPre = arrColl[coli];
          textN = txtNode[coli];
          var deText = textN.innerText;
          if (colPre.datafield == value.addDataField) {            
            if (i == 0 && isDynData) {              
              if (!deText.startsWith("<<")) {
                deText = "<<" + deText;
              }
              if (!deText.endsWith(">>")) {
                deText = deText + ">>";
              }
            txtNodeSv = rowBodySvg.getElementsByTagName("td");
            textNsv = txtNodeSv[coli];
              textNsv.innerText = deText;
            }
          }
          textN.innerText = colPre.prefix + deText + colPre.suffix;          
        }
        ///create new column
        let tbltd = parsedHtml.createElement("td");//border: 1px solid #000;
        tbltd.setAttribute("style", "padding: 8px;line-height:15px;width:"+colwidth+"px;max-width:"+colwidth+"px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;");
        this.setElementStyle(tbltd, this.colStylePro, value.colFontFamily, value.colFontSize);
        this.setBorder(tbltd,vBorder,hBorder);
        let text;
        let textCo;
        if (hasDtField) {///check datafield already exists
          text = parsedHtml.createTextNode(value.addDataprefix + mpColDt[value.addDataField][i] + value.addDataSuffix);//colData[i]//"col"
          textCo = parsedHtmlSvg.createTextNode(mpColDt[value.addDataField][i]);//colData[i]
        } else {
          var defText = value.addDataField;
          if (i == 0 && isDynData) {
            if (!defText.startsWith("<<")) {
              defText = "<<" + defText;
            }
            if (!defText.endsWith(">>")) {
              defText = defText + ">>";
            }
          }
          text = parsedHtml.createTextNode(value.addDataprefix + defText + value.addDataSuffix);//"col"
          // colData.push(defText);//create datafield  + colCnt
          colDt.push(defText);
          textCo = parsedHtmlSvg.createTextNode(defText);// + colCnt
        }
        ///create new column
        let tbltdCo = parsedHtmlSvg.createElement("td");//border: 1px solid #000;
        tbltdCo.setAttribute("style", "padding: 8px;line-height:15px;width:"+colwidth+"px;max-width:"+colwidth+"px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;");
        this.setElementStyle(tbltdCo, this.colStylePro, value.colFontFamily, value.colFontSize);
        this.setBorder(tbltdCo,vBorder,hBorder);
        //append
        tbltd.appendChild(text);
        rowBody.appendChild(tbltd);
 
        tbltdCo.appendChild(textCo);
        rowBodySvg.appendChild(tbltdCo);
      }
      let columProp = {
        // colid: this.columnList.length,
        "width": ""+value.columnwidth+"",
        "label": value.addColumnname,
        "dataField": value.addDataField,
        "dataField1": datFld1,
        "textAlign": this.colStylePro.align,
        "headerTextAlign": this.hdrStylePro.align,
        "styles": this.changeJStoStyle(this.colStylePro),
        "headerStyles": this.changeJStoStyle(this.hdrStylePro),
        "prefix": value.addDataprefix,
        "suffix": value.addDataSuffix
       
      }
      arrColl.push(columProp);
//      console.log("collist",tblJson.columns.column);

for (var tbli = 0; tbli < tblHead.rows.length; tbli++) {
  tblHRow = tblHead.rows[tbli];
  let tblTh = tblHRow.getElementsByTagName('th');
  for (var coli0 = 0; coli0 < tblTh.length; coli0++) {
     var header= tblTh[coli0]
     header.style.maxWidth=(tblJson.columns.column[coli0].width)+'px';
     header.style.width=(tblJson.columns.column[coli0].width)+'px';
  }
}

let tablewidth=0;
      for(var k=0;k<tblJson.columns.column.length;k++){
      tablewidth+=parseInt(tblJson.columns.column[k].width);
      }
      // console.log('tblw',tablewidth);
      let wdi = tablewidth + ((this.columnList.length + 1) + 1);// ((this.columnList.length + 1) * 91);
      let hei = (31 * (tblBody.rows.length + 1)) + (tblBody.rows.length + 1) + 1;// ((tblBody.rows.length + 1) * 37);
 
      let titRowDiv = parsedHtml.getElementById("divRowTitle");
      if (titRowDiv) {
        wdi = wdi + parseInt(tblJson.rowTitleWidth) + 4 + 1;//4 - > include left right padding 1 -> include left border px
      }
      let titDiv = parsedHtml.getElementById("divTitle");//Update Title div
      if (titDiv) {
        let actWdi = wdi - 6 - 6 - 2;
        titDiv.style.width = actWdi + "px";
        // titDiv.setAttribute("style","width:" + actWdi + "px;");
        let titDivSv = parsedHtmlSvg.getElementById("divTitle");
        // titDivSv.setAttribute("style","width:" + actWdi + "px;");
        titDivSv.style.width = actWdi + "px";
        hei = hei + 15 + 12 + 1;//Include Title height
      }
 
 
      var updSvgData = parsedHtml.getElementsByTagName('svg')[0];// as HTMLTableElement;
      var updSvg = parsedHtmlSvg.getElementsByTagName('svg')[0];// as HTMLTableElement;
      // updSvgData.setAttribute("height", hei.toString() + "px");
      updSvgData.setAttribute("width", wdi.toString() + "px");
      updSvg.setAttribute("width", wdi.toString() + "px");
      // console.log("svg data", updSvgData.outerHTML);
      // console.log("svg data", updSvg.outerHTML);
 
      let img = new Image();
      let svg = new Blob([updSvgData.outerHTML], { type: 'image/svg+xml' });
      window.URL.createObjectURL(svg);
      let b64 = 'data:image/svg+xml;base64,'+window.btoa(updSvgData.outerHTML);
      img.src = b64;
      img.height = hei;
      img.width = wdi;
 
      selObjj.setSrc(img.src, () => {//img.src
        selObjj.set({ height: hei, width: wdi });
        this.tempobj.renderAll();
      });
      // this.tblInputData.set(selObjj.id, updSvg.outerHTML);
      this.columnList.push(value.addColumnname); 
      tblJson.svgData = updSvg.outerHTML;
      if(tblJson.isDriverTable){
        datFld1 = value.addexcludedDataField;
      }else{
        datFld1 = value.addDataField;
      }
// console.log(tblJson.columns);
//  console.log(datFld1);
tblJson.columns.width=tablewidth;
tblJson.width=wdi;
tblJson.x=this.layer3[0].left;
if(tblJson.hasRowTitle===true){
tblJson.columns.x=parseInt(this.layer3[0].left)+parseInt(tblJson.rowTitleWidth);
}else{
  tblJson.columns.x=this.layer3[0].left;
}
if(tblJson.hasTitle===true){
  tblJson.columns.y=parseInt(this.layer3[0].top)+31;
}
else{
  tblJson.columns.y=this.layer3[0].top;
}
      if (!hasDtField) {///append if data field not 
        //mpColData.set(value.addDataField, colData);        
        mpColDt[value.addDataField] = colDt;// = ["<<col" + i + ">>"];
      }
      
    } else {//Update old column
      if(selObjj.dynamicjson != ""){
        tblJson = selObjj.dynamicjson;
      }else if(selObjj.staticjson != ""){
        tblJson = selObjj.staticjson;
      }else{
        return;
        console.log("Object json error!!!");
      } 

      let parser = new DOMParser();
      let parsedHtml = parser.parseFromString(tblJson.svgData, 'text/html');//this.tblInputData.get(selObjj.id)
      myTab = parsedHtml.getElementById('viewTable') as HTMLTableElement;
 
      arrColl = tblJson.columns.column;
      mpColDt = tblJson.tableData;
      var selCl = arrColl[Number(this.columnName) - 1];

    let hasDtFld = false;
      isDynData = tblJson.dynamicData;
      if (selCl.dataField != value.addDataField) {/// check data field changed             
        for(let item in mpColDt){
          if(item == value.addDataField){
            if(isDynData){
              if(!mpColDt[item][0].startsWith("<<")){
                mpColDt[item][0] = "<<" + mpColDt[item][0];
              }
              if(!mpColDt[item][0].endsWith(">>")){
                mpColDt[item][0] = mpColDt[item][0] + ">>";
              }
            }
            colDt = mpColDt[value.addDataField];
            hasDtFld = true;
            break;
          }
        }
        
      } else {
        // colData = colDynData.get(value.addDataField);
        colDt = mpColDt[this.addDataField];
        hasDtFld = true;
      }      
      // console.log("Coldat", colDt);

      selCl.label = value.addColumnname;
      selCl.dataField = value.addDataField;
      datFld1 = value.addDataField;
      if(tblJson.isDriverTable){
        datFld1 = value.addexcludedDataField;
      }
      // console.log(selCl);
      selCl.dataField1 = datFld1;
      selCl.textAlign = this.colStylePro.align;
      selCl.headerTextAlign = this.hdrStylePro.align;
      selCl.styles = this.changeJStoStyle(this.colStylePro);
      selCl.headerStyles = this.changeJStoStyle(this.hdrStylePro);
      selCl.prefix = value.addDataprefix;
      selCl.suffix = value.addDataSuffix;
      selCl.width = value.columnwidth;
 
      // let parsedHtmlSvg = parser.parseFromString(this.tblInputData.get(selObjj.id), 'text/html');
      // var myTabSvg = parsedHtmlSvg.getElementById('viewTable') as HTMLTableElement;
 
      tblHead = myTab.getElementsByTagName('thead')[0];
      // var tblHeadSvg = myTabSvg.getElementsByTagName('thead')[0];
 
      ///add header row column
      tblHRow = tblHead.rows[0];
//      tblHead.rows[0].style.width=value.columnwidth;
  //    tblHead.rows[0].style.maxWidth=value.columnwidth;
      tblTh = tblHRow.getElementsByTagName('th');
      let colInd = Number(this.columnName) - 1;
      var selTh = tblTh[colInd];
//      console.log("st00",selTh);

      this.setElementStyle(selTh, this.hdrStylePro, value.hdrFontFamily, value.hdrFontSize);
      selTh.innerHTML = value.addColumnname;
      selTh.style.maxWidth=(value.columnwidth - 8)+'px';
      selTh.style.width=(value.columnwidth - 8)+'px';
     // selTh.setAttribute("style", "width:"+value.columnwidth+"px;max-width:"+value.columnwidth+"px;");

      let parsedHtmlSvg = parser.parseFromString(parsedHtml.documentElement.innerHTML, 'text/html');  
      myTabSvg = parsedHtmlSvg.getElementById('viewTable') as HTMLTableElement;

      tblBody = myTab.getElementsByTagName('tbody')[0];// as HTMLTableElement;
      tblBodySvg = myTabSvg.getElementsByTagName('tbody')[0];// as HTMLTableElement;
      for (let i = 0; i < tblBody.rows.length; i++) {
      rowBody = tblBody.rows[i];
        ///update prefix suffix values
      txtNode = rowBody.getElementsByTagName("td");
        for (var colii = 0; colii < txtNode.length; colii++) {
          let colPre = arrColl[colii];
          textN = txtNode[colii];
          if (colii == colInd) {
            this.setElementStyle(textN, this.colStylePro, value.colFontFamily, value.colFontSize);
            textN.style.maxWidth=(value.columnwidth- 8)+'px';
            textN.style.width=(value.columnwidth - 8)+'px';
            rowBodySvg = tblBodySvg.rows[i];
            txtNodeSv = rowBodySvg.getElementsByTagName("td");
            textNsv = txtNodeSv[colii];
            this.setElementStyle(textNsv, this.colStylePro, value.colFontFamily, value.colFontSize);
            textNsv.style.maxWidth=(value.columnwidth - 8)+'px';
            textNsv.style.width=(value.columnwidth - 8)+'px';
            if (hasDtFld) {
              textN.innerText = colPre.prefix + colDt[i] + colPre.suffix;
              textNsv.innerText = colDt[i];
            } else {
              textN.innerText = colPre.prefix + value.addDataField + colPre.suffix;
              textNsv.innerText = value.addDataField;
              colDt.push(value.addDataField);
            }
          } else {
            textN.innerText = colPre.prefix + textN.innerText + colPre.suffix;
          }          
        }
      }
      for (var f = 0; f < tblHead.rows.length; f++) {
        tblHRow = tblHead.rows[f];
        tblTh = tblHRow.getElementsByTagName('th');
        for (let coli = 0; coli < tblTh.length; coli++) {
           let header= tblTh[coli]
           header.style.maxWidth=(tblJson.columns.column[coli].width)+'px';
           header.style.width=(tblJson.columns.column[coli].width)+'px';
        }
     }
      for(let k=0;k<tblJson.columns.column.length;k++){
       tablewidth+=parseInt(tblJson.columns.column[k].width);
      }
      // console.log("tblwidth",tablewidth);
      let wdi = tablewidth + ((this.columnList.length) + 1);// ((this.columnList.length + 1) * 91);
      let hei = (31 * (tblBody.rows.length + 1)) + (tblBody.rows.length + 1) + 1;// ((tblBody.rows.length + 1) * 37);

      let titRowDiv = parsedHtml.getElementById("divRowTitle");
      if (titRowDiv) {
        wdi = wdi + parseInt(tblJson.rowTitleWidth) + 4 + 1;//4 - > include left right padding 1 -> include left border px
      }

      let titDiv = parsedHtml.getElementById("divTitle");//Update Title div
      if (titDiv) {
        let actWdi = wdi - 6 - 6 - 2;
        titDiv.style.width = actWdi + "px";
        // titDiv.setAttribute("style","width:" + actWdi + "px;");
        let titDivSv = parsedHtmlSvg.getElementById("divTitle");
        // titDivSv.setAttribute("style","width:" + actWdi + "px;");
        titDivSv.style.width = actWdi + "px";
        hei = hei + 15 + 12 + 1;//Include Title height
      } 

      let updSvgData = parsedHtml.getElementsByTagName('svg')[0];// as HTMLTableElement;
      let updSvg = parsedHtmlSvg.getElementsByTagName('svg')[0];// as HTMLTableElement;
      // updSvgData.setAttribute("height", hei.toString() + "px");
       updSvgData.setAttribute("width", wdi.toString() + "px");
       updSvg.setAttribute("width", wdi.toString() + "px");
      // console.log("svg data", updSvgData.outerHTML);
      // console.log("svg data", updSvg.outerHTML);
 
      let img = new Image();
      let svg = new Blob([updSvgData.outerHTML], { type: 'image/svg+xml' });
      window.URL.createObjectURL(svg);
      let b64 = 'data:image/svg+xml;base64,'+window.btoa(updSvgData.outerHTML);
      img.src = b64;
      img.height = hei;
      img.width = wdi;
      // console.log("heighsvg", updSvgData.style.height);
      selObjj.setSrc(img.src, () => {//img.src
         selObjj.set({ height: hei, width: wdi });
        this.tempobj.renderAll();
      });
      tblJson.svgData = updSvg.outerHTML;
      tblJson.columns.width=tablewidth;
      tblJson.width=wdi;
      tblJson.x=this.layer3[0].left;
      if(tblJson.hasRowTitle===true){
      tblJson.columns.x=parseInt(this.layer3[0].left)+parseInt(tblJson.rowTitleWidth);
      }else{
        tblJson.columns.x=this.layer3[0].left;
      }
if(tblJson.hasTitle===true){
  tblJson.columns.y=parseInt(this.layer3[0].top)+31;
}
else{
  tblJson.columns.y=this.layer3[0].top;
}
      // this.columnList.push(value.addColumnname);
      if (!hasDtFld) {
        // colDynData.set(value.addDataField, colData);
        mpColDt[value.addDataField] = colDt;
      }
      tblJson.svgData = updSvg.outerHTML;
      // this.tblInputData.set(selObjj.id, updSvg.outerHTML);
      
    }
    this.modalRef.hide()
  }
 
 
  showsubmenu(menutype){
    if(menutype=='file'){
     this.menufile=!this.menufile;
     this.menuedit=false;
     this.menuview=false;
    }
    if(menutype=='edit'){
      this.menuedit=!this.menuedit;  
      this.menufile=false;
      this.menuview=false; 
    }
    if(menutype=='view'){
      this.menuview=!this.menuview;  
      this.menufile=false;
      this.menuedit=false;     
    }
  }
  
  btnDelColumn() {
    // console.log("del column value")
    if (this.columnName == "0") {//Create New column
      // console.log("invalid selection");
    } else {//Update old column
      var selObjj = this.tempobj.getActiveObject();
var tblHRow: any;
      var tblJson;
      if(selObjj.dynamicjson != ""){
        tblJson = selObjj.dynamicjson;
      }else if(selObjj.staticjson != ""){
        tblJson = selObjj.staticjson;
      }else{
        return;
        console.log("Object json error!!!");
      } 
      let parser = new DOMParser();// this.tblInputData.get(selObjj.id)
      let parsedHtml = parser.parseFromString(tblJson.svgData, 'text/html');
      var myTab = parsedHtml.getElementById('viewTable') as HTMLTableElement;
      ///Column property
      // let arrtbl = this.tblProperty.get(selObjj.id);
      // var arrCol = arrtbl[1];
      var arrColl = tblJson.columns.column;
            
      let parsedHtmlSvg = parser.parseFromString(tblJson.svgData, 'text/html');
      var myTabSvg = parsedHtmlSvg.getElementById('viewTable') as HTMLTableElement;
 
      var tblHead = myTab.getElementsByTagName('thead')[0];
      var tblHeadSvg = myTabSvg.getElementsByTagName('thead')[0];
      ///del header row column     
    tblHRow = tblHead.rows[0];
      let colInd = Number(this.columnName) - 1;
      tblHRow.deleteCell(colInd);
 
      tblHeadSvg.rows[0].deleteCell(colInd);     
 
      ///del body row column
      var tblBody = myTab.getElementsByTagName('tbody')[0];// as HTMLTableElement;
      var tblBodySvg = myTabSvg.getElementsByTagName('tbody')[0];// as HTMLTableElement;
      for (var i = 0; i < tblBody.rows.length; i++) {
        var rowBody = tblBody.rows[i];
        ///update prefix suffix values
        var txtNode = rowBody.getElementsByTagName("td");
        for (var coli = 0; coli < txtNode.length; coli++) {
          let colPre = arrColl[coli];
          var textN = txtNode[coli];
          textN.innerText = colPre.prefix + textN.innerText + colPre.suffix;
        }
        rowBody.deleteCell(colInd);
        tblBodySvg.rows[i].deleteCell(colInd);
      }
      
 //update column width...
 for (let i = 0; i < tblHead.rows.length; i++) {
  tblHRow = tblHead.rows[i];
  var tblTh = tblHRow.getElementsByTagName('th');
  for (let coli = 0; coli < tblTh.length; coli++) {
     var header= tblTh[coli]
     header.style.maxWidth=(tblJson.columns.column[coli].width)+'px';
     header.style.width=(tblJson.columns.column[coli].width)+'px';
  }
}
var tablewidth=0;
for (let i = 0; i < tblBody.rows.length; i++) {
 let rowBody = tblBody.rows[i];
 let txtNode = rowBody.getElementsByTagName("td");
 for (let coli = 0; coli < txtNode.length; coli++) {
   let textN = txtNode[coli];
   textN.style.maxWidth=(tblJson.columns.column[coli].width)+'px';
   textN.style.width=(tblJson.columns.column[coli].width)+'px';
 }
}

for(let k=0;k<tblJson.columns.column.length;k++){
  tablewidth+=parseInt(tblJson.columns.column[k].width);
  if(k==colInd){
  var deletedColumnWidth=parseInt(tblJson.columns.column[k].width)
  console.log("Deleted width value",parseInt(tblJson.columns.column[k].width));
 }
}

tablewidth=tablewidth-deletedColumnWidth;
  // console.log("table width",tablewidth)
    var wdi = tablewidth + (tblJson.columns.column.length); 
   var hei = (31 * (tblBody.rows.length + 1)) + (tblBody.rows.length + 1) + 1;// ((tblBody.rows.length + 1) * 37);
 
      let titRowDiv = parsedHtml.getElementById("divRowTitle");
      if (titRowDiv) {
        wdi = wdi + parseInt(tblJson.rowTitleWidth) + 4 + 1;//Include row title width
        
      }
      let titDiv = parsedHtml.getElementById("divTitle");//Update Title div
      if (titDiv) {
        let actWdi = wdi - 6 - 6 - 2;
        titDiv.style.width = actWdi + "px";
        let titDivSv = parsedHtmlSvg.getElementById("divTitle");
        titDivSv.style.width = actWdi + "px";
        hei = hei + 15 + 12 + 1;//Include Title height
      }
 
 
      var updSvgData = parsedHtml.getElementsByTagName('svg')[0];// as HTMLTableElement;
      var updSvg = parsedHtmlSvg.getElementsByTagName('svg')[0];// as HTMLTableElement;
      // updSvgData.setAttribute("height", hei.toString() + "px");
      updSvgData.setAttribute("width", wdi.toString() + "px");
      updSvg.setAttribute("width", wdi.toString() + "px");
      // console.log("svg data", updSvgData.outerHTML);
 
      var img = new Image();
      var svg = new Blob([updSvgData.outerHTML], { type: 'image/svg+xml' });
      window.URL.createObjectURL(svg);
      var b64 = 'data:image/svg+xml;base64,'+window.btoa(updSvgData.outerHTML);
      img.src = b64;
      img.height = hei;
      img.width = wdi;
      // console.log("heighsvg", updSvgData.style.height);
      selObjj.setSrc(img.src, () => {//img.src
        selObjj.set({ height: hei, width: wdi });
        this.tempobj.renderAll();
      });
      // this.tblInputData.set(selObjj.id, updSvg.outerHTML);
      // arrCol.splice(colInd, 1);//remove column property.
      tblJson.svgData = updSvg.outerHTML;
      arrColl.splice(colInd, 1);//remove column property.

      this.columnList.splice(Number(this.columnName), 1);
      // console.log(this.tblProperty.get(selObjj.id));
    }
    this.modalRef.hide()
  }
 
  // colFontFamily;
  // colFontSize;
  colStylePro = {
    fill: "#000000",
    bold: false,
    italic: false,
    underline: false,
    align: "left",
    fontFamily:"Arial",
    fontSize:12
  };
  // hdrFontFamily;
  // hdrFontSize;
  hdrStylePro = {
    fill: "#000000",
    bold: false,
    italic: false,
    underline: false,
    align: "left",
    fontFamily:"Arial",
    fontSize:12
  };
 
  clearColumnHeaderStye() {
    this.colStylePro.fontFamily = "Arial";// colFontFamily = "Arial";
    this.colStylePro.fontSize = 12;// colFontSize = 12;
    this.colStylePro.fill = "#000000";
    this.colStylePro.bold = false;
    this.colStylePro.italic = false;
    this.colStylePro.underline = false;
    this.colStylePro.align = "left";
 
    this.hdrStylePro.fontFamily = "Arial";// hdrFontFamily = "Arial";
    this.hdrStylePro.fontSize = 12;// hdrFontSize = 12;
    this.hdrStylePro.fill = "#000000";
    this.hdrStylePro.bold = false;
    this.hdrStylePro.italic = false;
    this.hdrStylePro.underline = false;
    this.hdrStylePro.align = "left";
  }
 
  setColBold(colStyPro) {
    colStyPro.bold = !colStyPro.bold;
  }
 
  setColItalic(colStyPro) {
    colStyPro.italic = !colStyPro.italic;
  }
 
  setColUnderline(colStyPro) {
    colStyPro.underline = !colStyPro.underline;
  }
 
  setHdrBold(hdrStyPro) {
    hdrStyPro.bold = !hdrStyPro.bold;
  }
 
  setHdrItalic(hdrStyPro) {
    hdrStyPro.italic = !hdrStyPro.italic;
  }
 
  setHdrUnderline(hdrStyPro) {
    hdrStyPro.underline = !hdrStyPro.underline;
  }
 
  setColumnFill() {
 
  }
 
  setHeaderFill() {
 
  }
 
  readColumnData() {
    this.columnList = [];
    this.addColumnname = "";
    this.addDataField = "";
    this.addDataSuffix = "";
    this.addDataprefix = "";
    this.addexcludedDataField = "";
    this.clearColumnHeaderStye();
 
    var selObjj = this.tempobj.getActiveObject(); 
    var tblJson;
    if(selObjj.dynamicjson != ""){
      tblJson = selObjj.dynamicjson;
    }else if(selObjj.staticjson != ""){
      tblJson = selObjj.staticjson;
    }else{
      return;
      console.log("Object json error!!!");
    }  
   
    let arrCol = tblJson.columns.column;
    for (var i = 0; i < arrCol.length; i++) {
      this.columnList.push(arrCol[i].label);
    }    
    this.columnName = "0";
    this.isDriverTable = tblJson.isDriverTable;    
  }

  changeStyletojs(styleProp){
    // console.log("stPro",styleProp);
    var retJs={};
    var styleArr = styleProp.split(';');
    for(var i=0; i<styleArr.length; i++){
      let attSty = styleArr[i].split(":");
      retJs[attSty[0]]=attSty[1];
    }
    return retJs;
  }
 
  addColumnname = "";
  addDataField = "";
  addDataprefix = "";
  addDataSuffix = "";
  addexcludedDataField = "";
  isDriverTable =  false;
  colNameChange(e) {
    // console.log(e);
    if(e.target.value!=0){
      this.showcolumnwidth=true;
    }
    // e.targe.selected
    // console.log(this.columnName);
    if (this.columnName == "0") {
      // console.log("0")
      this.addColumnname = "";
      this.addDataField = "";
      this.addDataprefix = "";
      this.addDataSuffix = "";
      this.addexcludedDataField = "";
      this.clearColumnHeaderStye();
    } else {
      // console.log("others")
      var selObjj = this.tempobj.getActiveObject();
      var tblJson;
      if(selObjj.dynamicjson != ""){
        tblJson = selObjj.dynamicjson;
      }else if(selObjj.staticjson != ""){
        tblJson = selObjj.staticjson;
      }else{
        return;
        console.log("Object json error!!!");
      }
      let arrCol = tblJson.columns.column;
      let colDetail = arrCol[Number(this.columnName) - 1];
      // console.log("coddeti", colDetail);
      if (colDetail) {
        this.addColumnname = colDetail.label;
        this.addDataField = colDetail.dataField;
        this.addDataprefix = colDetail.prefix;
        this.addDataSuffix = colDetail.suffix;
        this.columnwidth = colDetail.width;
        this.addexcludedDataField = colDetail.dataField1;//.excldatafield;
        
        let colSty = this.changeStyletojs(colDetail.styles);// colDetail.styles;//.columnstyle;
        // console.log("colVal",colSty);
        this.colStylePro.fontFamily = colSty['font-family'];//colFontFamily = colSty.fontfamily;
        this.colStylePro.fontSize = colSty['font-size'];// colFontSize = colSty.fontsize;
        this.colStylePro.fill = colSty['fill'];
        this.colStylePro.bold = (colSty['font-weight'] === "true");
        this.colStylePro.italic = (colSty['font-style']  === "true");
        this.colStylePro.underline = (colSty['text-decoration']  === "true");
        this.colStylePro.align = colDetail.textAlign;// colSty.align;
 
        let hdrSty = this.changeStyletojs(colDetail.headerStyles);//.headerstyle;
        // console.log("hdr", hdrSty);
        this.hdrStylePro.fontFamily = hdrSty['font-family'];// .hdrFontFamily = hdrSty.fontfamily;
        this.hdrStylePro.fontSize = hdrSty['font-size'];// .hdrFontSize = hdrSty.fontsize;
        this.hdrStylePro.fill = hdrSty['fill'];
        this.hdrStylePro.bold = (hdrSty['font-weight']  === "true");
        this.hdrStylePro.italic = (hdrSty['font-style']  === "true");
        this.hdrStylePro.underline = (hdrSty['text-decoration']  === "true");
        this.hdrStylePro.align = colDetail.headerTextAlign;// hdrSty.align;
      }

     
    }
  }
 
  columnName = "0";
  columnList = [];
  clientList = [];
  clcolumns = [];
 
  readTabledata() {
    // console.log("method called", this.tblInputData);
    var selObjj = this.tempobj.getActiveObject();
    var tblJson;
    if(selObjj.dynamicjson != ""){
      tblJson = selObjj.dynamicjson;
    }else if(selObjj.staticjson != ""){
      tblJson = selObjj.staticjson;
    }else{
      return;
      console.log("Object json error!!!");
    }

   
    let arrColl = tblJson.columns.column;
    var mpColDt = tblJson.tableData;

    this.clientList = [];
    this.clcolumns = [];
 
    var clLength;
    for (let u = 0; u < arrColl.length; u++) {//set up grid header
      let colProp = arrColl[u];
      if (u == 0) {/// get rows max length
        // let colData = colDyData.get(colProp.datafield);
        let colData = mpColDt[colProp.dataField];
        clLength = colData.length;
      }
      let dxProp = {
        dataField: colProp.dataField,
        caption: colProp.label //name //dataType: 'string'        
      }
      this.clcolumns.push(dxProp);
    }
 
    for (var i = 0; i < clLength; i++) {///load client list data
      var rowJs = {};
      var colList = [];
      for (var cl = 0; cl < arrColl.length; cl++) {
        let colProp = arrColl[cl];
        if (!colList.includes(colProp.dataField)) {
          let colData = mpColDt[colProp.dataField];// colDyData.get(colProp.datafield);
          rowJs[colProp.dataField] = colData[i];///perticular row value
          colList.push(colProp.dataField);
        }
      }
      this.clientList.push(rowJs);
    }
    // console.log("client list", this.clientList);
    // console.log("client list", this.clcolumns);
    
  }
 
  addRowTbl() {
    if (this.clientList.length) {
      var selObjj = this.tempobj.getActiveObject();
      var tblJson;
      if(selObjj.dynamicjson != ""){
        tblJson = selObjj.dynamicjson;
      }else if(selObjj.staticjson != ""){
        tblJson = selObjj.staticjson;
      }else{
        return;
        console.log("Object json error!!!");
      }
     
      let arrColl = tblJson.columns.column;
      var rowJs = {};
      
      var colFld = [];
      for (var i = 0; i < arrColl.length; i++) {
        let colTmp = arrColl[i];
        if (!colFld.includes(colTmp.dataField)) {
          rowJs[colTmp.dataField] = colTmp.dataField;
          colFld.push(colTmp.dataField);
        }
      }
      this.clientList.push(rowJs);
    }
  }
 
  delRowTbl() {
 
  }

  setColumnElementStyle(element, styleProp, txtAlign) {
    var colSty={};
    var styleArr = styleProp.split(';');
    for(var i=0; i<styleArr.length; i++){
      let attSty = styleArr[i].split(":");
      colSty[attSty[0]]=attSty[1];
    }

    element.style.fontFamily = colSty['font-family'];
    element.style.fontSize = colSty['font-size'];
    element.style.color = colSty['fill'];
    element.style.textAlign = txtAlign;

    if(colSty['font-weight'] === "true") {
      element.style.fontWeight = "bold";
    } else {
      element.style.fontWeight = "normal";
    }
    if(colSty['font-style']  === "true") {
      element.style.fontStyle = "italic";
    } else {
      element.style.fontStyle = "normal";
    }
    if (colSty['text-decoration']  === "true") {
      element.style.textDecoration = "underline";
    } else {
      element.style.textDecoration = "none";
    }
  }
 
tempobj:any;
updateTblData() {
  var selObjj = this.tempobj.getActiveObject();
  var tblJson;
var tblHRow: any;
  if(selObjj.dynamicjson != ""){
    tblJson = selObjj.dynamicjson;
  }else if(selObjj.staticjson != ""){
    tblJson = selObjj.staticjson;
  }else{
    return;
  }
  let parser = new DOMParser();
  let parsedHtml = parser.parseFromString(tblJson.svgData, 'text/html');
  var myTab = parsedHtml.getElementById('viewTable') as HTMLTableElement;
  
  let arrColl = tblJson.columns.column;
  var mpColDt = tblJson.tableData;
  var rLength = myTab.rows.length;
  for (var i = rLength - 1; i >= 0; i--) {
    myTab.deleteRow(i);
  }
  var tblHead = myTab.getElementsByTagName('thead')[0];// as HTMLTableElement;      
  var rowHead = tblHead.insertRow();
  for (i = 0; i < arrColl.length; i++) {//set up table header
    let colPre = arrColl[i];
    mpColDt[colPre.dataField] = [];//remove old values.....
 
    let th = parsedHtml.createElement("th");//background-color: #dddddd;
    th.setAttribute("style", "border: 1px solid #000;padding: 8px;line-height:15px;width:74px;max-width:74px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;");
    // this.setElementStyle(th, colPre.headerstyle, colPre.headerstyle.fontfamily, colPre.headerstyle.fontsize);
    this.setColumnElementStyle(th,colPre.headerStyles,colPre.headerTextAlign);
    let text = parsedHtml.createTextNode(colPre.label);//name);//item      
    th.appendChild(text);
    rowHead.appendChild(th);
 
    // let thSv = parsedHtmlSvg.createElement("th");//background-color: #dddddd;
    // thSv.setAttribute("style", "border: 1px solid #000;padding: 8px;line-height:15px;width:74px;max-width:74px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;");
    // this.setElementStyle(thSv, colPre.headerstyle, colPre.headerstyle.fontfamily, colPre.headerstyle.fontsize);
    // let textSv = parsedHtmlSvg.createTextNode(colPre.name);//item
    // thSv.appendChild(textSv);
    // rowHeadSvg.appendChild(thSv);
 
    if(tblJson.rowHeaderBg){
      th.style.backgroundColor = tblJson.rowHeaderFill;//arrtblProp
      // thSv.style.backgroundColor = arrtblProp.rowHeaderFill;
    }else{
      th.style.backgroundColor = "transparent";
      // thSv.style.backgroundColor = "transparent";
    }
  }
 
  let vBorder = tblJson.columns.showVerticalDivider;// arrtblProp.showVborder;
  let hBorder = tblJson.columns.showHorizontalDivider;// arrtblProp.showHborder;
  
  let parsedHtmlSvg = parser.parseFromString(parsedHtml.documentElement.innerHTML, 'text/html');  
  var myTabSvg = parsedHtmlSvg.getElementById('viewTable') as HTMLTableElement;

  var tblBody = myTab.getElementsByTagName('tbody')[0];// as HTMLTableElement;
  var tblBodySvg = myTabSvg.getElementsByTagName('tbody')[0];// as HTMLTableElement;
  for (let i = 0; i < this.clientList.length; i++) {
    var rowBody = tblBody.insertRow(i);
    var rowBodySvg = tblBodySvg.insertRow(i);
    var rowItem = this.clientList[i];
    
    var bindColumns = [];
    for (var cl = 0; cl < arrColl.length; cl++) {//(var item in parseRow) {
      let colPre = arrColl[cl];
      if (!bindColumns.includes(colPre.dataField)) {//remove redunant copy of columns....
        // var dataCol = colDynData.get(colPre.datafield);///update column dynamic data....
        var dataCol = mpColDt[colPre.dataField];///Update column dynamic data...
        dataCol.push(rowItem[colPre.dataField]);
        bindColumns.push(colPre.dataField);
      }
      let tbltd = parsedHtml.createElement("td");//border: 1px solid #000;
      tbltd.setAttribute("style", "padding: 8px;line-height:15px;width:74px;max-width:74px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;");
      // this.setElementStyle(tbltd, colPre.columnstyle, colPre.columnstyle.fontfamily, colPre.columnstyle.fontsize);
      this.setColumnElementStyle(tbltd,colPre.styles,colPre.textAlign);
      let text = parsedHtml.createTextNode(colPre.prefix + rowItem[colPre.dataField] + colPre.suffix);
      this.setBorder(tbltd,vBorder,hBorder);
      tbltd.appendChild(text);
      rowBody.appendChild(tbltd);
 
      let tbltdSv = parsedHtmlSvg.createElement("td");//border: 1px solid #000;
      tbltdSv.setAttribute("style", "padding: 8px;line-height:15px;width:74px;max-width:74px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;");
      // this.setElementStyle(tbltdSv, colPre.columnstyle, colPre.columnstyle.fontfamily, colPre.columnstyle.fontsize);
      this.setColumnElementStyle(tbltdSv,colPre.styles,colPre.textAlign);
      let textSv = parsedHtmlSvg.createTextNode(rowItem[colPre.dataField]);
      this.setBorder(tbltdSv,vBorder,hBorder);
      tbltdSv.appendChild(textSv);
      rowBodySvg.appendChild(tbltdSv);
 
    }
  }
 
  if(!vBorder || !hBorder){
    tblBody.style.border = "1px solid rgb(0,0,0)";
    tblBodySvg.style.border = "1px solid rgb(0,0,0)";
  }else{
    tblBody.style.border = "none";
    tblBodySvg.style.border = "none";
  }
 
 
  for(let item in mpColDt){
    var colTmp = mpColDt[item];
    if(this.clientList.length > colTmp.length){
      let colLeng = colTmp.length;
      for (i = colLeng; i < this.clientList.length; i++) {
        colTmp.push("");
      }
    }else if (this.clientList.length < colTmp.length) {
      let colLeng = colTmp.length;
      colTmp.splice(this.clientList.length, colLeng - this.clientList.length);
    }
  }
  var hei = (31 * (this.clientList.length + 1)) + (this.clientList.length + 1) + 1;
  for (let i = 0; i < tblHead.rows.length; i++) {
     tblHRow = tblHead.rows[i];
     var tblTh = tblHRow.getElementsByTagName('th');
     for (var coli = 0; coli < tblTh.length; coli++) {
        var header= tblTh[coli]
        header.style.maxWidth=(tblJson.columns.column[coli].width)+'px';
       header.style.width=(tblJson.columns.column[coli].width)+'px';
     }
  }

  for (let i = 0; i < tblBody.rows.length; i++) {
    let rowBody = tblBody.rows[i];
    let txtNode = rowBody.getElementsByTagName("td");
    for (let coli = 0; coli < txtNode.length; coli++) {
      var textN = txtNode[coli];
      textN.style.maxWidth=(tblJson.columns.column[coli].width)+'px';
      textN.style.width=(tblJson.columns.column[coli].width)+'px';
    }
  }

  var tablewidth=0;
      for(var k=0;k<tblJson.columns.column.length;k++){
      tablewidth+=parseInt(tblJson.columns.column[k].width);
      }
      var wdi = tablewidth + ((tblJson.columns.column.length) + 1); 
  let titRowDiv = parsedHtml.getElementById("divRowTitle");
  if (titRowDiv) {
    let titRowDivSv = parsedHtmlSvg.getElementById("divRowTitle");
    let actHei = hei - 4 - 2;
    titRowDiv.style.height = (actHei) + "px";//-2 -1 -> padding & border for row title
    titRowDivSv.style.height = (actHei) + "px";
    wdi = wdi + parseInt(tblJson.rowTitleWidth) + 4 + 1;//4 - > include left right padding 1 -> include left border px
  }
  let titDiv = parsedHtml.getElementById("divTitle");
  if (titDiv) {
    hei = hei + 15 + 12 + 1;//Include Title height
  }
  var updSvgData = parsedHtml.getElementsByTagName('svg')[0];// as HTMLTableElement;
  updSvgData.setAttribute("height", hei.toString() + "px");
  var updSvg = parsedHtmlSvg.getElementsByTagName('svg')[0];// as HTMLTableElement;
  updSvg.setAttribute("height", hei.toString() + "px");
 
  var img = new Image();
  var svg = new Blob([updSvgData.outerHTML], { type: 'image/svg+xml' });
  window.URL.createObjectURL(svg);
  var b64 = 'data:image/svg+xml;base64,'+window.btoa(updSvgData.outerHTML);
      img.src = b64;
  img.height = hei;
  img.width = wdi;
 
  selObjj.setSrc(img.src, () => {//img.src
    selObjj.set({ height: hei, width: wdi });
    this.tempobj.renderAll();
  });
  // this.tblInputData.set(selObjj.id, updSvg.outerHTML);
  tblJson.svgData = updSvg.outerHTML;
  this.modalRef.hide();
}
 
//Table properties configuration........
btnDynCompSel(){
  this.isDynCompSel = true;
  this.modalRef.hide();
}

btnCloseDynamicId(){
  let self=this;
  this.selection=false;
  this.isDynCompSel = false;
  //this.tableActiveObject.getActiveObject();
  this.tempobj.setActiveObject(this.tableActiveObject);
  this.dynamicFontSizeText=" ";
  self.modalRef = self.modalService.show(self.tempTableProperties, self.config)
}

dynamicFontSizeText;
dynamicFontSizeId;
tableActiveObject;
selection=false;

btnGetDynamicId(){
  if(this.dynamicFontSizeText ===" "){
    this.selection=true; 
     }
  else{
   let self=this;
   this.selection=false;
   this.isDynCompSel = false;
   //self.readTableProp();
   this.tblObjJson.dependantId=this.dynamicFontSizeId;
   this.tempobj.setActiveObject(this.tableActiveObject);
   this.dynamicFontSizeText=" ";
   self.modalRef = self.modalService.show(self.tempTableProperties, self.config)
  }
}

tblObjJson;
isDynCompSel = false;

readTableProp() {
  var selObjj = this.tempobj.getActiveObject();
  this.tableActiveObject=selObjj;
  ///Table property
  this.tblObjJson = [];
  if(selObjj.dynamicjson != ""){
    this.tblObjJson = Object.assign({}, selObjj.dynamicjson);
  }else if(selObjj.staticjson != ""){
    this.tblObjJson = Object.assign({}, selObjj.staticjson);
  }else{
    // console.log("Object json error!!!");
  }
 
}
 
settblTitleBold(titleStyle,condition) {
  if (condition) {
    titleStyle.fontweight = !titleStyle.fontweight;
  }
}
 
settblTitleItalic(titleStyle,condition) {
  if (condition) {
    titleStyle.fontStyle = !titleStyle.fontStyle;
  }
}
 
settblTitleUnderline(titleStyle,condition) {
  if (condition) {
    titleStyle.underline = !titleStyle.underline;
  }
}
 
checkChangeStatus(tblConf, styleProp) {
  var chStatus = false;
  if (tblConf.showTitle != styleProp.showTitle) {
    chStatus = true;
  } else if (tblConf.text != styleProp.text) {
    chStatus = true;
  } else if (tblConf.fontFamily != styleProp.fontFamily) {
    chStatus = true;
  } else if (tblConf.fontSize != styleProp.fontSize) {
    chStatus = true;
  } else if (tblConf.bold != styleProp.bold) {
    chStatus = true;
  } else if (tblConf.italic != styleProp.italic) {
    chStatus = true;
  } else if (tblConf.underline != styleProp.underline) {
    chStatus = true;
  } else if (tblConf.align != styleProp.align) {
    chStatus = true;
  } else if (tblConf.fill != styleProp.fill) {
    chStatus = true;
  }
  return chStatus;
}

setStyleAttr(styProp){
  return {
    "textalign":styProp.textalign,
    "fontweight":styProp.fontweight,
    "fill":styProp.fill,
    "fontFamily":styProp.fontFamily,
    "fontSize":styProp.fontSize,
    "fontStyle":styProp.fontStyle,
    "underline":styProp.underline
  }
}

setBorder(node,isVBorder,isHBorder){
  if(isVBorder){
    node.style.borderLeft = "1px solid rgb(0,0,0)";
    node.style.borderRight = "1px solid rgb(0,0,0)";      
  }else{
    node.style.borderLeft = "1px groove transparent";
    node.style.borderRight = "1px groove transparent";      
  }
  if(isHBorder){
    node.style.borderTop = "1px solid rgb(0,0,0)";
    node.style.borderBottom = "1px solid rgb(0,0,0)";      
  }else{
    node.style.borderTop = "1px groove transparent";
    node.style.borderBottom = "1px groove transparent";      
  }
}
 
setTitleElementStyle(element, style) {
  element.style.fontFamily = style.fontFamily;
  element.style.fontSize = style.fontSize;
  element.style.color = style.fill;
  element.style.textAlign = style.textalign;    
  if (style.fontweight) {
    element.style.fontWeight = "bold";
  } else {
    element.style.fontWeight = "normal";
  }
  if (style.fontStyle) {
    element.style.fontStyle = "italic";
  } else {
    element.style.fontStyle = "normal";
  }
  if (style.underline) {
    element.style.textDecoration = "underline";
  } else {
    element.style.textDecoration = "none";
  }
}
rightsidepanel(){
  if(this.showrightsidepanel){
    this.showrightsidepanel=false;
  }else{
    this.showrightsidepanel=true;
  }
}rightsidepanel0(){
 this.showrightsidepanel0=false;
}
leftsidepanel(){
  if(this.showleftsidepanel===false){
    this.showleftsidepanel=true;
  }else{
    this.showleftsidepanel=false;
  }
}
showdashboardmenu(){
  if(this.dashboardmenu===false){
    this.dashboardmenu=true;
  }else{
    this.dashboardmenu=false;
  }
}
showpdfmenus(){
  this.pdfmenus=!this.pdfmenus;
}
showdropdownmenu(){
  if(this.dropdownmenus===false){
    this.dropdownmenus=true;
  }else{
    this.dropdownmenus=false;
  }
  this.toggleClose();
}
toggleClose() {
  $('.menutoggle').trigger('click');
  this.panelOpen = '';
  this.mstatus0="none";
  $(".structuredocsec .card-body").css('margin-left','auto');
}
Image(istoggle = true) {
  this.closeAllPanels('image-area', istoggle);
  this.canvasmove();
  this.refreshSection('gflibsection');
}
pixabayimg(img) {
  this.hideLeftMenu();
  this.photoORbg = false;
  if (img == "bgimg") {
      this.photoORbg = true;
  }
  this.getPixabayImg();
  $('.nav-link').removeClass('active');
  $("#searchpixabaymodal").modal('show');
}
searchpixabayimg() {
  this.pixabayquery = $("#pixabayimage").val();
  this.pagenumber = 1;
  this.per_page = 30;
  $('#pixabaysection').empty();
  this.getPixabayImg();
}
getPixabayImg() {
  var lthis = this;
  var API_KEY = '12835551-9f6fcaec371f58892c9c19410';
  var URL = "https://pixabay.com/api/?key=" + API_KEY + "&q=" + this.pixabayquery + "&per_page=" + this.per_page + "&page=" + this.pagenumber;
  $.getJSON(URL, function(data) {
      //if (parseInt(data.totalHits) > 0)
      //$('#pixabaysection').empty();

      var pixabayhtmldata = '';
      $.each(data.hits, function(i, hit) {
          if (lthis.photoORbg) {
              var imglist = '<div class="col-lg-2 col-md-2 col-sm-2 imgsection" style="padding: 5px;float: left;"><img style="max-width: 100%;width: 250px;" class="stockadminbgimg img" src="' + hit.webformatURL + '"  data-imgsrc="' + hit.webformatURL + '" /></div>';
              pixabayhtmldata += imglist;
          } else {
              var imglist = '<div class="col-lg-2 col-md-2 col-sm-2 imgsection" style="padding: 5px;float: left;"><img style="max-width: 100%;width: 250px;" class="stockadminimg img" src="' + hit.webformatURL + '"  data-imgsrc="' + hit.webformatURL + '" /></div>';
              pixabayhtmldata += imglist;
          }
      });
      var $grid = $('#pixabaysection');
      if ($grid.length) {
          $grid.isotope({
              itemSelector: 'div',
              masonry: {
                  columnWidth: 'div'
              }
          });
          pixabayhtmldata = $(pixabayhtmldata);
          $grid.isotope().append(pixabayhtmldata).isotope('appended', pixabayhtmldata).isotope('layout');
          CreateUtils.showpixabay();
          lthis.initEvents();
      } else
          console.log('No hits');
  });
}
refreshSection(section) {
  $(".wholepopup").modal('hide');
  setTimeout(function() {
      var $grid = $('#' + section);
      $grid.imagesLoaded().progress(function() {
          $grid.isotope('layout');
          $grid.isotope('reloadItems');
      });
  }, 600);
}
btnTableProperty(value, TableProperty) {
  var selObjj = this.tempobj.getActiveObject();
  ///Table property
  var tblHRow:any;
  var tblJson;
  if(selObjj.dynamicjson != "" && selObjj.dynamicjson!=null){
    tblJson = selObjj.dynamicjson;
  }else if(selObjj.staticjson != "" && selObjj.dynamicjson!=null){
    tblJson = selObjj.staticjson;
  }else{
    return;
  }
  
  let parser = new DOMParser();
  let parsedHtml = parser.parseFromString(tblJson.svgData, 'text/html');//this.tblInputData.get(selObjj.id)  
  var divBody = parsedHtml.getElementById('viewBody') as HTMLDivElement;
 
  var hei = selObjj.height;
  var wdi = selObjj.width;
  var rowWidthCheck= tblJson.rowTitleWidth;
  if (this.tblObjJson.hasRowTitle){//tblRowConfig.showTitle) {
    let actHei = hei - 2 - 2 - 2;//2 -> remove left,right padding & border px
    let titDv = parsedHtml.getElementById("divTitle");
    if (titDv && !this.tblObjJson.hasTitle){//this.tblConfig.showTitle) {
      actHei = actHei - 15 - 12 - 1;//12 - > include top bottom padding 1 -> include top border px
    } else if (titDv && this.tblObjJson.hasTitle){//this.tblConfig.showTitle) {
      actHei = actHei - 15 - 12 - 1;//12 - > include top bottom padding 1 -> include top border px
    }
    let titDiv = parsedHtml.getElementById("divRowTitle");
    if (!titDiv) {
      // var rowtitle1:any;
      // if(value.rowTitleWidth=='' || value.rowTitleWidth==undefined){
      //   rowtitle1=0;
      // }else{
      //   rowtitle1=value.rowTitleWidth-4;
      // }
      titDiv = parsedHtml.createElement("div");
      titDiv.setAttribute("id", "divRowTitle");
      titDiv.setAttribute("style", "width:"+this.tblObjJson.rowTitleWidth+"; height: " + actHei + "px;float: left; border: 1px solid #000;border-right: none;padding: 2px;overflow:hidden;word-break:break-all;");
      // this.setElementStyle(titDiv, this.tblObjJson.rowTitleStyle, this.tblObjJson.rowTitleStyle.fontFamily, this.tblObjJson.rowTitleStyle.fontSize);
      this.setTitleElementStyle(titDiv,this.tblObjJson.rowTitleStyle);
      titDiv.innerText = this.tblObjJson.rowTitle;// this.tblRowConfig.text;
      // divBody.appendChild(titDiv);
      //row title color..
      if(value.rowTitleBg){
        titDiv.style.backgroundColor = this.tblObjJson.rowTitleFill;// this.tblOtrProp.rowHeaderFill;
      }else{
        titDiv.style.backgroundColor = "transparent";
      }
      let titDv = parsedHtml.getElementById("divTitle");
      if (titDv) {
        divBody.insertBefore(titDiv, divBody.children[1]);
      } else {
        divBody.insertBefore(titDiv, divBody.children[0]);
      }
      // hei = hei + 15 + 12 + 1;
      wdi = wdi + parseInt(this.tblObjJson.rowTitleWidth)+ 4 + 1;//4 - > include left right padding 1 -> include left border px
      // if(this.rowWidthCheck == this.tblObjJson.rowTitleWidth){
      //  wdi
      // }     
     
    } else {                
     // this.setTitleElementStyle(titDiv,this.tblObjJson.rowTitleStylesetTitleElementStylesetTitleElementStylesetTitleElementStyle);
      this.setTitleElementStyle(titDiv, this.tblObjJson.rowTitleStyle);
      titDiv.style.height = actHei + "px";
      titDiv.style.width= this.tblObjJson.rowTitleWidth+ "px"
      titDiv.innerText = this.tblObjJson.rowTitle;//this.tblRowConfig.text;
      wdi = wdi-rowWidthCheck;
      wdi = wdi + parseInt(this.tblObjJson.rowTitleWidth);//4 - > include left right padding 1 -> include left border px
      if(value.rowTitleBg){
        titDiv.style.backgroundColor = this.tblObjJson.rowTitleFill;// this.tblOtrProp.rowHeaderFill;
      }else{
        titDiv.style.backgroundColor = "transparent";
      }
    }
  } else {
    let titDiv = parsedHtml.getElementById("divRowTitle");
    if (titDiv) {
      titDiv.parentNode.removeChild(titDiv);
      wdi = wdi - parseInt(this.tblObjJson.rowTitleWidth) - 4 - 1;//4 - > include left right padding 1 -> include left border px          
     this.tblObjJson.rowTitleWidth=""
     this.tblObjJson.rowTitle=""
    }
  }
 
  if (this.tblObjJson.hasTitle){//this.tblConfig.showTitle) {
    let actWdi = wdi - 6 - 6 - 2;//2 -> remove left,right padding & border px
    // let titRowDiv = parsedHtml.getElementById("divRowTitle");// Check row title exists?
    // if(!titRowDiv && this.tblConfig.showRowTitle){//if not exists
    //   actWdi = actWdi + 90 + 4 + 1;//4 - > include left right padding 1 -> include left border px
    // }
    let titDiv = parsedHtml.getElementById("divTitle");
    if (!titDiv) {
      titDiv = parsedHtml.createElement("div");
      titDiv.setAttribute("id", "divTitle");
      titDiv.setAttribute("style", "width:" + actWdi + "px; height: 15px; border: 1px solid #000;border-bottom: none;padding: 6px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;");
      //this.setElementStyle(titDiv, this.tblObjJson.titleStyle, this.tblObjJson.titleStyle.fontFamily, this.tblObjJson.titleStyle.fontSize);
      this.setTitleElementStyle(titDiv,this.tblObjJson.titleStyle);
      titDiv.innerText = this.tblObjJson.title;// this.tblConfig.text;
      // divBody.appendChild(titDiv);
      divBody.insertBefore(titDiv, divBody.children[0]);
      hei = hei + 15 + 12 + 1;//12 - > include top bottom padding 1 -> include top border px
      if(value.titleBg){
        titDiv.style.backgroundColor = this.tblObjJson.titleFill;// this.tblOtrProp.titleFill;
      }else{
        titDiv.style.backgroundColor = "transparent";
      }
    } else {
      // this.setElementStyle(titDiv, this.tblObjJson.titleStyle, this.tblObjJson.titleStyle.fontFamily, this.tblObjJson.titleStyle.fontSize);
      this.setTitleElementStyle(titDiv,this.tblObjJson.titleStyle);
      titDiv.style.width = actWdi + "px";
      titDiv.innerText = this.tblObjJson.title;// this.tblConfig.text;   
      if(value.titleBg){
        titDiv.style.backgroundColor = this.tblObjJson.titleFill;// this.tblOtrProp.titleFill;
      }else{
        titDiv.style.backgroundColor = "transparent";
      }   
    }
  } else {
    let titDiv = parsedHtml.getElementById("divTitle");
    if (titDiv) {
      titDiv.parentNode.removeChild(titDiv);
      hei = hei - 15 - 12 - 1;//1 -> remove top border px
      //wdi = wdi - 90 - 4 - 1;//4 - > include left right padding 1 -> include left border px          
    }
  }
 
  var myTab = parsedHtml.getElementById('viewTable') as HTMLTableElement;        
  
  // if(arrProp.rowHeaderBg != value.rowHeaderBg || arrProp.rowHeaderFill != this.tblOtrProp.rowHeaderFill ){      
  if(tblJson.rowHeaderBg != value.rowHeaderBg || tblJson.rowHeaderFill != this.tblObjJson.rowHeaderFill ){      
    
    var tblHead = myTab.getElementsByTagName('thead')[0];
    for (var i = 0; i < tblHead.rows.length; i++) {
      var rowHead = tblHead.rows[i];         
      var txtNode = rowHead.getElementsByTagName("th");        
      for (var coli = 0; coli < txtNode.length; coli++) {
        var textN = txtNode[coli];
        if(value.rowHeaderBg){
          textN.style.backgroundColor = this.tblObjJson.rowHeaderFill;// this.tblOtrProp.rowHeaderFill;
        }else{
          textN.style.backgroundColor = "transparent";
        }
      }       
    }      
  }
 
  let parsedHtmlSvg = parser.parseFromString(parsedHtml.documentElement.innerHTML, 'text/html');
  
  var tblBody = myTab.getElementsByTagName('tbody')[0];// as HTMLTableElement;      
  var myTabSvg = parsedHtmlSvg.getElementById('viewTable') as HTMLTableElement;
  var tblBodySvg = myTabSvg.getElementsByTagName('tbody')[0];// as HTMLTableElement;
  
  for (let i = 0; i < tblBody.rows.length; i++) {
    var rowBody = tblBody.rows[i];
    var rowBodySvg = tblBodySvg.rows[i];
      ///update prefix suffix values
    let txtNode = rowBody.getElementsByTagName("td");
    var txtNodeSv = rowBodySvg.getElementsByTagName("td");
    for (let coli = 0; coli < txtNode.length; coli++) {
      let textN = txtNode[coli];
      var textNsv = txtNodeSv[coli];
      this.setBorder(textN,value.showVborder,value.showHborder);
      this.setBorder(textNsv,value.showVborder,value.showHborder);
      let colPre = tblJson.columns.column[coli];// arrCol[coli];
      textN.innerText = colPre.prefix + textN.innerText + colPre.suffix;
      // textN.innerText = colPre.dataprefix + textN.innerText + colPre.datasuffix;
    }       
  }
  if(!value.showVborder || !value.showHborder){
    tblBody.style.border = "1px solid rgb(0,0,0)";
    tblBodySvg.style.border = "1px solid rgb(0,0,0)";
  }else{
    tblBody.style.border = "none";
    tblBodySvg.style.border = "none";
  }
 //update column width...
 tblHead = myTab.getElementsByTagName('thead')[0];
 for (let i = 0; i < tblHead.rows.length; i++) {
   tblHRow = tblHead.rows[i];
  let tblTh = tblHRow.getElementsByTagName('th');
  for (let coli = 0; coli < tblTh.length; coli++) {
     var header= tblTh[coli]
     header.style.maxWidth=(tblJson.columns.column[coli].width)+'px';
     header.style.width=(tblJson.columns.column[coli].width)+'px';
  }
}

for (let i = 0; i < tblBody.rows.length; i++) {
 let rowBody = tblBody.rows[i];
 let txtNode = rowBody.getElementsByTagName("td");
 for (let coli = 0; coli < txtNode.length; coli++) {
   let textN = txtNode[coli];
   textN.style.maxWidth=(tblJson.columns.column[coli].width)+'px';
   textN.style.width=(tblJson.columns.column[coli].width)+'px';
 }
}
 var updSvgData = parsedHtmlSvg.getElementsByTagName('svg')[0];
  var updData = parsedHtml.getElementsByTagName('svg')[0];
  updSvgData.setAttribute("height", hei.toString() + "px");
  updSvgData.setAttribute("width", wdi.toString() + "px");
  updData.setAttribute("height", hei.toString() + "px");
  updData.setAttribute("width", wdi.toString() + "px");
    
  
 
  var img = new Image();
  var svg = new Blob([updData.outerHTML], { type: 'image/svg+xml' });
 window.URL.createObjectURL(svg);
  var b64 = 'data:image/svg+xml;base64,'+window.btoa(updData.outerHTML);
  img.src = b64;
  img.height = hei;
  img.width = wdi;
  //Update add row icons
  if (tblJson.dynamicData != value.dynamicData) { // (arrProp.dynamicData != value.dynamicData) {      
    this.tableAddRowIcon(value.dynamicData);
  }
 
  selObjj.setSrc(img.src, () => {//img.src
    selObjj.set({ height: hei, width: wdi });
    this.tempobj.renderAll();
  });
  tblJson.width=wdi;
  tblJson.height=hei;
  tblJson.title = this.tblObjJson.title;// value.titleText;
  tblJson.hasTitle = this.tblObjJson.hasTitle;// value.showTitle;
  tblJson.titleStyle = this.setStyleAttr(this.tblObjJson.titleStyle);

  tblJson.rowTitle = value.rowtitleText;
  tblJson.rowTitleStyle = this.setStyleAttr(this.tblObjJson.rowTitleStyle);
  tblJson.hasRowTitle = this.tblObjJson.hasRowTitle;
  tblJson.rowTitleWidth=this.tblObjJson.rowTitleWidth;
//  tblJson.rowTitle=this.tblObjJson.rowTitle;

  tblJson.columns.showHorizontalDivider = value.showHborder;
  tblJson.columns.showVerticalDivider = value.showVborder;
  
  tblJson.rowTitleBg = value.rowTitleBg;
  tblJson.rowTitleFill = this.tblObjJson.rowTitleFill;

  tblJson.rowHeaderBg = value.rowHeaderBg;
  tblJson.rowHeaderFill = this.tblObjJson.rowHeaderFill;

  tblJson.titleBg = value.titleBg;
  tblJson.titleFill = this.tblObjJson.titleFill;
  
  tblJson.borderstatus = value.showBorder;
  tblJson.isDriverTable = value.driverTable;
  tblJson.groupRows = value.groupRows;

  tblJson.dynamicFontSize=value.dynamicFontSize;
  tblJson.moveText=value.moveText;
  tblJson.dependantId=value.Selectcomponent;
  tblJson.fitRows=value.rowSize;
  tblJson.minFontSize=value.fontSize;
  
  //tblJson.dependantId=this.dynamicFontSizeId;
 
  tblJson.svgData = updSvgData.outerHTML;
  tblJson.type = value.dynamicData ? "dynamic" : "static";
  var dyUpdate = false;
  if (tblJson.dynamicData != value.dynamicData) {
    dyUpdate = true;    
  }
  if(tblJson.hasTitle===true){
    tblJson.columns.y=parseInt(this.layer3[0].top)+31;
  }
  else{
    tblJson.columns.y=this.layer3[0].top;
  }
  
  if(tblJson.hasRowTitle===true){
    // tblJson.columns.x=parseInt(this.layer3[0].left)+parseInt(tblrowwid);
  }
  else{
    tblJson.columns.x=this.layer3[0].left;
  }
  tblJson.dynamicData = value.dynamicData;  
  if(dyUpdate){
    if(value.dynamicData){
      selObjj.set('dynamicjson', tblJson);
      selObjj.set('staticjson','');
      this.extendtable(selObjj, selObjj.id, selObjj.objtype,selObjj.cacheKey,'',tblJson);      
    }else{
      selObjj.set('staticjson', tblJson);
      selObjj.set('dynamicjson','');
      this.extendtable(selObjj, selObjj.id, selObjj.objtype,selObjj.cacheKey,tblJson,'');      
    }
    this.tempobj.setActiveObject(selObjj).renderAll();
    this.renderLayers();
  }
  
  this.modalRef.hide()
  
} 
  
 
btnCreateTable(e) {
   if (this.seletecdPg > 0) {
    var canvas = this.arrPageCanvas[this.seletecdPg - 1];
    // icon
    var addColumIcon = "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAOEAAADhCAMAAAAJbSJIAAAAhFBMVEX///8AAAAvLy8yMjLu7u719fXq6uqmpqbT09Pl5eXi4uL5+fnX19e8vLzt7e3Ozs6vr6+EhIRiYmJ4eHhra2vExMRycnIkJCSMjIzb29ufn59mZmZXV1fKysq0tLSBgYFJSUlBQUGSkpJbW1tKSkocHBwVFRU7OzsMDAygoKAXFxciIiI7eJOAAAAL00lEQVR4nO1d6XriOBDMJDgGAjE3hCPB5Jhk5v3fb5c1BLrVsmW7uu3Zb+pnArIKWX2rdXPzF38RgE4/GY7W4+litplMJpvZYjpej4ZJv9P0xOrjPolXk9sfftxOVnFy3/Q0q+F+ftjmUKPYHuZ/Fs3+aPYZzO6Mz8Wo1/TEgxANF79KszvjfTp8aJpAPjqjt8rsztiO2iuAnuvTO5EcNk1FQncBopdhOmiaEEX0lacSquEubs+W7E3h9DKM26FCBhMlfkfM+k3Tu0lQ0sWH12Y3ZFeb3xHbp8b4DSz4HfHazLvamYVOcLmfHuJ5d/DtS3T6g+48Pkz3y9AhXiJ7guugmc3Ww37e5KL+cL0JGik2Y5ZhV2xZ7w+7UPOrMz/sC8dbdlUZUURFL+hylZRV1w+71XvBqFMVMhKGBYsXV/WC+us0f+gdlIcPD7kaPo3reQad+GfTyzjPm8AKIdb7q5wnfKrvxpec5cP5PM85C3mAPUXCo//JC6zlMfDrkK2iz+EXMWO8X37v91gS+MNO8O6PF524w73Xqf5Sed6NLzi4edR53r/ovXqeuVB4WMfjxae6ln9yJz92D9+MT54fUz9mNJIf/AH2/z1acIx9iowHj8iBvjzP4iN+WrltA9nLAorUWHzAGveAQshifI4a/ksafWnrd3dFdw0kBQ7S2C+YsUtA9NieESOLzjzs/SgBURgAVlHag8tmIrWixqr9W0s/3AQx3SqIpFhHzXjqThjSUoZySM5bLZEnvRfNZr6kTVPD7u/gX4raEKyrZfXRBGO7+VR7153UtupYrrv02YZ0l7B1Kmpn11L6aCC2LqDvUqyk+d2QxUdbSggEihUcjZ4zyK92rOARAsXyHrHrsLRlBY9w9+Jr2SHcIFDzUvQarkQtGZ1yjbWm9SCHKyZKbUVX1bevhsfxeX6X+baTvm7SFvXBCd+U0IqO8TfTm2cNpHyawVkb5x2905xndUR8nh+h33QCzUg9gYzkDvhEV2Hfc6QULGQxGB9LT9/HsDCgs53CfEX+LVTYt3eRX1uUBc+dgzTkS9zgvgVNhjp2oPfigS9HgAnu2KOguCiPh4CKDrhD/Fn8Fb7uoFSda0OARA7XioVJ8IR9YY+ZhxDPRZVVfLBxizwgnqgHiYRHhyBsEfmaFPxyXFOgrDUpRAaJyN+4blC+4PhNP4ySo2LSAZX64PI0N2DNnSaYapaqVN5Qg/MXJM+NYktY2m/2QsrG46xdFo/Y+D/JdyHOrddlyHWtXzyydwmYI9RlyJW4V5xyuQt0A5QZ8sCUTycyrwlZIqfM8IZVhHqU3L3eEqoz5Isof4o5FdAqR22GfBHlwJniEuozZO6+qGuZqsCWO6kz5OFBSdEFfKQ69BkyR1HYY8z6B1cj6DPk9pj7ARZCBpfhGjD8KiJA51AjNS7CgCGLnjp2DcvIocuMDRhyD43/mxWvoXOFFgyZ0clfU1p2gXObTrBgyCI2zG9gFhs8l2bCkBll9J9x3j8BMGHIjFPq6lO3IsdJrggThszXpw6G8ktqxJC+psQ2ZWIIf7DIhmHXT4PqisplYn7YMGSv4nVqJCX/UThUbMSQKv0r65vFVBWq8I0Y0njvVTKRuo/v+CdbMWRq/fIPqg3xusKMIdMXF41Iz2uOFJ5sxXDhYeJjjoMVQ3rQ7duDYoJG4cFmDKnh9i1qqKLcKzzYjCHTiOe/0qVVOdFkxpCmXs7hNGrOoVKzBGYMaeHC2aqhjoVKIakZQ6r4zsEYKkpVqrnNGNJU4imsTUWphkVjyJBaNScfgsaCgyrDSsOMIV2uU1CU6hCd/ihmDFlILfsbTcnotA6xY0iPKGZRUaoOy1il0WiR3oZAboxwF/TddFqq3SdVF1nNAnXww2sGO1rtEl1MwwU8ZZNVftNzmcHqMLfZEBzBPzxN0GQxNer6h+YNC9phwRFKkbr5mYFGU+CB74N78EsbgZuRqvxMqtBym8Cfyqpl4gWBuRTqKK2FyYaNw4uLLBDmmdOYU6b7JB1ZBDsxekFY7cST8B2qI8MYWjI7I6zYlQqIzEKrsg8tmZWbGjVMs7jha91hrFDhx89KSiZ1h7GCKUN+BMACgZ4r+U7GkMaDwzR+TvtENYSFyKR9SK22sPZyQusGdYRZzPRwTnY0lOq2wMRT+O0cKARmNSVtUcm34OW2+gjsXShpfMmjKoat8xTuW0h2KfXxg6sUbE3T4EpC+stnvgX1qMJT3FErfXwaEs78Q+pRlYlEWcVpygSp6Z7Llp6WJWp0BrWMtdEcaRaxoBHhvcpzm40mimFiMOwY0iSM+Mc/OzNDK4XPLiW1T1R6WpoxpELlXI8/Jn9V6dNixpAGOc9dJKgKUUlcmDGkyuKcoqDWiUbBkB1D6uyeTVDWDUDjwQ3VYkQFfwbCiiFdrEsLCSpMNfrLWjGkdvflaBMtN9EQNVYMfUyoiN0rPNmKYep5G5nDrnB/hBFDFse9SlfRZtkK99UYMaTb8Dr8SMNtgf2kysCIIbXOrstKaCAD1u/jAiOG9I7X6wo9djYP32nWhiGjQaJz9Igp/jiCDcN1zvg0qATrq/ING4YpGZ9mVFn0E96M1YQhU3pUJTBFAn9NTRiyw9rsv9Q0hRcomjCkBQncC2T31aBDGRYM2QFLHqtgPiJa6VswZDlNx/Zk6TLw0y0Y0tHdUAVr8wWORxkwZPvM9XKZNN1jH2/AkDW5Ej7BWhJgTz/pM2TJPinpzz6CzdDoM2RNhsQFYn3doHaNOkNmdP8UP8Tan0DPP6kzZHtMrlbnpVzIRdRmyAt6PR9jWWtkpyhthqzDp89g4U3PgIuozJAvodeFZ3YNUJwqM2TdAv1N8nkBCU4n6jIsMW9mF+B8fV2GbPS8+jBe6ASzTlOBIcwJ5TeV5hau8W64qElIxUWoU3L8ioT8Ej/ezRXlJ0oXwqI6G/Be0AXSg58UATn70g1uoDwlL3Utum2E60TZwCsP9+4hlFX4zsYtrNLknbdB2UTnPhHUEvJ67OJ95bxPIKXIdzioMaNzBWVAapBfHYsqA6OaCJTBcw5+BIkvfvMuSqpr3FHCr8QJsyKchQfeM3M8p/E+hlmDzoUEgSNv+PeQ2TbVu4JCHT5H7imkTBFw5hlwBcsJzr1yjd0AnIuUT7OEfHbOi+j0IagHx9YtIxJd/fwH3J33q9TX3fMiwbe2GcE9LV+ysY7r7rT9DsvSV+K4XnngwSMTuPeQlm9n6d5f1JLbgI+A3CUrbMX/2X3ArgneGorCtdUV4wXOTY/tuJfbsdVqeNNCDLB5iSqcCqzeNNdV/M3fCyx0janjwQpbWqUMPBxfwoxqSQfpoGiTdwNLcdea4UCplVBjnkaUamwb6V6/22bMG0GIQjaNRFGjFLzaRCA+j+OmHIG9SigEE2kaoFak4o93q3JO0Qv5bDzMaxUparRu92IszgCouJzAzX9IrQychOcmMkCdck+PCIWTGS4i6RLTH/Cu3II9j35RPJC3yI93uMbq3MpPetN9VZOl57EaD/O1pHnR8/17Tvj9BJ0+sh6B9i9WOhx7ng2oKMb9/S4VOPa9/DQjm4/SzcWn9wZrASRugOGMV4XzkVfI6UnzBpOrDyOPWDtC3XnL68z6cUDEcQZ5rdJ+GcQYIv/7c1zIUu1yXNyvc5ZP6VoDF7IN941tXHUlnw7+fX7EJ/jeST8i0ZO5wt2htLiL5oV9/Ew9toBeZtv1LvSFvZ+v0sLx7jRuh8mDGxEX8LmI5708ntHT8FD0QmTQuN+nAI8+i8rB8m16iOfdQf8U9nt47A+SYXxYpLJXJGCsqwN96O6LpwbBprlkQpIa8JvYxks4dtrruLEWMC66uRZATUybzwQd0XeLRzFYtSNfeUS0/l0835JIG9APuUj87lwV4Kr7gHgYoaTOpH31SWc8juqLncWwPTUfMuYvwZaKg5/lLfZm0I+DLboL3qfPbaiDCEdveHjl9dQ+LDfrXXsUQylESTx+9cR0j/i826xGg2asaige+7vhaP0yXcw2k8lkM1tMx1+jYdL7Q9ftL6zxD+6vj+j7lvsPAAAAAElFTkSuQmCC";
    var addColumnImg = document.createElement('img');
    addColumnImg.src = addColumIcon;
    var settingIcon = "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAOEAAADhCAMAAAAJbSJIAAAAgVBMVEX///8AAACFhYWNjY19fX38/Pz29vZubm7Y2Nj09PSvr6/v7+/5+floaGjr6+uIiIjR0dHKysrc3NxTU1MxMTG1tbVjY2N1dXWioqJNTU28vLzj4+NGRkaWlpbDw8OpqakqKio7OztbW1sPDw8jIyMbGxt4eHibm5sXFxdBQUEuLi4K5pU9AAAPd0lEQVR4nNVd6UIyOwy9rIIgqyCLiCzqh+//gFdEYU6aJunC4vlL6TTTNnsy//13bswnD4+bEoPN6/ijcfbHnx39Z464Ez5n115hGtprmb49nlvXXmUCOv90Ar/wd49qx0TfFwbXXmkkalsrhaXmtdcah3czgaX1tdcahbmdwFKpf+3VxuAuhMLptVcbgXoIgaXSHxQZL2EU3l97veFYhFF4d+31hgOu4bbKYFgcsbr2esPxVlx/hx2yKw5pX3h9yajBGeTHVIpD5pddXzoGxdV7BPp9cczLZdeXjlFx9V1+TKM4ZnHZ9aUDWOmIH9P808wUDEOfeVQc83bR5WXAa3H1dc8geA0XXV462sW1v/pGdf8wMwUm4rWNgB2ZHDbtVi3fIjk0PsbT1XC86GkDYe1eNhnGTHvVx8MLW55LTW8X+ON2KY+F8+dhpcT+GMszvqwKYx94JSkRsxLgn7iPoHP63TBFfvQozVd7wKefwxbpligqwmgY6B8GzFS4YT3n4aVqNCUecE6Xnfc+gCzf+Gc1aqaVEoPMKsIT9wzvDasti4Me/NMCQ5qOeJdbZ8U/XLm4YfC6zbjVvxAPjcAkB2S64cg9qvclH4RXFwrBqbQhDGfu3ldB0NXcCd9xQjEukG0XPUf0B8Utmk2ZAZKywk34WeCTffHRuXZRcwv+hlZqEz5MIVnvY37Kxc+NLCuPzrOLBr/n/hy2fa4nUc6xXHKP8tdrmz/qj86wiybH7lP9w/ubyNVn3r+Vukv/bzlJdAlcmR58gqh9NPX/A6bupieS6BI4024/hfwA9aYBPoi2nk4i1QYPDqOaIbJ7hBZzUaLgRbx9K7guiQnsxiXwR7b5pTCFamfZg3C/FzrjLrqs/Ojy82lSiPXSYq92lh6ZgTgpDtl20buD33B1F4JqL8Ac71XZhJQTQMvPtIv8HSwsSlrQU3jIs9cViCSWmkviUziBLlumXuma73DtGP3ZBFbpK7nKL0fiJPRh7g4xbveRM+gL7ymZFfMqM+OYeWEuiaGODUdhYuMKnR0d1vX5Rq2oO4eHN0IdEgOzHZwIri9wgusp50gbQQ330WeaOCSGOVyH5N/+yFDjxB/usnn5Tu+t7B9EzWfJb+SAWqZS6Kv2o9mtciZvdQ5q01ZkyWQXdyEP6NkJ/MK8Mp1Wc8f/5suPD00hIrsYMv19CIFXBO5iyEUEa++WE0GAKYVcE6DwljOyxrEUwindnm19yUCVI4SVo5EbofNdBq14TkOS0m6V1aBGFWZCERX4NjNciX7nDeKxIDr1TSZHUuMg8O/EuRtsm5wftU3aEqnqfXvJ5sRCf738BGcGtU3Dt4Aq39ljrmmglQ4x14he5NtSbYjpPYyahBrbqdZ7TtAwUOTaiCcj7j2dBdS+j1VJcpx1RK3ebDXryWlNVFDE8wjqvI9PPas17isPu9/0mdfdQ+W+EU8oiRelmAbjHFO1+xU+/LLr9qOyu2nQMSXnr03mEvxCHtRmclBiPAveSmJRJF4eKjL0UBKgwTl4Kd4DXVgktpfKAEkARgzKU2gVskc8h8hayv+ShRgRGXbfeX9lpG+PlZ1Goq6l266kyM66kg71KWsYWt/dBP4WzhlcYL6QkcLAqqdvGOsRcA8zqMuEc5ne9MBeH1vE1sT2YxYkApMlni1/wXMUAhPjR7su2U1GEl4s0sINHtthSRrNvIloYBjcWW1DqpaAlUHLIRG9RArx+brPtSNlHGyn64enh/VUuqb/DHuC/0ir60PdW2dcNKZ3xPOiX1x6p7/wqgO6PwIveprW9glzqVvoRte/MZ5xDtemT2XVSYThSRVTqJaqW8iW4L9N/HpVffLG/UWVGriJKf4VlPbaDWETDTVPNJfPsdF0TXSTJWTtB07EMJAPw1OY1NRP7T/ITuOVb3y/mix05eDaFu9qubmOmhxHAyM+hhtUT+6m9Nof7OY6aocbmFR0WAXvlVLL5XKZEC+0K2WUS48Rztg0FzykimCFotEvPIZF5Jqf5P/akQEmrLx9D2po4in5jZRdhPsWaNaeIsiB12zeP/pB+un8ZXK3Ig+UbWnqWohpqUNJlI8eoz09P010Olv95Tul7QD5f4QbBqUnHUF0dkU60WtxfHZ12edfTn1WfvarzfIhpS65OGWYagwyqxLdCK9VNyVVybWW65BXODjWRUvUWvkue5X8H2CeXVutjBHVBhIwjhfAxDsg6xhqM7hCsqL2OjTvBRpCKY27hgEzySV1exyvlk6g7Acjhysly5TwZPG4CzVTv/hhVpbaI9HxjjUhaQYp8g9PU5QDmPJMB4cLY/Ddioofhm9SO3jgg8WhbCI9wV6zsjTlEg8ePii1W2dIaqu/JPCIvdWu+8aGsv0F0j49kREerUj9ge65rKtsZrxQgl94SON04CLwJmqja50vDdOn3uwx86sGr+vFaGAIX+IpT2/ZhQ5fY8By/rIY84exytYar7ujhtkzAG7/HI0O4NSHtI9qD2YVh5wp2lmlYfe+EZhqCa8uR1oRcK5wK6w+AGb1Bhc7KML7A7yGOfrj4DGNmQEC10BhzBkDsyJPp9VVccoYLR6s42QKwQFlcR4GLjBGvualEE5EYKqGB8CdYzrV5aUQOF+e5D5w28WEsfNSCKw04v8cilPG+ELzUviWuBptzhj+npVCEBa5+sUUvW4xim5WCqH2JFdxjbVBlg+3TyFYDBHc63wU5mq/BU6DiHqd893DXK2pwMd0bQrBWZKL09zUKQXOnivX/aY4DUj814j/c1glzpmXQvAGR/yfQ3HKmFbmeSkErpCn6SYYiDHcKy+F4OfJU2wKEezr2xbgWw9q3OCFpVO2iLwUgjcyLjJKAcHgmMLHvBSiBzdHwTCWWcfMAO6//4ph322MIwnCHjm+wAUmfrhB1myAY+UfyT6clu97gUoE3JocWg24PENudr0x6jrpVc9czvJ2WLlvmJ3XGMNPP6Z4SG2en3ZjVBnyebllIe18XBkNLPsJf0r3tuGCtNH7fRNTEGbaZ5lexwvNjw05AEJbZCMgPK/wPkPdUdvSuPBT9spiilmM/CoCo5GyCuHtfnpC2VkgD1ko4dhECgMms9R1fF8zS9dC8UlY35Z2EzGsK1YaWL6ZdThRbaVl4R5i4JNc5UvlYhgacFb5aTnIgheFUIodPAyYST9778exHb0SSxQbJKEmPtJN8oxlYaiuGfJe1Ga3MlMjCSuxbUJIToG8hWLvzS/syBHvKK1gZVcorSSJi9DQ1CU5RULclMcy85bb/a6nueY35MWROxH3FTWSaqDouD7+OPxSrQXdsdVblofsf2XNhlaQx3CbsBxh95C+7ZMQjIy82bsv0+cpHvuL53nDIX2sjEJNoj1ayNmU0TSbJTBXv+Xk+it/gMGx/iFM/lMUTleDD8kxCG4pi6mX0SkgYDVoJcCuimHPFXbrbTQFHs50fEQIE7o0Kefm7Brrnpja/XflLyg5E5yYMI8aHVw5CzWp4Uxmneqzw34bJlp4oNWg8Y42Vy6pHTdOf1Y9YqgbpHhp8TCIOcl7sCr8duJ3+TQ/2IR79XCj6Zv0TTp0AKgCwOMSGc84YdWceb6xoEY/0DI0dUHwApmyuol+r8/UqeV2WoGbCSRbmOijRQ1Ol+JKPf5Yrcd/0wnELfyXRiDxhRgEzwV6KqBYSu1ARooaLJZf0EfVCTQ5uAexIpNTWlFamW61/QsmFCZXJKro6S5o0u7LlOY8j+tP82kKIRNmluFr17iJlmP0n6nWw4HRvYM6bI6c3Tjh0wrtUnNntbaQ9+WIOqMKaBevjZBeWGu784rc8vS0ZFIWFWKoNKzfhRqHOOeoUpHKS6n/K6ygYm75JFc3MEeFvLfUoCw5asE6YG0mi8encNuOer3SvmxAwztRMYmex005rMRdIlo8mpKnRAvb4pXcwejUv3TzuburjBJsHnIs4ryzBxDJnZw/Wqvvkb0HbbzIIJ6Xf2f+6rcd1DUXKzLoec/5qZxE0Ph23CxUUMTk0J0Nqxz3h6Qw5MlZywXqEopJkKBOvrN8sD0e1EQLl2P0MqdmkWQHCeiF+6NIpCTjN7AzgfapDt0Ccgg2NyMoTiARxNBmDmQL85ROZgZR68OMAqKu5cluzg5064XVYqLGnaL4nRPzhFWiD+LGBMUJQVFqBJiFN/xpOVhnUCS/qM+kdpw5J0A/DRL68G5ukpF+AwVG0F/xHuqOonlSDI+dcfmx1J5LJGLQ/MSjK9tNne/38ZSTH80Ph2gnzkkIDHNJ0Ywj6W0e85bLuRSf2kmWC1yOrjEwJZKGAb272C469xYZogjkAK19UzppX4FJUU4OtWcXe+RVJNPYdkIePKNzCAzuze7EctldZL4hz+U9msG6kLngupu4F5zX5jY5c0mc8/He51in44sn1OF+udolMOKZbjEDJdHN1TqiHC5DB8x5OIIwHJfAKNtAIbEux1025V4Aa21UlKDqungIXQIjP5DgvtTCFbO06hsvLZejfm+p+CiYfy6B0d9iEXbR8iGnPfQYrTlc/EtGth3cw+Vsh12cS13uwp5uib/94MBwMu7gHu5B3e9i0IdkZOeCperqhCX3h8SPlLivuD8P+5STXG4jlQcwGLoXJ/mLT8ZTJLB6idsI1VkL2wXN8EkrC4nTJqNt/UIyTLyZfouv99JQeyHn+WaXgcQDw6wt2Q+OiK5avhfw5jclVU0gy0KgSuL2JCVfuGsl5WxyvUV3BQVM6YaciUBF+GGW1NxlBVIzRTevqII6aEsq4s1GoLiLbi7FC122MDGxYO4Y0eJnOBkJ9O/iM5ur1X4BLVMwGYvDtn1ekfUxnKwE+kj0Zq/CcD8zheCBXzVhu6/rKdmBYA7q1m/rgtbjZ6ZQmi4k+zIM5wyhFEdVkxIx+7bFACuV1LsW1aNytBhxMFgVH/Eq2rgQZvdX6oGJKbusZ8Wr/ZSjSwyH/tGQG2vpaPAyvKOgsYr29F73W3Js1pNz0feNxmwymRkSa0CM+TRT0EpNnWjaKcX+eQHsz/dGIBsiwzdTLwoTMwVWmt6v/rIAZuoTXWfosnw5gFnk00yBld5soNmH4uJ9bNIy5naxKq6eZ++QGpiry/LlAF0oePXuT7NSwkx5PglRgRtOh/AAfeJlDjDir7FSU1sfwFk1sfPA4CgrQP226g1C/2hYEZkN9otA6wGESAkcXw2rAAJzdZG+LDwf6WaRPeHoMjA0/ftBaj321WCK7ZbMpbe3CBs/ze4XvCSEdI0jbq7OIQwtpQ9cqZslUeyqaM6qO16/eXsuv5yfvv8BqVq2HEo894AAAAAASUVORK5CYII=";
    var settingImg = document.createElement('img');
    settingImg.src = settingIcon
 
    //end
    var svgData = '<svg xmlns="http://www.w3.org/2000/svg" width="275px" height="65px">' +
      '<foreignObject width="100%" height="100%">' +
      '<div xmlns="http://www.w3.org/1999/xhtml" id="viewBody" width="100%" height="100%">' +
      '<table id="viewTable" style="font-family: arial, sans-serif;border-collapse: collapse;table-layout:fixed;"><thead><tr><th style="background-color: #dddddd;border: 1px solid #000;text-align: left;padding: 8px;line-height:15px;width:74px;max-width:74px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;font-family:Arial;font-size:12px;">Column 1</th><th style="background-color: #dddddd;border: 1px solid #000;text-align: left;padding: 8px;line-height:15px;width:74px;max-width:74px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;font-family:Arial;font-size:12px;">Column 2</th><th style="background-color: #dddddd;border: 1px solid #000;text-align: left;padding: 8px;line-height:15px;width:74px;max-width:74px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;font-family:Arial;font-size:12px;">Column 3</th></tr></thead><tbody><tr><td style="background-color:white;border: 1px solid #000;text-align: left;padding: 8px;line-height:15px;width:74px;max-width:74px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;font-family:Arial;font-size:12px;">&lt;&lt;col1&gt;&gt;</td><td style="background-color:white;border: 1px solid #000;text-align: left;padding: 8px;line-height:15px;width:74px;max-width:74px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;font-family:Arial;font-size:12px;">&lt;&lt;col2&gt;&gt;</td><td style="background-color:white;border: 1px solid #000;text-align: left;padding: 8px;table-layout:fixed;line-height:15px;width:74px;max-width:74px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;font-family:Arial;font-size:12px;">&lt;&lt;col3&gt;&gt;</td></tr></tbody></table>' +
      '</div>' +
      '</foreignObject>' +
      '</svg>';
    //'<table id="viewTable" style="font-family: arial, sans-serif;border-collapse: collapse;table-layout:fixed;"><thead><tr><th style="background-color: #dddddd;border: 1px solid #000;text-align: left;padding: 8px;line-height:15px;width:74px;max-width:74px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;font-family:Arial;font-size:12px;">Column 1</th><th style="background-color: #dddddd;border: 1px solid #000;text-align: left;padding: 8px;width:74px;max-width:74px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;font-family:Arial;font-size:12px;">Column 2</th><th style="background-color: #dddddd;border: 1px solid #000;text-align: left;padding: 8px;width:74px;max-width:74px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;font-family:Arial;font-size:12px;">Column 3</th></tr></thead><tbody><tr><td style="border: 1px solid #000;text-align: left;padding: 8px;width:74px;max-width:74px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;font-family:Arial;font-size:12px;">col1</td><td style="border: 1px solid #000;text-align: left;padding: 8px;width:74px;max-width:74px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;font-family:Arial;font-size:12px;">col2</td><td style="border: 1px solid #000;text-align: left;padding: 8px;table-layout:fixed;width:74px;max-width:74px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;font-family:Arial;font-size:12px;">col3</td></tr></tbody></table>' +
    //'<table id="viewTable" style="font-family: arial, sans-serif;border-collapse: collapse;table-layout:fixed;"><thead><tr><th style="background-color: #dddddd;border: 1px solid #000;text-align: left;padding: 8px;width:74px;max-width:74px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;">Column 1</th><th style="background-color: #dddddd;border: 1px solid #000;text-align: left;padding: 8px;width:74px;max-width:74px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;">Column 2</th><th style="background-color: #dddddd;border: 1px solid #000;text-align: left;padding: 8px;width:74px;max-width:74px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;">Column 3</th></tr></thead><tbody><tr><td style="border: 1px solid #000;text-align: left;padding: 8px;width:74px;max-width:74px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;">col1</td><td style="border: 1px solid #000;text-align: left;padding: 8px;width:74px;max-width:74px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;">col2</td><td style="border: 1px solid #000;text-align: left;padding: 8px;table-layout:fixed;width:74px;max-width:74px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;">col3</td></tr></tbody></table>' +
    //table-layout:fixed;width:20px;overflow:hidden;word-wrap:break-word; -- for word wraping
    // creating image from svg
    var img = new Image();
    img.setAttribute('crossOrigin', 'anonymous');
    
    var svg = new Blob([svgData], { type: 'image/svg+xml' });
    var base64Data = window.btoa(svgData);
    window.URL.createObjectURL(svg);
    img.src = "data:image/svg+xml;base64," + base64Data;
    img.height = 65;//((line-height + top padding + bottom padding) * no. of rows) + (border line count)= ((15px + 8px + 8px) * 2) + (3)
    img.width = 274;//(width + left padding + right padding) * no. of column + border line count
    // fabric.loadSVGFromString('...', function(objects, options) {  
 
    var imgInstance = new fabric.Image(img, {
      left: e.layerX,
      top: e.layerY,
      opacity: 1.0,
      variable: "",
      objtype: "table",
      cacheKey: "table",
      staticjson: "",
      dynamicjson: "",
      width: 274,
      height: 65,
      rx: 0,
      stroke: '#000000'
    });
    imgInstance.setControlsVisibility({
      bl: true,
      br: true,
      tl: true,
      tr: true,
      mt: true,
      mb: true,
      mtr: false,
      mr: true,
      ml: true
    });
    canvas.add(imgInstance);
    var ranId = this.randomId();
    // this.extendtable(imgInstance, ranId, imgInstance.type, imgInstance.cacheKey, imgInstance.staticjson, imgInstance.dynamicjson);    
    imgInstance.id = ranId;
    this.setDefaultTableProperty(imgInstance,svgData);
    canvas.setActiveObject(imgInstance)
    canvas.bringForward(imgInstance);
    canvas.renderAll();
    this.renderLayers();
    this.tableactions();
 
   
  }
  this.gettimefun();
  // this.tableDataJSON();
}

setDefaultTableProperty(objElement, svgData){
  let x = objElement;    
  var tableData = {};
  var dynamicColumns=[];  
  for(var i=1; i<4; i++){
    var dyColumn = {
      "width": "90",
      "label": "Column" + i + "",
      "dataField": "col" + i +"",
      "dataField1": "col" + i +"",
      "textAlign": "left",
      "headerTextAlign": "left",
      "styles": "font-family:Arial;font-size:12;fill:#000000;font-weight:false;font-style:false;text-decoration:false;text-anchor:middle;",
      "headerStyles": "font-family:Arial;font-size:12;fill:#000000;font-weight:true;font-style:false;text-decoration:false;text-anchor:middle;",
      "prefix": "",
      "suffix": ""
      };      
      dynamicColumns.push(dyColumn);
      //crate data json
      tableData["col" + i] = ["<<col" + i + ">>"];
  }
  var jsonDyProprty = {
    "id": "dataTable_"+ x.id +"",
    "borderstatus": true,
    "groupRows": false,
    "x": ""+x.left+"",
    "y": ""+x.top+"",
    "width": ""+x.width+"",
    "height": ""+x.height+"",    
    "isDriverTable": false,
    "type": "dynamic",
    "title": "",
    "titleHeight": "31",
    "rowTitle": "",
    "rowTitleWidth": "",
    "titleStyle": {"textalign":"left","fontweight":false,"fill":"#000000","fontFamily":"Arial","fontSize":12,"fontStyle":false,"underline":false},
    "rowTitleStyle": {"textalign":"left","fontweight":false,"fill":"#000000","fontFamily":"Arial","fontSize":12,"fontStyle":false,"underline":false},
    "hasTitle": false,
    "hasRowTitle": false,
    "fitRows": "",
    "dependantId": "",
    "minFontSize": "",
    "moveText": false,
    "dynHF": "body",
    "columns": {
      "x": ""+x.left+"",
      "y": ""+(x.top+31)+"",
      "width": ""+x.width+"",
      "headerHeight": "31",
      "rowHeight": "31",
      "showHorizontalDivider": true,
      "showVerticalDivider": true,
      "visibleRowCount": "1",
      "column":dynamicColumns
    },
    "svgData": svgData,/// new attributes included
    "rowHeaderBg": true,
    "rowHeaderFill":"#dddddd",
    "rowTitleBg":false,
    "rowTitleFill":"#dddddd",
    "titleBg":false,
    "titleFill":"#dddddd",
    "dynamicData": true,
    "tableData":tableData
  };    
  x.set('dynamicjson', jsonDyProprty);
  this.extendtable(x, x.id, x.objtype,x.cacheKey,'',jsonDyProprty);
}
 
  //viewTableDataJson: any;
  tableDataJSON() {

  }

  btnPreviewClick() {
    this.downloadType='templatewithvariable';
    this.btnSaveJsonClick0();
    /* setTimeout(() => {
   let data0 = {
      'designproductid': String(this.naviDate.designid),
      'downloadType': this.downloadType,
      'design':this.naviDate.tablename
    }
    this.userService.previewPDFstrucDOC(data0).subscribe(
      data => {*/
 var obje = {
          "routerpage":"Submitted",
          "tablename":String(this.naviDate.tablename),
          "content":"notEditable",
          "designid": this.naviDate.designid,
          "mode": "preview",
          "formtypeid": 1,
          "pdf":''
        }
      this.userService.changeNav(obje)
    this.router.navigate([`/designbuilderpreview`], { replaceUrl: true });
  }
 
  randomId() {
    return Math.floor(Math.random() * 999999) + 1;
  }
  extendtable(obj, id, objtype,cacheKey,staticjson,dynamicjson) {
    obj.toObject = (function (toObject) {
      return function () {
        return fabric.util.object.extend(toObject.call(this), {
          id: id,
          objtype: objtype,
          cacheKey: cacheKey,
          staticjson: staticjson,
          dynamicjson: dynamicjson
        });
      };
    })(obj.toObject);
  } 
  extendesignature(obj, id, objtype, esignatureconfigdata, status, tmp_width, tmp_height) {
    obj.toObject = (function (toObject) {
      return function () {
        return fabric.util.object.extend(toObject.call(this), {
          id: id,
          objtype: objtype,
          esignatureconfigdata:esignatureconfigdata,
          status: status,
          tmp_width: tmp_width,
          tmp_height: tmp_height
        });
      };
    })(obj.toObject);
  }
  extendstamp(obj, id, objtype, tmp_width, tmp_height) {
    obj.toObject = (function (toObject) {
      return function () {
        return fabric.util.object.extend(toObject.call(this), {
          id: id,
          objtype: objtype,
          tmp_width: tmp_width,
          tmp_height: tmp_height
        });
      };
    })(obj.toObject);
  }
  extendlogo(obj, id, objtype, src1, tmp_width, tmp_height) {
    obj.toObject = (function (toObject) {
      return function () {
        return fabric.util.object.extend(toObject.call(this), {
          id: id,
          objtype: objtype,
          src1: src1,
          tmp_width: tmp_width,
          tmp_height: tmp_height
        });
      };
    })(obj.toObject);
  }
  extend(obj, id, objtype, linkURL) {
    obj.toObject = (function (toObject) {
      return function () {
        return fabric.util.object.extend(toObject.call(this), {
          id: id,
          objtype: objtype,
          linkURL: linkURL
        });
      };
    })(obj.toObject);
  }
  extendflow(obj, id, objtype, breakWords,linkURL) {
    obj.toObject = (function (toObject) {
      return function () {
        return fabric.util.object.extend(toObject.call(this), {
          id: id,
          objtype: objtype,
          breakWords: breakWords,
          linkURL:linkURL
        });
      };
    })(obj.toObject);
  }
  extendimgvar(obj, id, objtype, cacheKey, imgvarvalue, tmp_width, tmp_height) {
    obj.toObject = (function (toObject) {
      return function () {
        return fabric.util.object.extend(toObject.call(this), {
          id: id,
          objtype: objtype,
          cacheKey: cacheKey,
          imgvarvalue: imgvarvalue,
          tmp_width: tmp_width,
          tmp_height: tmp_height
        });
      };
    })(obj.toObject);
  }
  extendimgsignature0(obj, id, handletype,objtype, cacheKey, signature_name, signature_id,relatedobj,dependantvariable,datetimevariable, tmp_width, tmp_height) {
    obj.toObject = (function (toObject) {
      return function () {
        return fabric.util.object.extend(toObject.call(this), {
          id: id,
          objtype: objtype,
          handletype:handletype,
          cacheKey: cacheKey,
          signature_name: signature_name,
          signature_id: signature_id,
          relatedobj: relatedobj,
          dependantvariable: dependantvariable,
          datetimevariable:datetimevariable,
          tmp_width: tmp_width,
          tmp_height: tmp_height
        });
      };
    })(obj.toObject);
  }
  extendimgsignature(obj, id, handletype,objtype, cacheKey, signature_name, signature_id) {
    obj.toObject = (function (toObject) {
      return function () {
        return fabric.util.object.extend(toObject.call(this), {
          id: id,
          objtype: objtype,
          handletype:handletype,
          cacheKey: cacheKey,
          signature_name: signature_name,
          signature_id: signature_id
        });
      };
    })(obj.toObject);
  }
  extendbarcode(obj, id, objtype,cacheKey,barcode_val0, barcode_val,label_name,label_type,tmp_width,tmp_height) {
    obj.toObject = (function (toObject) {
      return function () {
        return fabric.util.object.extend(toObject.call(this), {
          id: id,
          objtype: objtype,
          cacheKey: cacheKey,
          barcode_val0: barcode_val0,
          barcode_val: barcode_val,
          label_name: label_name,
          label_type: label_type,
          tmp_width: tmp_width,
          tmp_height: tmp_height
        });
      };
    })(obj.toObject);
  }
  extend1(obj, id, objtype, objsampledata, objtext, objcategory, breakWords,linkURL) {
    obj.toObject = (function (toObject) {
      return function () {
        return fabric.util.object.extend(toObject.call(this), {
          id: id,
          objtype: objtype,
          objsampledata,
          objtext,
          objcategory,
          breakWords: breakWords,
          linkURL: linkURL
        });
      };
    })(obj.toObject);
  }
  extend0(obj, id, objtype, text) {
    obj.toObject = (function (toObject) {
      return function () {
        return fabric.util.object.extend(toObject.call(this), {
          id: id,
          objtype: objtype,
          text
        });
      };
    })(obj.toObject);
  }
  extend0hf(obj, id, objtype, text,allpage,curpageid) {
    obj.toObject = (function (toObject) {
      return function () {
        return fabric.util.object.extend(toObject.call(this), {
          id: id,
          objtype: objtype,
          text,
          allpage:allpage,
          curpageid: curpageid
        });
      };
    })(obj.toObject);
  }

  setCanvasImage() {
    let self = this;
    if (this.props.canvasImage) {
      this.tempobj.setBackgroundColor({ source: this.props.canvasImage, repeat: 'repeat' }, function () {
        // self.props.canvasFill = '';
        self.canvas.renderAll();
      });
    }
  }
 
  rasterizeSVG() {
  }
 
  modechange: any = "";
 
  btnSaveJsonClick() {
    var resJSONdata: any = [];
    var curTmplate = this.arrTemplateList[this.currPage - 1];//match page with object
    var resSVGdata: any;
    if (this.fbPageCanvas) {
      resJSONdata.push(this.fbPageCanvas);
      const page={
        "width":this.currenttmpwidth,
        "height":this.currenttmpheight
      }
      resJSONdata.push({"page":page});
      resSVGdata = this.fbPageCanvas.toSVG();
      var images = $('#imagepage1').attr('src');
      var obj = {
        "designproductid": this.naviDate.designid,//this.naviDate.designid,
        "templateid": curTmplate.templateid,
        "templatejson": JSON.stringify(resJSONdata),
        "templatexml": resSVGdata,
        "templatesvg":resSVGdata,
        "templatehtml": "",
        "css": "",
        "image":images,
        "margin_right":this.mcright,
        "margin_bottom":this.mcbottom,
        "margin_setting":this.mcsetting
      }
      // console.log("json transfer", obj)//singlePageSaveTemplate
      this.userService.singlePageSaveTemplate(obj).subscribe(data => {
        // console.log(data)
        this.toast.success('Successfully Saved', '', { progressBar: true });
        this.updateValue=false;
      })
      this.updateValue=false;
    }
    if (this.viewjson) {
      var pagedata = { "id": this.naviDate.designid, "mode": this.naviDate.tablename, "data": this.myHtml1 ? this.myHtml1 : this.viewjson };
      this.userService.submit_rulejsonurl(pagedata).subscribe(data => {
 
      });
    }
    //console.log("ee");
    if (this.viewsignaturejson) {
      var signdata = { "id": this.naviDate.designid, "mode": this.naviDate.tablename, "data": this.myHtml ? this.myHtml : this.viewsignaturejson };
      this.userService.submit_signjsonurls(signdata).subscribe(data => {
 
      });
    }
  //  this.tableDataJSON();
  if(this.modalRef!=undefined){
  this.modalRef.hide();
  }
  }
  btnSaveJsonClick0() {
    var resJSONdata: any = [];
    var resSVGdata: any;
    if (this.fbPageCanvas) {
      resJSONdata.push(this.fbPageCanvas);
      const page={
        "width":this.currenttmpwidth,
        "height":this.currenttmpheight
      }
      resJSONdata.push({"page":page});
      resSVGdata = this.fbPageCanvas.toSVG();
      var images = $('#imagepage1').attr('src');
      var curTmplate = this.arrTemplateList[this.currPage - 1];//match page with object
      var obj = {
        "designproductid": this.naviDate.designid,//this.naviDate.designid,
        "templateid": curTmplate.templateid,
        "templatejson": JSON.stringify(resJSONdata),
        "templatexml": resSVGdata,
        "templatesvg":resSVGdata,
        "templatehtml": "",
        "css": "",
        "image":images,
        "margin_right":this.mcright,
        "margin_bottom":this.mcbottom,
        "margin_setting":this.mcsetting
      }
      this.userService.singlePageSaveTemplate(obj).subscribe(data => {
        this.updateValue=false;
      })
      this.updateValue=false;
    }
  }
  // save svg
  SVGTemplateData: any;
  SVGtemp: any;
 
  btnHomeClick() {
    this.userService.currentUser.subscribe(
      (userData) => {
        if (userData)
          var userDetail: any = userData;
        var RoleType = userDetail['approle'];
        if (RoleType === "ADMIN") {
          this.router.navigate(['/admin/dashboard']);
        }
        if (RoleType === "CLIENT") {
          // this.router.navigate(['/client/clientdashboard/clientdashboardview']);
          if (this.naviDate.mode == "create") {
 
            this.router.navigate(['/client/managedocument/inprogressdocument']);
          }
          else if (this.naviDate.mode == "edit") {
            if (this.naviDate.routerpage == "inprogress") {
              this.router.navigate(['/client/managedocument/inprogressdocument']);
            }
            else if (this.naviDate.routerpage == "reedit") {
              this.router.navigate(['/client/managedocument/reeditdocument']);
            } else if (this.naviDate.routerpage == "submitted") {
              this.router.navigate(['/client/managedocument/submitteddocument']);
            } else if (this.naviDate.routerpage == "approved") {
              this.router.navigate(['/client/managedocument/approveddocument']);
            }
            else if (this.naviDate.routerpage == "allapproval") {
              this.router.navigate(['/client/clientdashboard/allapprovalpending']);
            }
            else if (this.naviDate.routerpage == "myapproval") {
              this.router.navigate(['/client/clientdashboard/approvalpending']);
            }
            else if (this.naviDate.routerpage == "approvalcompleted") {
              this.router.navigate(['/client/clientdashboard/approvalcompleted']);
            }
            else if (this.naviDate.routerpage == "staging_pro") {
              this.router.navigate(['/client/masterlibrary/stagingproduction']);
            }
            else if (this.naviDate.routerpage == "businessunit_doc") {
              this.router.navigate(['/client/masterlibrary/businessunitdocument/']);
            }
            else if (this.naviDate.routerpage == "myallotment") {
              this.router.navigate(['/client/clientdashboard/myallotment']);
            }
            else if (this.naviDate.routerpage == "allalotment") {
              this.router.navigate(['/client/clientdashboard/allallotment']);
            }
          }
          else {
            this.router.navigate(['/client/clientdashboard/clientdashboardview']);
          }
 
        }
        else if (RoleType === "CUSTOMER") {
          this.router.navigate(['/customer']);
        } else {
          if (this.param.mode == "create") {
 
            this.router.navigate(['/client/managedocument/createnewdoc']);
          }
          else if (this.param.mode == "edit") {
            this.router.navigate(['/client/managedocument/inprogressdocument']);
          }
          else {
            this.router.navigate(['/client/clientdashboard/clientdashboardview']);
          }
        }
      }
    )
  }
  setSelWidth0() {
    if(this.selectedItem!='shape'){
      var elewidth:number;
      if(this.selectedProperty.tmp_width>this.selectedObj.tmp_width){
        elewidth=parseInt(this.selectedObj._originalElement.naturalWidth)+1
      }else{
        elewidth=parseInt(this.selectedObj._originalElement.naturalWidth)-1
      }
    var elWidth = this.selectedObj._originalElement.naturalWidth || this.selectedProperty.width;
               var scaleX = (this.selectedProperty.scaleX || 1) * elewidth / elWidth;
//               var scaleY = (this.selectedProperty.scaleY || 1) * this.selectedProperty.height / elHeight;
               this.selectedObj.set('tmp_width', this.selectedProperty.tmp_width);
              // this.selectedObj.set('height', elHeight);
               this.selectedObj.set('scaleX', scaleX);
               //this.selectedObj.set('scaleY', scaleY);
               if (this.seletecdPg > 0) {
                 var innPgCanvas = this.arrPageCanvas[this.seletecdPg - 1];
                 this.setObjectStyleforSelection();
                 innPgCanvas.renderAll();
               }
              }else{
                this.setSelWidth();
              }
              this.saveState();
  }
  setSelHeight0() {
    if(this.selectedItem!='shape'){
      var eleheight:number;
      if(this.selectedProperty.tmp_height>this.selectedObj.tmp_height){
        eleheight=parseInt(this.selectedObj._originalElement.naturalHeight)+1
      }else{
        eleheight=parseInt(this.selectedObj._originalElement.naturalHeight)-1
      }
               var elHeight = this.selectedObj._originalElement.naturalHeight || this.selectedProperty.height;
              // var scaleX = (this.selectedProperty.scaleX || 1) * this.selectedProperty.width / elWidth;
               var scaleY = (this.selectedProperty.scaleY || 1) * eleheight / elHeight;
            //   this.selectedObj.set('width', elWidth);
               this.selectedObj.set('tmp_height', this.selectedProperty.tmp_height);
              // this.selectedObj.set('scaleX', scaleX);
               this.selectedObj.set('scaleY', scaleY);
               if (this.seletecdPg > 0) {
                this.extendimgvar(this.selectedObj, this.selectedObj.id, this.selectedObj.objtype, this.selectedObj.cacheKey, this.selectedObj.imgvarvalue, this.selectedObj.tmp_width, this.selectedObj.tmp_height); 
                 var innPgCanvas = this.arrPageCanvas[this.seletecdPg - 1];
                 this.setObjectStyleforSelection();
                 innPgCanvas.renderAll();
               }
              }else{
                this.setSelHeight();
              }
              this.saveState();
  }
  setSelWidth() {
    const objectwhsize = $(".whchangeselected").html();
    if (this.selectedObj && this.selectedObj.type != 'group') {
    let objswidth = 0;
    if (objectwhsize == 'in') {
      objswidth = this.selectedProperty.width * 96;
    }
    if (objectwhsize == 'pt') {
      objswidth = this.selectedProperty.width * 1.33;
    }
    if (objectwhsize == 'pt') {
      objswidth = this.selectedProperty.width * 37.79;
    }
    if (objectwhsize == 'px') {
      objswidth = this.selectedProperty.width;
    }
      this.selectedObj.set('width', objswidth);
      if (this.seletecdPg > 0) {
        var innPgCanvas = this.arrPageCanvas[this.seletecdPg - 1];
        this.setObjectStyleforSelection();
        innPgCanvas.renderAll();
      }
    }
    this.saveState();
  }
  setSelMoveX() {
    if (this.selectedObj && this.selectedObj.type != 'group') {
      this.selectedObj.set('left', this.selectedProperty.left);
      if (this.seletecdPg > 0) {
        var innPgCanvas = this.arrPageCanvas[this.seletecdPg - 1];
        innPgCanvas.renderAll();
        this.setObjectStyleforSelection();
        this.renderLayers();
      }
    }
    this.saveState();
  }
  setSelMoveY() {
    if (this.selectedObj && this.selectedObj.type != 'group') {
      this.selectedObj.set('top', this.selectedProperty.top);
      if (this.seletecdPg > 0) {
        var innPgCanvas = this.arrPageCanvas[this.seletecdPg - 1];
        innPgCanvas.renderAll();
      }
    }
    this.saveState();
  }
  setSelHeight() {
    const objectwhsize = $(".whchangeselected").html();
    let objsheight = 0;
    if (objectwhsize == 'in') {
      objsheight = this.selectedProperty.height * 96;
    }
    if (objectwhsize == 'pt') {
      objsheight = this.selectedProperty.height * 1.33;
    }
    if (objectwhsize == 'cm') {
      objsheight = this.selectedProperty.height * 37.79;
    }
    if (objectwhsize == 'px') {
      objsheight = this.selectedProperty.height;
    }
    if (this.selectedObj && this.selectedObj.type != 'group') {
      this.selectedObj.set('height', objsheight);
      if(this.selectedObj.get('type')=="image"){
        var scaleY = (this.selectedObj.get('scaleY') || 1) * objsheight / this.selectedObj._originalElement.naturalHeight;
        this.selectedObj.set('scaleY', scaleY);
      }
      if (this.seletecdPg > 0) {
        var innPgCanvas = this.arrPageCanvas[this.seletecdPg - 1];
        innPgCanvas.renderAll();
      }
    }
    this.saveState();
  }
  objxyunit:any = 'px'
  objunit:any = 'px'
  changeobjectwh(e) {
    const objectwhsize = e;
    this.sizewhtype=e;
    const objw = $("#w").val();
    const objh = $("#h").val();
    let onjw,onjh;
    let objscw = 0;
    let objsch = 0;
    if(this.objunit == 'cm'){
      onjw = objw*37.79;
      onjh = objh*37.79;
    }else if(this.objunit == 'in'){
      onjw = objw *96;
      onjh = objh *96;
    }else if(this.objunit == 'pt'){
      onjw = objw/1.33;
      onjh = objh/1.33;
    }else{
      onjw = objw;
      onjh = objh;
    }
    if (objectwhsize == 'in') {
      objscw = onjw/96;
      objsch = onjh/96;
    }
    if (objectwhsize == 'pt') {
      objscw = onjw * 1.33;
      objsch = onjh * 1.33;
    }
    if (objectwhsize == 'cm') {
      objscw = onjw/37.79;
      objsch = onjh/37.79;
    }
    if (objectwhsize == 'px') {
      objscw = onjw;
      objsch = onjh;
    }
    this.objunit = objectwhsize
    if (this.selectedObj && this.selectedObj.type != 'group') {
      this.selectedProperty.width = objscw.toFixed(2)
      this.selectedProperty.height = objsch.toFixed(2)
    }
    this.saveState();
  }
  changeobjectxy(e) {
    const objectxysize = e;
    this.sizexytype=e;
    const objx = $("#x").val();
    const objy = $("#y").val();
    let onjx,onjy;
    let objscx = 0;
    let objscy = 0;
    if(this.objxyunit == 'cm'){
      onjx = objx*37.79;
      onjy = objy*37.79;
    }else if(this.objxyunit == 'in'){
      onjx = objx *96;
      onjy = objy *96;
    }else if(this.objxyunit == 'pt'){
      onjx = objx/1.33;
      onjy = objy/1.33;
    }else{
      onjx = objx;
      onjy = objy;
    }
    if (objectxysize == 'in') {
      objscx = onjx/96;
      objscy = onjy/96;
    }
    if (objectxysize == 'pt') {
      objscx = onjx*1.33;
      objscy = onjy*1.33;
    }
    if (objectxysize == 'cm') {
      objscx = onjx/37.79;
      objscy = onjy/37.79;
    }
    if (objectxysize == 'px') {
      objscx = onjx;
      objscy = onjy;
    }
    this.objxyunit = objectxysize
    if (this.selectedObj && this.selectedObj.type != 'group') {
      this.selectedProperty.top = objscx.toFixed(2)
      this.selectedProperty.left = objscy.toFixed(2)
         }
         this.saveState();
  }
  addsymbol(symbol) {
    const objtxt = this.selectedObj.get('text') + symbol;
    this.selectedObj.set('text', objtxt);
    if (this.seletecdPg > 0) {
      var innPgCanvas = this.arrPageCanvas[this.seletecdPg - 1];
      innPgCanvas.renderAll();
    }
    this.saveState();
  }
  Templateactions(e) {
    this.selectedItem='empty';
    var selectedval = e;
    this.tmpselect=selectedval;
    this.checkvariable();
   if (this.seletecdPg > 0) {
      var canvas = this.arrPageCanvas[this.seletecdPg - 1];
      if (canvas.getObjects()) {
        this.layers = canvas.getObjects();
        for (var i = 0; i < this.layers.length; i++) {
   var obj = canvas.item(i);
   if(obj.objtype!="header" && obj.objtype!="footer"){
     if (selectedval == 'Sample Data') {
            obj.set('visible', true);
            $(".eye_" + i).html('<i class="db fa fa-eye" aria-hidden="true" style="font-size: 11px !important;"></i>');
            if (this.layers[i].text && this.layers[i].text.slice(0, 1) != '<') {
              this.layers[i].text = this.layers[i].text+' ';
              this.layers[i].showTextBoxBorder=false;
            }
            if (this.layers[i].text && this.layers[i].objtype == 'stext' && this.layers[i].text.slice(0, 1) == '<') {
              if (this.layers[i].objsampledata) {
                this.layers[i].text = this.layers[i].objsampledata;
              }
            }
            this.layers[i].showTextBoxBorder=false;
          }
          else if (selectedval == 'Show Template') {
            if (this.layers[i].text && this.layers[i].text.slice(-1)==' '){
              this.layers[i].text = this.layers[i].text.slice(0, -1);
              }
            if (this.layers[i].objsampledata && this.layers[i].objtype == 'stext' && this.layers[i].objsampledata != '') {
              this.layers[i].text = '<<' + this.layers[i].objtext + '>>';
            }
            if (this.layers[i].text && this.layers[i].text.slice(0, 1) != '<' && this.layers[i].objtype != 'signature' && this.layers[i].objtype != 'imgvar' && this.layers[i].objtype != 'logo' && this.layers[i].objtype != 'barcode') {
              obj.set('visible', true);
              this.layers[i].text = ""+this.layers[i].text;
              $(".eye_" + i).html('<i class="db fa fa-eye" aria-hidden="true" style="font-size: 11px !important;"></i>');
            } else {
              obj.set('visible', false);
              $(".eye_" + i).html('<i class="db fa fa-eye-slash" aria-hidden="true" style="font-size: 11px !important;"></i>');
            }
            this.layers[i].showTextBoxBorder=true;
          }
          else if (selectedval == 'Show All') {
           obj.set('visible', true);
            $(".eye_" + i).html('<i class="db fa fa-eye" aria-hidden="true" style="font-size: 11px !important;"></i>');
            if (this.layers[i].text && this.layers[i].text.slice(-1)==' '){
             this.layers[i].text = this.layers[i].text.slice(0, -1);
              }
            if (this.layers[i].objsampledata && this.layers[i].objtype == 'stext' && this.layers[i].objsampledata != '') {
              this.layers[i].text = '<<' + this.layers[i].objtext + '>>';
            }
            this.layers[i].showTextBoxBorder=true;
          }
          else {
            obj.set('visible', true);
            this.layers[i].showTextBoxBorder=true;
            $(".eye_" + i).html('<i class="db fa fa-eye" aria-hidden="true" style="font-size: 11px !important;"></i>');
            if (this.layers[i].text && this.layers[i].text.slice(-1)==' '){
              this.layers[i].text = this.layers[i].text.slice(0, -1);
              }
            if (this.layers[i].objsampledata && this.layers[i].objtype == 'stext' && this.layers[i].objsampledata != '') {
              this.layers[i].text = '<<' + this.layers[i].objtext + '>>';
            }
          }
        }
        }
      }
    }
    var innPgCanvas = this.arrPageCanvas[this.seletecdPg - 1];
    innPgCanvas.renderAll();
  }
  setSelItemOpacity() {
    if (this.selectedObj && this.selectedObj.type != 'group') {
      if (this.selectedObj.selectionStart == this.selectedObj.selectionEnd)
        this.selectedObj.set('opacity', parseInt(this.selectedProperty.opacity) / 100);
      else
        this.selectedObj.setSelectionStyles({ opacity: parseInt(this.selectedProperty.opacity) / 100 },this.selectedObj.selectionStart,this.selectedObj.selectionEnd);
      if (this.seletecdPg > 0) {
        var innPgCanvas = this.arrPageCanvas[this.seletecdPg - 1];
        innPgCanvas.renderAll();
      }
    }
    this.saveState();
  }
 
  setSelItemStroke() {
    if (this.selectedObj && this.selectedObj.type != 'group') {
      if (this.selectedObj.selectionStart == this.selectedObj.selectionEnd)
        this.selectedObj.set('stroke', this.selectedProperty.stroke);
      else
        this.selectedObj.setSelectionStyles({ stroke: this.selectedProperty.stroke },this.selectedObj.selectionStart,this.selectedObj.selectionEnd);
      if (this.seletecdPg > 0) {
        var innPgCanvas = this.arrPageCanvas[this.seletecdPg - 1];
        innPgCanvas.renderAll();
      }
    }
    this.saveState();
  }
 
  setSelItemStWidth() {
    if (this.selectedObj && this.selectedObj.type != 'group') {
      if (this.selectedObj.selectionStart == this.selectedObj.selectionEnd)
        this.selectedObj.set('strokeWidth', this.selectedProperty.strokeWidth);
      else
        this.selectedObj.setSelectionStyles({ strokeWidth: this.selectedProperty.strokeWidth },this.selectedObj.selectionStart,this.selectedObj.selectionEnd);
      if (this.seletecdPg > 0) {
        var innPgCanvas = this.arrPageCanvas[this.seletecdPg - 1];
        innPgCanvas.renderAll();
      }
    }
    this.saveState();
  }
 
  setSelItemFill() {
    if (this.selectedObj && this.selectedObj.type != 'group') {
      if (this.selectedObj.selectionStart == this.selectedObj.selectionEnd)
        this.selectedObj.set('fill', this.selectedProperty.fill);
      else
        this.selectedObj.setSelectionStyles({ fill: this.selectedProperty.fill },this.selectedObj.selectionStart,this.selectedObj.selectionEnd);
      if (this.seletecdPg > 0) {
        var innPgCanvas = this.arrPageCanvas[this.seletecdPg - 1];
        innPgCanvas.renderAll();
      }
    }
  }
 
  /// Events for text controls
  setSelItemTxtAlign(format) {
    if (this.selectedObj && this.selectedObj.type != 'group') {
      this.selectedProperty.textAlign = format;
      this.selectedObj.set('textAlign', this.selectedProperty.textAlign);
      if (this.seletecdPg > 0) {
        var innPgCanvas = this.arrPageCanvas[this.seletecdPg - 1];
        innPgCanvas.renderAll();
      }
    }
  }
 
  setSelItemBold() {
    var innPgCanvas = this.arrPageCanvas[this.seletecdPg - 1];
    if (this.selectedObj && this.selectedObj.type != 'group') {
      this.selectedObj.fontWeight = !this.selectedObj.fontWeight;
      if (this.selectedObj.selectionStart == this.selectedObj.selectionEnd){
        this.selectedObj.set('fontWeight', this.selectedProperty.fontWeight!='bold' ? 'bold' : 'normal');
          this.selectedObj.set('styles', {}); 
        if (this.seletecdPg > 0) {
          innPgCanvas.renderAll();
        }
      }
      else{
      if(JSON.stringify(this.layer3[0].styles)!='{}'){          var sposition=this.selectedObj.selectionStart;
        var style=this.layer3[0].styles[0];
      }
        if(JSON.stringify(this.layer3[0].styles)=='{}'){
          this.fontweight()
       } 
         else if(style[sposition]==undefined || style[sposition].fontWeight!='bold'){
          this.fontweight() }
         else{
        this.selectedObj.setSelectionStyles({ fontWeight:'normal'},this.selectedObj.selectionStart,this.selectedObj.selectionEnd);
        this.selectedObj.set('fontWeight', 'normal');
      }
        if (this.seletecdPg > 0) {
            innPgCanvas.renderAll();
          }
      }
      this.setObjectStyleforSelection();
    }
    this.saveState();
  }
 fontweight(){
  this.selectedObj.set('fontWeight', 'normal');
  this.selectedObj.setSelectionStyles({fontWeight:'bold'},this.selectedObj.selectionStart,this.selectedObj.selectionEnd);
 }
  setSelItemFontStyle() { //fontStyle
    var innPgCanvas = this.arrPageCanvas[this.seletecdPg - 1];
    if (this.selectedObj && this.selectedObj.type != 'group') {
      this.selectedObj.fontStyle = !this.selectedObj.fontStyle;
      if (this.selectedObj.selectionStart == this.selectedObj.selectionEnd){
        this.selectedObj.set('fontStyle', this.selectedProperty.fontStyle!='italic' ? 'italic' : 'normal');
          this.selectedObj.set('styles', {}); 
        if (this.seletecdPg > 0) {
          innPgCanvas.renderAll();
        }
      }
      else{
      if(JSON.stringify(this.layer3[0].styles)!='{}'){          var sposition=this.selectedObj.selectionStart;
        var style=this.layer3[0].styles[0];
      }
        if(JSON.stringify(this.layer3[0].styles)=='{}'){
       this.fontstyle()
        } 
         else if(style[sposition]==undefined || style[sposition].fontStyle!='italic'){
        this.fontstyle(); }
         else{
        this.selectedObj.setSelectionStyles({ fontStyle:'normal'},this.selectedObj.selectionStart,this.selectedObj.selectionEnd);
        this.selectedObj.set('fontStyle', 'normal');
      }
        if (this.seletecdPg > 0) {
            innPgCanvas.renderAll();
          }
      }
      this.setObjectStyleforSelection();
    }
    this.saveState()
  }
 fontstyle(){
  this.selectedObj.set('fontStyle', 'normal');
  this.selectedObj.setSelectionStyles({ fontStyle:'italic'},this.selectedObj.selectionStart,this.selectedObj.selectionEnd);
 }
 unlink() {
  var innPgCanvas = this.arrPageCanvas[this.seletecdPg - 1];
  if (this.selectedObj && this.selectedObj.type != 'group') {
    if (this.selectedObj.selectionStart == this.selectedObj.selectionEnd){
      this.selectedObj.set('linkURL', '');
        this.selectedObj.set('styles', {}); 
      if (this.seletecdPg > 0) {
        this.selectedObj.setSelectionStyles({ fill:'#000000'},this.selectedObj.selectionStart,this.selectedObj.selectionEnd);
        innPgCanvas.renderAll();
      }
    }
    else{
      if(JSON.stringify(this.layer3[0].styles)!='{}'){          var sposition=this.selectedObj.selectionStart;
        var style=this.layer3[0].styles[0];
      }
        if(JSON.stringify(this.layer3[0].styles)=='{}'){
          this.selectedObj.setSelectionStyles({ linkURL:''},this.selectedObj.selectionStart,this.selectedObj.selectionEnd);
         } 
         else if(style[sposition]==undefined || style[sposition].linkURL==''){
          this.selectedObj.setSelectionStyles({ linkURL:''},this.selectedObj.selectionStart,this.selectedObj.selectionEnd);
        }
         else{
        this.selectedObj.setSelectionStyles({ linkURL:''},this.selectedObj.selectionStart,this.selectedObj.selectionEnd);
      }
      this.selectedObj.set('linkURL', '');
        if (this.seletecdPg > 0) {
          this.selectedObj.setSelectionStyles({ fill:'#000000'},this.selectedObj.selectionStart,this.selectedObj.selectionEnd);
           innPgCanvas.renderAll();
          }
    }
    this.setObjectStyleforSelection();
  }
  this.activehurl='';
}
  setSelItemUnderline() {
    var innPgCanvas = this.arrPageCanvas[this.seletecdPg - 1];
    if (this.selectedObj && this.selectedObj.type != 'group') {
      this.selectedObj.underline = !this.selectedObj.underline;
      if (this.selectedObj.selectionStart == this.selectedObj.selectionEnd){
        if(this.selectedProperty.underline!==true){
        this.selectedObj.set('underline', true);
        }else{
        this.selectedObj.set('underline', false);
        }
          this.selectedObj.set('styles', {}); 
        if (this.seletecdPg > 0) {
          innPgCanvas.renderAll();
        }
      }
      else{
        if(JSON.stringify(this.layer3[0].styles)!='{}'){          var sposition=this.selectedObj.selectionStart;
          var style=this.layer3[0].styles[0];
        }
          if(JSON.stringify(this.layer3[0].styles)=='{}'){
this.underline();
           } 
           else if(style[sposition]==undefined || style[sposition].underline!==true){
        this.underline();
          }
           else{
          this.selectedObj.setSelectionStyles({ underline:false},this.selectedObj.selectionStart,this.selectedObj.selectionEnd);
          this.selectedObj.set('underline', false);
        }
          if (this.seletecdPg > 0) {
             innPgCanvas.renderAll();
            }
      }
      this.setObjectStyleforSelection();
    }
  }
 underline(){
  this.selectedObj.set('underline', false);
  this.selectedObj.setSelectionStyles({ underline:true},this.selectedObj.selectionStart,this.selectedObj.selectionEnd);
 }
 sethyperlink() {
//   console.log(this.activehurl);
  var innPgCanvas = this.arrPageCanvas[this.seletecdPg - 1];
  if (this.selectedObj && this.selectedObj.type != 'group' && this.activehurl!='') {
    this.selectedObj.linkURL = !this.selectedObj.linkURL;
    if (this.selectedObj.selectionStart == this.selectedObj.selectionEnd){
   //   if(this.selectedProperty.linkURL==''){
      this.selectedObj.set('linkURL', this.activehurl);
      this.selectedObj.set('styles', {});
      /*else{
        this.selectedObj.set('linethrough', true); 
        this.selectedObj.set('styles', {});
      }*/
      if (this.seletecdPg > 0) {
        this.selectedObj.setSelectionStyles({ fill:'rgba(0,0,255,1)'},this.selectedObj.selectionStart,this.selectedObj.selectionEnd);
        innPgCanvas.renderAll();
      }
    }
    else{
      if(JSON.stringify(this.layer3[0].styles)!='{}'){         
         var sposition=this.selectedObj.selectionStart;
        var style=this.layer3[0].styles[0];
      }
        if(JSON.stringify(this.layer3[0].styles)=='{}'){
       this.linkurl();
        } 
         else if(style[sposition]==undefined || style[sposition].linkURL!=''){
        this.linkurl()
        }
         else{
        this.selectedObj.setSelectionStyles({ linkURL:this.activehurl},this.selectedObj.selectionStart,this.selectedObj.selectionEnd);
        this.selectedObj.set('linkURL', '');
      }
        if (this.seletecdPg > 0) {
          this.selectedObj.setSelectionStyles({ fill:'rgba(0,0,255,1)'},this.selectedObj.selectionStart,this.selectedObj.selectionEnd);
            innPgCanvas.renderAll();
          }
      }
      this.modalRef.hide();
//        this.setObjectStyleforSelection();
  }
  this.activehurl='';
}
  setSelItemOverline() {
    var innPgCanvas = this.arrPageCanvas[this.seletecdPg - 1];
    if (this.selectedObj && this.selectedObj.type != 'group') {
      this.selectedObj.linethrough = !this.selectedObj.linethrough;
      if (this.selectedObj.selectionStart == this.selectedObj.selectionEnd){
        if(this.selectedProperty.linethrough===true){
        this.selectedObj.set('linethrough', false);
        this.selectedObj.set('styles', {});
        }else{
          this.selectedObj.set('linethrough', true); 
          this.selectedObj.set('styles', {});
        }
        if (this.seletecdPg > 0) {
          innPgCanvas.renderAll();
        }
      }
      else{
        if(JSON.stringify(this.layer3[0].styles)!='{}'){         
           var sposition=this.selectedObj.selectionStart;
          var style=this.layer3[0].styles[0];
        }
          if(JSON.stringify(this.layer3[0].styles)=='{}'){
         this.linethrough();
          } 
           else if(style[sposition]==undefined || style[sposition].linethrough!==true){
          this.linethrough()
          }
           else{
          this.selectedObj.setSelectionStyles({ linethrough:false},this.selectedObj.selectionStart,this.selectedObj.selectionEnd);
          this.selectedObj.set('linethrough', false);
        }
          if (this.seletecdPg > 0) {
              innPgCanvas.renderAll();
            }
        }
//        this.setObjectStyleforSelection();
    }
 }
linethrough(){
  this.selectedObj.set('linethrough', false);
  this.selectedObj.setSelectionStyles({ linethrough:true},this.selectedObj.selectionStart,this.selectedObj.selectionEnd);
}
linkurl(){
  this.selectedObj.set('linkURL', '');
  this.selectedObj.setSelectionStyles({ linkURL:this.activehurl},this.selectedObj.selectionStart,this.selectedObj.selectionEnd);
}
  setSelItemFontFamily(e) {
    if (this.selectedObj && this.selectedObj.type != 'group') {
      if (this.selectedObj.selectionStart == this.selectedObj.selectionEnd)
        this.selectedObj.set('fontFamily', e);
      else
        this.selectedObj.setSelectionStyles({ fontFamily: e },this.selectedObj.selectionStart,this.selectedObj.selectionEnd);
      if (this.seletecdPg > 0) {
        var innPgCanvas = this.arrPageCanvas[this.seletecdPg - 1];
        innPgCanvas.renderAll();
        this.setObjectStyleforSelection();
      }
    }
  }
 
  setSelItemFontSize(e) {
    if (this.selectedObj && this.selectedObj.type != 'group') {
      if (this.selectedObj.selectionStart == this.selectedObj.selectionEnd)
        this.selectedObj.set('fontSize', e);
      else
        this.selectedObj.setSelectionStyles({ fontSize: e},this.selectedObj.selectionStart,this.selectedObj.selectionEnd);
      if (this.seletecdPg > 0) {
        var innPgCanvas = this.arrPageCanvas[this.seletecdPg - 1];
        innPgCanvas.renderAll();
        this.setObjectStyleforSelection();
      }
    }
  }
  changestrokesize() {
   this.setSelItemStWidth();
  }
  changestrokeradius() {
    if (this.selectedObj && this.selectedObj.type != 'group') {
      if (this.selectedObj.selectionStart == this.selectedObj.selectionEnd) {
        this.selectedObj.set('rx', this.selectedProperty.rx);
        this.selectedObj.set('ry', this.selectedProperty.rx);
      }
      else {
        this.selectedObj.setSelectionStyles({ rx: this.selectedProperty.rx },this.selectedObj.selectionStart,this.selectedObj.selectionEnd);
      }
      if (this.seletecdPg > 0) {
        var innPgCanvas = this.arrPageCanvas[this.seletecdPg - 1];
        innPgCanvas.renderAll();
      }
    }
  }
  setSelItemStrokecolor() {
  this.setSelItemStroke();  }
  setSelItemFillcolor() {
  this.setSelItemFill();
  }
  rotateobj(e){
    if (this.selectedObj && this.selectedObj.type != 'group') {
      if (this.selectedObj.selectionStart == this.selectedObj.selectionEnd)
        this.selectedObj.set('angle', e.target.value);
      else
        this.selectedObj.setSelectionStyles({ angle: e.target.value },this.selectedObj.selectionStart,this.selectedObj.selectionEnd);
      if (this.seletecdPg > 0) {
        var innPgCanvas = this.arrPageCanvas[this.seletecdPg - 1];
        innPgCanvas.renderAll();
      }
    }
    this.selectedProperty.angle=e.target.value;
  }
  setSelItemLineHeight() {
    if (this.selectedObj && this.selectedObj.type != 'group') {
      if (this.selectedObj.selectionStart == this.selectedObj.selectionEnd)
        this.selectedObj.set('lineHeight', parseFloat(this.selectedProperty.lineHeight));
      else
        this.selectedObj.setSelectionStyles({ lineHeight: parseFloat(this.selectedProperty.lineHeight) },this.selectedObj.selectionStart,this.selectedObj.selectionEnd);
      if (this.seletecdPg > 0) {
        var innPgCanvas = this.arrPageCanvas[this.seletecdPg - 1];
        innPgCanvas.renderAll();
      }
    }
  }//
 
  setSelItemCharSpacing() {
    if (this.selectedObj && this.selectedObj.type != 'group') {
      if (this.selectedObj.selectionStart == this.selectedObj.selectionEnd)
        this.selectedObj.set('charSpacing', parseFloat(this.selectedProperty.charSpacing));
      else
        this.selectedObj.setSelectionStyles({ charSpacing: parseFloat(this.selectedProperty.charSpacing) },this.selectedObj.selectionStart,this.selectedObj.selectionEnd);
      if (this.seletecdPg > 0) {
        var innPgCanvas = this.arrPageCanvas[this.seletecdPg - 1];
        innPgCanvas.renderAll();
      }
    }
  }
 
  sjson1: any = [
    {
      "version": "2.5.0",
      "objects": [
        {
          "type": "textbox",
          "version": "2.5.0",
          "originX": "left",
          "originY": "top",
          "left": 132.83,
          "top": 66,
          "width": 1105,
          "height": 113,
          "fill": "rgb(240,163,40)",
          "stroke": null,
          "strokeWidth": 1,
          "strokeDashArray": null,
          "strokeLineCap": "butt",
          "strokeDashOffset": 0,
          "strokeLineJoin": "miter",
          "strokeMiterLimit": 4,
          "angle": 0,
          "flipX": false,
          "flipY": false,
          "opacity": 1,
          "shadow": null,
          "visible": true,
          "clipTo": null,
          "backgroundColor": "",
          "fillRule": "nonzero",
          "paintFirst": "fill",
          "globalCompositeOperation": "source-over",
          "transformMatrix": null,
          "skewX": 0,
          "skewY": 0,
          "text": "The Day Before Surgery",
          "fontSize": 100,
          "rx": 0,
          "ry": 0,
          "fontWeight": "",
          "fontFamily": "Helvetica",
          "fontStyle": "normal",
          "lineHeight": 1.16,
          "underline": false,
          "overline": false,
          "linethrough": false,
          "textAlign": "left",
          "textBackgroundColor": "",
          "charSpacing": 0,
          "minWidth": 20,
          "styles": {},
          "id": 716169
        },
        {
          "type": "textbox",
          "version": "2.5.0",
          "originX": "left",
          "originY": "top",
          "left": 167,
          "top": 123,
          "width": 906.29,
          "height": 40.68,
          "fill": "#000000",
          "stroke": null,
          "strokeWidth": 1,
          "strokeDashArray": null,
          "strokeLineCap": "butt",
          "strokeDashOffset": 0,
          "strokeLineJoin": "miter",
          "strokeMiterLimit": 4,
          "angle": 0,
          "rx": 0,
          "ry": 0,
          "flipX": false,
          "flipY": false,
          "opacity": 1,
          "shadow": null,
          "visible": true,
          "clipTo": null,
          "backgroundColor": "",
          "fillRule": "nonzero",
          "paintFirst": "fill",
          "globalCompositeOperation": "source-over",
          "transformMatrix": null,
          "skewX": 0,
          "skewY": 0,
          "text": "Learn about what you need to do the day before surgery.",
          "fontSize": 36,
          "fontWeight": "",
          "fontFamily": "Helvetica",
          "fontStyle": "normal",
          "lineHeight": 1.16,
          "underline": false,
          "overline": false,
          "linethrough": false,
          "textAlign": "left",
          "textBackgroundColor": "",
          "charSpacing": 0,
          "minWidth": 20,
          "styles": {},
          "id": 462964
        },
        {
          "type": "textbox",
          "version": "2.5.0",
          "originX": "left",
          "originY": "top",
          "left": 36.65,
          "top": 235,
          "width": 1553.24,
          "height": 276.62,
          "fill": "#000000",
          "stroke": null,
          "strokeWidth": 1,
          "rx": 0,
          "ry": 0,
          "strokeDashArray": null,
          "strokeLineCap": "butt",
          "strokeDashOffset": 0,
          "strokeLineJoin": "miter",
          "strokeMiterLimit": 4,
          "angle": 0,
          "flipX": false,
          "flipY": false,
          "opacity": 1,
          "shadow": null,
          "visible": true,
          "clipTo": null,
          "backgroundColor": "",
          "fillRule": "nonzero",
          "paintFirst": "fill",
          "globalCompositeOperation": "source-over",
          "transformMatrix": null,
          "skewX": 0,
          "skewY": 0,
          "text": "         Leave jewelry, valuables, and large amounts of money at home. \n         Remove makeup before your procedure. \n         Do not use deodorant, body lotion or essential oils.You will receive a call \n          the day before surgery (or Friday if surgery is Monday) and will be given\n          instructions,what time your procedure is scheduled, what time to arrive at\n          the hospital, and where to come the day of surgery.",
          "fontSize": 36,
          "fontWeight": "",
          "fontFamily": "Helvetica",
          "fontStyle": "normal",
          "lineHeight": 1.16,
          "underline": false,
          "overline": false,
          "linethrough": false,
          "textAlign": "left",
          "textBackgroundColor": "",
          "charSpacing": 0,
          "minWidth": 20,
          "styles": {
            "2": {}
          }
        },
        {
          "type": "textbox",
          "version": "2.5.0",
          "originX": "left",
          "originY": "top",
          "left": 46.33,
          "top": 197,
          "width": 1167.01,
          "height": 49.72,
          "fill": "#000000",
          "stroke": null,
          "strokeWidth": 1,
          "rx": 0,
          "ry": 0,
          "strokeDashArray": null,
          "strokeLineCap": "butt",
          "strokeDashOffset": 0,
          "strokeLineJoin": "miter",
          "strokeMiterLimit": 4,
          "angle": 0,
          "flipX": false,
          "flipY": false,
          "opacity": 1,
          "shadow": null,
          "visible": true,
          "clipTo": null,
          "backgroundColor": "",
          "fillRule": "nonzero",
          "paintFirst": "fill",
          "globalCompositeOperation": "source-over",
          "transformMatrix": null,
          "skewX": 0,
          "skewY": 0,
          "text": "Find Out Your Arrival Time at the Hospital",
          "fontSize": 44,
          "fontWeight": "",
          "fontFamily": "Helvetica",
          "fontStyle": "normal",
          "lineHeight": 1.16,
          "underline": false,
          "overline": false,
          "linethrough": false,
          "textAlign": "left",
          "textBackgroundColor": "",
          "charSpacing": 0,
          "minWidth": 20,
          "styles": {
            "0": {
              "0": {
                "fontWeight": "bold"
              },
              "1": {
                "fontWeight": "bold"
              },
              "2": {
                "fontWeight": "bold"
              },
              "3": {
                "fontWeight": "bold"
              },
              "4": {
                "fontWeight": "bold"
              },
              "5": {
                "fontWeight": "bold"
              },
              "6": {
                "fontWeight": "bold"
              },
              "7": {
                "fontWeight": "bold"
              },
              "8": {
                "fontWeight": "bold"
              },
              "9": {
                "fontWeight": "bold"
              },
              "10": {
                "fontWeight": "bold"
              },
              "11": {
                "fontWeight": "bold"
              },
              "12": {
                "fontWeight": "bold"
              },
              "13": {
                "fontWeight": "bold"
              },
              "14": {
                "fontWeight": "bold"
              },
              "15": {
                "fontWeight": "bold"
              },
              "16": {
                "fontWeight": "bold"
              },
              "17": {
                "fontWeight": "bold"
              },
              "18": {
                "fontWeight": "bold"
              },
              "19": {
                "fontWeight": "bold"
              },
              "20": {
                "fontWeight": "bold"
              },
              "21": {
                "fontWeight": "bold"
              },
              "22": {
                "fontWeight": "bold"
              },
              "23": {
                "fontWeight": "bold"
              },
              "24": {
                "fontWeight": "bold"
              },
              "25": {
                "fontWeight": "bold"
              },
              "26": {
                "fontWeight": "bold"
              },
              "27": {
                "fontWeight": "bold"
              },
              "28": {
                "fontWeight": "bold"
              },
              "29": {
                "fontWeight": "bold"
              },
              "30": {
                "fontWeight": "bold"
              },
              "31": {
                "fontWeight": "bold"
              },
              "32": {
                "fontWeight": "bold"
              },
              "33": {
                "fontWeight": "bold"
              },
              "34": {
                "fontWeight": "bold"
              },
              "35": {
                "fontWeight": "bold"
              },
              "36": {
                "fontWeight": "bold"
              },
              "37": {
                "fontWeight": "bold"
              },
              "38": {
                "fontWeight": "bold"
              },
              "39": {
                "fontWeight": "bold"
              },
              "40": {
                "fontWeight": "bold"
              },
              "41": {
                "fontWeight": "bold"
              }
            }
          }
        },
        {
          "type": "textbox",
          "version": "2.5.0",
          "originX": "left",
          "originY": "top",
          "left": 46.33,
          "top": 404,
          "width": 1167.01,
          "height": 49.72,
          "fill": "#000000",
          "stroke": null,
          "strokeWidth": 1,
          "strokeDashArray": null,
          "strokeLineCap": "butt",
          "strokeDashOffset": 0,
          "strokeLineJoin": "miter",
          "strokeMiterLimit": 4,
          "angle": 0,
          "flipX": false,
          "flipY": false,
          "opacity": 1,
          "shadow": null,
          "visible": true,
          "clipTo": null,
          "backgroundColor": "",
          "fillRule": "nonzero",
          "paintFirst": "fill",
          "globalCompositeOperation": "source-over",
          "transformMatrix": null,
          "skewX": 0,
          "skewY": 0,
          "text": "Pack Your Bag - What to Bring to the Hospital",
          "fontSize": 44,
          "fontWeight": "",
          "fontFamily": "Helvetica",
          "fontStyle": "normal",
          "lineHeight": 1.16,
          "underline": false,
          "overline": false,
          "linethrough": false,
          "textAlign": "left",
          "textBackgroundColor": "",
          "charSpacing": 0,
          "minWidth": 20,
          "styles": {
            "0": {
              "0": {
                "fontWeight": "bold"
              },
              "1": {
                "fontWeight": "bold"
              },
              "2": {
                "fontWeight": "bold"
              },
              "3": {
                "fontWeight": "bold"
              },
              "4": {
                "fontWeight": "bold"
              },
              "5": {
                "fontWeight": "bold"
              },
              "6": {
                "fontWeight": "bold"
              },
              "7": {
                "fontWeight": "bold"
              },
              "8": {
                "fontWeight": "bold"
              },
              "9": {
                "fontWeight": "bold"
              },
              "10": {
                "fontWeight": "bold"
              },
              "11": {
                "fontWeight": "bold"
              },
              "12": {
                "fontWeight": "bold"
              },
              "13": {
                "fontWeight": "bold"
              },
              "14": {
                "fontWeight": "bold"
              },
              "15": {
                "fontWeight": "bold"
              },
              "16": {
                "fontWeight": "bold"
              },
              "17": {
                "fontWeight": "bold"
              },
              "18": {
                "fontWeight": "bold"
              },
              "19": {
                "fontWeight": "bold"
              },
              "20": {
                "fontWeight": "bold"
              },
              "21": {
                "fontWeight": "bold"
              },
              "22": {
                "fontWeight": "bold"
              },
              "23": {
                "fontWeight": "bold"
              },
              "24": {
                "fontWeight": "bold"
              },
              "25": {
                "fontWeight": "bold"
              },
              "26": {
                "fontWeight": "bold"
              },
              "27": {
                "fontWeight": "bold"
              },
              "28": {
                "fontWeight": "bold"
              },
              "29": {
                "fontWeight": "bold"
              },
              "30": {
                "fontWeight": "bold"
              },
              "31": {
                "fontWeight": "bold"
              },
              "32": {
                "fontWeight": "bold"
              },
              "33": {
                "fontWeight": "bold"
              },
              "34": {
                "fontWeight": "bold"
              },
              "35": {
                "fontWeight": "bold"
              },
              "36": {
                "fontWeight": "bold"
              },
              "37": {
                "fontWeight": "bold"
              },
              "38": {
                "fontWeight": "bold"
              },
              "39": {
                "fontWeight": "bold"
              },
              "40": {
                "fontWeight": "bold"
              },
              "41": {
                "fontWeight": "bold"
              },
              "42": {
                "fontWeight": "bold"
              },
              "43": {
                "fontWeight": "bold"
              },
              "44": {
                "fontWeight": "bold"
              }
            }
          }
        },
        {
          "type": "textbox",
          "version": "2.5.0",
          "originX": "left",
          "originY": "top",
          "left": 36.65,
          "top": 629,
          "width": 1167.01,
          "height": 49.72,
          "fill": "#000000",
          "stroke": null,
          "strokeWidth": 1,
          "rx": 0,
          "ry": 0,
          "strokeDashArray": null,
          "strokeLineCap": "butt",
          "strokeDashOffset": 0,
          "strokeLineJoin": "miter",
          "strokeMiterLimit": 4,
          "angle": 0,
          "flipX": false,
          "flipY": false,
          "opacity": 1,
          "shadow": null,
          "visible": true,
          "clipTo": null,
          "backgroundColor": "",
          "fillRule": "nonzero",
          "paintFirst": "fill",
          "globalCompositeOperation": "source-over",
          "transformMatrix": null,
          "skewX": 0,
          "skewY": 0,
          "text": "Special Instructions",
          "fontSize": 44,
          "fontWeight": "",
          "fontFamily": "Helvetica",
          "fontStyle": "normal",
          "lineHeight": 1.16,
          "underline": false,
          "overline": false,
          "linethrough": false,
          "textAlign": "left",
          "textBackgroundColor": "",
          "charSpacing": 0,
          "minWidth": 20,
          "styles": {
            "0": {
              "0": {
                "fontWeight": "bold"
              },
              "1": {
                "fontWeight": "bold"
              },
              "2": {
                "fontWeight": "bold"
              },
              "3": {
                "fontWeight": "bold"
              },
              "4": {
                "fontWeight": "bold"
              },
              "5": {
                "fontWeight": "bold"
              },
              "6": {
                "fontWeight": "bold"
              },
              "7": {
                "fontWeight": "bold"
              },
              "8": {
                "fontWeight": "bold"
              },
              "9": {
                "fontWeight": "bold"
              },
              "10": {
                "fontWeight": "bold"
              },
              "11": {
                "fontWeight": "bold"
              },
              "12": {
                "fontWeight": "bold"
              },
              "13": {
                "fontWeight": "bold"
              },
              "14": {
                "fontWeight": "bold"
              },
              "15": {
                "fontWeight": "bold"
              },
              "16": {
                "fontWeight": "bold"
              },
              "17": {
                "fontWeight": "bold"
              },
              "18": {
                "fontWeight": "bold"
              },
              "19": {
                "fontWeight": "bold"
              }
            }
          }
        },
        {
          "type": "textbox",
          "version": "2.5.0",
          "originX": "left",
          "originY": "top",
          "left": 30.02,
          "top": 667,
          "width": 1553.24,
          "height": 135.06,
          "fill": "#000000",
          "stroke": null,
          "strokeWidth": 1,
          "strokeDashArray": null,
          "strokeLineCap": "butt",
          "strokeDashOffset": 0,
          "strokeLineJoin": "miter",
          "strokeMiterLimit": 4,
          "angle": 0,
          "flipX": false,
          "flipY": false,
          "opacity": 1,
          "shadow": null,
          "visible": true,
          "clipTo": null,
          "backgroundColor": "",
          "fillRule": "nonzero",
          "paintFirst": "fill",
          "globalCompositeOperation": "source-over",
          "transformMatrix": null,
          "skewX": 0,
          "skewY": 0,
          "text": "          Leave jewelry, valuables, and large amounts of money at home.\n          Remove makeup before your procedure.\n          Do not use deodorant, body lotion or essential oils.",
          "fontSize": 36,
          "fontWeight": "",
          "fontFamily": "Helvetica",
          "fontStyle": "normal",
          "lineHeight": 1.16,
          "underline": false,
          "overline": false,
          "linethrough": false,
          "textAlign": "left",
          "textBackgroundColor": "",
          "charSpacing": 0,
          "minWidth": 20,
          "styles": {}
        },
        {
          "type": "textbox",
          "version": "2.5.0",
          "originX": "left",
          "originY": "top",
          "left": 30.02,
          "top": 438,
          "width": 1556.99,
          "height": 323.81,
          "fill": "#000000",
          "stroke": null,
          "strokeWidth": 1,
          "strokeDashArray": null,
          "strokeLineCap": "butt",
          "strokeDashOffset": 0,
          "strokeLineJoin": "miter",
          "strokeMiterLimit": 4,
          "angle": 0,
          "flipX": false,
          "flipY": false,
          "opacity": 1,
          "shadow": null,
          "visible": true,
          "clipTo": null,
          "backgroundColor": "",
          "fillRule": "nonzero",
          "paintFirst": "fill",
          "globalCompositeOperation": "source-over",
          "transformMatrix": null,
          "skewX": 0,
          "skewY": 0,
          "text": "          Personal hygiene items such as your toothbrush, deodorant, battery- operated razor and                so on\n          Loose fitting clothes (shorts, tops)\n          Flat shoes or tennis shoes with closed back\n          Copy of Advance Medical Directives (if you have one)\n          Insurance card, driver's license, or photo I.D.\n          Co-payment required by insurance company",
          "fontSize": 36,
          "fontWeight": "",
          "fontFamily": "Helvetica",
          "fontStyle": "normal",
          "lineHeight": 1.16,
          "underline": false,
          "overline": false,
          "linethrough": false,
          "textAlign": "left",
          "textBackgroundColor": "",
          "charSpacing": 0,
          "minWidth": 20,
          "styles": {}
        },
        {
          "type": "image",
          "version": "2.5.0",
          "originX": "left",
          "originY": "top",
          "left": 554.87,
          "top": 482,
          "width": 1920,
          "height": 1080,
          "fill": "rgb(0,0,0)",
          "stroke": null,
          "strokeWidth": 0,
          "strokeDashArray": null,
          "strokeLineCap": "butt",
          "strokeDashOffset": 0,
          "strokeLineJoin": "miter",
          "strokeMiterLimit": 4,
          "angle": 0,
          "flipX": false,
          "flipY": false,
          "opacity": 1,
          "shadow": null,
          "visible": true,
          "clipTo": null,
          "backgroundColor": "",
          "fillRule": "nonzero",
          "paintFirst": "fill",
          "globalCompositeOperation": "source-over",
          "transformMatrix": null,
          "skewX": 0,
          "skewY": 0,
          "crossOrigin": "",
          "cropX": 0,
          "cropY": 0,
          "src": "assets/designtool/broucher-img/bi7.jpg",
          "filters": [],
          "id": 306431
        }
      ], "background": "rgba(255,255,255,1)"
    }
  ]
  sjson2: any = [
    {
      "version": "2.5.0",
      "objects": [
        {
          "type": "textbox",
          "version": "2.5.0",
          "originX": "left",
          "originY": "top",
          "left": 109,
          "top": 85,
          "width": 1190.66,
          "height": 113,
          "fill": "rgb(255,194,97)",
          "stroke": null,
          "strokeWidth": 1,
          "strokeDashArray": null,
          "strokeLineCap": "butt",
          "strokeDashOffset": 0,
          "strokeLineJoin": "miter",
          "strokeMiterLimit": 4,
          "angle": 0,
          "flipX": false,
          "flipY": false,
          "opacity": 1,
          "shadow": null,
          "visible": true,
          "clipTo": null,
          "backgroundColor": "",
          "fillRule": "nonzero",
          "paintFirst": "fill",
          "globalCompositeOperation": "source-over",
          "transformMatrix": null,
          "skewX": 0,
          "skewY": 0,
          "text": "Advance Medical Directive",
          "fontSize": 100,
          "fontWeight": "",
          "fontFamily": "Helvetica",
          "fontStyle": "normal",
          "lineHeight": 1.16,
          "underline": false,
          "overline": false,
          "linethrough": false,
          "textAlign": "left",
          "textBackgroundColor": "",
          "charSpacing": 0,
          "minWidth": 20,
          "styles": {}
        },
        {
          "type": "textbox",
          "version": "2.5.0",
          "originX": "left",
          "originY": "top",
          "left": 34.41,
          "top": 163,
          "width": 861.83,
          "height": 229.44,
          "fill": "#000000",
          "stroke": null,
          "strokeWidth": 1,
          "strokeDashArray": null,
          "strokeLineCap": "butt",
          "strokeDashOffset": 0,
          "strokeLineJoin": "miter",
          "strokeMiterLimit": 4,
          "angle": 0,
          "flipX": false,
          "flipY": false,
          "opacity": 1,
          "shadow": null,
          "visible": true,
          "clipTo": null,
          "backgroundColor": "",
          "fillRule": "nonzero",
          "paintFirst": "fill",
          "globalCompositeOperation": "source-over",
          "transformMatrix": null,
          "skewX": 0,
          "skewY": 0,
          "text": "Advance Medical Directives are printed instructions that communicate your wishes regarding healthcare. As there are different directives, it is a good idea to consult your attorneyconcerning the legal implications of each. For example:",
          "fontSize": 36,
          "fontWeight": "",
          "fontFamily": "Helvetica",
          "fontStyle": "normal",
          "lineHeight": 1.16,
          "underline": false,
          "overline": false,
          "linethrough": false,
          "textAlign": "left",
          "textBackgroundColor": "",
          "charSpacing": 0,
          "minWidth": 20,
          "styles": {}
        },
        {
          "type": "textbox",
          "version": "2.5.0",
          "originX": "left",
          "originY": "top",
          "left": 64,
          "top": 294,
          "width": 1462.67,
          "height": 323.81,
          "fill": "#000000",
          "stroke": null,
          "strokeWidth": 1,
          "strokeDashArray": null,
          "strokeLineCap": "butt",
          "strokeDashOffset": 0,
          "strokeLineJoin": "miter",
          "strokeMiterLimit": 4,
          "angle": 0,
          "flipX": false,
          "flipY": false,
          "opacity": 1,
          "shadow": null,
          "visible": true,
          "clipTo": null,
          "backgroundColor": "",
          "fillRule": "nonzero",
          "paintFirst": "fill",
          "globalCompositeOperation": "source-over",
          "transformMatrix": null,
          "skewX": 0,
          "skewY": 0,
          "text": "A Living Will explains your wishes if you have a terminal condition, irreversible coma, and are unable  to communicate.\nAppointment of a Healthcare Agent (sometimes called a  Medical Power of Attorney) lets you name a person (your agent) to make medical decisions if you become unable to do so.\nHealthcare Instructions are your choices regarding use of life-sustaining equipment, hydration,      nutrition, and pain medications. If  you have an Advance Medical Directive, please bring a copy of the document with you to the  hospital.",
          "fontSize": 36,
          "fontWeight": "",
          "fontFamily": "Helvetica",
          "fontStyle": "normal",
          "lineHeight": 1.16,
          "underline": false,
          "overline": false,
          "linethrough": false,
          "textAlign": "left",
          "textBackgroundColor": "",
          "charSpacing": 0,
          "minWidth": 20,
          "styles": {}
        },
        {
          "type": "circle",
          "version": "2.5.0",
          "originX": "left",
          "originY": "top",
          "left": 44.51,
          "top": 310.67,
          "width": 100,
          "height": 100,
          "fill": "rgb(85,85,85)",
          "stroke": null,
          "strokeWidth": 1,
          "strokeDashArray": null,
          "strokeLineCap": "butt",
          "strokeDashOffset": 0,
          "strokeLineJoin": "miter",
          "strokeMiterLimit": 4,
          "angle": 180,
          "flipX": false,
          "flipY": false,
          "opacity": 1,
          "shadow": null,
          "visible": true,
          "clipTo": null,
          "backgroundColor": "",
          "fillRule": "nonzero",
          "paintFirst": "fill",
          "globalCompositeOperation": "source-over",
          "transformMatrix": null,
          "skewX": 0,
          "skewY": 0,
          "radius": 50,
          "startAngle": 0,
          "endAngle": 6.283185307179586,
          "id": 871176
        },
        {
          "type": "circle",
          "version": "2.5.0",
          "originX": "left",
          "originY": "top",
          "left": 44.51,
          "top": 356.1,
          "width": 100,
          "height": 100,
          "fill": "rgb(85,85,85)",
          "stroke": null,
          "strokeWidth": 1,
          "strokeDashArray": null,
          "strokeLineCap": "butt",
          "strokeDashOffset": 0,
          "strokeLineJoin": "miter",
          "strokeMiterLimit": 4,
          "angle": 180,
          "flipX": false,
          "flipY": false,
          "opacity": 1,
          "shadow": null,
          "visible": true,
          "clipTo": null,
          "backgroundColor": "",
          "fillRule": "nonzero",
          "paintFirst": "fill",
          "globalCompositeOperation": "source-over",
          "transformMatrix": null,
          "skewX": 0,
          "skewY": 0,
          "radius": 50,
          "startAngle": 0,
          "endAngle": 6.283185307179586
        },
        {
          "type": "circle",
          "version": "2.5.0",
          "originX": "left",
          "originY": "top",
          "left": 44.51,
          "top": 402.1,
          "width": 100,
          "height": 100,
          "fill": "rgb(85,85,85)",
          "stroke": null,
          "strokeWidth": 1,
          "strokeDashArray": null,
          "strokeLineCap": "butt",
          "strokeDashOffset": 0,
          "strokeLineJoin": "miter",
          "strokeMiterLimit": 4,
          "angle": 180,
          "flipX": false,
          "flipY": false,
          "opacity": 1,
          "shadow": null,
          "visible": true,
          "clipTo": null,
          "backgroundColor": "",
          "fillRule": "nonzero",
          "paintFirst": "fill",
          "globalCompositeOperation": "source-over",
          "transformMatrix": null,
          "skewX": 0,
          "skewY": 0,
          "radius": 50,
          "startAngle": 0,
          "endAngle": 6.283185307179586
        },
        {
          "type": "image",
          "version": "2.5.0",
          "originX": "left",
          "originY": "top",
          "left": 521.58,
          "top": 163,
          "width": 1100,
          "height": 734,
          "fill": "rgb(0,0,0)",
          "stroke": null,
          "strokeWidth": 0,
          "strokeDashArray": null,
          "strokeLineCap": "butt",
          "strokeDashOffset": 0,
          "strokeLineJoin": "miter",
          "strokeMiterLimit": 4,
          "angle": 0,
          "flipX": false,
          "flipY": false,
          "opacity": 1,
          "shadow": null,
          "visible": true,
          "clipTo": null,
          "backgroundColor": "",
          "fillRule": "nonzero",
          "paintFirst": "fill",
          "globalCompositeOperation": "source-over",
          "transformMatrix": null,
          "skewX": 0,
          "skewY": 0,
          "crossOrigin": "",
          "cropX": 0,
          "cropY": 0,
          "src": "./assets/designtool/broucher-img/bi55.jpg",
          "filters": [],
          "id": 772472
        },
        {
          "type": "textbox",
          "version": "2.5.0",
          "originX": "left",
          "originY": "top",
          "left": 34.41,
          "top": 476,
          "width": 1509.83,
          "height": 135.06,
          "fill": "#000000",
          "stroke": null,
          "strokeWidth": 1,
          "strokeDashArray": null,
          "strokeLineCap": "butt",
          "strokeDashOffset": 0,
          "strokeLineJoin": "miter",
          "strokeMiterLimit": 4,
          "angle": 0,
          "flipX": false,
          "flipY": false,
          "opacity": 1,
          "shadow": null,
          "visible": true,
          "clipTo": null,
          "backgroundColor": "",
          "fillRule": "nonzero",
          "paintFirst": "fill",
          "globalCompositeOperation": "source-over",
          "transformMatrix": null,
          "skewX": 0,
          "skewY": 0,
          "text": "If  you have an Advance Medical Directive, please bring a copy of the document with you to the  hospital.Advance Medical Directive\n",
          "fontSize": 36,
          "fontWeight": "",
          "fontFamily": "Helvetica",
          "fontStyle": "normal",
          "lineHeight": 1.16,
          "underline": false,
          "overline": false,
          "linethrough": false,
          "textAlign": "left",
          "textBackgroundColor": "",
          "charSpacing": 0,
          "minWidth": 20,
          "styles": {}
        }
      ], "background": "rgba(255,255,255,1)"
    }
  ]
 
  sjson3: any = [{ "version": "2.5.0", "objects": [{ "type": "textbox", "version": "2.5.0", "originX": "left", "originY": "top", "left": 326, "top": 68, "width": 161.18, "height": 113, "fill": "#000000", "stroke": null, "strokeWidth": 1, "strokeDashArray": null, "strokeLineCap": "butt", "strokeDashOffset": 0, "strokeLineJoin": "miter", "strokeMiterLimit": 4, "angle": 0, "flipX": false, "flipY": false, "opacity": 1, "shadow": null, "visible": true, "clipTo": null, "backgroundColor": "", "fillRule": "nonzero", "paintFirst": "fill", "globalCompositeOperation": "source-over", "transformMatrix": null, "skewX": 0, "skewY": 0, "text": "text", "fontSize": 100, "fontWeight": "", "fontFamily": "Helvetica", "fontStyle": "normal", "lineHeight": 1.16, "underline": false, "overline": false, "linethrough": false, "textAlign": "left", "textBackgroundColor": "", "charSpacing": 0, "minWidth": 20, "styles": {}, "id": 851626 }] }, { "version": "2.5.0", "objects": [{ "type": "rect", "version": "2.5.0", "originX": "left", "originY": "top", "left": 92, "top": 470, "width": 200, "height": 100, "fill": "#5d5386", "stroke": null, "strokeWidth": 1, "strokeDashArray": null, "strokeLineCap": "butt", "strokeDashOffset": 0, "strokeLineJoin": "miter", "strokeMiterLimit": 4, "angle": 0, "flipX": false, "flipY": false, "opacity": 1, "shadow": null, "visible": true, "clipTo": null, "backgroundColor": "", "fillRule": "nonzero", "paintFirst": "fill", "globalCompositeOperation": "source-over", "transformMatrix": null, "skewX": 0, "skewY": 0, "rx": 0, "ry": 0, "id": 35609 }] }]

  onDragStart(event) {
    event.dataTransfer.setData("dragObjId", event.target.id);
    if (event.target.src)
      event.dataTransfer.setData("imagePath", event.target.src);
    this.renderLayers();
  }
  onDragStartmulti(event, array, drag, catgoryname) {
    event.dataTransfer.setData("dragObjId", drag);
    event.dataTransfer.setData("cproperty", JSON.stringify(array.property));
    event.dataTransfer.setData("catname", catgoryname);
    this.renderLayers();
  }
  onDragStart0(event, name, index) {
    const val = name + '_' + index;
    event.dataTransfer.setData("dragObjId", val);
    this.renderLayers();
  }
  ondrag(event) {
    if (event.target.id == "brouch1")
      this.btnBrouch1Click()
    else if (event.target.id == "brouch2")
      this.btnBrouch2Click()
    else if (event.target.id == "brouch3")
      this.btnBrouch3Click()
  }
  onDragEnd(event) {
    // console.log("onDragEnd---->" + event.target.id);
 
  }
  onDragEnd0(event, name, index) {
    // console.log("onDragEndds---->" + name + '_' + index);
 
  }
  onDragOver(event) {
    // console.log("onDragOver");
  }
 
  onDragLeave(event) {
    // console.log("onDragLeave");
  }
 
  onDrop(event) {
    this.tmpselect='Show All';
  //  this.Templateactions(this.tmpselect);
    if (!this.editable) { return }
    event.preventDefault(); var data = event.dataTransfer.getData("dragObjId");
    var carray = event.dataTransfer.getData("cproperty");
    var catname = event.dataTransfer.getData("catname");
    const data0 = data.split('_')[1];
    if (data == 'image')
      this.imgpolar(event)
    else if (data == 'addtext01')
      this.dargText(event);
    else if (data == 'addtext06')
      this.dragaddText1(event);
    else if (data == 'addtext05')
      this.dragaddText2(event);
    else if (data == 'addtext04')
      this.dragtextbox(event);
    else if (data == 'datadictionary' + '_' + data0)
      this.dragtextbox00(event, data);
    else if (data == 'multidrag')
      this.multidrag(event, carray, catname);
    }
 
  dargText(e) {
    let textString = "Header Sample";
    let text = new fabric.Textbox(textString, {
      left: e.layerX,
      top: e.layerY,
      fontFamily: 'Helvetica',
      angle: 0,
      fill: '#000000',
      fontSize: 100,
      fontWeight: '',
      // fontStyle: normal,
      hasRotatingPoint: true,
      linkURL:''
    });
    this.extend(text, this.randomId(), text.type,text.linkURL);
    this.tempobj.add(text);
    this.selectItemAfterAdded(text);
    this.textString = '';
  }
  multidrag(event, carray, catname) {
    const carrays = JSON.parse(carray);
    let topspace = 0;
    for (var y = 0; y < carrays.length; y++) {
      var fontSize = carrays[y].style['fontSize'];
      var str00 = fontSize.slice(0, -2);
      let textString = '<<' + carrays[y].name + '>>';
      var str1=Math.round(str00 * 1.33);
      let text = new fabric.Textbox(textString, {
        left: event.layerX,
        top: event.layerY + topspace,
        width: 230,
        fontSize: str1,
        fill: carrays[y].style['fill'],
        textAlign: 'left',
        fontFamily: carrays[y].style['fontFamily'],
        fontWeight: carrays[y].style['fontWeight'],
        fontStyle:'normal',
        underline:'',
        overline:"",
        editingBorderColor: 'blue',
        showTextBoxBorder: true,
        textboxBorderColor: 'yellow',
        hasRotatingPoint: true,
        lockMovementX: false,
        linethrough: false,
        objtype: 'stext',
        breakWords: true,
        variable: ["" + carrays[y].name + ""],
        objsampledata: carrays[y].sampledata,
        objstyle: '',
        multidrag: true,
        objtext: carrays[y].name,
        objcategory: catname,
        linkURL:''
      });
      text.setControlsVisibility({
        bl: false,
        br: false,
        tl: false,
        tr: false,
        mt: false,
        mb: false,
        mtr: false,
        mr: true,
        ml: true
      });
      this.extend1(text, this.randomId(), text.objtype, text.objsampledata, text.objtext, text.objcategory, text.breakWords, text.linkURL);
      this.tempobj.add(text);
      this.selectItemAfterAdded(text);
      this.renderLayers();
      this.checksinglevariable();
      this.textString = '';
      topspace += 25;
    }
    this.renderLayers();
    var canvas = this.tempobj;
    this.layers1 = canvas.getObjects();
  }
  dragaddText3(e) {
  
    let textString = formatDate(new Date(), 'MM/dd/yyyy', 'en');
    let text = new fabric.Textbox(textString, {
      left: e.layerX,
      top: e.layerY,
      width: 90,
      fontSize: 16,
      linethrough: false,
      fontWeight: 'normal',
      fontStyle:"",
      underline:'',
      overline:"",
      textAlign: 'left',
      fontFamily: 'Arial',
      editingBorderColor: 'gray',
      showTextBoxBorder: true,
      textboxBorderColor: '#ffff7f',
      lockMovementX: false,
      hasRotatingPoint: false,
      editable: false,
      objtype: 'date',
    /*  borderColor: '#ffff7f',
  borderScaleFactor: 10,  
  textboxBorderScaleFactor: 10,  */
      breakWords: true,
      angle:0,
      id: this.randomId(),
      linkURL:'',
    });
    text.setControlsVisibility({
      bl: false,
      br: false,
      tl: false,
      tr: false,
      mt: false,
      mb: false,
      mtr: false,
      mr: false,
      ml: false
    });
    this.extendflow(text, text.id, 'date', true,text.linkURL);
    this.tempobj.add(text);
    this.selectItemAfterAdded(text);
    $('#dateassigned').val('');
    this.renderLayers();
    this.textString = ''; 
  }
  stampfpopup(e){
    var innPgCanvas = this.arrPageCanvas[this.seletecdPg - 1];
    const src = 'assets/images/designtool/sign/rubber_stamp.png';
    fabric.Image.fromURL(src, (image) => {
     image.set({
      left: e.layerX,
      top: e.layerY,
      opacity: 1,
      angle: 0,
      objtype: 'stamp',
      cacheKey: 'stamp',
      width: image.width,
      height: image.height,
      tmp_width: image.width,
      tmp_height: image.height,
      id: this.randomId()
    }).scale(0.9);
    image.setControlsVisibility({
      bl: true,
      br: true,
      tl: true,
      tr: true,
      mt: false,
      mb: false,
      mtr: false,
      mr: false,
      ml: false
    });
  this.extendstamp(image, image.id, image.objtype, image.tmp_width,image.tmp_height);
  innPgCanvas.add(image);
    innPgCanvas.setActiveObject(image).renderAll();
    this.renderLayers();
  });
    this.emptycontrols();
    this.gettimefun();  
  }
  dragtextbox00(e, data) {
    let ddval = $("#" + data).children('.ddval').html();
    let ddsampledata = $("#" + data).children('.objsampledata').html();
    const data0 = data.split('_')[1];
    for (var i = 0; i < this.mainpage.length; i++) {
      if (data0 == this.mainpage[i].propertyid) {
        this.objstyle = '';
        var fill = this.mainpage[i].style['fill'];
        var fontWeight = this.mainpage[i].style['fontWeight'];
        var fontFamily = this.mainpage[i].style['fontFamily'];
        var fontSize = this.mainpage[i].style['fontSize'];
        var str00 = fontSize.slice(0, -2);
        str00 = parseInt(str00)
        var str1=Math.round(str00 * 1.33);
      }
    }
    let textString = '<<' + ddval + '>>';
    let text = new fabric.Textbox(textString, {
      left: e.layerX,
      top: e.layerY,
      width: 230,
      fontSize: str1,
      fill: fill,
      textAlign: 'left',
      fontFamily: fontFamily,
      fontWeight: fontWeight,
      fontStyle:'normal',
      underline:'',
      linethrough: false,
      overline:"",
      editingBorderColor: 'blue',
      showTextBoxBorder: true,
      textboxBorderColor: 'yellow',
      lockMovementX: false,
      hasRotatingPoint: true,
      objtype: 'stext',
      breakWords: true,
      variable: ["" + ddval + ""],
      multidrag: true,
      objsampledata: ddsampledata,
      objstyle: this.objstyle,
      objtext: ddval,
      objcategory: this.currentfolder,
      angle: 0,
      linkURL:''
    });
    text.setControlsVisibility({
      bl: false,
      br: false,
      tl: false,
      tr: false,
      mt: false,
      mb: false,
      mtr: false,
      mr: true,
      ml: true
    });
    this.extend1(text, this.randomId(), text.objtype, text.objsampledata, text.objtext, text.objcategory, text.breakWords,text.linkURL);
    this.tempobj.add(text);
    //this.selectItemAfterAdded(text);
    this.renderLayers();
    this.checksinglevariable();
    this.textString = '';
    var canvas = this.tempobj;
    this.layers1 = canvas.getObjects();
  }
  dragaddText1(e) {
    let textString = "Type your text here...";
    let text = new fabric.Textbox(textString, {
      left: e.layerX,
      top: e.layerY,
      fontFamily: 'Arial',
      angle: 0,
      linethrough: false,
      translateX: 100,
      translateY: 100,
      fill: '#000000',
      width: 200,
      height: 200,
      textLength:"200",
      textAlign: 'left',
      fontSize: 15,
      fontWeight: 'normal',
      fontStyle:'normal',
      underline:'',
      overline:"",
      editingBorderColor: 'blue',
      showTextBoxBorder: true,
      textboxBorderColor: 'gray',
      hasRotatingPoint: true,
      variable: '',
      breakWords: false,
      objtype: 'flowpara',
      linkURL:''
    });
    text.setControlsVisibility({
      bl: true,
      br: true,
      tl: true,
      tr: true,
      mt: false,
      mb: false,
      mtr: false,
      mr: true,
      ml: true
    });
    this.extendflow(text, this.randomId(), 'flowpara', text.breakWords,text.linkURL);
    this.tempobj.add(text);
    this.selectItemAfterAdded(text);
    $('#addtext06').val('');
    this.renderLayers();
    this.textString = '';
  }
  dragaddText2(e) {
    let textString = "Add Label Text";
    let text = new fabric.Textbox(textString, {
      left: e.layerX,
      top: e.layerY,
      width: 150,
      fontSize: 16,
      linethrough: false,
      fontWeight: 'normal',
      fontStyle:"",
      underline:'',
      overline:"",
      textAlign: 'left',
      fontFamily: 'Arial',
      editingBorderColor: 'gray',
      showTextBoxBorder: true,
      textboxBorderColor: 'blue',
      lockMovementX: false,
      hasRotatingPoint: false,
      breakWords: true,
      objtype: 'slabel',
      linkURL: '',
      variable: '',
      angle:0
    });
    text.setControlsVisibility({
      bl: false,
      br: false,
      tl: false,
      tr: false,
      mt: false,
      mb: false,
      mtr: false,
      mr: true,
      ml: true
    });
    this.extend(text, this.randomId(), 'slabel', text.linkURL);
    this.tempobj.add(text);
    this.selectItemAfterAdded(text);
    $('#addtext05').val('');
    this.renderLayers();
    this.textString = '';
  }
  renderLayers() {
    $("#layers").html("");
    if (this.seletecdPg > 0) {
      var canvas = this.arrPageCanvas[this.seletecdPg - 1];
      if (canvas && canvas.getObjects()) {
        this.layers = canvas.getObjects();
       // console.log(this.layers)
        for (var i = 0; i < this.layers.length; i++) {
          canvas.item(i)['evented'] = this.editable;
        }
      }
    }
  }
  createdatadictionaryjson() {
    if (this.seletecdPg > 0) {
      var canvas = this.arrPageCanvas[this.seletecdPg - 1];
      if (canvas.getObjects()) {
        this.layers = canvas.getObjects();
        let tmpcategory = [];
        for (var i = 0; i < this.layers.length; i++) {
          if (this.layers[i].text && this.layers[i].objtype == 'stext' && this.layers[i].text.slice(0, 1) == '<') {
            if (this.layers[i].objcategory != '' && this.layers[i].objcategory != undefined) {
              tmpcategory.push(this.layers[i].objcategory);
            }
          }
        }
        var uniqueNames = [];
        $.each(tmpcategory, function (i, el) {
          if ($.inArray(el, uniqueNames) === -1) uniqueNames.push(el);
        });
      }
    }
    var catgoryarray = '';
    for (var val of uniqueNames) {
      var catgorydata = '';
      for (let i = 0; i < this.layers.length; i++) {
        if (this.layers[i].objcategory == val) {
          catgorydata += `{
              "name" : "`+ this.layers[i].objtext + `",
              "type" : "string",
              "length" : "99",
              "overflow" : "0",
              "sampledata" : "`+ this.layers[i].objsampledata + `",
              "isConstant" : "false"
        },`;
        }
      }
      catgorydata = catgorydata.slice(0, -1);
      catgoryarray += `{
      "name" : "`+ val + `",
      "element" : [
`+ catgorydata + `
      ]
    },`;
    }
    catgoryarray = catgoryarray.slice(0, -1);
    this.datadictionaryjson = `"group" : [` + catgoryarray + `]`;
  }
  closesignaturepopuptwo() {
    this.signaturepopuptwo = false;
    this.modalRef.hide();
  }
  contextmenu() {
    if (this.selectedObj && this.selectedObj.aCoords  &&  this.selectedObj.get('objtype') == "imgvar") {
      const x = Math.round(this.selectedObj.get('left') + 150) + 'px';
      const y = Math.round(this.selectedObj.get('top') + 40) + 'px';
      this.myStyles = {
        'background-color': 'white',
        'position': 'absolute',
        'padding': '4px 15px',
        'border': '1px solid gainsboro',
        'top': y,
        'left': x,
        'width': '200px',
        'z-index': '9999999999999'
      };
      this.showcontextmenu = true;
    }
    if (this.selectedObj && this.selectedObj.aCoords &&  this.selectedObj.get('objtype') == "barcode") {
      this.model = { option: '' + this.selectedObj.get('barcode_val0') + '' };
      const x = Math.round(this.selectedObj.get('left') + 250) + 'px';
      const y = Math.round(this.selectedObj.get('top') + 40) + 'px';
      this.myStyles = {
        'background-color': 'white',
        'position': 'absolute',
        'padding': '4px 15px',
        'border': '1px solid gainsboro',
        'top': y,
        'left': x,
        'width': '200px',
        'z-index': '9999999999999'
      };
      this.showcontextmenu = true;
    }
    if(this.layer3.length>1 && this.layer3[0].group && this.layer3[0].mouseMoveHandler!=''){
      const x = Math.round(this.layer3[0].group.left + 250) + 'px';
      const y = Math.round(this.layer3[0].group.top + 40) + 'px';
      this.myStyles = {
        'background-color': 'white',
        'position': 'absolute',
        'padding': '4px 15px',
        'border': '1px solid gainsboro',
        'top': y,
        'left': x,
        'width': '200px',
        'z-index': '9999999999999'
      };
      if(!this.signature_first_popup){
      this.showcontextmenugp=!this.showcontextmenugp;
      }
    }else{
      this.showcontextmenugp=false;
    }
  }
  createlines(){
    const oleft=(parseInt(this.activesignature.left)+parseInt(this.activesignature.width))-20;
    const otop=parseInt(this.activesignature.top)+parseInt(this.activesignature.height);
    var innPgCanvas = this.arrPageCanvas[this.seletecdPg - 1];
    for(var e=0;e<this.layer4[e].length;e++) {
    if (this.layer4[e].objtype!="signature") {
     var left1;
      var top1;
      if(oleft<this.layer4[e].left){
        left1=oleft;
      }else{
        left1=this.layer4[e].left;
      }
      if(otop<this.layer4[e].top){
        top1=otop;
      }else{
        top1=this.layer4[e].top;
      }
   let add = new fabric.Line([oleft, otop, this.layer4[e].left, this.layer4[e].top], ({
      left: left1, top: top1, fill: '#fff', id: this.randomId(), stroke: '#6EACAF', objtype: 'vline0', visible: false, strokeDashArray: [5, 5], strokeWidth: 1, text: this.activesignature.signature_id, angle: 0
    }));
    if (add) {
      this.extend0(add, add.id, add.objtype, add.text);
      innPgCanvas.add(add);
      var canvas = this.tempobj;
      canvas.sendBackwards(add);
      this.emptycontrols();
      this.renderLayers();
    }
  }
}
  }
  opentoolkitpopup(toolkitcreate){
    if (!this.editable) { return }
    this.modalRef = this.modalService.show(toolkitcreate, { class: 'modal-md', backdrop: 'static' });
  }
  openhyperlinkpopup(hyperlink){
    if (!this.editable) { return }
    this.modalRef = this.modalService.show(hyperlink, { class: 'modal-md', backdrop: 'static' });
  }
  showeditbarcodemenu(barcodes) {
    this.showcontextmenu = false;
    this.setObjectStyleforSelection();
    if (!this.editable) { return }
    this.modalRef = this.modalService.show(barcodes, { class: 'modal-md', backdrop: 'static' });
    this.ln=this.selectedProperty.label_name;
    this.lt=this.selectedProperty.label_type;
  }
  showeditcontextmenu(imgvar) {
    this.showcontextmenu = false;
    this.setObjectStyleforSelection();
    this.openModal0 = true;
    if (!this.editable) { return }
    this.modalRef = this.modalService.show(imgvar, { class: 'modal-md', backdrop: 'static' });
  }
  checkvariable() {
    var canvas = this.tempobj;
    this.layers1 = canvas.getObjects();
    for (var i = 0; i < this.layers1.length; i++) {
      if (this.layers1[i].objtype && this.layers1[i].objtype != 'imgvar' && this.layers1[i].objtype != 'barcode' && this.layers1[i].objtype != 'logo' && this.layers1[i].objtype != 'signature' && this.layers1[i].objtype != 'rect' && this.layers1[i].objtype != 'table' && this.layers1[i].objtype != 'vline' && this.layers1[i].objtype != 'hline' && this.layers1[i].objtype != 'ellipse' && this.layers1[i].objtype != 'circle') {
        var s = this.layers1[i].text;
if(this.layers1[i].text && this.layers1[i].text.slice(0, 1) == '<') {
        var arrStr = s.split(/[<<>>]/);
        this.arr = arrStr.filter(v => v != '');
        this.layers1[i].variable = this.arr;
}
        if (this.layers1[i].objtype == 'stext' && this.layers1[i].text && this.layers1[i].text.slice(0, 1) == '<') {
        //  var res = s.replace(/[^a-zA-Z ]/g, "");
          var obj = canvas.item(i);
          if (this.getitems != '' && this.getitems != undefined) {
           this.getitems.filter(x => {
              x.property.filter(y => {
                if (y.name == this.layers1[i].variable[0]) {
                  obj.set('objsampledata', y.sampledata);
                  obj.set('objcategory', x.itemname);
                  obj.set('objtext', y.name);
                  obj.set('fontWeight', y.style['fontWeight']);
                  obj.set('fill', y.style['fill']);
                  obj.set('fontFamily', y.style['fontFamily']);
                  obj.set('fontSize', Math.round(y.style['fontSize'].slice(0, -2)) * 1.33);
                }
              });
            });
          }
        }
      }
    }
 
  }
  checksinglevariable() {
    var canvas = this.tempobj;
    this.layers1 = canvas.getActiveObjects();
    if (this.layers1.objtype && this.layers1.objtype != 'imgvar' && this.layers1.objtype != 'logo' && this.layers1.objtype != 'signature' && this.layers1.objtype != 'rect' && this.layers1.objtype != 'table' && this.layers1.objtype != 'vline' && this.layers1.objtype != 'hline' && this.layers1.objtype != 'ellipse' && this.layers1.objtype != 'circle') {
      var s = this.layers1.text;
      var arrStr = s.split(/[<<>>]/);
      this.arr = arrStr.filter(v => v != '');
      this.layers1.variable = this.arr;
      if (this.layers1.objtype == 'stext' && this.layers1.text.slice(0, 1) == '<') {
       // var res = s.replace(/[^a-zA-Z ]/g, "");
 
        if (this.getitems != '' && this.getitems != undefined) {
          this.getitems.filter(x => {
            x.property.filter(y => {
              if (y.name ==  this.layers1.variable[0]) {
                this.layers1.set('objsampledata', y.sampledata);
                this.layers1.set('objcategory', x.itemname);
                this.layers1.set('objtext', y.name);
                this.layers1.set('fontWeight', y.style['fontWeight']);
                this.layers1.set('fill', y.style['fill']);
                this.layers1.set('fontFamily', y.style['fontFamily']);
                var str1=parseInt(y.style['fontSize'].slice(0, -2)) * 1.33;
                this.layers1.set('fontSize', str1);
              }
            });
          });
        }
      }
    }
 
 
  }
  activeLayers(index) {
    var canvas = this.tempobj;
    var obj = canvas.item(index);
    this.selectItemAfterAdded(obj);
    canvas.setActiveObject(obj);
  }
  lockunlockalllayer() {
    if (!this.editable) { return }
    var value = $('.alllock i').attr('class');
    if (value == 'fa fa-unlock') {
      $(".alllock").html('<i class="db fa fa-lock" aria-hidden="true" style="font-size: 11px !important;"></i>');
    } else {
      $(".alllock").html('<i class="db fa fa-unlock" aria-hidden="true" style="font-size: 11px !important;"></i>');
    }
    if (this.seletecdPg > 0) {
      var innPgCanvas = this.arrPageCanvas[this.seletecdPg - 1];
      for (var i = 0; i <= innPgCanvas.getObjects().length; i++) {
        this.lockunlocklayer(i);
      }
    }
  }
  lockunlockalllayer1() {
    if (!this.editable) { return }
    var value = $('.alllock i').attr('class');
    var canvas = this.tempobj;
      this.layers = canvas.getObjects();
      if(value=='fa fa-unlock'){
      for (var i = 0; i < this.layers.length; i++) {
        let obj = canvas.item(i);
        this.selectItemAfterAdded(obj);
        $(".lock_" + i).html('<i class="db fa fa-lock" aria-hidden="true" style="font-size: 11px !important;"></i>');
        this.selectedObj.set('lockMovementY', true);
        this.selectedObj.set('lockMovementX', true);
        this.selectedObj.set('lockScalingX', true);
        this.selectedObj.set('lockScalingY', true);
      }
    }else{
      for (let i = 0; i < this.layers.length; i++) {
        let obj = canvas.item(i);
        this.selectItemAfterAdded(obj);
        $(".lock_" + i).html('<i class="db fa fa-unlock" aria-hidden="true" style="font-size: 11px !important;"></i>');
        this.selectedObj.set('lockMovementY', false);
        this.selectedObj.set('lockMovementX', false);
        this.selectedObj.set('lockScalingX', false);
        this.selectedObj.set('lockScalingY', false);
      }
    }
    if (value == 'fa fa-unlock') {
      $(".alllock").html('<i class="db fa fa-lock" aria-hidden="true" style="font-size: 11px !important;"></i>');
    } else {
      $(".alllock").html('<i class="db fa fa-unlock" aria-hidden="true" style="font-size: 11px !important;"></i>');
    }
    var innPgCanvas = this.arrPageCanvas[this.seletecdPg - 1];
    innPgCanvas.renderAll();
    this.setObjectStyleforSelection();
    this.renderLayers();
  }
  lockunlocklayer(index) {
    if (!this.editable) { return }
    var innPgCanvas = this.arrPageCanvas[this.seletecdPg - 1];
    var canvas = this.tempobj;
    var obj = canvas.item(index);
    this.selectItemAfterAdded(obj);
    if (this.selectedObj.get('lockMovementY') === true && this.selectedObj.get('lockMovementX') === true) {
      $(".lock_" + index).html('<i class="db fa fa-unlock" aria-hidden="true" style="font-size: 11px !important;"></i>');
      if (this.selectedObj && this.selectedObj.type != 'group') {
        this.selectedObj.set('lockMovementY', false);
        this.selectedObj.set('lockMovementX', false);
        this.selectedObj.set('lockScalingX', false);
        this.selectedObj.set('lockScalingY', false);
        this.selectedObj.setControlsVisibility({
          bl: false,
          br: false,
          tl: false,
          tr: false,
          mt: false,
          mb: false,
          mtr: false,
          mr: true,
          ml: true
      });
        if (this.seletecdPg > 0) {
          innPgCanvas.renderAll();
        }
      }
    } else {
      $(".lock_" + index).html('<i class="db fa fa-lock" aria-hidden="true" style="font-size: 11px !important;"></i>');
      if (this.selectedObj && this.selectedObj.type != 'group') {
        this.selectedObj.set('lockMovementY', true);
        this.selectedObj.set('lockMovementX', true);
        this.selectedObj.set('lockScalingX', true);
        this.selectedObj.set('lockScalingY', true);
        this.selectedObj.setControlsVisibility({
          bl: false,
          br: false,
          tl: false,
          tr: false,
          mt: false,
          mb: false,
          mtr: false,
          mr: false,
          ml: false
      });
        if (this.seletecdPg > 0) {
          innPgCanvas.renderAll();
        }
      }
    }
    this.renderLayers();
  }
  hideshowlayer(index) {
    var innPgCanvas = this.arrPageCanvas[this.seletecdPg - 1];
    if (!this.editable) { return }
    var canvas = this.tempobj;
    var obj = canvas.item(index);
    if (obj.get('visible') == 1) {
      $(".eye_" + index).html('<i class="db fa fa-eye-slash" aria-hidden="true" style="font-size: 11px !important;"></i>');
      if (obj && obj.type != 'group') {
        obj.set('visible', false);
        canvas.discardActiveObject().renderAll();
        if (this.seletecdPg > 0) {
          innPgCanvas.renderAll();
        }
      }
    } else {
      this.selectItemAfterAdded(obj);
      $(".eye_" + index).html('<i class="db fa fa-eye" aria-hidden="true" style="font-size: 11px !important;"></i>');
      if (obj && obj.type != 'group') {
        obj.set('visible', true);
        if (this.seletecdPg > 0) {
          innPgCanvas.renderAll();
        }
      }
    }
  }
  setClickedRow(index) {
    this.selectedRow = index;
  }
  objsingleproperty() {
    this.showrightsidepanel=false;
    this.showrightsidecomments0=false;
    this.showrightsidepanel0=true;
    var canvas = this.arrPageCanvas[this.seletecdPg - 1];
    this.layer3 = canvas.getActiveObjects();
    // console.log(this.layer3)
if(this.layer3.length>1){
     if (this.layer3[0].objtype=="signature" || this.layer3[1].objtype=="signature"){
       if(this.layer3[0].group){
      this.layer4=this.layer3[0].group._objects;
       }
    }
    }
  }
  removevariable() {
    var canvas = this.tempobj;
    var obj = canvas.item(this.selectedRow);
    this.selectItemAfterAdded(obj);
    if (this.seletecdPg > 0) {
      var innPgCanvas = this.arrPageCanvas[this.seletecdPg - 1];
      var arrSel = innPgCanvas.getActiveObjects();
      for (var index in arrSel) {
        innPgCanvas.remove(arrSel[index]);
      }
      innPgCanvas._discardActiveObject();
    }
    innPgCanvas.renderAll();
    $("#" + this.selectedRow).remove();
    this.renderLayers();
  }
  downloadpdfwithdata(){
    let data = {
      'designproductid': String(this.naviDate.designid),
      'downloadType': 'templatewithdata',
      'watermark': this.watermarkvalue,
      'variablebackground': this.variablebackground ? 'on' : 'off',
      'design':this.naviDate.tablename,
      'watermarktext' : this.watermarktext
    }
    this.userService.downloadPDFstrucDOC(data).subscribe(
      response => {
        let blob: any = new Blob([response], { type: "application/pdf;" });
      fileSaver.saveAs(blob, 'pdf' + this.filename1 + this.naviDate.designid + '.pdf');
      })
     
  }
  onChange(fileList: FileList):void{
    let file = fileList[0];
    let fileReader: FileReader = new FileReader();
    let self = this;
    fileReader.onloadend = function (x) {
      self.fileContent = fileReader.result;
    }
    fileReader.readAsText(file);
    try {
      const file = fileList[0];
      const fReader = new FileReader();
      fReader.readAsDataURL(file)
      fReader.onloadend = (_event: any) => {
        this.filename = file.name;
//        this.filename1 = file.name;
        this.base64File = _event.target.result;
      }
    } catch (error) {
      this.filename = null;
 //     this.filename1 = null;
      this.base64File = null;
    }
    const a=document.querySelector('#fileSelect');
    this.fileSelects.nativeElement.value = '';
  }
  uploadfile() {
    var formdata = {
      "id": this.naviDate.designid,
      "mode": this.naviDate.tablename,
      "data": this.fileContent
    };
    this.userService.post_dataxmls(formdata).subscribe(data => {
      if (data == 'success') {
        this.toast.success('Uploaded successfully', '', { progressBar: true });
        this.base64File = null; this.filename = null;
      }
    })
  }
  removelayers(index0) {
    var canvas = this.tempobj;
    var obj = canvas.item(index0);
    this.selectItemAfterAdded(obj);
    if (this.seletecdPg > 0) {
      var innPgCanvas = this.arrPageCanvas[this.seletecdPg - 1];
      var arrSel = innPgCanvas.getActiveObjects();
      for (var index in arrSel) {
        innPgCanvas.remove(arrSel[index]);
      }
      innPgCanvas._discardActiveObject();
    }
    innPgCanvas.renderAll();
    $("#" + index0).remove();
    this.renderLayers();
  }
  dragtextbox(e) {
    let textString = "Add Text";
    //    const txt=textString.replace(/[&\/\\#,+()$~%.'":*?<>{}]/g,'_');
    let text = new fabric.Textbox(textString, {
      left: e.layerX,
      top: e.layerY,
      width: 150,
      fontSize: 16,
      angle: 0,
      textAlign: 'left',
      fontWeight: 'normal',
      fontStyle:'normal',
      underline:'',
      linethrough: false,
      overline:"",
      fontFamily: 'Arial',
      editingBorderColor: 'blue',
      showTextBoxBorder: true,
      textboxBorderColor: 'yellow',
      lockMovementX: false,
      hasRotatingPoint: true,
      objtype: 'stext',
      breakWords: true,
      variable: '',
      objsampledata: '',
      objstyle: '',
      objtext: '',
      objcategory: '',
      linkURL:''
    });
    text.setControlsVisibility({
      bl: false,
      br: false,
      tl: false,
      tr: false,
      mt: false,
      mb: false,
      mtr: false,
      mr: true,
      ml: true
    });
    this.extend1(text, this.randomId(), text.objtype, text.objsampledata, text.objtext, text.objcategory, text.breakWords,text.linkURL);
    this.tempobj.add(text);
    this.selectItemAfterAdded(text);
    $('#addtext04').val('');
    this.renderLayers();
    this.textString = '';
  }
  imgpolar(e){}
  uploadlogo(e) {
    var data = this.activelogo;
    var str = data.replace(environment.swagss, '');
    var innPgCanvas = this.arrPageCanvas[this.seletecdPg - 1];
    fabric.Image.fromURL(data, (image) => {
      image.set({
        left: e.layerX,
        top: e.layerY,
        angle: 0,
        cornersize: 4,
        hasRotatingPoint: true,
        peloas: 12,
        width: image.width,
        height: image.height,
        tmp_width: image.width,
        tmp_height: image.height,
        objtype: 'logo',
  src1: str
        // fixedWidth: 150,
      }).scale(0.9);
      image.setControlsVisibility({
        bl: true,
        br: true,
        tl: true,
        tr: true,
        mt: true,
        mb: true,
        mtr: false,
        mr: true,
        ml: true
      });
      this.extendlogo(image, this.randomId(), image.objtype, image.src1, image.tmp_width, image.tmp_height);
      innPgCanvas.add(image);
    innPgCanvas.setActiveObject(image).renderAll();
    this.renderLayers();
     },{
      crossOrigin: 'anonymous'
    });
     this.emptycontrols();
     this.gettimefun();
     this.activelogo='';
  }
  barcode(e, barcodes,ln,lt) {
    this.ln=ln;
    this.lt=lt;
    if(lt=="PostnetZip" || lt=="PLANET"){
      this.barcodemsg='*Numbers only';
      this.barcodemsg1='Max Chars: UNLIMITED';
    }
    if(lt=="Barcode_128" || lt=="QR" || lt=="2D_Barcode"){
      this.barcodemsg='*Any Character';
      this.barcodemsg1='Max Chars: UNLIMITED';
    }
    if(lt=="Barcode39"){
      this.barcodemsg='*[A-Z0-9.$/+%]';
      this.barcodemsg1='Max Chars: UNLIMITED';
    }
     if(lt=="EAN8"){
      this.barcodemsg='*Numbers only';
      this.barcodemsg1='Max Chars: 8';
    }
    if (!this.editable) { return }
    this.model = { option: "fixed" }
    this.modalRef = this.modalService.show(barcodes, { class: 'modal-md', backdrop: 'static' });
      var innPgCanvas = this.arrPageCanvas[this.seletecdPg - 1];
      fabric.Image.fromURL(e, (image) => {
        image.set({
        left: 300,
        top: 100,
        angle: 0,
        cornersize: 4,
        hasRotatingPoint: true,
        peloas: 12,
        width: image.width,
        height: image.height,
        tmp_width: image.width,
        tmp_height: image.height,
        cacheKey: 'barcode',
        objtype: 'barcode',
        barcode_val0: '',
        barcode_val: '',
        label_name:this.ln,
        label_type:this.lt,
        id: this.randomId()
      }).scale(0.9);
      this.extendbarcode(image, image.id, image.objtype, image.cacheKey,image.barcode_val0, image.barcode_val,image.label_name,image.label_type, image.tmp_width, image.tmp_height);
      innPgCanvas.add(image);
      this.emptycontrols();
      innPgCanvas.setActiveObject(image).renderAll();
      this.renderLayers();
    });
  }
  selectItemAfterAdded(obj) {
    if(obj && obj!=undefined){
    this.tempobj.discardActiveObject().renderAll();
    this.tempobj.setActiveObject(obj).renderAll();
    }
  }
  btnsuperimposedownload() {
    this.userService.structimposedownload(this.naviDate.designid,this.naviDate.tablename).subscribe(
      responsei => {
        let blob: any = new Blob([responsei], { type: "application/pdf;" });
       fileSaver.saveAs(blob, 'superimpose' + this.naviDate.designid + '.pdf');
      })
  }
  log(event, i) {
    this.itemnames[i].open = event
  }
  log1(event, i, j, k) {
    this.itemnames[i].subitemname[j].open = event
    if (k)
      this.itemnames[i].subitemname[j].subitemname[k] = event
  }
  toggleUniform() {
    var aObject = this.tempobj.getActiveObject();
    if (aObject.type === 'activeSelection') {
      aObject.getObjects().forEach(function (obj) {
        obj.set('strokeUniform', !obj.strokeUniform);
      });
    } else {
      aObject.set('strokeUniform', !aObject.strokeUniform);
    }
    this.tempobj.requestRenderAll();
  }
//search box..
searchShow:boolean=false;
serachImage:any;
searchValue:any;
getSearchBoxValue(value){
  if(!value){
    this.serachImage=[]
  }else{
    this.userService.getSearchImage(value).subscribe(data => {
      this.serachImage = data;
        })
  }
 
}
Templates() {
  this.closeAllPanels('templates-area');
  this.canvasmove()
  //this.refreshSection('templatelist');
}
canvasmove(){
  var val=$('.' + this.panelOpen).css('display');
  //  console.log(val)
   if(val=='block'){
     if(Math.round(this.currenttmpwidth)==816){
   $(".structuredocsec .card-body").css('margin-left','310px');
     }
   }else{
     $(".structuredocsec .card-body").css('margin-left','auto');
   }
 }
 Text(istoggle = true) {
  this.closeAllPanels('text-area', istoggle);
  this.canvasmove();
}
Shapes(istoggle = true) {
  this.closeAllPanels('shape-area', istoggle);
  this.canvasmove();
}
signatures(istoggle = true) {
  this.closeAllPanels('signature-area', istoggle);
  this.canvasmove();
}
closeAllPanels(selectedarea, istoggle = true) {
  var areas = ['templates-area', 'mydesigns-area', 'text-area', 'image-area', 'videos-area', 'shape-area', 'layer-area', 'bg-area', 'signature-area'];
  areas.forEach(function(area) {
      if (area != selectedarea)
          $('.' + area).hide();
  });
  if (selectedarea && istoggle)
      $('.' + selectedarea).toggle();
  else
      $('.' + selectedarea).show();

  this.panelOpen = selectedarea;
}
datesigndragenable(ids){
  setTimeout(() => {
  this.dragacbjtect=ids;
  $('#'+ids).css("display","block");
  },100);
}
colorpickercss() {
  $('.sp-container').css('z-index', 0);
  $('.sp-picker-container').css('position', 'relative');
  $('.sp-picker-container').css('float', 'none');
  $('.sp-picker-container').css('padding', '10px');
  $('.sp-picker-container').css('padding-bottom', '300px');
  $('.sp-picker-container').css('margin-bottom', '-290px');
  $('.sp-palette-container').css('position', 'relative');
  $('.sp-palette-container').css('float', 'none');
  $('.sp-palette-container').css('padding', '10px');
  $('.sp-palette-container').css('padding-bottom', '300px');
  $('.sp-palette-container').css('margin-bottom', '-290px');
  $('.sp-palette .sp-thumb-el').css('height', '16px');
  $('.sp-palette .sp-thumb-el').css('border', 'solid 1px #d0d0d0');
  $('.sp-palette .sp-thumb-el').css('width', '19px');
  $('.sp-palette .sp-thumb-el').css('margin', '3px');
  $('.sp-palette-container').css('border-right', 'none');
  $('.sp-palette').css('*', '');
  $('.sp-palette').css('width', '220px');
  $('.sp-palette').css('max-width', 'none');
}
strokecolorSpectrum() {
  let lthis = this;
  $("#strolkecolorSelector").spectrum({
      flat: true,
      showAlpha: false,
      showPalette: true,
      hideAfterPaletteSelect: true,
      preferredFormat: "hex",
      showInput: true,
      localStorageKey: "spectrum.yourcolor",
      palette: [
          ["#ffffff", "#c1b7ad", "#a69d94", "#665a53", "#00b1a5", "#8ed4c4", "#50b9a2", "#006360"],
          ["#000000", "#d2d0cd", "#878788", "#444448", "#005798", "#2f89d9", "#213c7f", "#0f1931"],
          ["#ac002c", "#e6a997", "#b2554d", "#6c1e20", "#4ba6e1", "#93d3e5", "#00a5de", "#004b71"],
          ["#b91020", "#e07a65", "#d70033", "#871821", "#422266", "#9a91da", "#634f90", "#1b1528"],
          ["#f84c05", "#fda240", "#ff7900", "#c74800", "#ac87ba", "#dfaed4", "#926096", "#8c43b4"],
          ["#f8a800", "#f6ce58", "#eeb100", "#c17d00", "#ed64a7", "#ee84ac", "#e53285", "#d50063"],
          ["#ffe500", "#f7da33", "#fad700", "#ffbb00", "#bb678c", "#c77c98", "#a4446d", "#6e243c"],
          ["#00903a", "#9bdfaa", "#45844d", "#1e4624", "#4f2b1f", "#b9967d", "#825745", "#3d281e"],
          ["#8ad000", "#c4e767", "#98cf44", "#44932d", "#be8f60", "#d2b193", "#9a6843", "#4d270b"]
      ],
      move: function(color) {
          var strokecolorVal = color.toHexString();
          var canvas = lthis.tempobj;
          var obj = canvas.getActiveObject();
          if (!obj) {
              lthis.colorpickercss();
          } else if (obj.type == "textbox" || obj.type == "curved-text" || obj.type == "text") {
              lthis.changeObjectColor('stroke', strokecolorVal);
              $('#strolkecolorSelector').css('backgroundColor', strokecolorVal);
              $('#textnostroke').prop('checked', false);
              lthis.colorpickercss();
          } else if (obj.type == null) {
              lthis.colorpickercss();
          }
      },
  });
}
setFontFamily() {
  this.setActiveProp('fontFamily', this.objProps.get('fontFamily'));
  $('#fontselect').css('color', 'white');
}
setActiveProp(name, value) {
  var canvas = this.tempobj;
  var object = canvas.getActiveObject();
  if (!object) return;
  object.set(name, value).setCoords();
  canvas.renderAll();
}
changeObjectColor(style, hex) {
  let lthis = this;
  var canvas = this.tempobj;
  let obj = canvas.selectedObject;
  //if (!obj)
  obj = canvas.getActiveObject();

  if (obj) {
      if (obj.paths) {
          for (let i = 0; i < obj.paths.length; i++) {
              this.setActiveStyle(style, hex, obj.paths[i]);
          }
      } else if (obj.type === "group") {
          let objects = obj.getObjects();
          for (let i = 0; i < objects.length; i++) {
              this.setActiveStyle(style, hex, objects[i]);
          }
      } else this.setActiveStyle(style, hex, obj);
  } else {
      let grpobjs = lthis.canvas.getActiveObjects();
      if (grpobjs) {
          grpobjs.forEach(function(object) {
              if (object.paths) {
                  for (let i = 0; i < object.paths.length; i++) {
                      lthis.setActiveStyle(style, hex, obj.paths[i]);
                  }
              } else lthis.setActiveStyle(style, hex, obj);
          });
      }
  }
 canvas.renderAll();
}
}

(function(fabric) {

  /*
   * https://jsfiddle.net/av01d/4p0syzw3/
   * CurvedText object for fabric.js
   * @author Arjan Haverkamp (av01d)
   * @date January 2018
   */
  var clone = fabric.util.object.clone;

  fabric.CurvedText = fabric.util.createClass(fabric.Object, {
      type: 'curved-text',
      diameter: 250,
      kerning: 0,
      text: '',
      flipped: false,
      fill: '#000',
      fontFamily: 'Times New Roman',
      fontSize: 24, // in px
      fontWeight: 'normal',
      fontStyle: '', // "normal", "italic" or "oblique".
      cacheProperties: fabric.Object.prototype.cacheProperties.concat('diameter', 'kerning', 'flipped', 'fill', 'fontFamily', 'fontSize', 'fontWeight', 'fontStyle', 'strokeStyle', 'strokeWidth'),
      strokeStyle: null,
      strokeWidth: 0,

      initialize: function(text, options) {
          options || (options = {});
          this.text = text;

          this.callSuper('initialize', options);
          this.set('lockUniScaling', true);

          // Draw curved text here initially too, while we need to know the width and height.
          var canvas = this.getCircularText();
          this.cropCanvas(canvas);
          this.set('width', canvas.width);
          this.set('height', canvas.height);
      },

      _getFontDeclaration: function() {
          return [
              // node-canvas needs "weight style", while browsers need "style weight"
              (fabric.isLikelyNode ? this.fontWeight : this.fontStyle),
              (fabric.isLikelyNode ? this.fontStyle : this.fontWeight),
              this.fontSize + 'px',
              (fabric.isLikelyNode ? ('"' + this.fontFamily + '"') : this.fontFamily)
          ].join(' ');
      },

      cropCanvas: function(canvas) {
          var ctx = canvas.getContext('2d'),
              w = canvas.width,
              h = canvas.height,
              pix = {
                  x: [],
                  y: []
              },
              n,
              imageData = ctx.getImageData(0, 0, w, h),
              fn = function(a, b) {
                  return a - b
              };

          for (var y = 0; y < h; y++) {
              for (var x = 0; x < w; x++) {
                  if (imageData.data[((y * w + x) * 4) + 3] > 0) {
                      pix.x.push(x);
                      pix.y.push(y);
                  }
              }
          }
          pix.x.sort(fn);
          pix.y.sort(fn);
          n = pix.x.length - 1;

          w = pix.x[n] - pix.x[0];
          h = pix.y[n] - pix.y[0];
          var cut = ctx.getImageData(pix.x[0], pix.y[0], w, h);

          canvas.width = w;
          canvas.height = h;
          ctx.putImageData(cut, 0, 0);
      },

      // Source: http://jsfiddle.net/rbdszxjv/
      getCircularText: function() {
          var text = this.text,
              diameter = this.diameter,
              flipped = this.flipped,
              kerning = this.kerning,
              fill = this.fill,
              inwardFacing = true,
              startAngle = 0,
              canvas = fabric.util.createCanvasElement(),
              ctx = canvas.getContext('2d'),
              cw, // character-width
              x, // iterator
              clockwise = -1; // draw clockwise for aligned right. Else Anticlockwise

          if (flipped) {
              startAngle = 180;
              inwardFacing = false;
          }

          startAngle *= Math.PI / 180; // convert to radians

          // Calc heigt of text in selected font:
          var d = document.createElement('div');
          d.style.fontFamily = this.fontFamily;
          d.style.fontSize = this.fontSize + 'px';
          d.style.fontWeight = this.fontWeight;
          d.style.fontStyle = this.fontStyle;
          d.textContent = text;
          document.body.appendChild(d);
          var textHeight = d.offsetHeight + 50;
          document.body.removeChild(d);

          canvas.width = canvas.height = diameter;
          ctx.font = this._getFontDeclaration();

          // Reverse letters for center inward.
          if (inwardFacing) {
              text = text.toString().split('').reverse().join('')
          };

          // Setup letters and positioning
          ctx.translate(diameter / 2, diameter / 2); // Move to center
          var outward = 1;
          if (inwardFacing) outward = 0;
          startAngle += (Math.PI * outward); // Rotate 180 if outward
          ctx.textBaseline = 'middle'; // Ensure we draw in exact center
          ctx.textAlign = 'center'; // Ensure we draw in exact center

          // rotate 50% of total angle for center alignment
          for (x = 0; x < text.length; x++) {
              cw = ctx.measureText(text[x]).width;
              startAngle += ((cw + (x == text.length - 1 ? 0 : kerning)) / (diameter / 2 - textHeight)) / 2 * -clockwise;
          }

          // Phew... now rotate into final start position
          ctx.rotate(startAngle);

          // Now for the fun bit: draw, rotate, and repeat
          for (x = 0; x < text.length; x++) {
              cw = ctx.measureText(text[x]).width; // half letter
              // rotate half letter
              ctx.rotate((cw / 2) / (diameter / 2 - textHeight) * clockwise);
              // draw the character at "top" or "bottom"
              // depending on inward or outward facing

              // Stroke
              if (this.strokeStyle && this.strokeWidth) {
                  ctx.strokeStyle = this.strokeStyle;
                  ctx.lineWidth = this.strokeWidth;
                  ctx.miterLimit = 2;
                  ctx.strokeText(text[x], 0, (inwardFacing ? 1 : -1) * (0 - diameter / 2 + textHeight / 2));
              }

              // Actual text
              ctx.fillStyle = fill;
              ctx.fillText(text[x], 0, (inwardFacing ? 1 : -1) * (0 - diameter / 2 + textHeight / 2));

              ctx.rotate((cw / 2 + kerning) / (diameter / 2 - textHeight) * clockwise); // rotate half letter
          }
          return canvas;
      },

      _set: function(key, value) {
          switch (key) {
              case 'scaleX':
                  this.fontSize *= value;
                  this.diameter *= value;
                  this.width *= value;
                  this.scaleX = 1;
                  if (this.width < 1) {
                      this.width = 1;
                  }
                  break;

              case 'scaleY':
                  this.height *= value;
                  this.scaleY = 1;
                  if (this.height < 1) {
                      this.height = 1;
                  }
                  break;

              default:
                  this.callSuper('_set', key, value);
                  break;
          }
      },

      _render: function(ctx) {
          var canvas = this.getCircularText();
          this.cropCanvas(canvas);

          this.set('width', canvas.width);
          this.set('height', canvas.height);

          ctx.drawImage(canvas, -this.width / 2, -this.height / 2, this.width, this.height);

          this.setCoords();
      },

      toObject: function(propertiesToInclude) {
          return this.callSuper('toObject', ['text', 'diameter', 'kerning', 'flipped', 'fill', 'fontFamily', 'fontSize', 'fontWeight', 'fontStyle', 'strokeStyle', 'strokeWidth'].concat(propertiesToInclude));
      },

      _toSVG: function() {
          return [
              '<' + this.type + ' ', 'COMMON_PARTS',
              'points="',
              '" />\n'
          ];
      }
  });

  fabric.CurvedText.fromObject = function(object, callback, forceAsync) {
      return fabric.Object._fromObject('CurvedText', object, callback, forceAsync, 'curved-text');
  };

  fabric.Object.prototype.toObject = (function (toObject) {
      return function (propertiesToInclude) {
          propertiesToInclude = (propertiesToInclude || []).concat(
              ['video_src']
          );
          return toObject.apply(this, [propertiesToInclude]);
      };
  })(fabric.Object.prototype.toObject);
})(fabric);
